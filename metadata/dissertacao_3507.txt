2016: DISSERTAC¸ ˜AO DE MESTRADO
Mestrado Proﬁssional em Matem´atica - PROFMAT, Universidade Federal de S˜ao Jo˜ao Del-Rei - UFSJ
Sociedade Brasileira de Matem´atica - SBM

M´ETODO ELGAMAL DE CRIPTOGRAFIA E AS CURVAS
EL´IPTICAS

Jos´e Helv´esio Rosa J´unior 1
F´abio Alexandre de Matos2

Resumo: Apresentamos neste trabalho a Fun¸c˜ao de Euler, o Teorema de Euler, o M´etodo
Elgamal de Codiﬁca¸c˜ao e um breve estudo sobre Curvas El´ıpticas e suas aplica¸c˜oes em
Criptograﬁa. Tais teoremas, deﬁni¸c˜oes e m´etodos possibilitaram uma eleva¸c˜ao substancial
no n´ıvel de prote¸c˜ao de dados, t˜ao necess´aria em nosso cotidiano.

Palavras-chave: Criptograﬁa, Curvas El´ıpticas, M´etodo Elgamal, Fun¸c˜ao de Euler.

1

Introdu¸c˜ao

O aperfei¸coamento e a necessidade de utiliza¸c˜ao da criptograﬁa foram ampliados com o
in´ıcio da Era da Informa¸c˜ao (ou Era Digital - cujo in´ıcio pode ser estabelecido como o
ﬁm do s´eculo XX). Os diversos sistemas e produtos que surgem com in´ıcio deste novo
per´ıodo na hist´oria humana est˜ao propiciando uma diversidade de possibilidades basea-
das na troca r´apida de informa¸c˜oes. Inerente `as trocas est´a a necessidade de proteger os
componentes da informa¸c˜ao. Dentro deste contexto, a criptograﬁa, que ﬁgura como uma
aliada na prote¸c˜ao das in´umeras informa¸c˜oes que circulam pelos diversos meios, tem se
tornado objeto de compreens˜ao de poucos e a beleza dos conceitos matem´aticos envolvidos
atua como desconhecida, apesar de extremamente necess´aria.

O advento dos m´etodos de criptograﬁa utilizados atualmente s´o foi poss´ıvel a par-
tir de conceitos elementares da Teoria dos N´umeros - ramo da Matem´atica que estuda
propriedades dos n´umeros em geral, e em particular dos n´umeros inteiros. A Fun¸c˜ao
Totiente (ou Fun¸c˜ao de Euler) (Deﬁni¸c˜ao 6) e o Teorema de Euler (Teorema 3), dentre
outros, s˜ao frutos deste Ramo desenvolvidos a mais de dois s´eculos. Reunidos, alicer¸cam
processos brilhantes de codiﬁca¸c˜ao, como exemplo est´a o M´etodo Elgamal, apresentado
em 1985 pelo Cript´ografo Eg´ıpcio Taher Elgamal. Este m´etodo, quando aplicado sobre
curvas el´ıpticas, apresenta uma enorme eﬁciˆencia j´a que aumenta a prote¸c˜ao quando da
transmiss˜ao eletrˆonica de dados.

1Aluno de Mestrado do PROFMAT, Turma 2014, Universidade Federal de S˜ao Jo˜ao Del-Rei - UFSJ,

helvesiomat@yahoo.com.br

2Professor orientador, Departamento de Matem´atica e Estat´ıstica - DEMAT, UFSJ,

matos@ufsj.edu.br

O aumento desta prote¸c˜ao ´e atingido quando ´e utilizada a deﬁni¸c˜ao da adi¸c˜ao sobre
Curvas El´ıpticas. Somar, ent˜ao, passa a ser um ‘caminhar aleat´orio’ - Koblitz (1994) - so-
bre um conjunto ﬁnito de pares ordenados com coordenadas inteiras que satisfazem certas
express˜oes. Como convite ao leitor, sugerimos comparar como o m´etodo de criptograﬁa
citado ´e desenvolvido em cada uma das duas maneiras apresentadas - aritm´etica modular
e sobre curvas el´ıpticas - enfatizando as peculiaridades sobre a segunda.

Apresentar uma base te´orica completa foge ao objetivo deste texto, mas ´e algo que
pode ser satisfeito na bibliograﬁa referenciada. Entretanto, por interm´edio de uma lin-
guagem simples e com exemplos num´ericos, acreditamos que esta obra possa servir como
uma apresenta¸c˜ao do tema e consequentemente possa instigar o interesse pela aritm´etica
modular e demais assuntos decorrentes al´em de tentar provocar uma reﬂex˜ao sobre os
questionamentos e eventuais respostas que podem ser constru´ıdas por professores, em
sala de aula, sobre o amadurecimento e a aplicabilidade da Matem´atica no dia a dia.

Quando o assunto ´e cotidiano, ´e imposs´ıvel n˜ao perceber como diversas tarefas, essen-
ciais ou n˜ao, s˜ao efetuadas por interm´edio de dispositivos eletrˆonicos que trocam os mais
variados tipos de informa¸c˜ao. Dentro desta realidade surge a necessidade de um tr´afego
r´apido de mensagens, mas com privacidade e seguran¸ca. Inseridos neste contexto est˜ao
alunos dos mais diversos n´ıveis de ensino, seus smartphones, computadores, milhares de
aplicativos e uma pergunta - como proteger dados? A resposta almejada foi alcan¸cada e
tem sido constantemente aprimorada gra¸cas `a Matem´atica.

2 M´etodo Elgamal de Criptograﬁa

2.1 O M´etodo

O M´etodo Elgamal de criptograﬁa foi apresentado pela primeira vez em um artigo [1]
em 1985 pelo Cript´ografo Eg´ıpcio Taher Elgamal. O processo utiliza chaves p´ublicas e
privadas cujas deﬁni¸c˜oes apresentamos a seguir:

Deﬁni¸c˜ao 1 Uma Chave P´ublica ´e uma parte do protocolo de criptograﬁa composta por
itens que podem ser divulgados sem qualquer tipo de restri¸c˜ao.

Deﬁni¸c˜ao 2 Uma Chave Privada ´e uma parte do protocolo de criptograﬁa composta por
itens que s´o podem ser do conhecimento do(s) transmissor(es) e do(s) receptor(es) da
informa¸c˜ao codiﬁcada.

Uma, dentre outras caracter´ısticas do m´etodo, est´a a transforma¸c˜ao de cada parte de
uma mensagem em um par de dados codiﬁcados. Sua seguran¸ca est´a baseada no Problema
do Logaritmo Discreto, ou seja, est´a estruturada sobre a enorme diﬁculdade de encontrar
o expoente a sabendo apenas o resto da divis˜ao de ba por um n´umero primo quando os
c´alculos s˜ao realizados utilizando n´umeros formados por mais de 200 algarismos.

2

2.2 Embasamento Te´orico

Diversos processos de criptograﬁa tem se baseado na Aritm´etica Modular - uma ferra-
menta important´ıssima da Teoria dos N´umeros. Devido a riqueza deste conte´udo, assu-
miremos a familiaridade do leitor quanto `as deﬁni¸c˜oes elementares e a simbologia. Indi-
camos [4] - Apostila 7 do Programa de Inicia¸c˜ao Cient´ıﬁca da Olimp´ıada Brasileira de
Matem´atica das Escolas P´ublicas - e [5] como fontes iniciais de consulta. Ressaltaremos
abaixo algumas deﬁni¸c˜oes, teoremas e demonstra¸c˜oes que propiciam a funcionalidade da
codiﬁca¸c˜ao e posteriormente decodiﬁca¸c˜ao abordados na subse¸c˜ao [2.3]:

Deﬁni¸c˜ao 3 Um Sistema Completo de Res´ıduos ´e um conjunto formado por todos os m
elementos representantes de uma classe de equivalˆencia m´odulo m.

Deﬁni¸c˜ao 4 Uma Fun¸c˜ao aritm´etica ´e uma fun¸c˜ao que est´a deﬁnida para todos os intei-
ros positivos.

Deﬁni¸c˜ao 5 Uma fun¸c˜ao aritm´etica ´e dita multiplicativa quando f (a · b) = f (a) · f (b)
para qualquer par de inteiros positivos a e b, tais que mdc (a, b) = 1.

Deﬁni¸c˜ao 6 A Fun¸c˜ao Totiente, ou Fun¸c˜ao de Euler (denotada por φ) ´e uma fun¸c˜ao
aritm´etica que informa a quantidade de n´umeros inteiros positivos relativamente primos
a n ∈ N, ou seja

φ(n) = # {a ∈ Z|1 ≤ a < n, mdc(a, n) = 1}.

Exemplo 1 φ(10) = 4, pois {1, 3, 7 e 9} s˜ao os quatro n´umeros relativamente primos a
10.
Observa¸c˜ao: φ(1) = 1 pois mdc(1,1)=1.

Teorema 1 A Fun¸c˜ao de Euler ´e uma fun¸c˜ao aritm´etica multiplicativa.

Sejam a e b ∈ Z, positivos de maneira que mdc(a,b)=1. ´E necess´ario mostrar que

φ(a · b) = φ(a) · φ(b).

Se a=b=1 ´e verdadeiro pois φ(1) = 1 ent˜ao φ(a · b) = φ(a) · φ(b) = 1 · 1 = 1.

Se a > 1 e b > 1, podemos escrever a · b em a colunas, da seguinte maneira:

1
a + 1
2·a + 1
...
(b - 1)·a + 1

2
a + 2
2·a + 2
...
(b - 1)·a + 2

...
...
...
...
...

n
a + n
2·a + n
...

a
2·a
3·a
...
(b - 1)·a + n ... b·a

...
...
...
...

Todos os inteiros da n-´esima coluna ser˜ao primos com a se, e somente se, mdc(a,

n)=1.

3

Como mdc(x·a+n, a)=mdc(n, a), evidentemente, a quantidade de inteiros primos com a
´e deﬁnida por φ(a), ent˜ao h´a φ(a) colunas cujos inteiros que as comp˜oe s˜ao todos primos
com a.

Analisando cada uma destas φ(a) colunas, veriﬁca-se um sistema completo de res´ıduos,
pois s˜ao compostas por b elementos todos incongruentes 2 a 2. Assim, h´a φ(b) elementos
relativamente primos com b, logo h´a φ(a) · φ(b) primos com a · b, ent˜ao φ(a · b) =
φ(a) · φ(b).

Teorema 2 Se p > 1 ´e um n´umero primo, ent˜ao φ(p) = p − 1.

Como p ´e primo, todos os inteiros positivos menores que p ´e primo com p, logo
φ(p) = p − 1. A rec´ıproca ´e verdadeira pois, se p fosse composto, ele possuiria um divisor
1 < n < p tal que p = n · a, o que implicaria em φ(p) < p − 1.

Teorema 3 (Teorema de Euler) Sejam os n´umeros a e n, com n inteiro positivo, tais
que mdc(a,n)=1, a seguinte rela¸c˜ao de congruˆencia ´e v´alida:

aφ(n) ≡ 1 (mod n).

Para a prova, ´e necess´ario estabelecer o Lema 2.2:

lemaLema
Sejam a e n> 1 inteiros tais que mdc(a, n)=1. Se a1, a2, ..., aφ(n) s˜ao inteiros positi-
vos menores que n e que s˜ao relativamente primos com n, ent˜ao cada um dos inteiros
a · a1, a · a2, ..., a · aφ(n) ´e congruente m´odulo n a um dos inteiros a1, a2, ..., aφ(n) (n˜ao ne-
cessariamente nesta ordem em que aparecem).

Os inteiros a · a1, a · a2, ..., a · aφ(n) s˜ao mutuamente incongruentes m´odulo n, pois, se

a · ai ≡ a · aj (mod n), com 1 ≤ i ≤ j ≤ φ(n).

Como mdc(a, n)=1, podemos utilizar o inverso multiplicativo do fator comum a o que
resulta em ai ≡ aj (mod n) ⇔ n|(ai − aj), o que ´e imposs´ıvel visto que (ai − aj) < n.

Por outro lado, como o mdc(ai, n)=1, i = 1, 2, ..., φ(n) e o mdc(a, n)=1, ent˜ao

mdc(a · ai, n)=1.

Mas, pelo algoritmo da divis˜ao, a · ai = n · qi + ri, 0 ≤ ri ≤ n, que implica em

a · ai ≡ ri (mod n), com 0 ≤ ri ≤ n

portanto, mdc(ri, n)= mdc(a · ai, n)=1 de modo que ri ´e um dos inteiros a1, a2, ..., aφ(n),
isto ´e, cada um dos inteiros a1, a2, ..., aφ(n) ´e congruente m´odulo n a um ´unico dos inteiros
a1, a2, ..., aφ(n), em uma certa ordem.
Reunidas as condi¸c˜oes, segue agora a prova do Teorema de Euler:
A veriﬁca¸c˜ao para n = 1 ´e trivial, pois aφ(1) ≡ 1 (mod 1). Supondo, pois n > 1, e sejam

4

a1, a2, ..., aφ(n) os inteiros positivos menores que n e relativamente primos a n. Como mdc
(a, n)=1, ent˜ao, pelo Lema 2.2, os inteiros a · a1, a · a2, ..., a · aφ(n) s˜ao congruentes m´odulo
n aos inteiros a1, a2, ..., aφ(n) em uma certa ordem

a · a1 ≡ a1

∗, a · a2 ≡ a2

∗, ..., a · aφ(n) ≡ aφ(n)

∗

∗, a2

∗, ..., aφ(n) denotam os inteiros a1, a2, ..., aφ(n) em uma certa ordem. Multipli-
onde a1
cando ordenadamente todas essas φ(n)congruˆencias, obtemos (a · a1) · (a · a2) · ... · (a · aφ(n))
(mod n) ou seja, aφ(n) · (a1 · a2 · ... · aφ(n)) ≡ a1 · a2 · ... · aφ(n) (mod n). Cada um dos inteiros
a1, a2, ..., aφ(n) ´e relativamente primo a n, e quando multiplicados por seus respectivos
inversos geram, ent˜ao, a congruˆencia em quest˜ao, aφ(n) ≡ 1 (mod n).

2.3 As Etapas do M´etodo

Sintetizando o processo de criptograﬁa em trˆes etapas, temos:

[I - ]Determina¸c˜ao das Chaves:
Para gerar as chaves ´e necess´ario:

1.

(a) Deﬁnir um n´umero primo p;
(b) Deﬁnir um gerador g ∈ Zp;
(c) Escolher aleatoriamente um inteiro a, tal que 1 ≤ a ≤ p − 2 e determinar ga

(mod p);

Satisfeitos I-(a), I-(b), I-(c), a Chave P´ublica ﬁca deﬁnida como o trio (p, g, ga) e a
Chave Privada como sendo o inteiro a.

2. Codiﬁca¸c˜ao:

De posse da chave p´ublica, a codiﬁca¸c˜ao deve respeitar os seguintes passos, aten-
tando para a deﬁni¸c˜ao abaixo:

Deﬁni¸c˜ao 7 Uma Pr´e-codiﬁca¸c˜ao ´e a maneira pela qual transforma-se uma letra,
ou qualquer outro componente de uma informa¸c˜ao, em um n´umero que ser´a utilizado
num processo de criptograﬁa.

Exemplo 2 A letra ‘A’ pode se pr´e-codiﬁcada como o n´umero 65, de acordo com a
tabela ASCII 3.

(a) Pr´e-codiﬁcar a mensagem m para n´umeros inteiros de modo que 0 ≤ m ≤

(p − 1);

(b) Selecionar aleatoriamente um inteiro k tal que 1 ≤ k ≤ (p − 2); e

3Do inglˆes American Standard Code for Information Interchange; ”C´odigo Padr˜ao Americano para o
Intercˆambio de Informa¸c˜ao”. ´E um c´odigo bin´ario (cadeias de bits: 0s e 1s) que codiﬁca um conjunto de
128 sinais: 95 sinais gr´aﬁcos (letras do alfabeto latino, sinais de pontua¸c˜ao e sinais matem´aticos) e 33
sinais de controle, utilizando portanto apenas 7 bits para representar todos os seus s´ımbolos.

5

(c) Determinar γ = gk (mod p) e δ = m · (ga)k.

Conclu´ıdos os passos II-(a), II-(b), II-(c), a mensagem m passa a ser o par (γ, δ).

3. Decodiﬁca¸c˜ao:

Para decodiﬁcar a mensagem, ap´os receber o par codiﬁcado (γ, δ) e de posse da
chave privada a, o receptor dever´a:

(a) Determinar γp−1−a (mod p); e
(b) Recuperar a mensagem m por interm´edio de (γ−a) · δ (mod p).

A express˜ao abaixo apresenta uma equa¸c˜ao modular que resume o processo de codi-

ﬁca¸c˜ao e decodiﬁca¸c˜ao:

m ≡ m · (ga)k · (gk)p−1−a ≡ m (mod p). (1)

Um leitor mais atento pode se perguntar como calcular o passo III-(a). A resposta
para esta pergunta ´e facilmente respondida pela utiliza¸c˜ao conjunta dos Teoremas 2 e 3:

• Pelo Teorema 2, φ(p) = p − 1 logo temos γp−1−a = γφ(p)−a = γφ(p) · γ−a; e

• Pelo Teorema de Euler temos γφ(p) = 1, ent˜ao γφ(p) · γ−a = 1 · γ−a.

2.4 Um Exemplo

Supondo que o Jo˜ao pretende enviar, de maneira codiﬁcada, a letra ‘A’ para Maria.
Utilizando o m´etodo em quest˜ao, ele escolhe p = 17, g = 6, a = 5(chave privada). Calcula
ent˜ao

ga = 65 (mod 17)
65 ≡ 7 (mod 17).

Assim, a chave p´ublica (17,6,7) ´e determinada.

Pre-codiﬁcando a letra ‘A’ como o inteiro 10 (obtido pela numera¸c˜ao das letras em
ordem alfab´etica come¸cando por 10), Jo˜ao ainda escolhe aleatoriamente um inteiro k = 11
e determina

γ = gk = 611 (mod 17), ent˜ao γ = 5.

6

Determina tamb´em o δ = 10 · (ga)k = 10 · 711 ≡ 4 (mod 17). A mensagem a ser

enviada, ent˜ao, ser´a o par (5, 4).

Para decodiﬁcar a mensagem, Maria, ao receber o par (5, 4), de posse da chave p´ublica

e da chave privada calcula γ−a · δ (mod 17), ou seja:

5−5 · 4 (mod 17).

Como 5−5 ≡ 75 (mod 17) (pois 5−1=7, deﬁni¸c˜ao de inverso multiplicativo), Maria

calcula:

5−5 ≡ 75 · 4 ≡ 11 · 4 ≡ 44 ≡ 10 (mod 17),

encontrando a letra ”A”, conforme a pr´e-codiﬁca¸c˜ao.

3 Curvas El´ıpticas

Curvas El´ıpticas tem sido objeto de intenso estudo nos ´ultimos dois s´eculos e gerando
uma estrutura alg´ebrica riqu´ıssima quando o assunto ´e criptograﬁa. O nome remete er-
roneamente `a ideia de trabalhos com elipses. Na verdade trata-se de conceitos muitos
mais profundos e densos, come¸cando nas deﬁni¸c˜oes de Geometria Projetiva e Equa¸c˜oes de
Weierstrass. Recentemente (maio de 2016) o WhatsApp Messenger, aplicativo de mensa-
gens mundialmente conhecido, foi atualizado e passou a oferecer conversas criptografadas
baseando-se em um tipo espec´ıﬁco de Curva El´ıptica cuja implementa¸c˜ao ´e explanada em
[9]. Tal atualiza¸c˜ao ´e um excelente exemplo de contextualidade e aplicabilidade do tema.

Abaixo apresentamos a deﬁni¸c˜ao de curvas el´ıpticas omitindo o embasamento te´orico
precedente por ser extremamente complexo e profundo mas que pode ser encontrado prin-
cipalmente em [7] e [3].

Deﬁni¸c˜ao 8 Seja K um corpo, com caracter´ıstica diferente de 2 e 3. E seja o polinˆomio
c´ubico x3 + ax + b, com a e b pertencentes a este corpo, sem multiplicidade de ra´ızes.
Uma curva el´ıptica E sobre K ´e o conjunto de pares ordenados (x, y) que satisfazem a
express˜ao

y2 = x3 + ax + b

(2)

al´em de um elemento denotado por O, chamado de ponto no inﬁnito.

A partir desta deﬁni¸c˜ao, uma aritm´etica muito espec´ıﬁca ´e constru´ıda e, quando s˜ao
utilizados pontos originados de um corpo ﬁnito, uma excelente condi¸c˜ao ´e criada para
codiﬁca¸c˜oes - uma quantidade ﬁnita de elementos e um ‘caminhar aleat´orio” sobre eles.
Neste caminhar, o ponto O desempenhar´a o papel de elemento neutro por ocasi˜ao da
adi¸c˜ao de pontos conforme a deﬁni¸c˜ao 9.

Como exemplo, a Curva El´ıptica y2 = x3 − 36x sobre o conjunto dos n´umeros reais

pode ser representada geometricamente pela ﬁgura (1) a seguir:

7

Figura 1: Curva El´ıptica y2 = x3 − 36x sobre R.

3.1 Aritm´etica sobre Curvas El´ıpticas

Deﬁni¸c˜ao 9 Seja E uma curva el´ıptica sobre R e sejam P e Q dois pontos pertencentes
a E. O negativo de P e a soma P + Q s˜ao deﬁnidas conforme as seguintes regras:

[(i)]

1. Se o ponto P ´e o ponto no inﬁnito O, ent˜ao o ponto −P ser´a o ponto O e P + Q
ser´a o ponto Q, ou seja, o ponto O ser´a o elemento neutro da adi¸c˜ao. Para as
pr´oximas regras os pontos P e Q n˜ao ser˜ao considerados pontos no inﬁnito.

2. O ponto negativo −P ´e um ponto com a mesma abcissa por´em com a ordenada
sim´etrica ao ponto P , ou seja −(x, y) = (x, −y). Obviamente, os pontos (x,y) e
(x,-y) pertencer˜ao `a equa¸c˜ao (2).

A regra (3) se ampara na seguinte proposi¸c˜ao:

Proposi¸c˜ao 1: Se P e Q tem coordenadas diferentes, ent˜ao a reta l = P Q in-
tersectar´a a curva em um ´unico ponto R.

(x2−x1) e β = y1 − αx1.

Sejam (x1, y1), (x2, y2) e (x3, y3) as coordenadas de P , Q e P + Q, respectivamente.
Seja ainda y = αx + β a equa¸c˜ao da reta l determinada pelos pontos P e Q. Ent˜ao
α = (y2−y1)
Um ponto (x, αx + β) pertencente a l estar´a sobre a curva el´ıptica se, e somente
se, (αx + β)2 = x3 + ax + b. Assim, pelas Rela¸c˜oes de Girard 4 , ´e necess´ario que
o discriminante ∆ = 4a3 − 27b2 (cid:54)= 0 para que hajam 3 ra´ızes reais e distintas e,

4Rela¸c˜oes entre os coeﬁcientes e as ra´ızes de um polinˆomio, determinadas pelo Matem´atico francˆes

Albert Girard (1595-1632).

8

consequentemente, haver´a um ´unico ponto de interse¸c˜ao para cada raiz da equa¸c˜ao
c´ubica x3 − (αx + β)2 + ax + b = 0. Duas ra´ızes x1 e x2 j´a s˜ao conhecidas pois
(x1, αx1 + β) e (x2, αx2 + β) s˜ao os pontos conhecidos P e Q sobre a curva. Como a
soma das ra´ızes ´e igual ao coeﬁciente α2 da segunda maior potˆencia de x, determina-
se, ent˜ao, a terceira raiz como x3 = α2 − x1 − x2.

3. Se P e Q tem coordenadas diferentes, ent˜ao a reta l = P Q intersectar´a a curva em
um ´unico ponto R, assim a soma P + Q = −R ﬁca deﬁnida, ou seja, a adi¸c˜ao de
dois pontos ser´a o ponto sim´etrico, em rela¸c˜ao ao eixo das abcissas, da interse¸c˜ao
da reta l com a curva el´ıptica, conforme ilustrado na ﬁgura (2).
Satisfeitas as devidas manipula¸c˜oes, as coordenadas do resultado de P +Q s˜ao dadas
por:

x3 =

(cid:17)2

(cid:16) y2−y1
x2−x1

− x1 − x2 (3)

y3 = −y1 +

(cid:17)

(cid:16) y2−y1
x2−x1

(x1 − x3). (4)

Se P = Q, o coeﬁciente angular da reta l ´e obtido por interm´edio da deriva¸c˜ao
impl´ıcita da equa¸c˜ao (2), obtendo para as coordenadas do ponto P + P = 2P =
(x3, y3):

x3 =

(cid:16) 3x1
2y1

2+a

(cid:17)2

− 2x1 (5)

y3 = −y1 +

(cid:16) 3x1
2y1

2+a

(cid:17)

(x1 − x3) (6)

9

Figura 2: Interpreta¸c˜ao geom´etrica da adi¸c˜ao sobre Curvas El´ıpticas.

4. Se Q = −P (ou seja, se Q e P tem a mesma abcissa e ordenadas opostas) ent˜ao ´e

deﬁnido P + Q = O (o ponto no inﬁnito).

5. A ´ultima possibilidade para os valores das coordenadas ocorre se P = Q. Quando
isto ocorre, a reta l ser´a tangente `a curva em P e intersectar´a a curva no ponto R
deﬁnido como P + P = 2P = −R ou seja, o dobro de P ´e o ponto sim´etrico a R
em rela¸c˜ao ao eixo das abcissas, conforme ilustrado na ﬁgura (3).

Uma observa¸c˜ao importante ´e que a aritm´etica deﬁnida anteriormente, apesar de ter sido
exempliﬁcada sobre o conjunto dos n´umeros reais, ´e aplicada a qualquer corpo, n˜ao sendo
diferente para Fp.

Para exempliﬁcar as deﬁni¸c˜oes, ser˜ao encontrados os pontos P + Q e 2P , com P =

(−3, 9) e Q = (−2, 8) sobre a curva el´ıptica y2 = x3 − 36x:

• Para P + Q:

Substituindo os valores x1 = −3, y1 = 9, x2 = −2 e y2 = 8 nas equa¸c˜oes (3) e (4)
obtendo x3 = 6 e y3 = 0. A ﬁgura (4) ilustra o resultado da opera¸c˜ao:

• Para P + P = 2P :

Analogamente, substituindo os valores das coordenadas de P nas equa¸c˜oes (5) e (6)
os valores x2P = 25

s˜ao obtidos e ilustrados na ﬁgura (5).

4 e y2P = −35

8

10

Figura 3: Interpreta¸c˜ao geom´etrica do dobro de P.

Figura 4: Exemplo num´erico da soma de P + Q sobre a curva el´ıptica y2 =
x3 − 36x.

11

Figura 5: Exemplo num´erico da soma de P + P = 2P sobre a curva el´ıptica
y2 = x3 − 36x.

3.2 Curvas El´ıpticas sobre Corpos Finitos

Curvas El´ıpticas sobre Corpos Finitos comp˜oe uma estrutura muito rica para a criptograﬁa
pois surge da´ı um conjunto ﬁnitos de pontos sobre os quais a codiﬁca¸c˜ao e consequen-
temente a decodiﬁca¸c˜ao tornam-se poss´ıveis. Por interm´edio de algoritmos eﬁcientes e
protegidos pelas deﬁni¸c˜oes elencadas na subse¸c˜ao 3.1, os m´etodos criptogr´aﬁcos tˆem seu
n´ıvel de seguran¸ca aumentado pois o Problema do Logaritmo Discreto torna-se muito
mais dif´ıcil de ser resolvido.

Conforme a deﬁni¸c˜ao 8, uma Curva El´ıptica sobre um Corpo Finito Fp, com p um
n´umero primo ´e o conjunto de pontos (x, y) que satisfazem a equa¸c˜ao (2) m´odulo p, ou
seja:

y2 (mod p) = x3 + ax + b (mod p) (7)

A quantidade de pontos encontrados satisfaz a inequa¸c˜ao apresentada no Teorema de
Hasse5, |N − (q + 1)| ≤ 2
q, onde N ´e a quantidade de pontos e q ´e a quantidade de
elementos do Corpo Finito. Este fato consolida uma caracter´ıstica essencial para a crip-
tograﬁa - a quantidade ﬁnita de elementos.

√

Exempliﬁcando, utilizaremos o corpo ﬁnito F5 (cujos elementos s˜ao os n´umeros inteiros
de 0 a 4). Sabemos que qualquer opera¸c˜ao resultar´a em um n´umero inteiro entre 0 e 4
se p = 5. Fazendo a = 1 e b = 1 em (7), os c´alculos necess´arios para encontrar os pares
(x, y) que satisfazem a Curva El´ıptica y2 = x3 + x + 1 sobre F5 s˜ao os seguintes:

5Para mais detalhes sobre o Teorema de Hasse e sua demonstra¸c˜ao, consulte [2].

12

x
0
1
2
3
4

x3 + x + 1
1
3
11
31
69

x3 + x + 1 (mod 5)
1
2
1
1
4

y
0
1
2
3
4

y2
0
1
4
9
16

y2 (mod 5)
0
1
4
4
1

C´alculos das abcissas.

C´alculos das ordenadas.

E assim os pontos procurados s˜ao (0,1), (0,4), (2,1), (2,4), (3,1), (3,4), (4,2) e (4,3).
Apesar de n˜ao ser o caso exempliﬁcar geometricamente as opera¸c˜oes devido ao corpo
utilizado, representando os pontos num plano cartesiano ´e poss´ıvel perceber uma certa
simetria na ﬁgura (6).

Figura 6: Representa¸c˜ao cartesiana da Curva El´ıptica y2 = x3 + x + 1 sobre F5.

Cabe ressaltar como se d´a a adi¸c˜ao elencada na deﬁni¸c˜ao 9:

• Seja P(0,1), como obter P+P=2P? Conforme a regra (3) da subse¸c˜ao 3.1 temos P=P,
ent˜ao a abcissa ser´a obtida por interm´edio da regra (3)(4) da mesma subse¸c˜ao, com
a aten¸c˜ao para o detalhe do inverso multiplicativo:

(cid:16) 3·02+1
2·1

(cid:17)2

x2P =
Portanto x2P = 32 ≡ 4 (mod 5).

− 2 · 0 = (1 · 2−1)2 (mod 5), onde 2−1 ´e o inverso de 2 (mod 5).

Para ober y2P , utiliza-se a regra (3)(5) da subse¸c˜ao 3.1, ou seja:

y2P = −1 +

(cid:16) 3·02+1
2·1

(cid:17)

(0 − 4) (mod 5).

13

y2P = −1 + 1 · 2−1 · (−4) (mod 5),
substituindo 2−1 por 3 e −4 por 1
y2P = −1 + 3 · 1 ≡ 2 (mod 5).
Logo temos 2P=(4,2).

4−0

(cid:1)2 − 0 − 4 (mod 5)

• Sejam P(0,1) e Q(4,2). Para obter abcissa e a ordenada do ponto P+Q basta
utilizar as regras (3)(2) e (3)(3), ambos da subse¸c˜ao 3.1, respectivamente:
xP +Q = (cid:0) 2−1
xP +Q = (1 · 4−1)2 − 4 (mod 5), substituindo 4−1 por 4,
xP +Q = 42 − 4 = 12 ≡ 2 (mod 5)
e
yP +Q = −1 + (cid:0) 2−1
yP +Q = −1 + 4(−2) (mod 5),
substituindo −2 por 3,
yP +Q = −1 + 4 · 3 = 11 ≡ 1 (mod 5).
Logo temos P+Q=(2, 1).

(cid:1) (0 − 2) (mod 5)

4−0

4 O M´etodo Elgamal sobre Curvas El´ıpticas

O m´etodo, agora, possuir´a uma diferen¸ca quando da adi¸c˜ao de pontos ou da multiplica¸c˜ao
de um ponto por um escalar, pois ser˜ao utilizadas as regras aritm´eticas apresentada na
deﬁni¸c˜ao 9.

De maneira an´aloga `a subse¸c˜ao (2.3), as etapas ser˜ao:

[I - ]Determina¸c˜ao das Chaves:
Para gerar as chaves ´e necess´ario:

1.

(a) Escolher um n´umero primo p para um corpo Fp e uma Curva El´ıptica E;
(b) Escolher um ponto P que perten¸ca ao conjunto de pontos de E sobre Fp;
(c) Escolher aleatoriamente um inteiro a, tal que 1 ≤ a ≤ p − 2 e determinar um
novo ponto A = a · P respeitando a multiplica¸c˜ao por escalar sobre curvas
el´ıpticas;

Satisfeitos I-(a), I-(b), I-(c), a Chave P´ublica ser´a composta por (E, Fp, P, A) e a
Chave Privada ser´a apenas inteiro a.

2. Codiﬁca¸c˜ao:

De posse da chave p´ublica, a codiﬁca¸c˜ao deve respeitar os seguintes passos:

(a) Pr´e-codiﬁcar a mensagem m de modo a associ´a-la a um ponto M pertencente

`a curva E sobre Fp;

14

(b) Escolher um inteiro k e computar M1 = k · P atentando para a deﬁni¸c˜ao de

multiplica¸c˜ao por escalar sobre curvas el´ıpticas; e

(c) Somar M2 = M + k · A, atentando para a deﬁni¸c˜ao da soma de dois pontos em

curvas el´ıpticas.

Conclu´ıdos os passos II-(a), II-(b), II-(c), a mensagem m passa a ser o par (M1, M2).

3. Decodiﬁca¸c˜ao:

Para decodiﬁcar a mensagem, ap´os receber o par codiﬁcado (M1, M2) e de posse da
chave privada a, o receptor dever´a:

(a) Computar o ponto M utilizando a equa¸c˜ao M = M2 − a · M1; e
(b) Obter a mensagem m conforme a associa¸c˜ao ao ponto M .

Assim, todo o processo pode ser resumido pelos passos abaixo:

M = M2 − a · M1, como M2 = M + k · A e M1 = k · P
M = M + k · A − a · k · P , fazendo A = a · P , temos
M = M + k · a · P − a · k · P , ent˜ao M = M .

Exempliﬁcando o m´etodo em quest˜ao, ser´a utilizada a Curva El´ıptica E : y2 = x3+x+1
sobre F11 cujos pontos tem sua representa¸c˜ao na ﬁgura 7 onde, mais uma vez, percebe-se
uma simetria:

Figura 7: Representa¸c˜ao cartesiana da Curva El´ıptica E : y2 = x3 + x + 1 sobre
F11.

• Estabelecendo o ponto inicial P = (1, 5).

15

• Escolhendo a = 2, calculamos A = 2 · P :

xA =

(cid:16) 3·12+1
2·5

(cid:17)2

− 2 · 1 ≡ 3 (mod 11)

yA = −5 +

(cid:16) 3·12+1
2·5

(cid:17)

(1 − 3) ≡ 3 (mod 11)

Assim obtemos A = (3, 3) e a chave p´ublica ser´a [E, F11, (1, 5), (3, 3)].

• Supondo que o transmissor desejasse transmitir a palavra ‘F´E’, pr´e-codiﬁcada como
65 (conforme a numera¸c˜ao das letras do alfabeto - F=6, E=5) associada, ent˜ao ao
ponto M = (6, 5). De posse da chave p´ublica, determina M1 = k·P e M2 = M +k·A.
Escolhendo aleatoriamente k = 3 temos:
Para o c´alculo de M1:
Como M1 = 3 · P = P + 2 · P , basta fazer M1 = (1, 5) + (3, 3):

xM 1 = (cid:0) 3−5

(cid:1)2 − 1 − 3 (mod 11)
(cid:1) − 4 = 1 − 4 = −3 ≡ 8 (mod 11).

3−1

xM 1 = (cid:0) 4

4

yM 1 = −5 (cid:0) −2
(cid:1) · (1 − 8) (mod 11)
yM 1 = −5(−1) · (−7) ≡ 2 (mod 11).

2

Obtemos, ent˜ao, o ponto M1 = (8, 2).

Para o c´alculo de M2 = M +3·A, primeiro calcularemos 3·A sabendo que 3·A = A+2·A:

Para 2 · A:

x2A =

(cid:16) 3·32+1
2·3

(cid:17)2

− 2 · 3 (mod 11)

x2A = (cid:0) 28

(cid:1)2 − 6

6
x2A = (1)2 − 6 = −5 ≡ 6 (mod 11)

Portanto, 2A = (6, 5).

Para 3 · A:

Para x3A, calculamos:

y2A = −3 + (1) · (3 − 6) (mod 11)
y2A = −3 − 3 = −6 ≡ 5 (mod 11)

3 · (3, 3) = (3, 3) + (6, 5)

16

x3A = (cid:0) 5−3

(cid:1)2 − 3 − 6 (mod 11)
(cid:1)2 − 9
(cid:1)2 − 9 = 4 · 9−1 − 9, onde 9−1 = 5 (mod 11), ent˜ao

x3A = (cid:0) 2

6−3

3

x3A = 20 − 9 = 11 ≡ 0 (mod 11).

x3A = (cid:0) 4

9

Para y3A, calculamos:

y3A = −3 + (cid:0) 2

(cid:1) · (3 − 0) (mod 11)

3

y3A = −3 + 2 · 3−1 · 3 = −3 + 2 · 4 · 3 = 21 ≡ 10 (mod 11).

Agora, obtendo M2 = M + 3 · A:

Para xM2, calculamos:

xM2 = (cid:0) 10−5

0−6

(cid:1)2 − 6 − 0 (mod 11)
(cid:1)2 − 6
(cid:1) − 6
(cid:1) − 6

xM2 = (cid:0) −5
xM2 = (cid:0) 25
xM2 = (cid:0) 3

−6

36

3

xM2 = (1) − 6 = −5 ≡ 6(mod 11).

Para yM2, calculamos:

yM2 = −10 + (cid:0) 6

(cid:1) · (6) (mod 11)

5
yM2 = −10 + (6 · 5−1) · (6), onde 5−1 = 20 (mod 11)
yM2 = −10 + (6 · 20) · (6)
yM2 = −10 + 60
yM2 = 50 ≡ 6 (mod 11).

Desta forma, ﬁca determinado M2 = (6, 6) e a mensagem a ser transmitida passa a

ser a dupla de pontos [(8,2),(6,6)], descaracterizando completamente a palavra ’F´E’.

• Para a decodiﬁca¸c˜ao, o receptor, de posse da mensagem codiﬁcada, calcula M =
M2 − a · M1. Os detalhes dos c´alculos apresentados durante a codiﬁca¸c˜ao ser˜ao
omitidos, mas podem ser conﬁrmados na s´ıntese abaixo:

M = M2 − a · M1
M = (6, 6) − 2 · (8, 2), onde podemos usar a deﬁni¸c˜ao e calcularmos
M = (6, 6) + 2 · (8, 9), fazendo −(8, 2) = (8, −2) = (8, 9)
M = (6, 6) + (0, 1)
M = (6, 5), restaurando o ponto associado `a mensagem original.

Com esta estrutura matem´atica, este m´etodo consegue um n´ıvel de seguran¸ca utili-

zando chaves p´ublicas e privadas muito menores que outros sistemas criptogr´aﬁcos.

17

“Em 2003, a principal empresa ligada a ECC (CERTICOM) promoveu um
teste para veriﬁca¸c˜ao de seguran¸ca do criptossistema baseado em curvas el´ıpticas,
que foi atacado por 10.000 computadores do tipo Pentium durante 540 dias se-
guidos. Nesse epis´odio foi quebrado um sistema com chave de 109 bits...”(Sangalli,
2012)

Entretanto, devido a presen¸ca de c´alculos soﬁsticados, sua utiliza¸c˜ao ´e restrita a si-
tua¸c˜oes em que a complexidade de sua implementa¸c˜ao n˜ao comprometa a rapidez do
processo onde a criptograﬁa est´a inserida.

5 Conclus˜ao

A matem´atica, em alguns momentos durante a vida estudantil, pode ser uma linguagem
muito densa e distante do que se aplica no cotidiano. Esta situa¸c˜ao aliada `a rapidez,
volume e modo cujo o qual as informa¸c˜oes e diversas op¸c˜oes de entretenimento se apre-
sentam `a sociedade tˆem diﬁcultado o ensino de conceitos mais abstratos.

Dentro desta realidade, o Mestrado Proﬁssional em Matem´atica (PROFMAT) de-
senvolvido na Universidade Federal de S˜ao Jo˜ao del Rei (UFSJ), por interm´edio de seus
professores e material did´atico, conduz o aluno participante a um mergulho sobre diversos
temas, permitindo a percep¸c˜ao da complexidade, profundidade e beleza de v´arios ramos
desta Ciˆencia e, simultaneamente, incentiva o aprofundamento em temas que diﬁcilmente
seriam conhecidos fora de um ambiente universit´ario.

Ao escolher estudar, de maneira sutilmente mais atenciosa, como a Matem´atica est´a
inserida em alguns ramos da Criptograﬁa, percebe-se como ´e frut´ıfero o estudo das diver-
sas abstra¸c˜oes alg´ebricas. Um Professor de Ensino B´asico, ao tomar conhecimento destas
teorias, ´e revestido de um amadurecimento que permite responder questionamentos em
sala de aula e exempliﬁcar aplica¸c˜oes de conceitos, mostrando que a densidade e comple-
xidade de certos temas n˜ao diminuem sua beleza e importˆancia para humanidade e ainda,
ao eventualmente convidar seus alunos para uma an´alise hist´orica sobre como as t´ecnicas
de codiﬁca¸c˜ao evolu´ıram ao longo dos s´eculos, pode evidenciar a genialidade presente na
dedica¸c˜ao de diversas personalidades e simultaneamente provocar uma nova percep¸c˜ao de
hero´ısmo.

Referˆencias

[1] EL GAMAL, Taher . A public key cryptosystem and a signature scheme based
on discrete logarithms. In Proceedings of CRYPTO 84 on Advances in cryptology,
pages 10-18. Springer-Verlag, New York, Inc., 1985.

[2] SILVERMAN, J. The Arithmetic of Elliptic Curves, Springer-Verlag, New York,

1986.

18

[3] KOBLITZ, Neal. A Course in Number Theory and Cryptography, 2aEd.,

Springer-Verlag, New York, 1994.

[4] COUTINHO, Severino. Criptograﬁa, IMPA, Rio de Janeiro, 2015.

[5] VIDIGAL, Angela et al. Fundamentos de ´Algebra, Belo Horizonte, UFMG, 2005.

[6] LIMA, Elon Lages Curso de An´alise, Volume 1, 11a Ed., IMPA, Rio de Janeiro,

2006.

[7] COHEN, Henri et al. Handbook of Elliptic and Hyperelliptic Curve Crypto-

graphy. Chapman Hall/CRC, Florida, 2006.

[8] <https://www.certicom.com/-30-elliptic-curve-groups-over-fp>.

Acesso

em

20/03/2016.

[9] <https://www.whatsapp.com/security/>. Acesso em 05/06/2016.

19

