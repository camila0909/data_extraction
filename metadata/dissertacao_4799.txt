Universidade do Estado do Rio de Janeiro

Centro de Tecnologia e Ciˆencias

Instituto de Matem´atica e Estat´ıstica

Jos´e Travassos Ichihara

Constru¸c˜ao de quadrados m´agicos pelo m´etodo do passo

uniforme

Rio de Janeiro

2014

Jos´e Travassos Ichihara

Constru¸c˜ao de quadrados m´agicos pelo m´etodo do passo uniforme

Disserta¸c˜ao apresentada, como requisito par-
cial para obten¸c˜ao do t´ıtulo de Mestre, ao
Programa de Mestrado Proﬁssional em Ma-
tem´atica em Rede Nacional (PROFMAT),
da Universidade do Estado do Rio de Janeiro.

Orientadora: Profa. Dra. Patr´ıcia Nunes da Silva

Rio de Janeiro

2014

               CATALOGAÇÃO NA FONTE UERJ / REDE SIRIUS / BIBLIOTECA CTC-A                 Autorizo, apenas para fins acadêmicos e científicos, a reprodução total ou parcial deste projeto final, desde que citada a fonte.  ______________________________   _____________________________ Assinatura       Data  Ichihara, José Travassos. Construção de quadrados mágicos pelo método do passo uniforme / José Travassos Ichihara. – 2014.  100 f. : il.  Orientadora: Patrícia Nunes da Silva.  Dissertação (Mestrado Profissional em Matemática em Rede Nacional / PROFMAT) - Universidade do Estado do Rio de Janeiro, Instituto de Matemática e Estatística.   1. Teoria dos números. 2.Quadrados mágicos. I. Silva, Patrícia Nunes da.  II. Universidade do Estado do Rio de Janeiro. Instituto de Matemática e Estatística.  III. Título. CDU 512.12  I16 Jos´e Travassos Ichihara

Constru¸c˜ao de quadrados m´agicos pelo m´etodo do passo uniforme

Disserta¸c˜ao apresentada, como requisito par-
cial para obten¸c˜ao do t´ıtulo de Mestre, ao
Programa de Mestrado Proﬁssional em Ma-
tem´atica em Rede Nacional (PROFMAT),
da Universidade do Estado do Rio de Janeiro.

Aprovada em 27 de Novembro de 2014.
Banca Examinadora:

Profa. Dra. Patr´ıcia Nunes da Silva (Orientadora)
Instituto de Matem´atica e Estat´ıstica – UERJ

Prof. Dr. Silas Fantin
Departamento de Matem´atica e Estat´ıstica – UNIRIO

Prof. Dr. Roberto Alfonso de Olivares Jara
Instituto de Matem´atica e Estat´ıstica – UERJ

Rio de Janeiro

2014

DEDICAT ´ORIA

Ao meu pai Toshio (in memoriam), `a minha m˜ae Danza.

AGRADECIMENTOS

Agrade¸co aos meus pais Toshio e Danza por terem me passado muitos valores entre

eles o valor do conhecimento e da sabedoria.

Agrade¸co `as amigas F´atima de Azevedo e F´atima Neto por terem sido o estopim

e a for¸ca impulsionadora para fazer o PROFMAT na UERJ.

Agrade¸co a CAPES pela bolsa que me ajudou a custear despesas e necessidades

que foram surgindo desde o in´ıcio do mestrado at´e a conclus˜ao deste trabalho.

Agrade¸co ao amigo Luis Oliveira, colega de proﬁss˜ao e amigo de longa data com
o qual tenho compartilhado as muitas alegrias e as eventuais tristezas da proﬁss˜ao, pela
paciente escuta e troca.

Agrade¸co aos amigos da minha turma do PROFMAT em especial Marcos As-

sump¸c˜ao pelos momentos de estudo e convivˆencia fraterna.

Agrade¸co aos amigos e amigas do Focolare com o qual compartilho o Ideal da

Unidade de Chiara Lubich.

Agrade¸co a todos os amigos que direta ou indiretamente me ajudaram de alguma

forma a realizar este trabalho.

Agrade¸co aos meus irm˜aos e irm˜as Carolina, Ana, Yury, Antˆonio e Telma e a todos

os meus familiares aos quais sempre serei um reconhecido devedor.

Agrade¸co aos meus professores da UERJ envolvidos no PROFMAT que me ajuda-

ram com suas aulas, aten¸c˜ao e comprometimento na realiza¸c˜ao desse objetivo.

Agrade¸co `a professora Renata Abreu pelas preciosas dicas, pelo interesse em me

ajudar.

Agrade¸co `a minha orientadora Patr´ıcia Nunes pela dedica¸c˜ao, pela paciˆencia e
entrega. Quando escolhi este tema, n˜ao foi pelo orientador como muitos fazem, nem
mesmo pelo tema apesar do meu despertado interesse em Aritm´etica, mas foi sobretudo
pela proposta de trabalho, a meu ver, pouco pedag´ogica e muito matem´atica. Mas,
passados alguns meses, na conclus˜ao deste TCC posso dizer que n˜ao podia ter escolhido
melhor orientador.

O menino pergunta: “Vovˆo, ´e f´acil pegar um tatu?” O avˆo, medita alguns segundos e
responde: ”Antes de tudo, tem que ter o tatu!”
Fonte: O autor, 2014.

RESUMO

ICHIHARA, Jos´e Travassos. Constru¸c˜ao de quadrados m´agicos pelo m´etodo do passo
uniforme. 2014. 100 f. Disserta¸c˜ao (Mestrado Proﬁssional em Matem´atica em Rede
Nacional / PROFMAT) – Universidade do Estado do Rio de Janeiro, Instituto de
Matem´atica e Estat´ıstica.

Lehmer (1929) analisa matematicamente o m´etodo do passo uniforme para cons-
tru¸c˜ao de quadrados m´agicos de ordem ´ımpar. Ele divide sua an´alise em v´arias etapas.
Na primeira delas, envolvendo a discuss˜ao de condi¸c˜oes necess´arias e suﬁcientes para o
preenchimento do quadrado pelo m´etodo, o autor aﬁrma que se dois n´umeros guardarem
entre si uma certa rela¸c˜ao, eles ser˜ao designados a ocupar a mesma c´elula do quadrado
causando seu n˜ao preenchimento. A an´alise do preenchimento pelo m´etodo do passo uni-
forme envolve a resolu¸c˜ao de um sistema linear m´odulo n. Nesse trabalho, discutimos
o comportamento das solu¸c˜oes desse sistema quando o m´etodo falha no preenchimento.
Como consequˆencia, conclu´ımos que n´umeros que guardam a rela¸c˜ao mencionada nunca
ocupam a mesma c´elula. A an´alise das condi¸c˜oes necess´arias e suﬁcientes para obter qua-
drados m´agicos segundo a deﬁni¸c˜ao de Lehmer (1929) envolve a resolu¸c˜ao de equa¸c˜oes de
congruˆencias lineares a duas vari´aveis. Nesse trabalho, detalhamos os resultados de Leh-
mer (1929). A an´alise das condi¸c˜oes necess´arias e suﬁcientes para obten¸c˜ao de quadrados
m´agicos, como s˜ao reconhecidos usualmente, tamb´em envolve a resolu¸c˜ao de equa¸c˜oes de
congruˆencias lineares a duas vari´aveis. Discutimos o comportamento das solu¸c˜oes dessas
equa¸c˜oes para obter diagonais principais m´agicas. Como consequˆencia, mostramos que
diagonais principais m´agicas s˜ao obtidas se e somente se as coordenadas iniciais guarda-
rem certas rela¸c˜oes.

Palavras-chave: Quadrados m´agicos. M´etodo do passo uniforme. Regularidades.

ABSTRACT

ICHIHARA, Jos´e Travassos. Construction of magic squares by the uniform step method.
2014. 100 f. Disserta¸c˜ao (Mestrado proﬁssional em Matem´atica em Rede Nacional /
PROFMAT) – Universidade do Estado do Rio de Janeiro, Instituto de Matem´atica e
Estat´ıstica.

Lehmer (1929) mathematically analyzes the uniform step method for constructing
magic squares of odd order. He divides his analysis into several steps. In the ﬁrst, in-
volving a discussion of necessary and suﬃcient conditions for completing the square, the
author states that if two numbers keep a certain relationship to each other, they will
be designated to occupy the same cell of the square causing its non fullﬁllment. The
analysis of the uniform step method involves solving a linear system module n. In this
monograph, we discuss the behavior of solutions of this system when the method fails in
fulﬁlling the square. Consequently, we conclude that numbers guarding the mentioned
relationship never occupy the same cell. The analysis of necessary and suﬃcient condi-
tions for obtaining magic square (as deﬁned by Lehmer (1929)) involves solving linear
congruences in two variables. In this work, we detail the results of Lehmer (1929). The
analysis of the necessary and suﬃcient conditions for magic squares (as usually deﬁned)
also involves solving linear congruences in two variables. We discuss the behavior of so-
lutions of these equations to obtain magic main diagonals. Then, we show that magic
main diagonals are obtained if and only if the initial coordinates keep certain relationships.

Keywords: Magic squares. Uniform step method. Regularities.

LISTA DE ILUSTRAC¸ ˜OES

1 - Melancolia, gravura de 1514 de Albrecht D¨urer
. . . . . . . . . . . . . 11
Figura
2 - Detalhe da gravura Melancolia
. . . . . . . . . . . . . . . . . . . . . . 11
Figura
. . . . . . . . . . . . . . . . . . . . . . 17
3 - Sistema de coordenadas (A, B)
Figura
4 - Quadrado de ordem n . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
Figura
5 - Cilindro de ordem n . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
Figura
6 - Toro de ordem n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
Figura
7 - Inser¸c˜ao de 1 a 25 pelo MPU . . . . . . . . . . . . . . . . . . . . . . . 20
Figura
8 - Matriz M (w(cid:48), k(cid:48))
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Figura
9 - Estrutura das matrizes do exemplo 2. . . . . . . . . . . . . . . . . . . . 33
Figura
Figura 10 - Localiza¸c˜ao do n´umero 133, M (2, 3).
. . . . . . . . . . . . . . . . . . . 34
Figura 11 - M (2, 3) do Ex. 3. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
Figura 12 - Regularidades.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
Figura 13 - Regularidades.
. . . . . 42
Figura 14 - Elementos e suas coordenadas, matriz M (1, 1), do Exemplo 4.
Figura 15 - x1 e x2 em uma mesma coluna l de M (w(cid:48), k(cid:48)) tem coordenadas (A, B) diferentes.
. 44
Figura 16 - x1 e x2 em uma mesma linha t de M (w(cid:48), k(cid:48)) tem coordenadas (A, B) diferentes. . . 44
. . . . . . . . . . . . . . 45
Figura 17 - M (2, 3) elementos e coordenadas. Exemplo 5.
. . . 47
Figura 18 - Elementos e suas coordenadas, da matriz M (1, 1), do Exemplo 6.
. . . . . . . 48
Figura 19 - N´umeros de M (2, 0) que ocupam a mesma c´elula que 138.
. . . . . . . . . . . . . . . . . . . . . . . . . . 49
Figura 20 - Matriz(2, 0), Exemplo 7.
Figura 21 - Ciclos do quadrado do Exemplo 7.
. . . . . . . . . . . . . . . . . . . . 51
Figura 22 - Diagonais positivas. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
Figura 23 - Diagonais negativas.
Figura 24 - n = 9, α = 4, β = 1, a = 5, b = 1, p = 2 e q = 4. DPN n˜ao m´agica.
. . 72
Figura 25 - n = 9, α = 4, β = 1, a = 5, b = 1. . . . . . . . . . . . . . . . . . . . . . 73
Figura 26 - n = 9, α = 4, β = 1, a = 5, b = 1. . . . . . . . . . . . . . . . . . . . . . 83
Figura 27 - Coordenadas iniciais para DPP e DPN m´agicas (parˆametros: n = 55,

α = 7, β = 4, a = 6, b = 1).

. . . . . . . . . . . . . . . . . . . . . . . . 89

Figura 28 - Coordenadas iniciais para DPP e DPN m´agicas (parˆametros: n = 105,

α = 11, β = 2, a = 31, b = 11).

. . . . . . . . . . . . . . . . . . . . . . 92

SUM ´ARIO

1
2

2.1
3
3.1
3.2
3.3
3.4
4
4.1
4.2
4.2.1
4.2.1.1 O par´agrafo de Lehmer (1929, p. 531)
4.2.2
4.3
4.3.1
4.3.2
4.3.3
4.3.4
4.3.5
4.3.6

INTRODUC¸ ˜AO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
RESULTADOS PRELIMINARES . . . . . . . . . . . . . . . . . . . 13
REPRESENTAC¸ ˜AO MATEM ´ATICA DE UM QUADR ´ADO M ´A-
GICO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
Coordenadas das c´elulas . . . . . . . . . . . . . . . . . . . . . . . . . . 17
M´ETODO DO PASSO UNIFORME . . . . . . . . . . . . . . . . . . 19
Um Exemplo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Descri¸c˜ao e formaliza¸c˜ao do m´etodo . . . . . . . . . . . . . . . . . . 20
Congruˆencias fundamentais do m´etodo do passo uniforme . . . . 22
An´alise do m´etodo do passo uniforme . . . . . . . . . . . . . . . . . 24
O M´ETODO PREENCHE O QUADRADO?
. . . . . . . . . . . . 25
A condi¸c˜ao suﬁciente para o preenchimento . . . . . . . . . . . . . . 26
Se preenche, o determinante ´e primo com n? . . . . . . . . . . . . . 27
. . . 29
A condi¸c˜ao necess´aria para o preenchimento segundo Lehmer (1929)
. . . . . . . . . . . . . . . . . . . . 29
O ponto crucial no caminho da volta . . . . . . . . . . . . . . . . . . . . . 31
. . . . . . . . . . . . . . . . . . 32
Como ocorre o n˜ao preenchimento?
Coordenadas dos elementos de M (w(cid:48), k(cid:48)) . . . . . . . . . . . . . . . . . . . 35
As coordenadas A(cid:48) e B(cid:48)
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
Regularidade das coordenadas A e B entre matrizes
. . . . . . . . . . . . 37
Regularidade das coordenadas A e B ao longo de uma linha de M (w(cid:48), k(cid:48)) . 39
Regularidade das coordenadas A e B ao longo de uma coluna de M (w(cid:48), k(cid:48)) 40
Padr˜ao dos n´umeros em M (w(cid:48), k(cid:48)) que ocupam uma mesma c´elula no
quadrado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
Duas solu¸c˜oes de interesse que ocupam a mesma c´elula . . . . . . . . . . . 46
M ´AGICO NAS COLUNAS OU LINHAS . . . . . . . . . . . . . . . 52
A condi¸c˜ao ´e necess´aria? . . . . . . . . . . . . . . . . . . . . . . . . . . 53
Calculando a soma das colunas . . . . . . . . . . . . . . . . . . . . . . . . 53
Calculando a soma das linhas . . . . . . . . . . . . . . . . . . . . . . . . . 57
Condi¸c˜ao necess´aria para que colunas e linhas sejam m´agicas
. . . . . . . 59
DIAGONAIS PRINCIPAIS POSITIVA E NEGATIVA M ´AGI-
CAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
Condi¸c˜oes para que a diagonal principal negativa seja m´agica . . 62
Calculando a soma da diagonal
. . . . . . . . . . . . . . . . . . . . . . . . 64
Condi¸c˜ao necess´aria e suﬁciente . . . . . . . . . . . . . . . . . . . . . . . . 66
. . . . . . . . . . . . . . . . 68
Onde come¸car para que a DPN seja m´agica?

4.3.7
5
5.1
5.1.1
5.1.2
5.1.3
6

6.1
6.1.1
6.1.2
6.1.3

6.2
6.2.1
6.2.2
6.2.3
6.3
7

Condi¸c˜oes para que a diagonal principal positiva seja m´agica . . . 76
Calculando a soma da diagonal
. . . . . . . . . . . . . . . . . . . . . . . . 77
Condi¸c˜ao necess´aria e suﬁciente . . . . . . . . . . . . . . . . . . . . . . . . 78
Onde come¸car para que a DPP seja m´agica? . . . . . . . . . . . . . . . . . 79
Onde come¸car para que a DPP e a DPN sejam ambas m´agicas? . 86
M´ETODO DE LA LOUB`ERE . . . . . . . . . . . . . . . . . . . . . . 95
CONCLUS ˜AO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
REFERˆENCIAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

INTRODUC¸ ˜AO

11

Na literatura, raramente encontram-se referˆencias sobre quaisquer aplica¸c˜oes pr´ati-
cas para quadrados m´agicos. Em geral, s˜ao objeto de curiosidade e divers˜ao. No Brasil, os
livros did´aticos de matem´atica endere¸cados ao ensino fundamental costumam apresentar
quest˜oes com quadrados m´agicos de ordem 3. No entanto, os quadrados m´agicos oferecem
uma variedade interessante de propriedades matem´aticas.

Um famoso exemplo de quadrado m´agico aparece na gravura Melancolia de Albre-
cht D¨urer (Figura 1). Sobre a parede atr´as do anjo que pondera sobre o universo, vˆe-se
um quadrado m´agico de ordem 4 (Figura 2) que apresenta a mesma soma 34 em cada

Figura 1 - Melancolia, gravura de 1514 de Albrecht D¨urer

Fonte: CHABERT; BARBIN, 1999.

Figura 2 - Detalhe da gravura Melancolia

Fonte: Adaptado de CHABERT; BARBIN, 1999.

linha, coluna e nas duas diagonais principais:

12









16
5
9
4

2
3
10 11
6
7
15 14









13
8
12
1

A soma 34 tamb´em se veriﬁca nas quatro casas centrais, nas quatros casas dos cantos,
nas duas casas do meio da linha superior com as duas casas do meio da linha inferior, nas
duas casas centrais da coluna da esquerda com as duas casas centrais da coluna da direita.
Ainda, a data da gravura, 1514, aparece nas duas c´elulas centrais da linha inferior.

H´a muitas maneiras de gerar quadrados m´agicos. Existem v´arios m´etodos de
constru¸c˜ao. Quadrados de ordem ´ımpar s˜ao constru´ıdos com m´etodos diferentes dos
quadrados de ordem par. Este trabalho tem como objetivo principal a an´alise matem´atica
do m´etodo do passo uniforme para constru¸c˜ao de quadrados m´agicos que ser´a descrito
mais adiante. Estudaremos as condi¸c˜oes necess´arias e suﬁcientes para garantir que um
quadrado constru´ıdo pelo m´etodo do passo uniforme seja m´agico.

1 RESULTADOS PRELIMINARES

13

Apresentamos nessa se¸c˜ao alguns resultados e conceitos de Teoria dos N´umeros

que ser˜ao utilizados ao longo do trabalho.

Como em Hefez (2006), denotaremos por N o conjunto dos n´umeros naturais:

N = {0, 1, 2, . . .}

Deﬁni¸c˜ao 1. Dados dois n´umeros naturais a e b com a (cid:54)= 0, diremos que a divide b,
escrevendo a | b, quando existir c ∈ N tal que b = a · c. Neste caso, diremos tamb´em que
a ´e um divisor ou um fator de b ou, ainda, que b ´e um m´ultiplo de a.

Observe que essa deﬁni¸c˜ao pode ser naturalmente estendida para os inteiros (ver

Deﬁni¸c˜ao 1.1, (SANTOS, 1998), p. 3).

Teorema 1 (Divis˜ao Euclidiana, Teorema 3.2.1 (HEFEZ, 2006, p. 35)). Sejam a e b dois
n´umeros naturais com 0 < a < b. Existem dois ´unicos n´umeros naturais q e r tais que
b = a · q + r, com r < a.

Deﬁni¸c˜ao 2 (M´aximo Divisor Comum, (HEFEZ, 2006, p. 53)). Dizemos que d ´e um
m´aximo divisor comum (mdc) de a e b se possuir as seguintes propriedades:

(i) d ´e um divisor comum de a e b, e

(ii) d ´e divis´ıvel por todo divisor comum de a e b.

Dados dois n´umeros naturais a e b, denotaremos seu m´aximo divisor comum por

mdc(a, b).

Teorema 2 (Teorema 5.2.2 (HEFEZ, 2006, p. 60)). Sejam a, b e c n´umeros naturais. Se
a | b · c e mdc(a, b) = 1, ent˜ao a | c.

Proposi¸c˜ao 1 (Proposi¸c˜ao 5.2.2 (HEFEZ, 2006, p. 61)). Dados n´umeros naturais a1, . . . , an,
n˜ao todos nulos, existe o seu mdc e

mdc(a1, . . . , an) = mdc(a1, . . . , mdc(an−1, an))

Deﬁni¸c˜ao 3 (Deﬁni¸c˜ao 2.1 (SANTOS, 1998, p. 32)). Se a e b s˜ao inteiros dizemos que
a ´e congruente a b m´odulo m (m > 0) se m | (a − b). Denotamos isto por a ≡ b
(mod m). Se m (cid:54) | (a − b), dizemos que a ´e incongruente a b m´odulo m e denotamos
a (cid:54)≡ b (mod m).

14

Proposi¸c˜ao 2 (Proposi¸c˜ao 9.1.1 (HEFEZ, 2006, p. 110)). Seja m ∈ N, com m > 1. Para
todos a, b, c ∈ N, tem-se que:

(i) a ≡ a (mod m),

(ii) Se a ≡ b (mod m), ent˜ao b ≡ a (mod m),

(iii) Se a ≡ b (mod m) e b ≡ c (mod m), ent˜ao a ≡ c (mod m).

Proposi¸c˜ao 3 (Proposi¸c˜ao 9.1.3 (HEFEZ, 2006, p. 111)). Sejam a, b, c, d, m ∈ N, com
m > 1,

(i) Se a ≡ b (mod m) e c ≡ d (mod m), ent˜ao a + c ≡ b + d (mod m),

(ii) Se a ≡ b (mod m) e c ≡ d (mod m), ent˜ao a · c ≡ b · d (mod m).

Proposi¸c˜ao 4 (Do cancelamento aditivo, Proposi¸c˜ao 9.1.4 (HEFEZ, 2006, p. 113)). Se-
jam a, b, c, m ∈ N, com m > 1. Tem-se que

a + c ≡ b + c

(mod m) ⇐⇒ a ≡ b

(mod m).

Proposi¸c˜ao 5 (Do cancelamento multiplicativo, Proposi¸c˜ao 9.1.5 (HEFEZ, 2006, p. 114)).
Sejam a, b, c, m ∈ N, com c (cid:54)= 0 e m > 1. Temos que

a · c ≡ b · c

(mod m) ⇐⇒ a ≡ b

mod

(cid:18)

m
mdc(c, m)

(cid:19)

.

Corol´ario 1 (HEFEZ, p. 114). Sejam a, b, c, m ∈ N, com m > 1 e mdc(c, m) = 1.
Temos que

a · c ≡ b · c (mod m) ⇔ a ≡ b (mod m).

Observamos que todos os resultados de congruˆencia enunciados para naturais

tamb´em s˜ao v´alidos para inteiros (veja Cap´ıtulo 2, (SANTOS, 1998)).

Deﬁni¸c˜ao 4. Chamamos de equa¸c˜ao de congruˆencia linear (ECL) na vari´avel x ∈ Z a
uma congruˆencia na forma ax ≡ b (mod m), onde x ´e a inc´ognita.

Teorema 3 (Existˆencia e quantidade de solu¸c˜oes da ECL, Teorema 2.8 (SANTOS, 1998,
p. 37)). Se d = mdc(a, m) e d | b, ent˜ao a equa¸c˜ao ax ≡ b
(mod m) tem d solu¸c˜oes
incongruentes mod m.

Teorema 4 (ECL em uma vari´avel, prova do Teorema 2.8 (SANTOS, 1998, p. 37)).
Sejam a, c, m ∈ N, com m > 1 e mdc(c, m) | c. Se x0 ´e a solu¸c˜ao minimal (isto ´e, a
menor solu¸c˜ao n˜ao negativa) da congruˆencia ax ≡ c (mod m), ent˜ao

x0, x0 +

m
d

, x0 + 2

m
d

, . . . , x0 + (d − 1)

m
d

,

onde d = mdc(a, m), s˜ao as solu¸c˜oes incongruentes mod m da ECL.

Deﬁni¸c˜ao 5 (Se¸c˜ao 5.5 (SIVARAMAKRISHNAN, 2006, p. 124)). Uma ECL em n
vari´aveis x1, x2, . . . , xn ´e da forma

a1x1 + a2x2 + · · · + anxn ≡ b

(mod m),

(1)

15

b, m, ai ∈ Z, i = 1, 2, . . . , n e m > 1. Uma n-upla (x1, x2, . . . , xn) que satisfaz (1) ser´a
chamada de solu¸c˜ao de (1). Duas solu¸c˜oes (x1, x2, . . . , xn) e (x(cid:48)
n) ser˜ao contadas
como a mesma solu¸c˜ao se, e somente se,

2, . . . , x(cid:48)

1, x(cid:48)

xi ≡ x(cid:48)
i

(mod m),

i = 1, . . . , n.

Teorema 5 (Existˆencia de solu¸c˜oes de uma ECL com n vari´aveis, Theorem 36 (SIVA-
RAMAKRISHNAN, 2006, p. 124)). A congruˆencia linear a1x1 + a2x2 + · · · + anxn ≡ b
(mod m) tem solu¸c˜ao se, e somente se, mdc(a1, a2, . . . , an, m) | b.

Teorema 6 (N´umero de solu¸c˜oes de uma ECL com n vari´aveis, Theorem 36 (SIVA-
RAMAKRISHNAN, 2006, p. 124)). A congruˆencia linear a1x1 + a2x2 + · · · + anxn ≡ b
(mod m), com mdc(a1, a2, . . . , an, m) = d | b tem d · mn−1 solu¸c˜oes distintas.

2 REPRESENTAC¸ ˜AO MATEM ´ATICA DE UM QUADR ´ADO M ´AGICO

16

Para Lehmer (1929), um quadrado ´e denominado “m´agico” nas linhas se a soma
dos n´umeros em cada linha for a mesma. Ser´a chamado de quadrado “m´agico” nas
colunas se a soma dos n´umeros em cada coluna for a mesma. Se um quadrado for m´agico
simultaneamente nas linhas e nas colunas ser´a dito “quadrado m´agico”. Um quadrado
´e reconhecido “m´agico nas diagonais positivas” se a soma em cada diagonal estendida,
paralela `a diagonal principal, for a mesma soma da diagonal principal. Se for tamb´em
“m´agico nas diagonais negativas” ser´a denominado “diab´olico”. Um quadrado m´agico ´e
“sim´etrico” se a soma entre quaisquer duas c´elulas localizadas simetricamente em rela¸c˜ao
ao centro do quadrado for a mesma. As deﬁni¸c˜oes de Lehmer (1929) para quadrados
m´agicos ser˜ao adotadas nesse trabalho.

Para montar um quadrado m´agico, uma matriz quadrada de ordem n deve ser pre-
enchida, completamente, sem repeti¸c˜ao, com os n´umeros naturais de 1 at´e n2. Portanto,
a soma de todos os elementos da matriz ser´a a soma de uma progress˜ao aritm´etica com
a1 = 1, r = 1, an2 = n2 e n2 elementos, que ´e igual a (1+n2)n2/2. Ent˜ao se o quadrado for
m´agico a soma dos elementos de qualquer coluna ou linha ser´a igual a esse valor dividido
por n, teremos

(1 + n2)n
2

.

(2)

17

2.1 Coordenadas das c´elulas

Cada c´elula do quadrado ser´a identiﬁcada por suas coordenadas (A, B) que indicam
respectivamente a coluna e a linha que ocupa (Figura 3) A primeira diﬁculdade a ser
contornada na tentativa de preencher um quadrado de ordem n com algum m´etodo de
passo regular, ´e a existˆencia de um contorno. Em outras palavras movendo-se pelas c´elulas
de uma linha para a esquerda ou para a direita ou pelas c´elulas de uma coluna para cima
ou para baixo, vamos nos deparar com uma c´elula na borda que ultrapassada levar´a para
fora do quadrado (Figura 4).

Figura 3 - Sistema de coordenadas (A, B)

Fonte: O autor, 2014.

Figura 4 - Quadrado de ordem n

Fonte: O autor, 2014.

Figura 5 - Cilindro de ordem n

18

Fonte: O autor, 2014.

Uma solu¸c˜ao seria colar as bordas direita e esquerda do quadrado obtendo-se um
cilindro. Agora, movendo-se por uma linha qualquer para a direita ou para a esquerda
n˜ao se sai mais do quadrado pois as c´elulas, n˜ao est˜ao mais dispostas em um segmento
de reta horizontal com duas extremidades mas dispostas de maneira circular (Figura 5).
De maneira an´aloga, as extremidades superior e inferior de cada coluna s˜ao cola-
das obtendo-se um toro. Assim, movendo-se por uma coluna qualquer para cima ou para
baixo n˜ao se sai mais da matriz pois as c´elulas, n˜ao est˜ao mais dispostas em um segmento
de reta vertical com duas extremidades mas dispostas de maneira circular (Figura 6).

Algebricamente, o efeito “toro” de mover-se sem sair da matriz, ´e obtido tratando
as coordenadas de cada c´elula da matriz como congruˆencias m´odulo n, sendo n a ordem da
matriz. Com efeito, o movimento de uma c´elula (p, q) para uma c´elula (p+α, q+β) sempre
poder´a ser associado, atrav´es de congruˆencia m´odulo n, a uma c´elula de coordenadas com
valores de 1 a n.

Figura 6 - Toro de ordem n

Fonte: O autor, 2014.

3 M´ETODO DO PASSO UNIFORME

19

H´a muitas maneiras de gerar quadrados m´agicos. Existem v´arios m´etodos de
constru¸c˜ao. Quadrados de ordem ´ımpar s˜ao constru´ıdos com m´etodos diferentes dos
quadrados de ordem par. No presente trabalho vamos nos deter exclusivamente ao m´etodo
do passo uniforme (MPU). Ele consiste em atribuir, um de cada vez, ordenadamente, a
sequˆencia dos n´umeros 1, 2, 3, ..., n2 `as c´elulas seguindo uma regularidade de movimento
para a direita e para cima que ser´a detalhada a seguir.

3.1 Um Exemplo

No m´etodo do passo uniforme, inicia-se com o 1 sendo atribu´ıdo a uma c´elula qual-
quer (p, q). Em seguida, vem o 2, colocado na c´elula (p + α, q + β) sendo α o deslocamento
ou “passo” para a direita e β o passo para cima1. Esses passos ser˜ao mantidos, por isso,
α e β s˜ao chamadas de constantes do passo uniforme. Ao t´ermino de cada aloca¸c˜ao de n
n´umeros, ser´a necess´ario fazer uma quebra de passo (atrav´es da introdu¸c˜ao de parˆametros
a e b) para evitar a sobreposi¸c˜ao de n´umeros em uma mesma c´elula.

Exemplo 1. Seja o quadrado de ordem n = 5 constru´ıdo pelo m´etodo do passo uniforme
com os seguintes parˆametros: α = 1, β = 1, a = 1, b = 2, p = 2 e q = 3.

O 1 ´e alocado na c´elula inicial (p, q) = (2, 3), escolhida arbitrariamente, prossegue-
se colocando 2 na c´elula situada 1 passo para a direita e um passo para cima, ou seja,
(2 + 1, 3 + 1) ≡ (3, 4). Da mesma forma, 3 ´e alocado em (3 + 1, 4 + 1) ≡ (4, 5), 4 em
(4 + 1, 5 + 1) ≡ (5, 1) e 5 em (5 + 1, 1 + 1) ≡ (1, 2), Figura 7a.

A primeira quebra de passo ser´a requerida, ao t´ermino do 1o. ciclo, na inser¸c˜ao de
6. De fato, partindo da coordenada p = 2 ao serem somados 5 passos horizontais α = 1
voltaremos `a coordenada 2, isto ´e, 2 + 5 · 1 ≡ 2 (mod 5). Da mesma maneira, a partir
da coordenada q = 3, acrescentados 5 passos verticais β = 1 volta-se `a coordenada 3, ou
seja, 3 + 5 · 1 ≡ 3 (mod 5). Ent˜ao, o m´etodo prop˜oe uma quebra de passo que consiste
em deslocar-se a passos para a direita e b passos para cima, isto ´e, somar a = 1 e b = 2,
respectivamente, `as coordenadas p = 2 e q = 3. O 2o. ciclo, ´e iniciado, com a primeira
quebra de passo introduzida, permitindo que o n´umero 6 seja alocado n˜ao mais na c´elula
(2, 3) ocupada pelo 1 mas em uma outra c´elula, com coordenadas (2 + 1, 3 + 2) ≡ (3, 5).

1 Mais precisamente, os passos para a direita e para cima est˜ao associados a parˆametros α e β positivos.
No entanto, n˜ao h´a perda de generalidade em descrevermos apenas esse caso. Se α ou β for negativos,
a congruˆencia m´odulo n sempre permite redeﬁni-los de modo que possam ser considerados positivos.

Figura 7 - Inser¸c˜ao de 1 a 25 pelo MPU

20

(a)

(b)

(c)

(d)

Legenda: (a) 1o. ciclo; (b) 2o. ciclo; (c) 3o. ciclo; (d) 4o. e 5o. ciclos.
Fonte: O autor, 2014.

Os n´umeros de 7 at´e 10 poder˜ao, ent˜ao, ser alocados fechando o 2o. ciclo, Figura 7b. Esse
procedimento se repete para o 3o. ciclo, Figura 7c e prossegue com o 4o. e 5o. ciclos at´e que
todos os 25 n´umeros tenham sido distribu´ıdos, Figura 7d.

3.2 Descri¸c˜ao e formaliza¸c˜ao do m´etodo

No que segue, as coordenadas de cada c´elula sempre ser˜ao reduzidas m´odulo n,
exceto quando forem igual a n, pois n˜ao existe coordenada igual a 0. Genericamente,
inicia-se com o 1 sendo atribu´ıdo a uma c´elula qualquer (p, q). Em seguida, vem o 2,
colocado na c´elula (p + α, q + β). Prosseguindo, temos: Ao ﬁnal do 1o. ciclo de n n´umeros
(Tabela 1), a inser¸c˜ao de n + 1 exigir´a uma altera¸c˜ao no procedimento. De fato, partindo
da coordenada p ao serem somados n passos horizontais α voltaremos `a coordenada p,
isto ´e, p + nα ≡ p (mod n). Da mesma maneira, a partir da coordenada q, acrescentados
n passos verticais β volta-se `a coordenada q, ou seja, q + nβ ≡ q (mod n). Portanto,
ap´os terem sido inseridos com sucesso os n´umeros 1, 2, 3, . . . , n nos n primeiros passos,
trope¸camos na inser¸c˜ao do n´umero n + 1, destinado a uma c´elula necessariamente j´a
ocupada, pois (p + nα, q + nβ) ≡ (p, q) (mod n), sendo (p, q) as coordenadas da c´elula

Tabela 1 - Aloca¸c˜ao dos n´umeros no 1o. ciclo

x

1
2
3
...
n − 1
n

(A, B)

(p, q)
(p + α, q + β)
(p + 2α, q + 2β)
...
(p + (n − 2)α, q + (n − 2)β)
(p + (n − 1)α, q + (n − 1)β)

Fonte: O autor, 2014.

21

Tabela 2 - Aloca¸c˜ao dos n´umeros no 2o. ciclo

x

n + 1
n + 2
n + 3
...
n + (n − 1)
n + n

(A, B)

(p + a, q + b)
(p + α + a, q + β + b)
(p + 2α + a, q + 2β + b)
...
(p + (n − 2)α + a, q + (n − 2)β + b)
(p + (n − 1)α + a, q + (n − 1)β + b)

Fonte: O autor, 2014.

Tabela 3 - Aloca¸c˜ao dos n´umeros no 3o. ciclo

x

2n + 1
2n + 2
2n + 3
...
2n + (n − 1)
2n + n

(A, B)

(p + 2a, q + 2b)
(p + α + 2a, q + β + 2b)
(p + 2α + 2a, q + 2β + 2b)
...
(p + (n − 2)α + 2a, q + (n − 2)β + 2b)
(p + (n − 1)α + 2a, q + (n − 1)β + 2b)

Fonte: O autor, 2014.

ocupada pelo 1.

Ent˜ao, o m´etodo prop˜oe uma quebra de passo que consiste em somar as constantes
a e b, respectivamente, `as coordenadas p e q. O 2o. ciclo, ´e iniciado, com a primeira quebra
de passo introduzida, permitindo que o n´umero n + 1 seja alocado n˜ao mais na c´elula
(p, q) ocupada pelo 1 mas em uma outra c´elula deslocada por a unidades para `a direita e
por b unidades para cima em rela¸c˜ao a esta com coordenadas (p + a, q + b)
O restante dos n´umeros do 2o. ciclo, de n + 1 at´e 2n poder´a, ent˜ao, ser alocado como
anteriormente.

Analogamente, uma segunda quebra de passo ´e requerida ap´os a conclus˜ao do 2o.
ciclo (Tabela 2). De fato, tendo j´a sido alocados os n´umeros n + 1, n + 2, n + 3, . . . , 2n
ao tentar alocar o n´umero 2n + 1, como foram dados, novamente, n passos horizontais
α e veticais β a partir da c´elula (p + a, q + b) voltamos a ela novamente, uma vez que,
p + a + nα ≡ p + a (mod n) e q + b + nβ ≡ q + b (mod n). Dessa forma, o n´umero 2n + 1
seria destinado `a c´elula (p + α, q + β) que j´a estaria ocupada pelo n´umero n + 1. Ent˜ao, o
m´etodo prop˜oe uma segunda quebra de passo que ´e executada, alocando o n´umero 2n + 1
na c´elula (p + 2a, q + 2b). Segue-se, normalmente, a aloca¸c˜ao dos restantes dos n´umeros
do 3o. ciclo (Tabela 3).

22

Tabela 4 - Aloca¸c˜ao dos n´umeros no no. ciclo

x

(n − 1)n + 1
(n − 1)n + 2
(n − 1)n + 3
...
(n − 1)n + (n − 1)
(n − 1)n + n
Fonte: O autor, 2014.

(A, B)

(p + (n − 1)a, q + (n − 1)b)
(p + α + (n − 1)a, q + β + (n − 1)b)
(p + 2α + (n − 1)a, q + 2β + (n − 1)b)
...
(p + (n − 2)α + (n − 1)a, q + (n − 2)β + (n − 1)b)
(p + (n − 1)α + (n − 1)a, q + (n − 1)β + (n − 1)b)

O n-´esimo ciclo pode ser visto na Tabela 4.

3.3 Congruˆencias fundamentais do m´etodo do passo uniforme

Ap´os a descri¸c˜ao do m´etodo do passo uniforme, Lehmer (1929) resume o processo
descrito nas seguintes congruˆencias fundamentais, para determinar as coordenadas (A, B)
da c´elula na qual o n´umero x deve ser alocado:

A ≡ p + α (x − 1) + a

B ≡ q + β (x − 1) + b

(cid:21)

(cid:20)x − 1
n
(cid:20)x − 1
n

(mod n),

(cid:21)

(mod n),

(3)

(4)

onde

(cid:21)

(cid:20)x − 1
n

indica a parte inteira da divis˜ao de x − 1 por n.

As congruˆencias fundamentais s˜ao apresentadas por Lehmer (1929) sem nenhum
detalhamento. Vimos na descri¸c˜ao do m´etodo do passo uniforme que o coeﬁciente de α e
β “conta” a quantidade de passos. O coeﬁciente de a e b “conta” a quantidade de quebras
de passos. De fato, ap´os cada ciclo (n passos) h´a uma quebra de passo, sendo adicionada
uma unidade ao coeﬁciente de a e b que se mant´em constante durante o ciclo. Assim, no
1o. ciclo, o coeﬁciente de a e b ´e 0. No 2o. ciclo, o coeﬁciente ´e 1. No 3o. ciclo, ´e 2 e assim
sucessivamente. No n-´esimo ciclo, ´e n − 1. Logo, em (3) e (4), (x − 1) ´e o “contador de

passos” e

´e o “contador de quebra de passos”.

(cid:21)

(cid:20) x − 1
n

Para entender melhor, a primeira coisa que iremos fazer ´e deﬁnir uma forma para
o n´umero x. O teorema da Divis˜ao Euclidiana (Teorema 1, p´agina 13) garante que um

n´umero natural x ∈ {1, 2, 3, . . . , n2} pode ser escrito, de uma ´unica maneira, na forma

x = 1 + w + kn

com 0 ≤ k, w ≤ n − 1. Segue que k ´e a parte inteira da divis˜ao de x − 1 por n,

23

k =

(cid:21)

(cid:20)x − 1
n

e que

w ≡ x − 1

(mod n)

Dessa forma, k ´e o quociente da divis˜ao de x − 1 por n. E, w ´e o resto dessa
divis˜ao. Ent˜ao, ´e imediato perceber que k assume o valor 0, enquanto w assume os
valores 0, 1, 2, . . . , n − 1 para x ∈ {0, 1, 2, . . . , n − 1}; k assume o valor 1, enquanto w
assume, novamente, os valores 0, 1, 2, . . . , n − 1 para x ∈ {n, n + 1, n + 2, . . . , 2n − 1};
k assume o valor 2, enquanto w assume, novamente, os valores 0, 1, 2, . . . , n − 1 para
x ∈ {2n, 2n + 1, 2n + 2, . . . , 3n − 1} e, assim por diante.

Portanto, para x = 1+w+kn e x ∈ {1, 2, 3, . . . , n2}, k e w assumem, por n vezes, os
valores {0, 1, 2, 3, . . . , n−1}. Mas, vimos que k e w variam no conjunto {0, 1, 2, 3, . . . , n−1}
com “velocidades” diferentes. Fazendo uma analogia com um rel´ogio (de 0 a n − 1), k
seria o ponteiro das horas e w, o dos minutos. Assim, escrevendo x na forma 1 + w + kn,
w se identiﬁca com o coeﬁciente de α e de β, e k se identiﬁca com o coeﬁciente de a e de
b.

Observa¸c˜ao 1. Um n´umero x ∈ {1, 2, . . . , n2} pode sempre ser escrito, de modo ´unico,
na forma x = 1 + w + kn, com 0 ≤ k, w ≤ n − 1, e alocado pelo m´etodo do passo uniforme
na c´elula de coordenadas (p + wα + ka, q + wβ + kb).

Esquematicamente2:

x = 1 + w + kn (cid:55)→ (p + αw + ak, q + βw + bk)

2 Esta nota¸c˜ao para o n´umero x e suas coordenadas, n˜ao foi utilizada por Lehmer mas ser´a empregada

neste trabalho sempre que trouxer facilidade.

Mas, como k =

(cid:21)

(cid:20)x − 1
n

e w ≡ (x − 1) (mod n), segue da Proposi¸c˜ao 2, p´agina 14:

24

p + αw + ak ≡ p + α(x − 1) + a

q + βw + bk ≡ q + β(x − 1) + b

(cid:20)x − 1
n
(cid:20)x − 1
n

(cid:21)

(cid:21)

(mod n)

(mod n)

As congruˆencias (3) e (4) indicam que as coordenadas A e B de um n´umero x no
quadrado, dadas pelo m´etodo do passo uniforme, dependem apenas dos seis parˆametros
α, β, a, b, p e q.

Na descri¸c˜ao que foi feita do m´etodo, a quebra do passo ´e requerida ao t´ermino de
cada ciclo de n n´umeros. Isso ´e bem expresso nas congruˆencias fundamentais (3) e (4)

(cid:21)

(cid:20)x − 1
n

pelo “contador de ciclos”

. Mas, dependendo da escolha dos referidos parˆametros,

´e poss´ıvel3 que um n´umero seja atribu´ıdo a uma c´elula j´a ocupada antes mesmo da quebra
de passo, ou seja, antes de se completar n passos. Isso pode ocorrer no caso de algum dos
parˆametros α, β, a e b n˜ao ser primo com n. Quando α, β, a e b s˜ao todos primos com n,
um n´umero s´o seria atribu´ıdo a uma c´elula j´a ocupada apenas ao ﬁnal de cada ciclo de n
passos.

3.4 An´alise do m´etodo do passo uniforme

At´e agora, usamos o conceito de congruˆencia m´odulo n para formalizar matema-
ticamente o m´etodo do passo uniforme: estabelecemos uma rela¸c˜ao alg´ebrica entre cada
n´umero x e as coordenadas da c´elula que ser´a ocupada por ele. Note que essa forma-
liza¸c˜ao j´a nos permite determinar a posi¸c˜ao de qualquer n´umero sem que necessitemos
posicionar todos os anteriores a ele. Vamos prosseguir nossa investiga¸c˜ao matem´atica so-
bre o m´etodo respondendo a algumas perguntas. O m´etodo do passo uniforme se prop˜oe
a gerar quadrados m´agicos. Para que ele funcione, uma condi¸c˜ao inicial b´asica ´e que o
procedimento por ele proposto garanta o preenchimento do quadrado. Por isso, iniciamos
nossa investiga¸c˜ao respondendo `a pergunta: o m´etodo preenche o quadrado?

3 Por exemplo: n = 10, α = 4, β = 2, a = 3 e b = 3. Iniciamos com 1 na c´elula (1, 1), 2 na c´elula (5, 3),
3 na c´elula (9, 5), 4 na c´elula (3, 7), 5 na c´elula (7, 9), 6 na c´elula (1, 1) j´a ocupada pelo 1. A quebra
de passo n˜ao evitar´a que o quadrado n˜ao seja preenchido.
Outro exemplo com n ´ımpar: n = 9, α = 3, β = 3, a = 2 e b = 1. Iniciamos com 1 na c´elula (2, 3), 2
na c´elula (5, 6), 3 na c´elula (8, 9), 4 na c´elula (2, 3) j´a ocupada pelo 1. Novamente, a quebra de passo
n˜ao evitar´a que o quadrado n˜ao seja preenchido.

4 O M´ETODO PREENCHE O QUADRADO?

25

O m´etodo do passo uniforme garante que nenhum n´umero 1 ≤ x ≤ n2 caia fora do
quadrado. Sendo assim, a ´unica maneira do quadrado n˜ao ser preenchido pelo m´etodo ´e
existirem dois n´umeros x1 e x2 que tenham a mesma coordenada (A, B). Vamos assumir
esta condi¸c˜ao.

Sejam x1 e x2, dois n´umeros do conjunto {1, 2, 3, . . ., n2}, alocados em um quadrado
de ordem n pelo m´etodo do passo uniforme respectivamente nas c´elulas de coordenadas
(A1, B1) e (A2, B2) dadas por (3) e (4).

Se x1 e x2 est˜ao em uma mesma c´elula, temos A1 ≡ A2 (mod n) e B1 ≡ B2

(mod n). Isto ´e,






p + α (x1 − 1) + a

q + β (x1 − 1) + b

(cid:21)

(cid:20)x1 − 1
n

(cid:21)

(cid:20) x1 − 1
n

≡ p + α (x2 − 1) + a

(cid:21)

(cid:20)x2 − 1
n

(mod n)

≡ q + β (x2 − 1) + b

(cid:21)

(cid:20)x2 − 1
n

(mod n)

Pela Proposi¸c˜ao 4 (p´agina 14), efetuamos os devidos cancelamentos aditivos, obtendo:





α (x1 − x2) + a

β (x1 − x2) + b

(cid:21)

(cid:21)

(cid:26)(cid:20) x1 − 1
n
(cid:26)(cid:20) x1 − 1
n

−

−

(cid:20)x2 − 1
n
(cid:20)x2 − 1
n

(cid:21)(cid:27)

(cid:21)(cid:27)

≡ 0

(mod n)

≡ 0

(mod n)

(5)

(6)

Os procedimentos a seguir s˜ao justiﬁcados pela Proposi¸c˜ao 3 (p´agina 14). Multiplicamos
a equa¸c˜ao (5) por b, a equa¸c˜ao (6) por a e subtraimos uma da outra.

(αb − βa) (x1 − x2) ≡ 0

(mod n)

Multiplicamos a equa¸c˜ao (5) por β, a equa¸c˜ao (6) por α e subtraimos uma da outra.

(αb − βa)

(cid:21)

(cid:26)(cid:20) x1 − 1
n

−

(cid:20)x2 − 1
n

(cid:21)(cid:27)

≡ 0

(mod n)

Portanto, chegamos ao sistema abaixo, que ´e determinado pela condi¸c˜ao de dois n´umeros
x1 e x2 ocuparem a mesma c´elula, pelo m´etodo do passo uniforme.






(αb − βa)

(αb − βa) (x1 − x2) ≡ 0
(cid:20)x2 − 1
n

(cid:26)(cid:20) x1 − 1
n

≡ 0

(cid:21)(cid:27)

−

(cid:21)

(mod n)

(mod n)

(7)

(8)

4.1 A condi¸c˜ao suﬁciente para o preenchimento

Vamos mostrar que se mdc(αb − βa, n) = 1, ent˜ao o m´etodo do passo uniforme
preenche o quadrado. De fato, se mdc(αb − βa, n) = 1, ent˜ao, pelo Color´ario 1 (p´agina
14), temos:

26

(9)

(10)






(cid:21)

(cid:20)x1 − 1
n

≡

x1 ≡ x2
(cid:21)
(cid:20)x2 − 1
n

(mod n)

(mod n)

Segue de (10) e da Defni¸c˜ao 3 na p´agina 13 que:

(cid:21)

(cid:20) x1 − 1
n

≡

(cid:21)

(cid:20)x2 − 1
n

(mod n) ⇔ n |

(cid:21)

(cid:20)x1 − 1
n

−

(cid:20) x2 − 1
n

(cid:21)

.

Temos:

n |

(cid:21)

(cid:20)x1 − 1
n

−

(cid:21)

(cid:20)x2 − 1
n

⇔ k1 = k2 + tn,

t ∈ Z

onde x1 = 1 + w1 + k1n e x2 = 1 + w2 + k2n. Uma vez que 0 ≤ k1, k2 ≤ n − 1, ent˜ao4
t = 0 e

k1 = k2.

(11)

Analogamente, segue de (9) que

x1 ≡ x2

(mod n) ⇔ x1 = x2 + ln,

l ∈ Z

Substituindo, x1 = 1 + w1 + k1n e x2 = 1 + w2 + k2n, na igualdade x1 = x2 + ln, e
considerando a igualdade (11), obtemos:

1 + w1 + k1n = 1 + w2 + k2n + ln ⇔ w1 = w2 + ln,

l ∈ Z

Uma vez que 0 ≤ w1, w2 ≤ n − 1, ent˜ao l = 0 e w1 = w2.
Esses resultados, k1 = k2 e w1 = w2, mostram que

x1 = 1 + w1 + k1n = 1 + w2 + k2n = x2.

4 (11) mostra que x1 e x2 s˜ao de um mesmo ciclo n.

Isto ´e, se mdc(αb − βa, n) = 1, dois n´umeros n˜ao poder˜ao ser alocados em uma mesma
c´elula, pelo m´etodo do passo uniforme, a n˜ao ser que sejam iguais. Ora, nesse caso o
m´etodo preenche o quadrado5.

27

Teorema 7 (Condi¸c˜ao suﬁciente para o preenchimento). Dados os parˆametros α, β, a e
b (n´umeros inteiros) a condi¸c˜ao suﬁciente para que o m´etodo do passo uniforme preencha

o quadrado de ordem n ´e que o determinante

seja primo com n.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

Recapitulando: At´e aqui, vimos que para preencher o quadrado pelo m´etodo do

passo uniforme ´e suﬁciente escolher os parˆametros α, β, a e b tais que

= αb − βa

seja primo com n. Ou seja, se o determinante αb − βa for primo com n o quadrado
preenche. Observamos, que n˜ao s˜ao relevantes para o preenchimento, as coordenadas da
c´elula inicial que alocar´a o 1. Tanto faz. Al´em disso, n˜ao ´e necess´ario que os parˆametros
α, β, a e b sejam primos6 com n. Antes de dar prosseguimento, vamos nos deter um pouco,
diante da pergunta natural que se p˜oe agora: se o m´etodo preenche o quadrado ent˜ao o
determinante αb − βa ´e primo com n?

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

4.2 Se preenche, o determinante ´e primo com n?

A proposi¸c˜ao “Se o quadrado ´e preenchido, ent˜ao o determinante αb − βa ´e primo
com n.” ´e equivalente `a sua contrapositiva “Se o determinante αb − βa n˜ao ´e primo com
n, ent˜ao o quadrado n˜ao ´e preenchido”. Aqui, vamos tomar a contrapositiva.

A condi¸c˜ao necess´aria de dois n´umeros x1 e x2 ocuparem uma mesma c´elula, est´a
determinada pelo sistema (7)–(8). Evidente que se n e (αb − βa) tˆem um divisor co-
mum δ (cid:54)= 1, efetuando-se o cancelamente multiplicativo, vamos obter o seguinte sistema
equivalente a (7)–(8):






(cid:21)

(cid:20)x1 − 1
n

≡

(cid:16)

mod

mod

x1 ≡ x2
(cid:20)x2 − 1
n

(cid:21) (cid:16)

(cid:17)

(cid:17)

n
δ
n
δ

(12)

(13)

5 Em cada coluna ou linha, tanto w quanto k assumir˜ao os valores de um sistema completo de res´ıduos

m´odulo n.

6 Em seu artigo, ao estabelecer uma condi¸c˜ao necess´aria e suﬁciente para o preenchimento, Lehmer
(1929) sup˜oe que α, β, a e b sejam primos com n. No entanto, ao provar que essa condi¸c˜ao ´e suﬁciente,
ele n˜ao faz uso dessa hip´otese.

Por k ≡

(cid:21)

(cid:20)x − 1
n

, a equa¸c˜ao

(cid:21)

(cid:20) x1 − 1
n

≡

(cid:20)x2 − 1
n

(cid:21) (cid:16)

mod

(cid:17)

n
δ

pode ser reescrita:

k1 ≡ k2

(cid:16)

mod

(cid:17)

n
δ

De acordo com x = 1 + w + kn , a equa¸c˜ao x1 ≡ x2

(cid:16)

mod

(cid:17)

n
δ

pode ser escrita:

1 + w1 + k1n ≡ 1 + w2 + k2n
(cid:16)
(cid:17)

(cid:16)

w1 + k1

w1 ≡ w2

δ ·
(cid:16)

n
δ
mod

≡ w2 + k2
(cid:17)
n
δ

mod
(cid:17) (cid:16)

(cid:17)

n
δ
mod

(cid:16)

n
δ

(cid:17)

n
δ

δ ·

O sistema (12)–(13) pode, ent˜ao, ser reescrito:






w1 ≡ w2

k1 ≡ k2

(cid:16)

(cid:16)

mod

mod

(cid:17)

(cid:17)

n
δ
n
δ

28

(14)

(15)

Como queremos investigar n´umeros x1, x2 ∈ {1, 2, . . . , n2} que ocupam a mesma c´elula no
quadrado, estamos interessados em solu¸c˜oes de (12)–(13) tais que

xj = 1 + wj + kjn ∈ {1, 2, . . . , n2}.

Vamos nos referir a tais solu¸c˜oes como solu¸c˜oes de interesse. Faremos o mesmo com
solu¸c˜oes (w1, k1) e (w2, k2) do sistema (14)–(15) correspondentes respectivamente a x1, x2.
Obviamente, duas solu¸c˜oes de interesse w1 e w2 de (14) deixam o mesmo resto w(cid:48) na
divis˜ao por

. De um modo geral, as solu¸c˜oes de interesse de (14) s˜ao dadas por

n
δ

w = w(cid:48) + l ·

n
δ

(16)

com 0 ≤ l ≤ δ − 1 e 0 ≤ w(cid:48) ≤
absurdo, pois 0 ≤ w ≤ n − 1, p´agina 23, Observa¸c˜ao 1.

n
δ

− 1. Observe que, se l ≥ δ ent˜ao w ≥ n, o que ´e um

Analogamente, as solu¸c˜oes de interesse de (15) s˜ao dadas por

k = k(cid:48) + t ·

n
δ

com 0 ≤ t ≤ δ − 1

e

0 ≤ k(cid:48) ≤

n
δ

− 1. Portanto, as solu¸c˜oes de interesse do sistema

(12)–(13) s˜ao dadas por

x = 1 + w(cid:48) + k(cid:48)n + l ·

n
δ

+ t ·

n2
δ

29

(17)

com w(cid:48) e k(cid:48) varrendo o conjunto de res´ıduos7 m´odulo
, l e t varrendo o conjunto de
res´ıduos8 m´odulo δ. Para obter a condi¸c˜ao necess´aria para o preenchimento, resta exibir
x1 (cid:54)= x2 dados por (17) que sejam solu¸c˜oes de (5)–(6), isto ´e, que ocupem a mesma c´elula,
o que ser´a feito na Subse¸c˜ao 4.3.7.

n
δ

4.2.1 A condi¸c˜ao necess´aria para o preenchimento segundo Lehmer (1929)

Nesta se¸c˜ao, ap´os a descri¸c˜ao do m´etodo do passo uniforme, do estabelecimento das
suas congruˆencias fundamentais e do teorema da condi¸c˜ao suﬁciente para o preenchimento,
vamos discutir um par´agrafo, da p´agina 531, do artigo de Lehmer (1929) que trata da
prova de sua condi¸c˜ao necess´aria.

Teorema 8 (Condi¸c˜ao necess´aria para o preenchimento – Lehmer). Dados os parˆametros
α, β, a e b, primos com n, a condi¸c˜ao necess´aria para que o m´etodo do passo uniforme

preencha o quadrado de ordem n ´e que o determinante

seja primo com n.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

Para Lehmer (1929), a condi¸c˜ao necess´aria para o preenchimento requer, al´em da
condi¸c˜ao mdc(αb − βa, n) = 1, tamb´em a primalidade dos parˆametros α, β, a e b com n.

4.2.1.1 O par´agrafo de Lehmer (1929, p. 531)

Se9 o mdc(αb − βa, n) = δ, ent˜ao

(cid:21)

(cid:20)x1 − 1
n

≡

(cid:20)x2 − 1
n

(cid:21) (cid:16)

mod

(cid:17)

n
δ

7 w(cid:48), k(cid:48) ∈ {0, 1, 2, . . . ,

n
δ

− 1}.

8 l, t ∈ {0, 1, 2, . . . , δ − 1}.
9 tradu¸c˜ao livre de:

(cid:3) (cid:0)mod n

(cid:1) and x1 ≡ x2

If however n and (αb − βa) have a common divisor δ then we have (cid:2) x1−1
If then we put x2 = x1 + (cid:0) n

(cid:2) x2−1
(cid:0)mod n
n
satisﬁed. Put this value of x2 in the other congruence and we have (cid:2) x1−1
δ is an integer the congruence is clearly satisﬁed. Two values of x which diﬀer by n2
since n
fall in the same cell by this rule for ﬁlling the square and the square will therefore not be ﬁlled.

(cid:3) ≡
(cid:1) n this last congruence is
(cid:1) and
δ
δ will then

(cid:3) ≡ (cid:2) x1−1

(cid:3) (cid:0)mod n

n + n

(cid:1).

n

n

δ

δ

δ

δ

30

(cid:0)mod n

(cid:1) n a ´ultima con-
(cid:1). Se consideramos ent˜ao x2 = x1 + (cid:0) n
e x1 ≡ x2
gruˆencia se veriﬁca. Substitua esse valor de x2 na outra congruˆencia e obtenha

δ

δ

(cid:21)

(cid:20)x1 − 1
n

≡

(cid:20)x1 − 1
n

+

n
δ

(cid:21) (cid:16)

mod

(cid:17)

.

n
δ

δ ´e um inteiro, a congruˆencia claramente se veriﬁca. Dois valores de x
δ ser˜ao alocados pelo m´etodo do passo uniforme na mesma

Como n
que diﬁram por n2
c´elula e o quadrado n˜ao ser´a preenchido. (LEHMER, 1929, p. 531).

Lehmer (1929) assume que os parˆametros do m´etodo do passo uniforme, α, β, a, b sejam
todos primos com n e ainda que o mdc(αb − βa, n) = δ (cid:54)= 1. Lehmer (1929) exibe duas

que satistazem (12)-(13) e aﬁrma que v˜ao cair na mesma c´elula e
solu¸c˜oes x1 − x2 =
por isto o quadrado n˜ao ser´a preenchido. Essa aﬁrma¸c˜ao ´e equivocada pois duas solu¸c˜oes

x1 − x2 =

n˜ao satisfazem (5)-(6), como mostrado a seguir:

n2
δ

n2
δ

(cid:19)

(cid:19)





α

β

(cid:18) n2
δ
(cid:18) n2
δ

+ a

+ b

(cid:26)(cid:20)x2 − 1
n
(cid:26)(cid:20)x2 − 1
n

+

+

(cid:21)

(cid:21)

n
δ
n
δ

−

−

(cid:20)x2 − 1
n
(cid:20)x2 − 1
n

(cid:21)(cid:27)

(cid:21)(cid:27)

≡ 0

(mod n)

≡ 0

(mod n)

Como

n
δ

´e inteiro, segue:




αn



βn

(cid:17)

(cid:17)

(cid:16)n
δ
(cid:16)n
δ

+ a

+ b

(cid:17)

(cid:17)

(cid:16)n
δ
(cid:16)n
δ

≡ 0

(mod n)

≡ 0

(mod n)




a



b

(cid:17)

(cid:17)

(cid:16)n
δ
(cid:16)n
δ

≡ 0

(mod n)

≡ 0

(mod n)

Como (a, n) = (b, n) = 1, temos

n
δ

≡ 0 (mod n) que ´e falso!

Diferentemente das equa¸c˜oes alg´ebricas, multiplicando-se congruˆencias lineares
com duas vari´aveis m´odulo n, por um n´umero n˜ao primo com n, solu¸c˜oes esp´urias podem
ser introduzidas. Dividindo-se congruˆencias lineares com duas vari´aveis m´odulo n, por um
n´umero n˜ao primo com n, solu¸c˜oes podem ser perdidas. Por exemplo, 4x+2y ≡ 0 (mod 6)
tem 12 solu¸c˜oes: (0, 0), (1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (0, 3), (3, 0), (4, 1), (1, 4), (5, 2), (2, 5).
Dividindo-se por 2, obt´em-se a equa¸c˜ao 2x + y ≡ 0 (mod 3) que tem apenas 3 solu¸c˜oes:
(0, 0), (1, 1), (2, 2). Por´em, multiplicando-se ou dividindo-se congruˆencias lineares m´odulo
n, por um n´umero primo com n, n˜ao se perdem nem se ganham solu¸c˜oes. O fato de Leh-
mer (1929) ter pensado que podia voltar, ou seja, que as duas solu¸c˜oes apresentadas de

(12)-(13) s˜ao tamb´em solu¸c˜oes de (5)-(6), nos levou a fazer uma an´alise das implica¸c˜oes
dos caminhos de ida e de volta.

31

4.2.2 O ponto crucial no caminho da volta

O ponto crucial na prova da condi¸c˜ao necess´aria encontra-se na passagem, de (5)-
(6) para (7)-(8), onde as equa¸c˜oes lineares foram multiplicadas pelos parˆametros α, β,
a e b presumidamente primos. Logo, nessa passagem n˜ao haveria ganho nem perda de
solu¸c˜oes, portanto haveria uma equivalˆencia. No entanto, voltando, de (7)-(8) para (5)-(6)
observamos algo que nos surpreendeu. Vamos, adotar aqui, a nota¸c˜ao com w(cid:48)s e k(cid:48)s. O
sistema (7)-(8) pode ser reescrito como






(αb − βa)(w1 − w2) ≡ 0

(mod n)

(αb − βa)(k1 − k2) ≡ 0

(mod n)

e ´e equivalente a

(18)

(19)






b[α(w1 − w2) + a(k1 − k2)] − a[β(w1 − w2) + b(k1 − k2)] ≡ 0

(mod n)

(20)

α[β(w1 − w2) + b(k1 − k2)] − β[α(w1 − w2) − a(k1 − k2) ≡ 0

(mod n)

(21)

Multiplicando (20) por α e (21) por a e somando, vamos obter:

(αb − βa)[α(w1 − w2) + a(k1 − k2)] ≡ 0

(mod n)

Multiplicando (20) por β e (21) por b e somando, vamos obter:

(αb − βa)[β(w1 − w2) + b(k1 − k2)] ≡ 0

(mod n)

Portanto, o sistema (18)-(19) implica em:

(cid:40)(αb − βa)[α(w1 − w2) + a(k1 − k2)] ≡ 0
(αb − βa)[β(w1 − w2) + b(k1 − k2)] ≡ 0

(mod n)

(mod n)

Se αb − βa for primo com n ent˜ao:

(cid:40)α(w1 − w2) + a(k1 − k2) ≡ 0
β(w1 − w2) + b(k1 − k2) ≡ 0

(mod n)

(mod n)

32

Portanto, o que impede a equivalˆencia entre os sistemas (5)-(6) e (7)-(8) ´e apenas, a
n˜ao primalidade, do determinante αb − βa com n. Veremos que a condi¸c˜ao necess´aria e
suﬁciente do preenchimento do quadrado pelo m´etodo do passo uniforme depende unica-
mente da primalidade do determinante e n˜ao exige a primalidade dos parˆametros com n
diferentemente do que havia estabelecido Lehmer (1929).

Aﬁrmamos que ´e possivel haver dois n´umeros x1 e x2 que satisfa¸cam as congruˆencias
do sistema (12)–(13) mas n˜ao ocupem a mesma c´elula do quadrado. Em vista disso, antes
de dar prosseguimento, achamos importante nos deter um pouco, para entender como se
conﬁgura, o n˜ao preenchimento pelo m´etodo do passo uniforme.

4.3 Como ocorre o n˜ao preenchimento?

Vimos na p´agina 29, que as solu¸c˜oes de interesse do sistema (12)-(13) s˜ao n´umeros

da forma

x = x(cid:48) + l ·

n
δ

+ t ·

n2
δ

,

0 ≤ l, t ≤ δ − 1,

n
− 1. Fixados w(cid:48) e k(cid:48), estes n´umeros podem
sendo x(cid:48) = 1 + w(cid:48) + k(cid:48)n, com 0 ≤ w(cid:48), k(cid:48) ≤
δ
ser dispostos em δ linhas e δ colunas, Figura 8, formando uma matriz M (w(cid:48), k(cid:48)). Mais
precisamente, para 0 ≤ w(cid:48), k(cid:48) ≤

− 1, temos

n
δ

M (w(cid:48), k(cid:48)) = (mt+1,l+1), mt+1,l+1 = xtl = x(cid:48) + l ·

n
δ

+ t ·

n2
δ

,

0 ≤ l, t ≤ δ − 1

Figura 8 - Matriz M (w(cid:48), k(cid:48))

Fonte: O autor, 2014.

Figura 9 - Estrutura das matrizes do exemplo 2.

33

(a)

(b)

Legenda: (a) 25 matrizes M (w(cid:48), k(cid:48)), 3×3.
(b) M (w(cid:48), k(cid:48)), 3 × 3.

Fonte: O autor, 2014.

Segue que o conjunto de solu¸c˜oes de interesse do sistema (12)-(13) ser´a constitu´ıdo por
(cid:16) n
δ

matrizes, cada uma deﬁnida por um w(cid:48) e um k(cid:48) tais que 0 ≤ w(cid:48), k(cid:48) ≤

− 1, tendo

n
δ

(cid:17)2

cada uma δ2 n´umeros.

A este ponto, somos capazes de dado um n´umero qualquer 1 ≤ x ≤ n2 identiﬁcar

a qual M (w(cid:48), k(cid:48)) ele pertence, e quais ser˜ao os outros n´umeros desta mesma matriz.

Por que ´e importante saber quais s˜ao os n´umeros de uma M (w(cid:48), k(cid:48))? Porque
s˜ao n´umeros de uma M (w(cid:48), k(cid:48)) que v˜ao ocupar uma mesma c´elula, ocasionando, o n˜ao
preenchimento do quadrado.

Exemplo 2. Seja o quadrado de ordem n = 15 constru´ıdo pelo m´etodo do passo uniforme

com os seguintes parˆametros: α = 2, β = 1, a = 11 e b = 4. Observe que

= −3 e

mdc(n, αb − βa) = δ = 3. Assim, teremos

(cid:17)2

(cid:16)n
δ

=

(cid:18) 15
3

(cid:19)2

Figura 9a, cada uma com δ2 = 32 = 9 elementos, Figura 9b.

= 25 matrizes M (w(cid:48), k(cid:48)), 3 × 3,

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

Figura 10 - Localiza¸c˜ao do n´umero 133, M (2, 3).

34

Fonte: O autor, 2014.

• Nessas condi¸c˜oes, em qual M (w(cid:48), k(cid:48)) vai cair o n´umero, digamos, 133?

133 = 1 + w + 15 · k ⇔ k = 8 e w = 12

(cid:16)

k(cid:48) ≡ k

w(cid:48) ≡ w

mod
(cid:16)

mod

(cid:17)

n
δ
n
δ

⇒ k(cid:48) ≡ 8 ≡ 3

(mod 5)

(cid:17)

⇒ w(cid:48) ≡ 12 ≡ 2

(mod 5)

Desta forma, o n´umero 133 est´a em M (2, 3), Figura 10.

35

4.3.1 Coordenadas dos elementos de M (w(cid:48), k(cid:48))

Um elemento gen´erico de M (w(cid:48), k(cid:48)) tem a forma

x = 1 + w(cid:48) + k(cid:48) · n + l ·

n
δ

+ t ·

n2
δ

.

Vamos calcular as suas coordenadas A e B. Para isso retomamos a equa¸c˜ao (3). Substi-
tuindo a express˜ao de x, vamos obter a seguinte congruˆencia m´odulo n:

(cid:18)

A ≡ p + α

w(cid:48) + k(cid:48) · n + l ·

n
δ

+ t ·

(cid:19)

n2
δ

+ a






w(cid:48) + k(cid:48) · n + l ·

n

n
δ

+ t ·

n2
δ




 (mod n)

Temos:

α · k(cid:48) · n ≡ 0

(mod n)

e α · t ·

n2
δ

≡ 0

(mod n)

Portanto, ambos podem ser eliminados.

A ≡ p + α

(cid:16)

w(cid:48) + l ·

(cid:17)

n
δ

+ a






w(cid:48) + k(cid:48) · n + l ·

n

n
δ

+ t ·

n2
δ




 (mod n).

O termo multiplicado por a pode ser decomposto:

A ≡ p + α

(cid:16)

w(cid:48) + l ·

(cid:17)

n
δ

+ a

w(cid:48) + l ·

n

n
δ



 +

(cid:21)

(cid:20)k(cid:48) · n
n

+






t ·

n2
δ

n




















(mod n).

E, considerando que:





w(cid:48) + l ·

n

n
δ



 = 0,

(cid:21)

(cid:20) k(cid:48) · n
n

= k(cid:48)

e

uma vez que w = w(cid:48) + l ·

n
δ

e 0 ≤ w ≤ n − 1.






t ·

n2
δ

n




 =

(cid:21)

(cid:20)t · n
δ

=

t · n
δ

,

uma vez que δ | n,

a congruˆencia se reduz a:

A ≡ p + αw(cid:48) + a · k(cid:48) + l ·

αn
δ

+ t ·

an
δ

(mod n)

(22)

Figura 11 - M (2, 3) do Ex. 3.

Fonte: O autor, 2014.

Analogamente, segue de (4) que a coordenada B de x ´e dada por

B ≡ q + βw(cid:48) + b · k(cid:48) + l ·

βn
δ

+ t ·

bn
δ

(mod n)

36

(23)

Exemplo 3. Seja o quadrado de ordem n = 15 constru´ıdo pelo m´etodo do passo uniforme
com os seguintes parˆametros: α = 2, β = 1, a = 11 e b = 4. Quais s˜ao as coordenadas
(A, B), de cada elemento da matriz M (2, 3)?
Obs.: p e q s˜ao as coordenadas da c´elula inicial, onde ´e alocado o 1.

A Figura 11 mostra os resultados obtidos quando usamos (22) e (23). Veriﬁcamos

que os n´umeros

• 48, 133 e 203 v˜ao ocupar a c´elula do quadrado de coordenadas (p + 7, q + 14);

• 53, 123 e 208; a c´elula de coordenadas (p + 2, q + 4) e

• 58, 128 e 198 ir˜ao cair na c´elula de coordenadas (p + 12, q + 9),

conﬁrmando que dois valores de x que correspondam a solu¸c˜oes de interesse do sistema
(12)-(13) podem n˜ao ocupar a mesma c´elula.

Com rela¸c˜ao `a aﬁrma¸c˜ao de Lehmer (4.2.1.1), P´ag.29, “que dois valores de x que

diferem de

n2
δ

v˜ao ocupar a mesma c´elula”, a Figura 11, oferece v´arios pares de valores

de x que a contradizem, por exemplo, 53 e 128, que diferem de
diferentes.

152
3

mas ocupam c´elulas

4.3.2 As coordenadas A(cid:48) e B(cid:48)

O elemento x00 se localiza na 1a. linha e na 1a. coluna de M (w(cid:48), k(cid:48)). Ent˜ao, fazendo

37

l = 0 e t = 0, temos:

x00 = 1 + w(cid:48) + k(cid:48) · n + 0 ·

βn
δ

+ 0 ·

bn
δ

= 1 + w(cid:48) + k(cid:48) · n = x(cid:48)

Vamos denotar suas coordenadas por A(cid:48) e B(cid:48). Temos

A(cid:48) ≡ p + αw(cid:48) + ak(cid:48)

(mod n)

B(cid:48) ≡ q + βw(cid:48) + bk(cid:48)

(mod n)

Ent˜ao, as congruˆencias (22) e (23) podem ser reescritas:

A ≡ A(cid:48) + l ·

B ≡ B(cid:48) + l ·

αn
δ
βn
δ

+ t ·

+ t ·

an
δ
bn
δ

(mod n)

(mod n)

(24)

(25)

As coordenadas dentro de uma matriz M (w(cid:48), k(cid:48)) dependem de (A(cid:48), B(cid:48)) que s˜ao as coor-
denadas do elemento x00. A partir destas coordenadas todas as outras coordenadas dos
demais elementos da matriz s˜ao obtidas somando-se

l ·

αn
δ

+ t ·

an
δ

e

l ·

βn
δ

+ t ·

bn
δ

respectivamente a A(cid:48) e a B(cid:48). Ou seja todas s˜ao obtidas regularmente a partir de (A(cid:48), B(cid:48)).

4.3.3 Regularidade das coordenadas A e B entre matrizes

Seja

x = 1 + w(cid:48) + k(cid:48)n + l

n
δ

+ t

n2
δ

.

Note que a diferen¸ca entre n´umeros, localizados na mesma linha e coluna, mas em matrizes
vizinhas M (w(cid:48)±1, k(cid:48)) ser´a de 1. E, em matrizes vizinhas da forma M (w(cid:48), k(cid:48)±1), a diferen¸ca
ser´a de n como mostram as ﬁguras 12a e 12c.

Sejam (A, B) as coordenadas do elemento x localizado na ta. linha e la. coluna de
M (w(cid:48), k(cid:48)). A coordenada Aw(cid:48)±1,k(cid:48) de um elemento na mesma posi¸c˜ao, mas localizado em

Figura 12 - Regularidades.

38

(a)

(b)

(c)

(d)

Legenda: (a) Elementos de mesma posi¸c˜ao, em matrizes vizinhas,

`a esquerda e `a direita; (b) Coordenadas de mesma

posi¸c˜ao, em matrizes vizinhas, `a esquerda e `a direita; (c)

Elementos de mesma posi¸c˜ao, em matrizes vizinhas,

acima e abaixo; (d) Coordenadas de mesma posi¸c˜ao, em

matrizes vizinhas, acima e abaixo.

Fonte: O autor, 2014.

uma matriz vizinha M (w(cid:48) ± 1, k(cid:48)), ser´a determinada por:

Aw(cid:48)±1,k(cid:48) ≡ p + α(w(cid:48) ± 1) + ak(cid:48) + l ·
αn
δ

p + αw(cid:48) + ak(cid:48) + l ·

Aw(cid:48)±1,k(cid:48) ≡

(cid:16)

αn
δ
+ t ·

(mod n)

an
δ
± α (mod n)

+ t ·
(cid:17)
an
δ

Aw(cid:48)±1,k(cid:48) ≡ A ± α (mod n)

Analogamente

Bw(cid:48)±1,k(cid:48) ≡ B ± β (mod n)

Portanto, a partir das coordenadas (A, B) de x, podemos determinar as coordenadas de
um elemento localizado na mesma posi¸c˜ao, em uma matriz vizinha `a esquerda ou `a direita

M (w(cid:48) ± 1, k(cid:48)), simplesmente, somando ±α `a coordenada A e ±β `a coordenada B, Figura
12b

A coordenada Aw(cid:48),k(cid:48)±1 de um elemento na mesma posi¸c˜ao, mas localizado em uma

matriz vizinha M (w(cid:48), k(cid:48) ± 1), ser´a determinada por:

39

Aw(cid:48),k(cid:48)±1 ≡ p + αw(cid:48) + a(k(cid:48) ± 1) + l ·
αn
δ

p + αw(cid:48) + ak(cid:48) + l ·

Aw(cid:48),k(cid:48)±1 ≡

(cid:16)

αn
δ
+ t ·

(mod n)

an
δ
± a (mod n)

+ t ·
(cid:17)
an
δ

Aw(cid:48),k(cid:48)±1 ≡ A ± a (mod n)

Analogamente

Bw(cid:48),k(cid:48)±1 ≡ B ± b

(mod n)

Portanto, a partir das coordenadas (A, B) de x, podemos determinar as coordenadas
de um elemento localizado na mesma posi¸c˜ao, em uma matriz vizinha acima ou abaixo
M (w(cid:48) ± 1, k(cid:48)), simplesmente, somando ±a `a coordenada A e ±b `a coordenada B, Figura
12d.

Observa¸c˜ao 2 (A possibilidade de α ser m´ultiplo de n). A ´unica possibilidade de termos
duas coordenadas (A, B) iguais em matrizes vizinhas seria se β tamb´em fosse m´ultiplo
de n, pois ter´ıamos α ≡ 0 (mod n) e β ≡ 0 (mod n). Mas, esse problema ´e aparente,
pois em caso dos dois serem m´ultiplos de n ent˜ao o determinante tamb´em seria m´ultiplo
de n e o m´aximo divisor comum δ = n. Nesse caso, a quantidade de matrizes ´e dada
= 1. Ent˜ao, ter´ıamos apenas uma ´unica matriz n × n que seria a M (0, 0). ´E

por
inteiramente an´aloga, a possibilidade de a ou b serem m´ultiplos de n.

(cid:16) n
δ

(cid:17)2

4.3.4 Regularidade das coordenadas A e B ao longo de uma linha de M (w(cid:48), k(cid:48))

Seja (Atl, Btl) as coordenadas do elemento xtl localizado na linha t e coluna l de
M (w(cid:48), k(cid:48)). As coordenadas de um elemento vizinho, localizado na mesma linha, xt,l+1 ou
xt,l−1, ser˜ao determinadas por:

At,l±1 ≡

(cid:16)

A(cid:48) + l ·

Bt,l±1 ≡

(cid:18)

B(cid:48) + l ·

αn
δ
βn
δ

+ t ·

+ t ·

(cid:17)

±

(cid:19)

±

an
δ
bn
δ

αn
δ
βn
δ

≡ At,l ±

≡ Bt,l ±

αn
δ
βn
δ

(mod n)

(mod n)

Portanto, a partir das coordenadas (A, B) de x, podemos determinar as coordenadas dos
`a coordenada A
elementos vizinhos em uma mesma linha, simplesmente, somando ±

αn
δ

Figura 13 - Regularidades.

40

(a)

(b)

Legenda: (a) Elementos vizinhos de x; (b) Coordenadas vizinhas de (A, B).
Fonte: O autor, 2014.

e ±

βn
δ

`a coordenada B.

4.3.5 Regularidade das coordenadas A e B ao longo de uma coluna de M (w(cid:48), k(cid:48))

Seja (Atl, Btl) as coordenadas do elemento xt,l localizado na linha t e coluna l de
M (w(cid:48), k(cid:48)) . As coordenadas de um elemento vizinho, localizado na mesma coluna, xt+1,l
ou xt−1,l, ser˜ao determinadas por:

At±1,l ≡

(cid:16)

A(cid:48) + l ·

Bt±1,l ≡

(cid:18)

B(cid:48) + l ·

αn
δ
βn
δ

+ t ·

+ t ·

(cid:17)

±

(cid:19)

±

an
δ
bn
δ

αn
δ
βn
δ

≡ At,l ±

≡ Bt,l ±

an
δ
bn
δ

(mod n)

(mod n)

Portanto, a partir das coordenadas (A, B) de x, podemos determinar as coordenadas

an
δ

bn
δ

dos elementos vizinhos em uma mesma coluna somando ±
`a
coordenada B. As ﬁguras 13a e 13b mostram os vizinhos de um elemento gen´erico, x, em
uma M (w(cid:48), k(cid:48)), assim como suas respectivas coordenadas.

`a coordenada A e ±

Recapitulando: At´e aqui, vimos que as solu¸c˜oes de interesse do sistema (12)-(13)

n
δ

n2
δ

+ t ·

s˜ao n´umeros da forma x = 1 + w(cid:48) + k(cid:48) · n + l ·
e podem ser organizados em
matrizes M (w(cid:48), k(cid:48)). S˜ao os n´umeros que est˜ao em uma mesma matriz M (w(cid:48), k(cid:48)) que v˜ao
compartilhar c´elulas, causando o n˜ao preenchimento do quadrado pelo m´etodo do passo
uniforme. Tamb´em observamos um padr˜ao: `a medida em que nos movemos, horizon-
talmente, para a direita ou esquerda, em M (w(cid:48), k(cid:48)), os elementos variam de ±
e suas,
αn
δ

respectivas coordenadas, variam de ±

. Se o movimento for, verticalmente,

βn
δ

e ±

n
δ

para cima ou para baixo, os elementos variam de ±

s˜ao acrescidas de ±

an
δ

e ±

bn
δ

.

41

n2
δ

e suas, respectivas coordenadas,

Exemplo 4. Seja o quadrado constru´ıdo pelo m´etodo do passo uniforme deﬁnido pelos
parˆametros n = 15, α = 4, β = 5, a = 1 e b = 2.

Aplicando as regularidades da matriz M (w(cid:48), k(cid:48)), vamos determinar quais s˜ao os n´umeros,
com suas respectivas coordenadas, que est˜ao na mesma matriz que 102.
αb − βa = 4 · 2 − 5 · 1 = 3 e δ = mdc(15, 3) = 3

102 = 1 + w + 15 · k ⇔ k = 6 e w = 11

(cid:16)

k(cid:48) ≡ k

w(cid:48) ≡ w

mod
(cid:16)

mod

(cid:17)

n
δ
n
δ

⇒ k(cid:48) ≡ 6 ≡ 1

(mod 5)

(cid:17)

⇒ w(cid:48) ≡ 11 ≡ 1

(mod 5)

Ent˜ao, 102 est´a em M (1, 1). O elemento x00 que est´a na 1a. linha e 1a. coluna de M (1, 1)
´e dado por

x00 = x(cid:48) = 1 + w(cid:48) + k(cid:48)n = 1 + 1 + 1 · 15 = 17

Suas coordenadas s˜ao:

A00 = A(cid:48) ≡ p + αw(cid:48) + ak(cid:48) ≡ p + 4 · 1 + 1 · 1 ≡ p + 5
B00 = B(cid:48) ≡ q + βw(cid:48) + bk(cid:48) ≡ q + 5 · 1 + 2 · 1 ≡ q + 7

(mod 15)

(mod 15)

Ent˜ao, a partir de x00 = 17, A00 = p + 5 e B00 = q + 7, podemos determinar, respectiva-
mente, x01, A01 e B01:

x01 = 17 + 5 = 22

A01 ≡ (p + 5) + 5 ≡ p + 10 (mod 15)

B01 ≡ (q + 7) + 10 ≡ q + 2 (mod 15)

A partir de x01 = 22, A01 = p + 10 e B01 = q + 2, podemos determinar, respectivamente,
x02, A02 e B02:

x02 = 22 + 5 = 27

A02 ≡ (p + 10) + 5 ≡ p (mod 15)

B02 ≡ (q + 2) + 10 ≡ q + 12 (mod 15)

Assim, a 1a. linha foi conclu´ıda.

Continuando, de x00 = 17, A00 = p + 5 e B00 = q + 7, podemos determinar, respectiva-
mente, x10, A10 e B10:

x10 = 17 + 75 = 92

A10 ≡ (p + 5) + 5 ≡ p + 10 (mod 15)

B10 ≡ (q + 7) + 10 ≡ q + 2 (mod 15)

42

De x10 = 92, A10 = p + 10 e B10 = q + 2, podemos determinar, respectivamente, x11, A11
e B11:

x11 = 92 + 5 = 97

A11 ≡ (p + 10) + 5 ≡ p (mod 15)

B11 ≡ (q + 2) + 10 ≡ q + 12 (mod 15)

De x11 = 97, A11 = p e B11 = q + 12, podemos determinar, respectivamente, x12, A12 e
B12:

x12 = 97 + 5 = 102

A12 ≡ p + 5 ≡ p + 5 (mod 15)

B12 ≡ (q + 12) + 10 ≡ q + 7 (mod 15)

Assim, a 2a. linha foi conclu´ıda.

De x10 = 92, A10 = p + 10 e B10 = q + 2, podemos determinar, respectivamente, x20, A20
e B20:

x20 = 92 + 75 = 167

A20 ≡ (p + 10) + 5 ≡ p (mod 15)

B20 ≡ (q + 2) + 10 ≡ q + 12 (mod 15)

De x20 = 167, A20 = p e B20 = q + 12, podemos determinar, respectivamente, x21, A21 e
B21:

x21 = 167 + 5 = 172

A21 ≡ p + 5 ≡ p + 5 (mod 15)

B21 ≡ (q + 12) + 10 ≡ q + 7 (mod 15)

De x21 = 172, A21 = p + 5 e B21 = q + 7, podemos determinar, respectivamente, x22, A22
e B22:

x22 = 172 + 5 = 177

A22 ≡ (p + 5) + 5 ≡ p + 10 (mod 15)

B22 ≡ (q + 7) + 10 ≡ q + 2 (mod 15)

Os resultados obtidos est˜ao na Figura 14.

Figura 14 - Elementos e suas coordenadas, matriz M (1, 1), do Exemplo 4.

Fonte: O autor, 2014.

43

4.3.6 Padr˜ao dos n´umeros em M (w(cid:48), k(cid:48)) que ocupam uma mesma c´elula no quadrado

Vimos que ter o mesmo valor para w(cid:48) e o mesmo valor para k(cid:48) ´e condi¸c˜ao necess´aria,
mas n˜ao suﬁciente para que dois n´umeros ocupem a mesma c´elula do quadrado. Sejam
x1 = xt1,l1 e x2 = xt2,l2 dois elementos em uma matriz M (w(cid:48), k(cid:48)). Suas coordenadas s˜ao
dadas respectivamente por (24) e (25)

A1 ≡ A(cid:48) + l1

B1 ≡ B(cid:48) + l1

A2 ≡ A(cid:48) + l2

B2 ≡ B(cid:48) + l2

αn
δ
βn
δ
αn
δ
βn
δ

+ t1

+ t1

+ t2

+ t2

an
δ
bn
δ
an
δ
bn
δ

(mod n)

(mod n)

(mod n)

(mod n)

Vamos assumir que x1 e x2 tenham coordenadas iguais, A1 ≡ A2 e B1 ≡ B2, temos:

(cid:40)α(l1 − l2) ≡ a(t2 − t1)

(mod δ)

β(l1 − l2) ≡ b(t2 − t1)

(mod δ)

(26)

(27)

”, citado por Leh-
Vamos agora rediscutir o exemplo dos “dois n´umeros que diferem por
mer. At´e o ﬁm dessa subse¸c˜ao, tal como Lehmer (1929), admitiremos que os parˆametros
α, β, a e b s˜ao primos com n. Veremos que dois n´umeros com essa rela¸c˜ao, embora em uma
mesma M (w(cid:48), k(cid:48)), n˜ao caem em uma mesma c´elula (A, B). Vamos analisar o sistema (26)-
(27) tendo em vista analisar o erro cometido por Lehmer sob uma nova perspectiva.

n2
δ

Segue do fato dos parˆametros α, β, a e b serem primos com n que o sistema (26)–

(27) ´e equivalente a

(cid:40) α(l1 − l2) ≡ a(t2 − t1)

(mod δ)

(αb − βa)(t2 − t1) ≡ 0

(mod δ)

(28)

(29)

Observe que quaisquer inteiros t1, t2 satisfazem a (29). Consequentemente, basta resolver
(28).

Considere (28). Se l1 = l2 ent˜ao 0 ≡ a(t2 − t1) (mod δ),

mas a ´e primo com n, ent˜ao t1 ≡ t2 (mod δ),

(mas 0 ≤ t ≤ δ − 1) ent˜ao t1 = t2.

Por outro lado, se t1 = t2 ent˜ao α(l1 − l2) ≡ 0 (mod δ),

mas α ´e primo com n, ent˜ao l1 ≡ l2 (mod δ),

mas 0 ≤ l ≤ δ − 1, ent˜ao l1 = l2.

Figura 15 - x1 e x2 em uma mesma coluna l de M (w(cid:48), k(cid:48)) tem

coordenadas (A, B) diferentes.

44

Fonte: O autor, 2014.

Figura 16 - x1 e x2 em uma mesma linha t de M (w(cid:48), k(cid:48)) tem

coordenadas (A, B) diferentes.

Fonte: O autor, 2014.

Portanto, podemos enunciar o seguinte:

Teorema 9. Dados α, β, a e b todos primos com n. Se dois elementos distintos x1 =
n
xt1,l1 = x(cid:48) + l1
δ
mesma c´elula do quadrado, ent˜ao l1 (cid:54)= l2 e t1 (cid:54)= t2.

da matriz M (w(cid:48), k(cid:48)) ocupam a

e x2 = xt2,l2 = x(cid:48) + l2

n2
δ

n2
δ

+ t1

+ t2

n
δ

Isso signiﬁca que dois n´umeros que est˜ao em uma mesma coluna l da matriz
M (w(cid:48), k(cid:48)) n˜ao podem ocupar uma mesma c´elula do quadrado, Figura 15. Da mesma
forma, dois n´umeros que est˜ao em uma mesma linha t da matriz M (w(cid:48), k(cid:48)) n˜ao ocupam

”
uma mesma c´elula do quadrado, Figura 16. Note que “dois n´umeros que diferem por
sempre pertencem a uma mesma coluna. Portanto, n˜ao podem ocupar uma mesma c´elula
do quadrado.

n2
δ

Substituindo os coeﬁcientes de (28) pelos restos na divis˜ao por δ, obtemos um

sistema equivalente a (28)–(29)






α(cid:48)(l1 − l2) + a(cid:48)(t1 − t2) ≡ 0

(mod δ)

(αb − βa)(t2 − t1) ≡ 0

(mod δ)

(30)

(31)

Figura 17 - M (2, 3) elementos e coordenadas. Exemplo 5.

45

Fonte: O autor, 2014.

Note que a hip´otese de primalidade nos diz que α(cid:48)
(cid:54)= 0. Pelo Teorema 5 na
p´agina 15, a equa¸c˜ao de congruˆencia linear com duas vari´aveis (30), tem solu¸c˜ao, pois,
mdc(α(cid:48), a(cid:48), δ) = 1 | 0. O Teorema 6 assegura que a equa¸c˜ao (30) tem mdc(α(cid:48), a(cid:48), δ) · δ2−1 =
1 · δ = δ solu¸c˜oes distintas.

(cid:54)= 0 e a(cid:48)

Seja (α(cid:48), a(cid:48)) = mdc(α(cid:48), a(cid:48)). Para 0 ≤ k ≤ δ − 1, considere

l1 − l2 ≡

a(cid:48)
(α(cid:48), a(cid:48))

· k

(mod δ)

e

t1 − t2 ≡ δ −

α(cid:48)
(α(cid:48), a(cid:48))

· k

(mod δ)

(32)

Note que se 0 ≤ k1 (cid:54)= k2 ≤ δ − 1,

a(cid:48)
(α(cid:48), a(cid:48))

· (k1 − k2) (cid:54)≡ 0

(mod δ)

e

δ −

α(cid:48)
(α(cid:48), a(cid:48))

· (k1 − k2) (cid:54)≡ 0

(mod δ).

Al´em disso, se l1, t1, l2 e t2 satisfazem (32), temos

α(cid:48)(l1 − l2) + a(cid:48)(t1 − t2) ≡

a(cid:48)α(cid:48)
(α(cid:48), a(cid:48))

· k −

a(cid:48)α(cid:48)
(α(cid:48), a(cid:48))

· k + a(cid:48) · δ ≡ 0

(mod δ).

Consequentemente, (32) nos permite determinar todos os elementos de uma matriz M (w(cid:48), k(cid:48))
que cair˜ao em uma mesma c´elula do quadrado. Note que os δ2 elementos de M (w(cid:48), k(cid:48))
ser˜ao designados a δ c´elulas distintas. Al´em disso, cada uma dessas c´elulas ser´a ocupada
exatamente por δ elementos de M (w(cid:48), k(cid:48)).

Exemplo 5. Retomamos aqui o Exemplo 3 do quadrado de ordem n = 15 constru´ıdo
pelo m´etodo do passo uniforme com os seguintes parˆametros: α = 2, β = 1, a = 11 e
b = 4, para ilustrar o Teorema 9. A Figura 17 apresenta os elementos de M (2, 3) e suas
respectivas coordenadas.

(cid:17)2

(cid:16) n
δ

Recapitulando: Os n´umeros que ocupam uma mesma c´elula, est˜ao distribu´ıdos em
matrizes M (w(cid:48), k(cid:48)), com 0 ≤ w(cid:48), k(cid:48) ≤

− 1, constitu´ıda de δ linhas e δ colunas.

n
δ

46

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

Nesta subse¸c˜ao (Se¸c˜ao 4.3.6), vimos que o m´etodo do passo uniforme, com parˆametros

α, β, a e b, primos um a um com n, por´em com o determinante

= αb − βa

tendo um divisor comum, δ, com n, (Se¸c˜ao 4.3 na p´agina 32), n˜ao preenche o quadrado e
caracterizamos os n´umeros que v˜ao ocupar uma mesma c´elula. Mostramos que conhecidas
a linha t e a coluna l de um n´umero em M (w(cid:48), k(cid:48)), podemos calcular quais s˜ao todos os
outros n´umeros que ser˜ao alocados na mesma c´elula do quadrado.

4.3.7 Duas solu¸c˜oes de interesse que ocupam a mesma c´elula

Nessa se¸c˜ao, n˜ao supomos que os parˆametros α, β, a e b sejam primos com n.
Admitimos apenas de mdc(αb − βa, n) (cid:54)= 1. Para obter a condi¸c˜ao necess´aria para o

n
preenchimento, resta exibir x1 (cid:54)= x2 dados por x = 1 + w(cid:48) + k(cid:48)n + l ·
δ
solu¸c˜oes de (5)–(6). isto ´e, que ocupem a mesma c´elula no quadrado.

+ t ·

n2
δ

que sejam

J´a sabemos que duas solu¸c˜oes, x1 e x2, que ocupam a mesma c´elula (A, B) do
quadrado, pertencem a uma mesma matriz M (w(cid:48), k(cid:48)) e tˆem suas coordenadas dadas por
(26)–(27). Substituindo os coeﬁcientes α, β, a e b do sistema pelos restos na divis˜ao por
mdc(αb − βa, n) = δ (cid:54)= 1, obtemos:






α(cid:48)(l1 − l2) + a(cid:48)(t1 − t2) ≡ 0

(mod δ)

β(cid:48)(l1 − l2) + b(cid:48)(t1 − t2) ≡ 0

(mod δ)

Interessam-nos solu¸c˜oes l1 − l2 (cid:54)= 0 ou t1 − t2 (cid:54)= 0. Observe que

δ | (αb − βa) ⇒ α(cid:48)b(cid:48) − β(cid:48)a(cid:48) ≡ 0

(mod δ)

(33)

(34)

Note que se todos os parˆametros α(cid:48), β(cid:48), a(cid:48) e b(cid:48) forem nulos, todos os elementos da matriz
M (w(cid:48), k(cid:48)) ocupam a mesma c´elula do quadrado e n˜ao h´a o que demonstrar.

Vamos supor que pelo menos um dos parˆametros α(cid:48), β(cid:48), a(cid:48) e b(cid:48) ´e diferente de zero.

Por inspe¸c˜ao, se tomamos

(cid:40) l1 − l2 ≡ b(cid:48)

(mod δ)

t1 − t2 ≡ δ − β(cid:48)

(mod δ)

o sistema (33)-(34) ´e satisfeito uma vez que β(cid:48)(b(cid:48)) + b(cid:48)(δ − β(cid:48)) ≡ 0 (mod δ)

O mesmo acontece se temos

(cid:40) l1 − l2 ≡ δ − b(cid:48)
t1 − t2 ≡ β(cid:48)

(mod δ)

(mod δ)

ou

(cid:40) l1 − l2 ≡ δ − a(cid:48)
t1 − t2 ≡ α(cid:48)

(mod δ)

(mod δ)

Figura 18 - Elementos e suas coordenadas, da matriz M (1, 1), do Exemplo 6.

47

Fonte: O autor, 2014.

ou

(cid:40) l1 − l2 ≡ a(cid:48)

(mod δ)

t1 − t2 ≡ δ − α(cid:48)

(mod δ)

Como a(cid:48), b(cid:48), α(cid:48), β(cid:48) < δ, e pelo menos um deles ´e n˜ao nulo, em pelo menos um dos quatro
sistemas acima, haver´a uma escolha l1 (cid:54)= l2 ou t1 (cid:54)= t2. Portanto, podemos sempre exibir
x1 (cid:54)= x2 dados por (17) que sejam solu¸c˜oes de (5)–(6), isto ´e, que ocupem a mesma c´elula
(A, B) do quadrado.

Os argumentos acima estabelecem as condi¸c˜oes necess´arias para o preenchimento

do quadrado pelo m´etodo do passo uniforme:

Teorema 10 (Condi¸c˜ao necess´aria para o preenchimento). Dados os parˆametros α, β, a e
b (n´umeros inteiros) a condi¸c˜ao necess´aria para que o m´etodo do passo uniforme preencha

o quadrado de ordem n ´e que o determinante

seja primo com n.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

Exemplo 6. Considere n = 9, α = 3, β = 6, a = 1, b = 3. O determinante αb − βa = 3;
δ = 3. Teremos 9 matrizes 3 × 3. A Figura 18 exibe a matriz M (1, 1). Observamos,
que neste caso existem elementos de uma mesma linha que ocupam a mesma c´elula do
quadrado. Por exemplo, na linha t = 0, os elementos 11, 14 e 17 v˜ao ocupar a mesma
c´elula (5, 1) do quadrado.

Exemplo 7. Seja um quadrado de ordem n = 15, constru´ıdo pelo m´etodo do passo
uniforme, com os seguintes parˆametros: α = 3, β = 1, a = 1 e b = 2. Quais n´umeros
ocupam a mesma c´elula que 138?

Como δ = mdc (αb − βa, n) = (5, 15) = 5 teremos
uma com δ2 = 25 elementos. Para escrever 138 como em (17):

(cid:17)2

(cid:16)n
δ

= 9 matrizes M (w(cid:48), k(cid:48)), cada

138 = 1 +

(cid:18)

w(cid:48) + l ·

(cid:19)

15
5

+

(cid:18)

k(cid:48) + t ·

(cid:19)

15
5

15.

Figura 19 - N´umeros de M (2, 0) que ocupam a mesma c´elula que 138.

48

Fonte: O autor, 2014.

Segue, do teorema da divis˜ao euclidiana que

(w(cid:48) + 3 · l) = 2 e

(k(cid:48) + 3 · t) = 9.

Portanto, w(cid:48) = 2, k(cid:48) = 0, l = 0 e t = 3. Isso signiﬁca que 138 est´a na linha t = 3 (4a
linha) e na coluna l = 0 (1a coluna) da matriz M (2, 0) (Figura 19).

Ainda que tenhamos mdc(α, n) (cid:54)= 1, pelo fato dos demais parˆametros β, a e b serem
primos com n e ainda mdc(α, a, n) = 1, com um racioc´ınio an´alogo ao da Subse¸c˜ao 4.3.6,
todos os outros n´umeros que compartilham a mesma c´elula do quadrado com 138, podem
ser determinados. Vamos tomar (30),

3 (l1 − l2) + (t1 − t2) ≡ 0

(mod 5)

Como mdc(α, a, n) = mdc(3, 1, 5) = 1 | 0 ⇒ ent˜ao pelos Teoremas 5 e 6 a equa¸c˜ao acima
ter´a 5 solu¸c˜oes (l1 − l2, t1 − t2) distintas. Por (32) segue:

l1 − l2 ≡ k

(mod 5)

e

t1 − t2 ≡ 2k

(mod 5)

Sendo k = 0, 1, 2, . . . , δ − 1 = 0, 1, 2, . . . , 4.

k = 0

k = 1

k = 2

k = 3

k = 4

l1 − l2 ≡ 0
t1 − t2 ≡ 0
l1 − l2 ≡ 1
t1 − t2 ≡ 2
l1 − l2 ≡ 2
t1 − t2 ≡ 4
l1 − l2 ≡ 3
t1 − t2 ≡ 1
l1 − l2 ≡ 4
t1 − t2 ≡ 3

(mod 5)

(mod 5)

(mod 5)

(mod 5)

(mod 5)

(mod 5)

(mod 5)

(mod 5)

(mod 5)

(mod 5)

Para 138, temos l = 0 e t = 3. Fazendo (l2, t2) = (0, 3), os elementos que compar-

tilham a mesma c´elula do quadrado com 138, tˆem localiza¸c˜oes em M (2, 0) dadas por

(l, t) ≡ (0, 3) + (l1, t1)

(mod 5),

tais que

(l1, t1) ∈ {(0, 0), (1, 2), (2, 4), (3, 1), (4, 3)}

49

Assim, podemos determinar os n´umeros

xtl = 1 + w(cid:48) + k(cid:48)n + l ·

n
δ

+ t ·

n2
δ

= 1 + 2 + 0 · 15 + l ·

15
5

+ t ·

152
5

que v˜ao ocupar a mesma c´elula do quadrado que 138:

x30 = 138,

x01 = 6,

x22 = 99,

x43 = 192,

x14 = 60.

Por (22) e (23), as coordenadas (A, B) de 138 s˜ao

(p + 6 + 0 + 0 · 9 + 3 · 3, q + 2 + 0 + 0 · 3 + 3 · 6) ≡ (p, q + 5)

(mod 15)

Assim, 6, 60, 99, 138 e 192 compartilham a mesma c´elula do quadrado de coordenadas
(p, q + 5). A Figura 20a, exibe a matriz M (2, 0) completa. Na Figura 20b temos todas as
respectivas coordenadas.

Figura 20 - Matriz(2, 0), Exemplo 7.

(a)

(b)

Legenda: (a) – N´umeros; (b) – Respectivas coordenadas (A, B).
Fonte: O autor, 2014.

50

Na p´agina 51, a Figura 21a, mostra como ﬁcar´a o quadrado ap´os os trˆes primeiros
ciclos. A ﬁgura 21b, mostra que do 4o. ao 7o. ciclos, os n´umeros ser˜ao alocados nas mesmas
c´elulas j´a preenchidas anteriormente. As ﬁguras 21c, 21d e 21e mostram, que nos ciclos
restantes, suceder´a o mesmo e, assim, o quadrado n˜ao ser´a preenchido. De fato, ap´os
todos os 225 n´umeros terem sido alocados pelo m´etodo do passo uniforme o quadrado
ﬁcar´a como mostra a ´ultima ﬁgura 21e, com c´eluas vazias. T´ınhamos visto que em cada
M (w(cid:48), k(cid:48)), os δ2 n´umeros x v˜ao ocupar apenas δ c´elulas. Esse percentual que se mant´em

para o quadrado, corresponde a
apresentados at´e aqui, estabelecem o seguinte teorema.

=

1
δ

1
5

= 0, 2, ou, 20% de preenchimento. Os resultados

Teorema 11 (Condi¸c˜ao necess´aria para o preenchimento). Dados os parˆametros α, β, a e
b (n´umeros inteiros) a condi¸c˜ao necess´aria para que o m´etodo do passo uniforme preencha

o quadrado de ordem n ´e que o determinante

seja primo com n.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

Ao suprimir a hip´otese de primalidade com n sobre os parˆametros α, β, a e b, os

Teoremas 7 e 11 generalizam o resultado apresentado por Lehmer:

Teorema 12 (LEHMER, 1929, p. 530). Dados10 α, β, a, b, todos primos com n, a condi¸c˜ao
necess´aria e suﬁciente para que o m´etodo do passo uniforme preencha o quadrado ´e que o

determinante

seja primo com n.

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

10 tradu¸c˜ao livre de: Given α, β, a, b, all prime to n, the necessary and suﬃcient condition that the

uniform step process shall ﬁll the square is that the determinant

shall be prime to n.

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:12)
α a
(cid:12)
(cid:12)
β b
(cid:12)

Figura 21 - Ciclos do quadrado do Exemplo 7.

51

(a)

(b)

(c)

(d)

(e)

Legenda: (a) 1o. ao 3o. ciclos: de 1 at´e 45; (b) 4o. ao 6o. ciclos: de 46
at´e 90; (c) 7o. ao 9o. ciclos: de 91 at´e 135; (d) 10o. ao 12o.
ciclos: de 136 at´e 180; (e) 13o. ao 15o. ciclos: de 181 at´e
225.

Fonte: O autor, 2014.

5 M ´AGICO NAS COLUNAS OU LINHAS

52

Teorema 13 (LEHMER, 1929, p. 531). Se os coeﬁcientes α, a e o determinante αb − βa
forem primos com n ent˜ao o quadrado ´e m´agico nas colunas.

Demonstra¸c˜ao. Como o mdc(αb − βb, n) = 1, pelo Teorema 7, p´agina 27, o quadrado ser´a
preenchido. Vamos tomar dois n´umeros distintos x1 e x2 quaisquer de uma coluna do
quadrado. Sendo assim, a congruˆencia A1 ≡ A2 deve ser verdadeira. Logo,

p + w1α + k1a ≡ p + w2α + k2a (mod n)

w1α + k1a ≡ w2α + k2a (mod n)

Se k1 = k2, ent˜ao w1α ≡ w2α (mod n). Como α e n s˜ao primos entre si, ent˜ao
w1 ≡ w2 (mod n). Como 0 ≤ w ≤ n − 1, ent˜ao w1 = w2. Isto ´e, se dois n´umeros distintos
x1 e x2 pertencem a uma mesma coluna do quadrado e w1 (cid:54)= w2, ent˜ao k1 (cid:54)= k2.

Se w1 = w2, ent˜ao k1α ≡ k2α (mod n). Como α e n s˜ao primos entre si, ent˜ao
k1 ≡ k2 (mod n). Como 0 ≤ k ≤ n − 1, ent˜ao k1 = k2. Isto ´e, se dois n´umeros distintos
x1 e x2 pertencem a uma mesma coluna do quadrado e k1 (cid:54)= k2, ent˜ao w1 (cid:54)= w2. Vimos
que

k1 (cid:54)= k2 ⇔ w1 (cid:54)= w2

(35)

Sejam x1 (cid:54)= x2, em uma mesma coluna, segue que (1 + w1 + k1n) − (1 + w2 + k2n) =
(w1 − w2) + (k1 − k2)n (cid:54)= 0. Da´ı, sendo n (cid:54)= 0, ter´ıamos trˆes possibilidades: Ou w1 (cid:54)= w2
e k1 = k2; ou w1 = w2 e k1 (cid:54)= k2; ou w1 (cid:54)= w2 e k1 (cid:54)= k2.

Mas, levando em conta o resultado (35) apenas a ´ultima rela¸c˜ao vai se veriﬁcar
sob as hip´oteses do teorema. Portanto, se dois n´umeros distintos x1 e x2, pertencem a
uma mesma coluna, de um quadrado preenchido pelo m´etodo do passo uniforme, com
as condi¸c˜oes dadas, ent˜ao w1 (cid:54)= w2 e k1 (cid:54)= k2. Isso signiﬁca que os w(cid:48)s s˜ao distintos, os
k(cid:48)s tamb´em s˜ao distintos e portanto, cada um vai assumir todos os valores do conjunto
{0, 1, 2, . . . , n − 1}. Sendo, assim, se somarmos os elementos de uma coluna, temos:

n
(cid:88)

i=1

xi =

n
(cid:88)

i=1

(1 + wi + kin) =

n
(cid:88)

1 +

n
(cid:88)

wi +

= n +

0 + n − 1
2

· n +

i=1

i=1

0 + n − 1
2

· n2

n
(cid:88)

i=1

kin

=

2n + n2 − n + n3 − n2
2

=

n (n2 + 1)
2

,

que ´e igual `a soma m´agica (veja (2), na p´agina 16). Logo, o quadrado ´e m´agico nas

53

colunas.

Essa propriedade, v´alida para uma coluna gen´erica, que acabamos de demonstrar
´e, obviamente, verdadeira tamb´em para uma linha gen´erica. A demonstra¸c˜ao ´e inteira-
mente an´aloga.

Teorema 14 (LEHMER, 1929, p. 532). Se os coeﬁcientes β, b e o determinante αb − βa
forem primos com n ent˜ao o quadrado ´e m´agico nas linhas.

5.1 A condi¸c˜ao ´e necess´aria?

Vamos considerar em todos os casos a seguir que o determinante αb−βa seja primo

com n, assim garantimos o preenchimento.

5.1.1 Calculando a soma das colunas

Um n´umero x = 1 + w + kn cujas coordenadas s˜ao (A, B) est´a na j-´esima coluna

se, e somente se, w e k forem solu¸c˜oes de11

αw + ak ≡ j − p

(mod n)

(36)

Se mdc(α, a, n) = 1, ent˜ao pelos Teoremas 5 e 6 a equa¸c˜ao acima sempre ter´a n solu¸c˜oes
(w, k) distintas.

Observa¸c˜ao 3. Observe que se mdc(αb − βa, n) = 1, ent˜ao mdc(α, a, n) = 1.

Lema 1. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(α, n) = δα.
Para cada coluna j do quadrado, existe 0 ≤ kj ≤ δα − 1 tal que para qualquer um dos
n elementos x = 1 + w + k · n alocados na j-´esima coluna, temos k = kj + l · δα, sendo

(cid:26)

(cid:27)

n
δα

0 ≤ l ≤

n
δα

−1. Al´em disso, para cada l ∈

0, 1, . . . ,

− 1

, h´a exatamente δα repeti¸c˜oes

de k = kj + l · δα dentre as solu¸c˜oes de interesse (w, k) de (36).

Demonstra¸c˜ao. Como mdc(αb − βa, n) = 1, o quadrado ´e preenchido e a j-´esima coluna
do quadrado possui exatamente n valores da forma

xi = 1 + wi + nki,

0 ≤ wi, ki ≤ n − 1.

11 A ≡ j (mod n) ⇒ p + αw + ak ≡ j (mod n) ⇒ αw + ak ≡ j − p (mod n)

54

Vamos tomar kj como o menor valor de ki dentre tais pares (wi, ki). Certamente, existe
wj ∈ {0, 1, 2, . . . , n − 1} tal que (wj, kj) satisfaz (36). Isto ´e

αwj + akj ≡ j − p

(mod n).

Observe que para cada l tal que 0 ≤ l ≤

n
δα

− 1, pelo Teorema 5, a ECL

αwi + a (kj + lδα) ≡ j − p

(mod n).

(37)

admite solu¸c˜ao. Pelo Teorema 6, h´a δα valores de wi.

Observe ainda que 0 ≤ kj ≤ δα − 1. De fato, se kj ≥ δα, tomando l = n
− 1
δα
em (37), vemos que existe ˜w tal que x = 1 + ˜w + (kj − δα)n pertence `a j-´esima coluna
contrariando o fato de kj ser m´ınimo.
Consequentemente, dentre os n elementos da diagonal, os ki’s assumem
tos e cada um deles se repete δα vezes.

valores distin-

n
δα

Corol´ario 2. Se em αw + ak ≡ j − p (mod n), mdc(α, n) = 1, ent˜ao os k’s formam um
sistema completo de res´ıduos.

Observa¸c˜ao 4. Observe que kj depende de j e ´e o menor valor de k ∈ {0, 1, . . . , n − 1}
que torna j − p − akj divis´ıvel por δα. Conforme j varia de 1 a n, como mdc(a, δα) = 1,
kj ir´a assumir (em alguma ordem) todos os valores de 0 a δα − 1.

Um resultado an´alogo ´e v´alido se mdc(a, n) = δa.

Lema 2. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(a, n) = δa.
Para cada coluna j do quadrado, existe 0 ≤ wj ≤ δa − 1 tal que para qualquer um dos n
elementos x = 1 + w + k · n alocados na j-´esima coluna, temos w = wj + t · δa, sendo

(cid:26)

(cid:27)

n
δa

0 ≤ t ≤

n
δa

−1. Al´em disso, para cada t ∈

0, 1, . . . ,

− 1

, h´a exatamente δa repeti¸c˜oes

de w = wj + t · δa dentre as solu¸c˜oes de interesse (w, k) de (36).

Corol´ario 3. Se em αw + ak ≡ j − p (mod n), mdc(a, n) = 1 ent˜ao os w’s formam um
sistema completo de res´ıduos.

Observa¸c˜ao 5. Observe que wj depende de j e ´e o menor valor de w ∈ {0, 1, . . . , n − 1}
que torna j − p − αwj divis´ıvel por δa. Conforme j varia de 1 a n, como mdc(α, δa) = 1,
wj ir´a assumir (em alguma ordem) todos os valores de 0 a δa − 1.

Sejam mdc(a, n) = δa e mdc(α, n) = δα e xi, i = 1, . . . , n os elementos da j-´esima
coluna do quadrado. Inicialmente, vamos calcular a soma de todos os k’s associados a
n
esses elementos. Uma vez que mdc(α, n) = δα, pelo Lema 1, os k’s poder˜ao assumir
δα
valores no conjunto

{0, 1, 2, . . . , n − 1}.

Esses valores dependem de j − p e pertencem a um dos seguintes conjuntos disjuntos

55

(cid:26)

(cid:26)

(cid:26)

(cid:26)

0, δα, 2δα, . . . ,

(cid:18) n
δα

− 1

(cid:19)

(cid:27)

1, 1 + δα, 1 + 2δα, . . . , 1 +

2, 2 + δα, 2 + 2δα, . . . , 2 +

,

δα
(cid:18) n
δα
(cid:18) n
δα

(cid:19)

(cid:27)

− 1

δα

(cid:19)

(cid:27)

− 1

δα

,

,

...

δα − 1, 2δα − 1, 3δα − 1, . . . ,

(cid:27)

· δα − 1

.

n
δα

O conjunto que inicia com 0 ter´a como soma dos seus elementos:

0 + δα + 2δα + · · · +

(cid:18) n
δα

(cid:19)

− 1

δα =

n
2

(cid:18) n
δα

(cid:19)

− 1

Indutivamente, ´e poss´ıvel mostrar que para cada inteiro kj tal que 0 ≤ kj ≤ δα − 1, o
conjunto que inicia com kj ter´a soma:

n
2

(cid:18) n
δα

(cid:19)

− 1

+

kjn
δα

Vimos no Lema 1 que cada um desses conjuntos se repete δα vezes, logo a soma dos ki’s,
de uma coluna, ser´a

n
(cid:88)

i=1

ki =

n
2

(n − δα) + kjn

Analogamente, ´e poss´ıvel mostrar que se xi, i = 1, . . . , n s˜ao os elementos da j-
valores no conjunto

´esima coluna, os w’s associados a esses elementos poder˜ao assumir

n
δa

{0, 1, 2, . . . , n − 1}.

Esses valores dependem de j − p e pertencem a um dos seguintes conjuntos disjuntos

56

(cid:26)

(cid:26)

(cid:26)

(cid:26)

0, δa, 2δa, . . . ,

(cid:18) n
δa

(cid:19)

(cid:27)

− 1

δa

,

1, 1 + δa, 1 + 2δa, . . . , 1 +

2, 2 + δa, 2 + 2δa, . . . , 2 +

...

(cid:19)

(cid:27)

− 1

δa

(cid:19)

(cid:27)

− 1

δa

,

,

(cid:18) n
δa
(cid:18) n
δa

δa − 1, 2δa − 1, 3δa − 1, . . . ,

(cid:27)

· δa − 1

.

n
δa

O conjunto que inicia com 0 ter´a como soma de seus elementos:

0 + δa + 2δa + · · · +

(cid:19)

− 1

δa =

(cid:18) n
δa

n
2

(cid:18) n
δa

(cid:19)

− 1

Indutivamente, ´e poss´ıvel mostrar que para cada inteiro wj tal que 0 ≤ wj ≤ δa − 1, o
conjunto que inicia com wj ter´a soma:

n
2

(cid:18) n
δa

(cid:19)

− 1

+

wjn
δa

Vimos no Lema 1 que cada um desses conjuntos se repete δα vezes, logo a soma dos wi’s,
de uma coluna, ser´a

n
(cid:88)

i=1

wi =

n
2

(n − δa) + wjn.

A soma dos elementos xi da j-´esima coluna ´e

Cj =

=

n
(cid:88)

i=1
n
(cid:88)

i=1

= n +

n
(cid:88)

(1 + wi + ki · n)

xi =

i=1
n
(cid:88)

wi +

n
(cid:88)

ki · n

i=1

i=1

(cid:105)
· (n − δa) + wjn

+

(cid:104) n
2

· (n − δα) + kjn

(cid:105)

· n

1 +

(cid:104) n
2

= n + n · wj +

=

n
2

+

n3
2

+

n
2

n2
2

− δa ·

n
2

+ n2 · kj +

n3
2

− δα ·

n2
2

+ n · wj + n2 · kj +

n2
2

− δa ·

n
2

− δα ·

n2
2

Isto ´e

Cj =

(cid:19)

(cid:18) 1 + n2
2

(cid:18)

n +

wj −

δa − 1
2

(cid:19)

(cid:18)

n +

kj −

(cid:19)

n2

δα − 1
2

57

(38)

Os resultados estabelecidos para as colunas se estendem naturalmente para as

linhas.

5.1.2 Calculando a soma das linhas

Um n´umero x = 1 + w + kn cujas coordenadas s˜ao (A, B) est´a na m-´esima linha

se, e somente se, w e k forem solu¸c˜oes de

βw + bk ≡ m − q

(mod n)

(39)

Se mdc(β, b, n) = 1, ent˜ao pelos Teoremas 5 e 6 a equa¸c˜ao acima sempre ter´a n solu¸c˜oes
(w, k) distintas.

Observa¸c˜ao 6. Observe que se mdc(αb − βa, n) = 1, ent˜ao mdc(β, b, n) = 1.

Lema 3. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(β, n) = δβ.
Para cada linha m do quadrado, existe 0 ≤ km ≤ δβ − 1 tal que para qualquer um dos
n elementos x = 1 + w + k · n alocados m-´esima linha, temos k = km + l · δβ, sendo

(cid:26)

(cid:27)

n
δβ

0 ≤ l ≤

n
δβ

−1. Al´em disso, para cada l ∈

0, 1, . . . ,

− 1

, h´a exatamente δβ repeti¸c˜oes

de k = km + l · δβ dentre as solu¸c˜oes de interesse (w, k) de (39).

Corol´ario 4. Se em βw + bk ≡ m − q (mod n), mdc(β, n) = 1 ent˜ao os k’s formam um
sistema completo de res´ıduos.

Observa¸c˜ao 7. Observe que km depende de m e ´e o menor valor de k ∈ {0, 1, . . . , n − 1}
que torna m − q − bkm divis´ıvel por δβ. Conforme m varia de 1 a n, como mdc(b, δβ) = 1,
km ir´a assumir (em alguma ordem) todos os valores de 0 a δβ − 1.

Um resultado an´alogo ´e v´alido se mdc(b, n) = δb.

Lema 4. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(b, n) = δb.
Para cada linha m do quadrado, existe 0 ≤ wm ≤ δb − 1 tal que para qualquer um dos
n elementos x = 1 + w + k · n alocados m-´esima linha, temos w = wm + t · δb, sendo

0 ≤ t ≤

− 1. Al´em disso, para cada t ∈

0, 1, . . . ,

− 1

, h´a exatamente δb repeti¸c˜oes

(cid:26)

(cid:27)

n
δb

n
δb

de w = wm + t · δb dentre as solu¸c˜oes de interesse (w, k) de (39).

58

Corol´ario 5. Se em βw + bk ≡ m − q (mod n), mdc(b, n) = 1 ent˜ao os w’s formam um
sistema completo de res´ıduos.

Observa¸c˜ao 8. Observe que wm depende de m e ´e o menor valor de w ∈ {0, 1, . . . , n − 1}
que torna m − q − βwm divis´ıvel por δb. Conforme m varia de 1 a n, como mdc(α, δb) = 1,
wm ir´a assumir (em alguma ordem) todos os valores de 0 a δb − 1.

Sejam mdc(b, n) = δb e mdc(β, n) = δβ e xi, i = 1, . . . , n os elementos da m-´esima
linha do quadrado. Inicialmente, vamos calcular a soma de todos os k’s associados a esses
valores
elementos. Uma vez que mdc(β, n) = δβ, pelo Lema 3, os k’s poder˜ao assumir

n
δβ

no conjunto

{0, 1, 2, . . . , n − 1}.

Esses valores dependem de m − q e pertencem a um dos seguintes conjuntos disjuntos

(cid:26)

(cid:26)

(cid:26)

(cid:26)

0, δβ, 2δβ, . . . ,

(cid:18) n
δβ

− 1

(cid:19)

(cid:27)

1, 1 + δβ, 1 + 2δβ, . . . , 1 +

2, 2 + δβ, 2 + 2δβ, . . . , 2 +

,

δβ
(cid:18) n
δβ
(cid:18) n
δβ

(cid:19)

(cid:27)

− 1

δβ

(cid:19)

(cid:27)

− 1

δβ

,

,

...

δβ − 1, 2δβ − 1, 3δβ − 1, . . . ,

(cid:27)

· δβ − 1

.

n
δβ

e sua soma ser´a dada por

(cid:88)

k =

n
2

(n − δβ) + kmn,

0 ≤ km ≤ δβ − 1.

(40)

Analogamente, ´e poss´ıvel mostrar que se xi, i = 1, . . . , n s˜ao os elementos da m-´esima
linha, os w’s associados a esses elementos poder˜ao assumir

valores no conjunto

n
δb

{0, 1, 2, . . . , n − 1}.

Esses valores dependem de m − q e pertencem a um dos seguintes conjuntos disjuntos

59

(cid:26)

(cid:26)

(cid:26)

(cid:26)

0, δb, 2δb, . . . ,

(cid:18) n
δb

(cid:19)

(cid:27)

− 1

δb

,

1, 1 + δb, 1 + 2δb, . . . , 1 +

2, 2 + δb, 2 + 2δb, . . . , 2 +

...

(cid:19)

(cid:27)

− 1

δb

(cid:19)

(cid:27)

− 1

δb

,

,

(cid:18) n
δb
(cid:18) n
δb

δb − 1, 2δb − 1, 3δb − 1, . . . ,

(cid:27)

· δb − 1

.

n
δb

e sua soma ´e dada por

(cid:88)

w =

n
2

(n − δb) + wmn,

0 ≤ wm ≤ δb − 1.

(41)

Por (40) e (41), podemos deduzir que a soma dos elementos xi da m-´esima linha ´e

dada por

Cm =

(cid:19)

(cid:18) 1 + n2
2

(cid:18)

n +

wm −

δb − 1
2

(cid:19)

(cid:18)

n +

km −

(cid:19)

n2.

δβ − 1
2

5.1.3 Condi¸c˜ao necess´aria para que colunas e linhas sejam m´agicas

Teorema 15. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Suponha o
quadrado gerado com tais parˆametros pelo m´etodo do passo uniforme seja m´agico nas
colunas. Ent˜ao, mdc(a, n) = mdc(α, n) = 1.

Demonstra¸c˜ao. Sejam mdc(a, n) = δa e mdc(α, n) = δα. Como as colunas s˜ao m´agicas,
para todo j ∈ {1, . . . , n}, por (38), temos

wj −

δa − 1
2

= n

(cid:18) δα − 1
2

(cid:19)

− kj

.

O lado direito ´e um m´ultiplo de n e o esquerdo ´e um inteiro entre −n e n. Consequente-
mente, para todo j ∈ {1, . . . , n},

wj −

δa − 1
2

=

δα − 1
2

− kj = 0.

Pelas Observa¸c˜oes 4 e 5, se δα ou δa for diferente de 1, existe j tal que

wj −

δa − 1
2

(cid:54)= 0

ou

δα − 1
2

− kj (cid:54)= 0.

60

Portanto, se todas as colunas s˜ao m´agicas temos, δa = δα = 1.

Analogamente,

Teorema 16. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Suponha o
quadrado gerado com tais parˆametros pelo m´etodo do passo uniforme seja m´agico nas
linhas. Ent˜ao, mdc(b, n) = mdc(β, n) = 1.

A este ponto, podemos aﬁrmar que o m´etodo do passo uniforme n˜ao gera quadrados
m´agicos nas linhas e nas colunas, ao mesmo tempo, quando n for par. De acordo como os
Teoremas 15 e 16, para que todas as linhas e todas as colunas sejam m´agicas ´e necess´ario
que os parˆametros α, β, a e b sejam, um a um, primos com n. Ora, se n for par, ent˜ao
todos tˆem de ser ´ımpar. Mas se todos forem ´ımpar, o determinante αb − βa ´e par,
consequentemente tendo um divisor comum diferente de 1 com n e portanto, de acordo
com o Teorema 10, n˜ao preenchendo o quadrado.

6 DIAGONAIS PRINCIPAIS POSITIVA E NEGATIVA M ´AGICAS

61

Sejam A e B as coordenadas de uma c´elula do quadrado. Vamos denominar di-
agonal principal positiva a diagonal regida por A + B ≡ 1 (mod n) e diagonal principal
negativa a diagonal regida por A − B ≡ 0 (mod n). Note que a reta r que passa pelo
canto inferior direito do quadrado e por seu canto superior esquerdo intercepta todos os
pontos de coordenadas (A, B) tais que A + B ≡ 1. Al´em disso, vemos em cada linha e em
cada coluna do quadrado h´a apenas uma c´elula que satisfaz A + B ≡ 1. O termo diagonal
pode ser generalizado da seguinte maneira: considere a reta paralela a r que passa pela
c´elula da n-´esima linha e que est´a na p-´esima coluna contada a partir da direita e a reta
paralela a r que passa pela c´elula da primeira coluna e p-´esima linha. Ao todo, essas
duas retas interceptam n c´elulas do quadrado, e apenas uma de linha e de cada coluna.
Tais diagonais s˜ao chamadas de diagonais positivas do quadrado. (KRAITCHIK, 1942,
p. 143) As diagonais positivas do quadrado preenchidas pelo m´etodo do passo uniforme
As diagonais negativas podem
s˜ao determinadas pela equa¸c˜ao A + B ≡ j, Figura 22.

Figura 22 - Diagonais positivas.

Fonte: O autor, 2014.

Figura 23 - Diagonais negativas.

62

Fonte: O autor, 2014.

ser deﬁnidas de modo an´alogo. As diagonais negativas por A − B ≡ j, Figura 23, com
j = 0, 1, 2, . . . , n − 1. Antes de prosseguir, devemos enfatizar que em todos os casos
desta se¸c˜ao estaremos considerando que o determinante αb − βa seja primo com n, o que
ir´a garantir o preenchimento do quadrado, e tamb´em cada parˆametro α, β, a e b primo
com n o que garantir´a linhas e colunas m´agicas. Essas duas condi¸c˜oes juntas, como j´a
visto anteriormente12, descartam todos os quadrados de ordem par. Portanto, s´o ser˜ao
considerados, os quadrados de ordem ´ımpar.

6.1 Condi¸c˜oes para que a diagonal principal negativa seja m´agica

Nosso interesse agora ´e obter condi¸c˜oes para que a diagonal principal negativa seja
m´agica. Um n´umero x = 1 + w + kn est´a na diagonal principal negativa se, e somente se,
w e k forem solu¸c˜oes de A − B ≡ 0.

A ≡ B (mod n) ⇒ p + wα + ka ≡ q + wβ + kb

(mod n)

12 A condi¸c˜ao para o preenchimento ´e o determinante αb − βa ser primo com n. Se n for par ent˜ao o
determinante αb − βa dever´a ser ´ımpar, o que implica em pelo menos um dos parˆametros α ou β ou a
ou b ser par o que implica por sua vez em algumas colunas ou linhas n˜ao m´agicas.

Segue,

(α − β)w + (a − b)k ≡ q − p

(mod n)

63

(42)

Se mdc(α − β, a − b, n) = 1 ent˜ao pelos Teoremas 5 e 6 a equa¸c˜ao acima sempre ter´a n
solu¸c˜oes (w, k) distintas.

Observa¸c˜ao 9. Se o m´etodo preenche o quadrado, ent˜ao n n´umeros s˜ao dispostos na dia-
gonal principal negativa. Isto ´e, (42) tem n solu¸c˜oes pertencentes ao conjunto {1, 2, . . . , n2}.

Observa¸c˜ao 10. Observe que se mdc(αb − βa, n) = 1, ent˜ao mdc(α − β, a − b, n) = 1.

De fato, vamos supor que mdc(α − β, a − b, n) = δ (cid:54)= 1. Ent˜ao, δ | α − β, δ | a − b

e δ | n.

Agora

δ | α − β ⇒ δ | αb − βb

δ | a − b ⇒ δ | aβ − bβ

Subtraindo uma da outra, temos:

δ | (αb − βb) − (aβ − bβ) ⇒ δ | αb − βa

Logo, como δ | n e δ | αb − βa, temos mdc(αb − βa, n) (cid:54)= 1.

(cid:3)

Lema 5. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(α − β, n) =
δ−
k . Existe 0 ≤ k0 ≤ δ−
k − 1 tal que para qualquer uma das n solu¸c˜oes (w, k), com
0 ≤ w, k ≤ n − 1 da equa¸c˜ao (α − β)w + (a − b)k ≡ q − p (mod n), temos k = k0 + l · δ−
k ,
, h´a exatamente δ−
k

− 1. Al´em disso, para cada l ∈

sendo 0 ≤ l ≤

0, 1, . . . ,

− 1

(cid:27)

(cid:26)

n
δ−
k

n
δ−
k

repeti¸c˜oes de k = k0 + l · δ−

k dentre essas n solu¸c˜oes (w, k) de (42).

Demonstra¸c˜ao. Como mdc(αb − βa, n) = 1, o quadrado ´e preenchido e a diagonal do
quadrado possui exatamente n valores da forma

xi = 1 + wi + nki,

0 ≤ wi, ki ≤ n − 1.

Consequentemente, h´a exatamente n pares (wi, ki) (com 0 ≤ wi, ki ≤ n−1) que satisfazem
(α − β)w + (a − b)k ≡ q − p (mod n). Vamos tomar k0 como o menor valor de ki dentre
tais pares (wi, ki). Certamente, existe w0 ∈ {0, 1, 2, . . . , n − 1} tal que (w0, k0) satisfaz
(α − β)w + (a − b)k ≡ q − p (mod n). Isto ´e

(α − β)w0 + (a − b)k0 ≡ q − p

(mod n).

Observe que para cada l tal que 0 ≤ l ≤

n
δ−
k

− 1, pelo Teorema 5, a ECL

(α − β)wi + (a − b) (cid:0)k0 + lδ−

k

(cid:1) ≡ q − p

(mod n).

64

(43)

admite solu¸c˜ao. Pelo Teorema 6, h´a δ−
Observe ainda que 0 ≤ k0 ≤ δ−
(43), vemos que existe ˜w tal que x = 1 + ˜w + (k0 − δ−
contrariando o fato de k0 ser m´ınimo.
Consequentemente, dentre os n elementos da diagonal, os k’s assumem

k valores de wi.
k − 1. De fato, se k0 ≥ δ−

k , tomando l = n
δ−
k

− 1 em
k )n pertence `a diagonal negativa

n
δ−
k

valores distintos

e cada um deles se repete δ−

k vezes.

Corol´ario 6. Se em (α − β)w + (a − b)k ≡ q − p (mod n), mdc(α − β, n) = 1, ent˜ao os
k’s formam um sistema completo de res´ıduos m´odulo n.

Um resultado an´alogo ´e v´alido se mdc(a − b, n) = δ−
w .

Lema 6. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(a − b, n) =
w . Existe 0 ≤ w0 ≤ δ−
δ−
w − 1 tal que para qualquer uma das n solu¸c˜oes (w, k), com
0 ≤ w, k ≤ n − 1 da equa¸c˜ao (42), temos w = w0 + t · δ−
− 1. Al´em

w , sendo 0 ≤ t ≤

n
δ−
w

− 1

, h´a exatamente δ−

w repeti¸c˜oes de w = w0 + t · δ−
w

disso, para cada t ∈

0, 1, . . . ,

(cid:26)

(cid:27)

n
δ−
w

dentre essas n solu¸c˜oes (w, k) de (42).

Corol´ario 7. Se em (α − β)w + (a − b)k ≡ q − p (mod n), mdc(a − b, n) = 1, ent˜ao os
w’s formam um sistema completo de res´ıduos m´odulo n.

6.1.1 Calculando a soma da diagonal

Sejam mdc(a − b, n) = δ−

w e mdc(α − β, n) = δ−
k e xi, i = 1, . . . , n os elementos da
diagonal principal negativa. Inicialmente, vamos calcular a soma de todos os k’s associados
a esses elementos. Uma vez que mdc(α − β, n) = δ−
k , pelo Lema 5, os k’s poder˜ao assumir
n
δ−
k

valores no conjunto

{0, 1, 2, . . . , n − 1}.

Esses valores dependem de q − p e pertencem a um dos seguintes conjuntos disjuntos

65

(cid:26)

(cid:26)

(cid:26)

(cid:26)

0, δ−

k , 2δ−

k , . . . ,

(cid:19)

− 1

(cid:18) n
δ−
k

1, 1 + δ−

k , 1 + 2δ−

k , . . . , 1 +

2, 2 + δ−

k , 2 + 2δ−

k , . . . , 2 +
...

(cid:27)

,

δ−
k
(cid:18) n
δ−
k
(cid:18) n
δ−
k

(cid:19)

− 1

(cid:19)

− 1

(cid:27)

(cid:27)

δ−
k

δ−
k

k − 1, 2δ−
δ−

k − 1, 3δk − 1, . . . ,

n
δ−
k

(cid:27)

· δ−

k − 1

,

,

.

O conjunto que inicia com 0 ter´a soma:

0 + δ−

k + 2δ−

k + · · · +

(cid:18) n
δ−
k

(cid:19)

− 1

δ−
k =

n
2

(cid:18) n
δ−
k

(cid:19)

− 1

Indutivamente, ´e poss´ıvel mostrar que para cada inteiro rk tal que 0 ≤ rk ≤ δ−
conjunto que inicia com rk ter´a soma:

k − 1, o

n
2

(cid:18) n
δ−
k

(cid:19)

− 1

+

rkn
δ−
k

Vimos no Lema 5 que cada um desses conjuntos se repete δ−
ser´a dada por

k vezes, logo a soma dos k’s,

(cid:88)

k =

n
2

(cid:0)n − δ−

k

(cid:1) + rkn

(44)

Veremos que p e q devem ser escolhidos de modo que os valores de k na diagonal principal
negativa sejam os do conjunto

(cid:26)

Rk =

rk, rk + δ−

k , rk + 2δ−

k , . . . , rk +

(cid:18) n
δ−
k

(cid:19)

− 1

(cid:27)

δ−
k

onde

rk =

δ−
k − 1
2

.

Analogamente, ´e poss´ıvel mostrar que se xi, i = 1, . . . , n s˜ao os elementos da dia-
valores

gonal principal negativa, os w’s associados a esses elementos poder˜ao assumir

n
δ−
w

no conjunto

{0, 1, 2, . . . , n − 1}.

Esses valores dependem de q − p e pertencem a um dos seguintes conjuntos disjuntos

66

(cid:26)

(cid:26)

(cid:26)

(cid:26)

0, δ−

w , 2δ−

w , . . . ,

(cid:19)

− 1

(cid:18) n
δ−
w

1, 1 + δ−

w , 1 + 2δ−

w , . . . , 1 +

2, 2 + δ−

w , 2 + 2δ−

w , . . . , 2 +
...

(cid:27)

,

δ−
w
(cid:18) n
δ−
w
(cid:18) n
δ−
w

(cid:19)

− 1

(cid:19)

− 1

(cid:27)

(cid:27)

,

,

δ−
w

δ−
w

w − 1, 2δ−
δ−

w − 1, 3δ−

w − 1, . . . ,

n
δ−
w

(cid:27)

· δ−

w − 1

.

e sua soma ´e dada por

(cid:88)

w =

n
2

(cid:0)n − δ−

w

(cid:1) + rwn

(45)

onde rw ´e um inteiro tal que 0 ≤ rw ≤ δ−
w − 1.
Veremos tamb´em que p e q devem ser escolhidos de modo que os valores de w na diagonal
principal negativa sejam os do conjunto

(cid:26)

Rw =

rw, rw + δ−

w , rw + 2δ−

w , . . . , rw +

(cid:18) n
δ−
w

(cid:19)

− 1

(cid:27)

δ−
w

onde

rw =

δ−
w − 1
2

.

Por (44) e (45), podemos deduzir que a soma dos elementos xi da diagonal principal
positiva ´e dada por

(cid:88)

xi =

(cid:88)

1 +

(cid:88)

w + n

(cid:88)

k

i

i

(cid:1) + rwn +

(cid:0)n − δ−

(cid:1) + rkn2

(46)

= n +

n
2

(cid:0)n − δ−

w

= n + rwn +

n
2

(cid:0)n − δ−

w

n2
2
(cid:1) + rkn2 +

k
n2
2

(cid:0)n − δ−

(cid:1)

k

6.1.2 Condi¸c˜ao necess´aria e suﬁciente

Teorema 17. Sejam xi = 1 + wi + nki, 0 ≤ wi, ki ≤ n − 1, i = 1, . . . , n, os elementos
da diagonal principal negativa. Sejam mdc(a − b, n) = δ−
k . Para
que a diagonal principal negativa seja m´agica ´e necess´ario e suﬁciente que p e q sejam

w e mdc(α − β, n) = δ−

escolhidos de modo que

rk =

δ−
k − 1
2

e

rw =

δ−
w − 1
2

sejam respectivamente o menor k e o menor w dentre todas os elementos xi da diagonal.

67

Demonstra¸c˜ao. Vamos mostrar que se

rw =

δ−
w − 1
2

e

rk =

δ−
k − 1
2

ent˜ao (cid:80) xi ser´a igual `a soma m´agica

(cid:19)

(cid:18) 1 + n2
2

n.

Por (46), temos

xi = n + rwn +

n
2

(cid:0)n − δ−

w

(cid:1) + rkn2 +

n2
2

(cid:0)n − δ−

k

(cid:1)

(cid:88)

i

Substituindo rw =

δ−
w − 1
2

e rk =

δ−
k − 1
2

, temos:

(cid:88)

i

xi = n +

= n +

(cid:19)

(cid:18) δ−

w − 1
2

n +

δ−
w
2

n −

n
2

+

n2
2

n
2

−

(cid:0)n − δ−

w

(cid:1) +

(cid:19)

(cid:18) δ−

k − 1
2

n2 +

n2
2

(cid:0)n − δ−

k

(cid:1)

δ−
w
2

n +

δ−
k
2

n2 −

n2
2

+

n3
2

−

δ−
k
2

n2

Ap´os os devidos cancelamentos, temos:

= n −

n
2

+

n3
2

=

n
2

+

n3
2

=

(cid:19)

(cid:18) 1 + n2
2

n

Pelo Lema 5, sabemos que o menor rk1 associado aos elementos da diagonal ´e tal que

rk1 =

δ−
k − 1
2

± t = rk ± t,

sendo 0 ≤ t ≤
`a soma de um sistema completo de res´ıduos m´odulo n. De fato, por (44)

− 1. Mostraremos ent˜ao a soma (cid:80) k ir´a variar de ±tn em rela¸c˜ao

δ−
k − 1
2

(cid:88)

k =

=

(cid:0)n − δ−

k

n
2
(cid:20)(cid:18) δ−

k − 1
2

(cid:104)

(cid:1) + rk1n =
(cid:19)

(rk ± t)n +
(cid:21)

n +

(n − δ−
k )

± tn =

n
2

n(n − 1)
2

± tn

(cid:105)
(n − δ−
k )

=

(cid:104)

rkn +

n
2

(n − δ−
k )

(cid:105)

± tn

n
2

68

Analogamente, se o menor rw1 associado aos elementos da diagonal ´e tal que

rw1 =

δ−
w − 1
2

± l = rw ± l,

ent˜ao a soma (cid:80) w ir´a variar de ±ln em rela¸c˜ao `a soma de um sistema completo de res´ıduos
m´odulo n. Isto ´e,

(cid:88)

w =

(cid:19)

(cid:20)(cid:18) δ−

w − 1
2

n +

n
2

(cid:21)

(n − δ−
w )

± ln =

n(n − 1)
2

± ln.

Consequentemente, a soma dos elementos da diagonal principal ser´a dada por

(cid:88)

x = n +

n(n − 1)
2

± ln + n

(cid:18) n(n − 1)
2

(cid:19)

± tn

=

(cid:19)

(cid:18) 1 + n2
2

n ± ln ± tn2.

Claramente, (cid:80) x ser´a m´agica se, se somente se, l = t = 0. Isto ´e, se e somente se o menor
k e o menor w dentre todas os elementos x da diagonal sejam respectivamente

rk =

δ−
k − 1
2

e

rw =

δ−
w − 1
2

.

Corol´ario 8. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Sejam mdc(α −
β, n) = δ−

w . Se p e q s˜ao tais que

k e mdc(a − b, n) = δ−

q − p ≡ (α − β)

(cid:19)

(cid:18)δ−

w − 1
2

+ (a − b)

(cid:19)

(cid:18) δ−

k − 1
2

(mod n)

ent˜ao a soma dos elementos da diagonal principal negativa do quadrado gerado pelo m´etodo
do passo uniforme ´e igual a n(n2+1)

.

2

6.1.3 Onde come¸car para que a DPN seja m´agica?

Vimos nas se¸c˜oes anteriores que os elementos da diagonal principal negativa (DPN)
foram caracterizados como solu¸c˜oes de (42). Al´em disso, vimos que ´e poss´ıvel associar `a
DPN ´unicos conjuntos Rw e Rk tais que se x = 1 + w + kn ´e um elemento da DPN, temos
w ∈ Rw e k ∈ Rk. Consequentemente, se h´a na DPN algum x da forma

x = 1 +

δ−
w − 1
2

+ l · δ−

w +

(cid:18) δ−

k − 1
2

(cid:19)

· n

+ t · δ−
k

com 0 ≤ l ≤ n
δ−
w

− 1, 0 ≤ t ≤ n
δ−
k

− 1, ent˜ao

69

(cid:26)

Rw =

rw, rw + δ−

w , rw + 2δ−

w , . . . , rw +

(cid:18) n
δ−
w

(cid:19)

− 1

(cid:27)

δ−
w

,

onde rw =

δ−
w − 1
2

e

Rk =

(cid:26)

rk, rk + δ−

k , rk + 2δ−

k , . . . , rk +

(cid:18) n
δ−
k

(cid:19)

− 1

(cid:27)

δ−
k

,

onde rk =

δ−
k − 1
2

Portanto, pelo Teorema 17, a DPN ´e m´agica.

Reciprocamente, se a DPN ´e m´agica, pelo Teorema 17, ela cont´em elementos x da

forma

x = 1 +

δ−
w − 1
2

+ l · δ−

w +

(cid:18) δ−

k − 1
2

(cid:19)

· n

+ t · δ−
k

com 0 ≤ l ≤ n
δ−
w

− 1, 0 ≤ t ≤ n
δ−
k

− 1.

Essas considera¸c˜oes nos permitem estabelecer a seguinte proposi¸c˜ao.

Proposi¸c˜ao 6. Sejam α, β, a, b e n n´umeros inteiros tais que α, β, a, b e αb − βa s˜ao
primos com n. A DPN do quadrado de ordem n constru´ıdo pelo m´etodo do passo uniforme
´e m´agica se e somente se as coordenadas (p, q) da c´elula inicial satisfazem

(α − β)

(cid:18) δ−

w − 1
2

(cid:19)

+ l · δ−
w

+ (a − b)

(cid:18) δ−

k − 1
2

(cid:19)

+ t · δ−
k

≡ q − p

(mod n)

(47)

para algum 0 ≤ l ≤ n
δ−
w

−1, 0 ≤ t ≤ n
δ−
k

−1 e onde δ−

w = mdc(a−b, n) e δ−

k = mdc(α−β, n).

Note que se α − β e a − b forem primos com n, a diagonal principal negativa sempre
ser´a m´agica. De fato, pelos Corol´arios 6 e 7, a soma dos elementos xi da diagonal principal
negativa, ser´a m´agica:

x1 + x2 + · · · + xn =

n
(cid:88)

1 +

n
(cid:88)

i=1

i=1

wi + n

n
(cid:88)

i=1

ki

= n + (0 + 1 + 2 + · · · + n − 1) + n(0 + 1 + 2 + · · · + n − 1)

=

(cid:19)

(cid:18) 1 + n2
2

n

Portanto, se os coeﬁcientes α − β e a − b da equa¸c˜ao linear (42) com duas vari´aveis w e

70

k, m´odulo n, que determina a diagonal principal negativa forem primos13 com n, ela ser´a
m´agica, independentemente dos valores iniciais (p, q). Esse resultado tamb´em pode ser
obtido a partir da Proposi¸c˜ao 6. Se os coeﬁcientes α − β e a − b forem primos com n, (47)
´e dada por

(α − β)l + (a − b)t ≡ q − p

(mod n)

com 0 ≤ l, t ≤ n−1. ´E f´acil ver que podemos escolher (l, t) de modo que (α−β)l +(a−b)t
gere um conjunto completo de res´ıduos. Isso resulta em p e q quaisquer.

Exemplo 8. O quadrado preenchido pelo m´etodo do passo uniforme com n = 7, α = 4,
β = 2, a = 3 e b = 6, ser´a m´agico nas linhas, nas colunas e na diagonal principal negativa,
uma vez que os coeﬁcientes α−β = 2 e a−b = −3 s˜ao ambos primos com 7. A condi¸c˜ao de
primalidade de α−β e a−b com n garante que todas as diagonais negativas sejam m´agicas.

Segue da Proposi¸c˜ao 6 que todos os poss´ıveis valores de q − p que determinam uma

DPN m´agica pertencem ao conjunto

(cid:26)

m ∈ Z, m ≡ mtl

(mod n), 0 ≤ l ≤

n
δ−
w

− 1, 0 ≤ t ≤

(cid:27)

− 1

n
δ−
k

O =

onde

mtl = (α − β)

(cid:18) δ−

w − 1
2

(cid:19)

+ l · δ−
w

+ (a − b)

(cid:18) δ−

k − 1
2

(cid:19)

.

+ t · δ−
k

(48)

Vamos investigar agora estrat´egias para determinar os elementos do conjunto O.
Fixados t e l, pela Proposi¸c˜ao 6, o elemento mtl pode ser associado a uma DPN m´agica.
Consequentemente, pelo Teorema 17, deve haver um elemento x da forma

x = 1 +

δ−
w − 1
2

+

(cid:18) δ−

k − 1
2

(cid:19)

· n.

+ t · δ−
k

Al´em disso, temos

(α − β) ·

δ−
w − 1
2

+ (a − b)

(cid:18) δ−

k − 1
2

(cid:19)

+ t · δ−
k

≡ mtl ≡ q − p

(mod n).

13 Na verdade, com tal condi¸c˜ao (argumentando como na prova do Teorema 13), podemos deduzir que o

quadrado ´e m´agico em todas as diagonais negativas. Isto ´e, nas diagonais em que

A − B ≡ j

(mod n), j = 0, 1, 2, . . . , n − 1

Consequentemente, temos

(cid:26)

m ∈ Z, m ≡ mt0,

O =

0 ≤ t ≤

(cid:27)

− 1

,

n
δk

onde mtl ´e dado por (48). Analogamente, temos

(cid:26)

m ∈ Z, m ≡ m0l,

O =

0 ≤ l ≤

(cid:27)

− 1

,

n
δw

onde mtl ´e dado por (48).

71

(49)

(50)

Vamos ilustrar essa caracteriza¸c˜ao do conjunto O em alguns casos especiais.
Suponha mdc(α − β, n) = δ (cid:54)= 1 e mdc(a − b, n) = 1. Pelo Corol´ario 7, os w’s
associados `as solu¸c˜oes de (42) formam um sistema completo de res´ıduos cuja soma ´e dada
por

n
(cid:88)

i=1

w =

(cid:19)

(cid:18) n − 1
2

n.

Para obter uma DPN m´agica, pelo Teorema 17, sabemos que p e q devem ser escolhidos
de modo que os valores de k na diagonal principal negativa sejam os do conjunto

(cid:110)

r0, r0 + δ, r0 + 2δ, . . . , r0 +

(cid:17)

− 1

(cid:111)

δ

(cid:16)n
δ

R =

onde

r0 =

δ − 1
2

.

(51)

(52)

Como os w’s formam um sistema completo de res´ıduos, por (49), para cada k ∈ R

obtemos pela congruˆencia

(α − β) · 0 + (a − b) · k ≡ q − p

(mod n)

uma rela¸c˜ao entre p e q para obter todas as poss´ıveis diagonais principais negativas
m´agicas.

Suponha agora mdc(α − β, n) = 1 e mdc(a − b, n) = δ (cid:54)= 1. Esse caso ´e an´alogo
ao caso anterior, apenas trocando k por w. Ent˜ao, fazendo k = 0, para cada w ∈ R (ver
(51) e (52)), por (50), obtemos pela congruˆencia

(α − β) · w + (a − b) · 0 ≡ q − p

(mod n)

uma rela¸c˜ao entre p e q para obter todas as poss´ıveis diagonais principais negativas
m´agicas.

Figura 24 - n = 9, α = 4, β = 1, a = 5, b = 1, p = 2 e q = 4.

DPN n˜ao m´agica.

72

Fonte: O autor, 2014.

Exemplo 9. Sejam n = 9, α = 4, β = 1, a = 5 e b = 1. Para quais valores de p e q a
diagonal negativa ser´a m´agica?

Temos

α − β = 3

e

a − b = 4.

Substituindo os valores dos coeﬁcientes em (42), temos:

3w + 4k ≡ q − p

(mod 9).

Al´em disso, mdc(3, 9) = 3 = δ, logo por (52), r0 =
Por outro lado, temos mdc(4, 9) = 1, logo w ∈ {0, 1, 2, . . . , 7, 8}

= 1, e por (51), k ∈ {1, 4, 7}

3 − 1
2

Os valores de q − p s˜ao calculados fazendo w = 0 e k assumindo os valores do

conjunto R = {1, 4, 7}, logo:

k = 1,

q − p ≡ 4

(mod 9),

k = 4,

q − p ≡ 16

(mod 9),

k = 7,

q − p ≡ 28

(mod 9).

Logo, a diagonal principal negativa ser´a m´agica se q − p ≡ 1, q − p ≡ 4 ou q − p ≡ 7
(mod 9).

Na Figura 24 o quadrado foi preenchido com as coordenadas iniciais p = 2 e q = 4. A
DPN n˜ao ser´a m´agica, uma vez que q − p ≡ 2.

23 + 81 + 49 + 26 + 75 + 52 + 20 + 78 + 46 = 450 (cid:54)= 369.

Figura 25 - n = 9, α = 4, β = 1, a = 5, b = 1.

73

(b)

(a)

(c)

Legenda: (a) DPN m´agica, p = 2 e q = 6.
(b) DPN m´agica, p = 1 e q = 2.
(c) DPN m´agica, p = 1 e q = 8.

Fonte: O autor, 2014.

Na Figura 25a, o quadrado foi preenchido com as coordenadas iniciais p = 2 e

q = 6. Uma DPN m´agica ser´a obtida, pois q − p = 4.

13 + 71 + 39 + 16 + 65 + 42 + 10 + 68 + 45 = 369.

Na Figura 25b, p = 1 e q = 2, atende a condi¸c˜ao q − p = 1, uma DPN m´agica ser´a obtida:

41 + 18 + 67 + 44 + 12 + 70 + 38 + 15 + 64 = 369.

Na Figura 25c, p = 1 e q = 8, atende a condi¸c˜ao q − p = 7, uma DPN m´agica ´e

obtida:

11 + 69 + 37 + 14 + 72 + 40 + 17 + 66 + 43 = 369.

74

Prosseguindo, vamos tentar investigar quantos valores incongruentes de q−p geram

DPN m´agicas. Seja q0 − p0 o gerador de DPN m´agicas associado a m00. Isto ´e

q0 − p0 ≡ (α − β) ·

δ−
w − 1
2

+ (a − b) ·

δ−
k − 1
2

(mod n).

(53)

Note que para qualquer outro valor q − p gerador de DPN m´agicas, teremos

q − p − (q0 − p0) ≡ (α − β) · l · δ−

w + (a − b) · t · δ−
k

(mod n).

− 1 e 0 ≤ t ≤ n
δ−
k

para algum 0 ≤ l ≤ n
− 1. Isto nos diz que podemos obter todos
δ−
w
os demais geradores de DPN m´agicas a partir de q0 − p0 atrav´es de acr´escimos da forma
(α − β) · l · δ−
k . Para identiﬁcar todos os geradores incongruentes, basta
identiﬁcar quantos valores incongruentes m´odulo n podem ser gerados por

w + (a − b) · t · δ−

(α − β) · l · δ−

w + (a − b) · t · δ−
k

para 0 ≤ l ≤

n
δ−
w

− 1 e 0 ≤ t ≤

n
δ−
k

− 1.

Pela Observa¸c˜ao 10 e pela Proposi¸c˜ao 1, temos

mdc(δ−

k , δ−

w ) = mdc(mdc(α − β, n), mdc(a − b, n)) = mdc(α − β, a − b, n) = 1.

Pelo Teorema 2, temos δ−
Temos

k ·δ−

w | n. Seja rtl o res´ıduo m´odulo n de (α−β)·l·δ−

w +(a−b)·t·δ−
k .

(α − β) · l · δ−

w + (a − b) · t · δ−

k ≡ rtl

(mod n).

(54)

Sejam Mαβ e Mab naturais tais que

α − β = Mαβ · δ−
k

e a − b = Mab · δ−
w .

Podemos reescrever (54) da seguinte maneira

Mαβ · δ−

k · δ−

w · l + Mab · δ−

w · δ−

k · t ≡ rtl

(mod n).

(55)

Como δ−

k · δ−

w | n, temos

mdc(δ−

k · δ−

w , n) = δ−

k · δ−
w .

Pelo Teorema 5, δ−

k · δ−

w | rtl. Como 0 ≤ rtl ≤ n − 1, existe um inteiro r(cid:48)

tl tal que

rtl = r(cid:48)

tl · δ−

k · δ−
w ,

0 ≤ r(cid:48)

tl ≤

n
δ−
k δ−
w

− 1

Pela Proposi¸c˜ao 5, (55) ´e equivalente a

Mαβ · l + Mab · t ≡ r(cid:48)
tl

(cid:18)

mod

(cid:19)

n
δ−
k δ−
w

75

(56)

Segue de mdc(α − β, a − b, n) = 1 que mdc
todo 0 ≤ r(cid:48)
incongruentes m´odulo n de DPN m´agicas. E para determin´a-los, basta resolver

= 1. Pelo Teorema 5, para
− 1, (56) admite solu¸c˜oes. Portanto, esse ´e o total de geradores q − p

tl ≤ n
k δ−
δ−

Mαβ, Mab,

w

n
k ·δ−
δ−

w

(cid:16)

(cid:17)

q − p − (q0 − p0) ≡ r · δ−

k · δ−

w

(mod n)

(57)

(cid:110)

(cid:111)

0, 1, . . . ,

. Essa congruˆencia nos diz que podemos obter todos os
para cada r ∈
poss´ıveis geradores de DPN m´agicas adicionando (m´odulo n) ao gerador q0 − p0 a quan-
tidade δ−

− 1 vezes.

− 1

n
k δ−
δ−

w

k · δ−

w por

n
k δ−
δ−

w

Exemplo 10. Considere α = 11, β = 2, a = 31, b = 11 e n = 105. Temos

mdc(αb − βa, n) = mdc(59, 105) = 1

mdc(α, n) = mdc(β, n) = mdc(a, n) = mdc(b, n) = 1

δ−
k = mdc(α − β, n) = mdc(9, 105) = 3
δ−
w = mdc(a − b, n) = mdc(20, 105) = 5

Temos

Rw = {2, 7, 12, 17, . . . , 102} ,

rw =

δ−
w − 1
2

= 2

e

Rk = {1, 4, 7, 10, . . . , 103} ,

rk =

δ−
k − 1
2

= 1

Al´em disso, vimos que temos
podem ser obtidos a partir do gerador

n
k δ−
δ−

w

= 7 geradores de DPN m´agicas incongruentes que

q0 − p0 ≡ (α − β) ·

δ−
w − 1
2

+ (a − b) ·

δ−
k − 1
2

≡ 38

(mod 105)

por 6 adi¸c˜oes m´odulo 105 de δ−

k · δ−

w = 15. Temos

q − p ∈ {8, 23, 38, 53, 68, 83, 98}.

Esse resultado ´e o mesmo obtido pelo m´etodo de tomarmos, por exemplo, o primeiro

elemento de Rk e considerar

q − p ≡ 38 + (α − β) · l

(mod 105),

l ∈ Rw.

76

6.2 Condi¸c˜oes para que a diagonal principal positiva seja m´agica

Nosso interesse agora ´e obter condi¸c˜oes para que a diagonal principal positiva seja
m´agica. Um n´umero x = 1 + w + kn est´a na diagonal principal positiva se, e somente se,
w e k forem solu¸c˜oes de A + B ≡ 1.

A + B ≡ 1

(mod n) ⇒ p + wα + ka + q + wβ + kb ≡ 1

(mod n)

Segue,

(α + β)w + (a + b)k ≡ 1 − p − q

(mod n)

(58)

Se mdc(α + β, a + b, n) = 1 ent˜ao pelos Teoremas 5 e 6, a equa¸c˜ao acima sempre ter´a n
solu¸c˜oes (w, k).

Observa¸c˜ao 11. Se o m´etodo preenche o quadradro, ent˜ao n n´umeros s˜ao dispostos na
diagonal principal positiva. Isto ´e, (α + β)w + (a + b)k ≡ 1 − p − q (mod n) tem n solu¸c˜oes
pertencentes ao conjunto {1, 2, . . . , n2}.

Observa¸c˜ao 12. Observe que se mdc(αb − βa, n) = 1, ent˜ao mdc(α + β, a + b, n) = 1.

De fato, vamos supor que mdc(α + β, a + b, n) = δ (cid:54)= 1. Ent˜ao, δ | α + β, δ | a + b

e δ | n. Agora

δ | α + β ⇒ δ | αb + βb

δ | a + b ⇒ δ | aβ + bβ

Subtraindo uma da outra, temos:

δ | (αb + βb) − (aβ + bβ) ⇒ δ | αb − βa

Logo, como δ | n e δ | αb − βa, temos mdc(αb − βa, n) (cid:54)= 1.

(cid:3)

Lema 7. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(α + β, n) =
k . Existe 0 ≤ k0 ≤ δ+
δ+
k − 1 tal que para qualquer uma das n solu¸c˜oes (w, k), com
0 ≤ w, k ≤ n−1 da equa¸c˜ao (α +β)w +(a+b)k ≡ 1−p−q (mod n), temos k = k0 +l ·δ+
k ,
, h´a exatamente δ+
k

− 1. Al´em disso, para cada l ∈

sendo 0 ≤ l ≤

0, 1, . . . ,

− 1

(cid:26)

(cid:27)

n
δ+
k

n
δ+
k

77

repeti¸c˜oes de k = k0 +l ·δ+
(mod n).

k dentre essas n solu¸c˜oes (w, k) de (α+β)w +(a+b)k ≡ 1−p−q

Demonstra¸c˜ao. An´aloga `a do Lema 5

Corol´ario 9. Se na equa¸c˜ao (α + β)w + (a + b)k ≡ 1 − p − q (mod n), mdc(α + β, n) = 1,
ent˜ao os k’s formam um sistema completo de res´ıduos.

Um resultado an´alogo ´e v´alido se mdc(a + b, n) = δ+
w .

Lema 8. Sejam n, α, β, a e b inteiros tais que mdc(αb − βa, n) = 1. Seja mdc(a + b, n) =
δ+
w . Existe 0 ≤ w0 ≤ δ+
w − 1 tal que para qualquer uma das n solu¸c˜oes (w, k), com
0 ≤ w, k ≤ n−1 da equa¸c˜ao (α+β)w +(a+b)k ≡ 1−p−q (mod n), temos w = w0 +t·δ+
w ,
, h´a exatamente δ+
w

− 1. Al´em disso, para cada t ∈

sendo 0 ≤ t ≤

0, 1, . . . ,

− 1

(cid:27)

(cid:26)

n
δ+
w

n
δ+
w

w dentre essas n solu¸c˜oes (w, k) de (α+β)w+(a+b)k ≡ 1−p−q

repeti¸c˜oes de w = w0 +t·δ+
(mod n).

Corol´ario 10. Se na equa¸c˜ao (α + β)w + (a + b)k ≡ 1 − p − q (mod n), mdc(a + b, n) = 1,
ent˜ao os w’s formam um sistema completo de res´ıduos.

6.2.1 Calculando a soma da diagonal

Sejam mdc(a + b, n) = δ+
Argumentando como no caso da diagonal principal negativa, o Lema 8 nos mostra

w e mdc(α + β, n) = δ+
k .

que os k’s poder˜ao assumir

{0, 1, 2, . . . , n − 1}.

n
δ+
k

valores no conjunto

Esses valores dependem de 1 − p − q e a soma dos k’s, ser´a dada por

(cid:88)

k =

n
2

(cid:0)n − δ+

k

(cid:1) + rkn,

(59)

k − 1.

com 0 ≤ rk ≤ δ+
Veremos que p e q devem ser escolhidos de modo que os valores de k na diagonal principal
positiva sejam os do conjunto

(cid:26)

Rk =

rk, rk + δ+

k , rk + 2δ+

k , . . . , rk +

onde

rk =

δ+
k − 1
2

.

(cid:18) n
δ+
k

(cid:19)

− 1

(cid:27)

δ+
k

(60)

(61)

Analogamente, ´e poss´ıvel mostrar que se xi, i = 1, . . . , n s˜ao os elementos da
valores

diagonal principal positiva, os w’s associados a esses elementos poder˜ao assumir

78

n
δ+
w

no conjunto

{0, 1, 2, . . . , n − 1}.

Esses valores dependem de 1 − p − q e sua soma ´e dada por

(cid:88)

w =

n
2

(cid:0)n − δ+

w

(cid:1) + rwn

(62)

onde rw ´e um inteiro tal que 0 ≤ rw ≤ δ+
w − 1.
Veremos tamb´em que p e q devem ser escolhidos de modo que os valores de w na diagonal
principal positiva sejam os do conjunto

(cid:26)

Rw =

rw, rw + δ+

w , rw + 2δ+

w , . . . , rw +

(cid:18) n
δ+
w

(cid:19)

− 1

(cid:27)

δ+
w

onde

rw =

δ+
w − 1
2

.

Por (59) e (62), podemos deduzir que a soma dos elementos xi da diagonal principal
positiva ´e dada por

(cid:88)

xi =

(cid:88)

1 +

(cid:88)

w + n

(cid:88)

k

i

i

(cid:1) + rwn +

(cid:0)n − δ+

(cid:1) + rkn2

= n +

n
2

(cid:0)n − δ+

w

= n + rwn +

n
2

(cid:0)n − δ+

w

n2
2
(cid:1) + rkn2 +

k
n2
2

(cid:0)n − δ+

(cid:1)

k

6.2.2 Condi¸c˜ao necess´aria e suﬁciente

Teorema 18. Sejam xi = 1 + wi + nki, 0 ≤ wi, ki ≤ n − 1, i = 1, . . . , n, os elementos da
diagonal principal positiva. Sejam mdc(a + b, n) = δ+
k . Para que a
diagonal principal positiva seja m´agica ´e necess´ario e suﬁciente que p e q sejam escolhidos
de modo que

w e mdc(α + β, n) = δ+

r+
k =

δ+
k − 1
2

e

r+
w =

δ+
w − 1
2

sejam respectivamente o menor k e o menor w dentre todas os elementos xi da diagonal.

Demonstra¸c˜ao. An´aloga `a prova do Teorema 17.

79

Corol´ario 11. Sejam n, α, β, a e b inteiros tais que mdc(αb + βa, n) = 1. Sejam mdc(α +
β, n) = δ+

w . Se p e q s˜ao tais que

k e mdc(a + b, n) = δ+

1 − q − p ≡ (α + β)

(cid:19)

(cid:18)δ+

w − 1
2

+ (a + b)

(cid:19)

(cid:18) δ+

k − 1
2

(mod n)

ent˜ao a soma dos elementos da diagonal principal positiva do quadrado gerado pelo m´etodo
do passo uniforme ´e igual a n(n2+1)

.

2

6.2.3 Onde come¸car para que a DPP seja m´agica?

Vimos nas se¸c˜oes anteriores que os elementos da diagonal principal positiva (DPP)
foram caracterizados como solu¸c˜oes de (58). Al´em disso, vimos que ´e poss´ıvel associar `a
DPP ´unicos conjuntos Rw e Rk tais que se x = 1 + w + kn ´e um elemento da DPP, temos
w ∈ Rw e k ∈ Rk. Consequentemente, se h´a na DPP algum x da forma

x = 1 +

δ+
w − 1
2

+ l · δ+

w +

(cid:18) δ+

k − 1
2

(cid:19)

· n

+ t · δ+
k

com 0 ≤ l ≤ n
δ+
w

− 1, 0 ≤ t ≤ n
δ+
k

− 1, ent˜ao

(cid:26)

Rw =

rw, rw + δ+

w , rw + 2δ+

w , . . . , rw +

(cid:18) n
δ+
w

(cid:19)

− 1

(cid:27)

δ+
w

,

onde rw =

δ+
w − 1
2

e

Rk =

(cid:26)

rk, rk + δ+

k , rk + 2δ+

k , . . . , rk +

(cid:18) n
δ+
k

(cid:19)

− 1

(cid:27)

δ+
k

,

onde rk =

δ+
k − 1
2

.

Portanto, pelo Teorema 18, a DPP ´e m´agica.

Reciprocamente, se a DPP ´e m´agica, pelo Teorema 18, ela cont´em elementos x da

forma

x = 1 +

δ+
w − 1
2

+ l · δ+

w +

(cid:18) δ+

k − 1
2

(cid:19)

· n

+ t · δ+
k

com 0 ≤ l ≤ n
δ+
w

− 1, 0 ≤ t ≤ n
δ+
k

− 1.

Essas considera¸c˜oes nos permitem estabelecer a seguinte proposi¸c˜ao.

Proposi¸c˜ao 7. Sejam α, β, a, b e n n´umeros inteiros tais que α, β, a, b e αb − βa s˜ao
primos com n. A DPP do quadrado de ordem n constru´ıdo pelo m´etodo do passo uniforme

´e m´agica se e somente se as coordenadas (p, q) da c´elula inicial satisfazem

(α + β)

(cid:18) δ+

w − 1
2

(cid:19)

+ l · δ+
w

+ (a + b)

(cid:18) δ+

k − 1
2

(cid:19)

+ t · δ+
k

≡ 1 − q − p

(mod n)

(63)

80

para algum 0 ≤ l ≤ n
δ+
w

−1, 0 ≤ t ≤ n
δ+
k

−1 e onde δ+

w = mdc(a+b, n) e δ+

k = mdc(α+β, n).

Note que se α + β e a + b forem primos com n, a diagonal principal positiva sempre
ser´a m´agica. De fato, pelos Corol´arios 9 e 10, a soma dos elementos xi da diagonal
principal positiva, ser´a m´agica:

x1 + x2 + · · · + xn =

n
(cid:88)

1 +

n
(cid:88)

i=1

i=1

wi + n

n
(cid:88)

i=1

ki =

(cid:19)

(cid:18) 1 + n2
2

n

Portanto, se os coeﬁcientes α + β e a + b da equa¸c˜ao linear (58) com duas vari´aveis w e
k, m´odulo n, que determina a diagonal principal positiva forem primos14 com n, ela ser´a
m´agica, independentemente dos valores iniciais (p, q). Esse resultado tamb´em pode ser
obtido a partir da Proposi¸c˜ao 7. Se os coeﬁcientes α + β e a + b forem primos com n, (63)
´e dada por

(α + β)l + (a + b)t ≡ 1 − q − p

(mod n)

com 0 ≤ l, t ≤ n−1. ´E f´acil ver que podemos escolher (l, t) de modo que (α +β)l +(a+b)t
gere um conjunto completo de res´ıduos. Isso resulta em p e q quaisquer.

Exemplo 11. Tomando o mesmo quadrado do exemplo 8, P´agina 70, n = 7, α = 4,
β = 2, a = 3 e b = 6, veriﬁcamos que ser´a m´agico tamb´em nas diagonais positivas uma
vez que α + β = 6 e a + b = 9 s˜ao ambos primos com 7.

A condi¸c˜ao de primalidade de α + β e a + b com n garante que todas as diagonais

positivas sejam m´agicas.

Segue da Proposi¸c˜ao 7 que todos os poss´ıveis valores de 1 − q − p que determinam

uma DPP m´agica pertencem ao conjunto

(cid:26)

m ∈ Z, m ≡ mtl

O =

(mod n), 0 ≤ l ≤

n
δ+
w

− 1, 0 ≤ t ≤

(cid:27)

− 1

n
δ+
k

14 Na verdade, com tal condi¸c˜ao (argumentando como na prova do Teorema 13, podemos deduzir que o

quadrado ´e m´agico em todas as diagonais positivas. Isto ´e, nas diagonais em que

A + B ≡ j

(mod n), j = 0, 1, 2, . . . , n − 1

onde

mtl = (α + β)

(cid:18) δ+

w − 1
2

(cid:19)

+ l · δ+
w

+ (a + b)

(cid:18) δ+

k − 1
2

(cid:19)

.

+ t · δ+
k

81

(64)

Vamos investigar agora estrat´egias para determinar os elementos do conjunto O.
Fixados t e l, pela Proposi¸c˜ao 7, o elemento mtl pode ser associado a uma DPP m´agica.
Consequentemente, pelo Teorema 18, deve haver um elemento x da forma

x = 1 +

δ+
w − 1
2

+

(cid:18) δ+

k − 1
2

(cid:19)

· n.

+ t · δ+
k

Al´em disso, temos

(α + β) ·

δ+
w − 1
2

+ (a + b)

(cid:18) δk − 1
2

(cid:19)

+ t · δ+
k

≡ mtl ≡ 1 − q − p

(mod n).

Consequentemente, temos

(cid:26)

m ∈ Z, m ≡ mt0,

O =

0 ≤ t ≤

(cid:27)

− 1

,

n
δ+
k

onde mtl ´e dado por (64). Analogamente, temos

(cid:26)

m ∈ Z, m ≡ m0l,

O =

0 ≤ l ≤

(cid:27)

− 1

,

n
δ+
w

onde mtl ´e dado por (64).

(65)

(66)

Vamos ilustrar essa caracteriza¸c˜ao do conjunto O em alguns casos especiais.
Suponha mdc(α + β, n) = δ (cid:54)= 1 e mdc(a + b, n) = 1. Pelo Corol´ario 7, os w’s
associados `as solu¸c˜oes de (58) formam um sistema completo de res´ıduos cuja soma ´e dada
por

n
(cid:88)

i=1

w =

(cid:19)

(cid:18) n − 1
2

n.

Para obter uma DPP m´agica, pelo Teorema 17, sabemos que p e q devem ser escolhidos
de modo que os valores de k na diagonal principal positiva sejam os do conjunto

(cid:110)

r0, r0 + δ, r0 + 2δ, . . . , r0 +

(cid:17)

− 1

(cid:111)

δ

(cid:16)n
δ

R =

onde

r0 =

δ − 1
2

.

(67)

(68)

82

Como os w’s formam um sistema completo de res´ıduos, por (65), para cada k ∈ R

obtemos pela congruˆencia

(α + β) · 0 + (a + b) · k ≡ 1 − q − p

(mod n)

uma rela¸c˜ao entre p e q para obter todas as poss´ıveis diagonais principais positivas m´agicas.
Suponha agora mdc(α + β, n) = 1 e mdc(a + b, n) = δ (cid:54)= 1. Esse caso ´e an´alogo
ao caso anterior, apenas trocando k por w. Ent˜ao, fazendo k = 0, para cada w ∈ R (ver
(67) e (68)), por (66), obtemos pela congruˆencia

(α + β) · w + (a + b) · 0 ≡ 1 − q − p

(mod n)

uma rela¸c˜ao entre p e q para obter todas as poss´ıveis diagonais principais positivas m´agicas.

Exemplo 12. Sejam n = 9, α = 4, β = 1, a = 5 e b = 1, veriﬁcamos que ser´a m´agico
na diagonal principal positiva para determinados valores de p e q. Que valores s˜ao esses?
Temos

α + β = 5

e

a + b = 6.

Substituindo em (58), temos:

5w + 6k ≡ 1 − q − p

(mod 9).

Al´em disso, mdc(5, 9) = 1, logo k ∈ {0, 1, 2, . . . , 7, 8}. Por outro lado, mdc(6, 9) = 3 = δ,

logo por (68), r0 =

= 1, e por (67), w ∈ {1, 4, 7}.

3 − 1
2

Os valores de 1 − q − p s˜ao calculados fazendo k = 0 e w assumindo os valores do conjunto
R = {1, 4, 7}, logo:

w = 1,

q + p ≡ −4 ≡ 5

(mod 9),

w = 4,

q + p ≡ −1 ≡ 8

(mod 9),

w = 7,

q + p ≡ −7 ≡ 2

(mod 9).

Logo, a diagonal principal positiva ser´a m´agica se q + p ≡ 2, q + p ≡ 5 ou q + p ≡ 8.

Na Figura 26a o quadrado foi preenchido com as coordenadas iniciais p = 2 e q = 4. A
DPP n˜ao ser´a m´agica, uma vez que q + p ≡ 6.

63 + 21 + 69 + 36 + 75 + 42 + 9 + 48 + 15 = 378 (cid:54)= 369.

Figura 26 - n = 9, α = 4, β = 1, a = 5, b = 1.

83

(b)

(a)

(c)

Legenda: (a) DPP n˜ao m´agica, p = 2 e q = 4.

(b) DPP m´agica, p = 1 e q = 1.
(c) DPP m´agica, p = 5 e q = 3.

Fonte: O autor, 2014.

Na Figura 26b, p = 1 e q = 1, atende a condi¸c˜ao q + p = 2, uma DPP m´agica ser´a obtida

41 + 8 + 47 + 14 + 62 + 20 + 68 + 35 + 74 = 369.

Na Figura 26c, p = 5 e q = 3, atende a condi¸c˜ao p + q = 8, uma DPP m´agica ´e obtida.ﬁg:

80 + 38 + 5 + 53 + 11 + 59 + 26 + 65 + 32 = 369.

84

Prosseguindo, vamos tentar investigar quantos valores incongruentes de q+p geram

DPP m´agicas. Seja q0 + p0 o gerador de DPP m´agicas associado a m00. Isto ´e

q0 + p0 ≡ 1 − (α + β) ·

δ+
w − 1
2

− (a + b) ·

δ+
k − 1
2

(mod n)

(69)

Note que para qualquer outro valor q + p gerador de DPP m´agicas, teremos

(q + p) − (q0 + p0) ≡ −(α + β) · l · δ+

w − (a + b) · t · δ+
k

(mod n)

− 1 e 0 ≤ t ≤ n
δ+
k

para algum 0 ≤ l ≤ n
− 1. Isto nos diz que podemos obter todos
δ+
w
os demais geradores de DPN m´agicas a partir de q0 − p0 atrav´es de acr´escimos da forma
−(α + β) · l · δ+
k . Para identiﬁcar todos os geradores incongruentes, basta
identiﬁcar quantos valores incongruentes m´odulo n podem ser gerados por

w − (a + b) · t · δ+

−(α + β) · l · δ+

w − (a + b) · t · δ+
k

para 0 ≤ l ≤ n
δ+
w

− 1 e 0 ≤ t ≤ n
δ+
k

− 1.

Pela Observa¸c˜ao 10 e pela Proposi¸c˜ao 1, temos

mdc(δ+

k , δ+

w ) = mdc(mdc(α + β, n), mdc(a + b, n)) = mdc(α + β, a + b, n) = 1.

Pelo Teorema 2, temos δ+
Temos

k ·δ+

w | n. Seja rtl o res´ıduo m´odulo n de (α+β)·l·δ+

w +(a+b)·t·δ+
k .

−(α + β) · l · δ+

w − (a + b) · t · δ+

k ≡ rtl

(mod n).

(70)

Sejam Mαβ e Mab naturais tais que

α + β = Mαβ · δ+
k

e a + b = Mab · δ+
w .

Podemos reescrever (70) da seguinte maneira

−Mαβ · δ+

k · δ+

w · l − Mab · δ+

w · δ+

k · t ≡ rtl

(mod n).

(71)

Como δ+

k · δ+

w | n, temos

mdc(δ+

k · δ+

w , n) = δ+

k · δ+
w .

Pelo Teorema 5, δ+

k · δ+

w | rtl. Como 0 ≤ rtl ≤ n − 1, existe um inteiro r(cid:48)

tl tal que

rtl = r(cid:48)

tl · δ+

k · δ+
w ,

0 ≤ r(cid:48)

tl ≤

n
δ+
k δ+
w

− 1

Pela Proposi¸c˜ao 5, (71) ´e equivalente a

−Mαβ · l − Mab · t ≡ r(cid:48)
tl

(cid:18)

mod

(cid:19)

n
δ+
k δ+
w

85

(72)

Segue de mdc(α + β, a + b, n) = 1 que mdc
todo 0 ≤ r(cid:48)
incongruentes m´odulo n de DPP m´agicas. E para determin´a-los, basta resolver

= 1. Pelo Teorema 5, para
− 1, (72) admite solu¸c˜oes. Portanto, esse ´e o total de geradores q + p

tl ≤ n
k δ+
δ+

Mαβ, Mab,

w

w

n
k ·δ+
δ+

(cid:16)

(cid:17)

(q + p) − (q0 + p0) ≡ −r · δ+

k · δ+

w

(mod n)

(73)

(cid:110)

(cid:111)

0, 1, . . . ,

. Essa congruˆencia nos diz que podemos obter todos
para cada r ∈
os poss´ıveis geradores de DPP m´agicas adicionando (m´odulo n) ao gerador q0 + p0 a
quantidade −(δ+

− 1 vezes.

− 1

w

n
k δ+
δ+

k · δ+

w ) por

n
k δ+
δ+

w

Exemplo 13. Sejam n = 75, α = 2, β = 7, a = 8 e b = 2.

mdc(αb − βa, n) = mdc(−52, 75) = 1

mdc(α, n) = mdc(β, n) = mdc(a, n) = mdc(b, n) = 1

δ+
k = mdc(α + β, n) = mdc(9, 75) = 3
δ+
w = mdc(a + b, n) = mdc(20, 75) = 5

Temos

Rw = {2, 7, 12, 17, . . . , 72} ,

rw =

δ+
w − 1
2

= 2

e

Rk = {1, 4, 7, 10, . . . , 73} ,

rk =

δ+
k − 1
2

= 1

Al´em disso, vimos que temos
podem ser obtidos a partir do gerador

n
k δ+
δ+

w

= 5 geradores de DPP m´agicas incongruentes que

q0 + p0 ≡ 1 − (α + β) ·

δ+
w − 1
2

− (a + b) ·

δ+
k − 1
2

≡ −27

(mod 75)

por 5 adi¸c˜oes m´odulo 75 de δ+

k · δ+

w = 15. Temos

q + p ∈ {48, 63, 3, 18, 33}.

Esse resultado ´e o mesmo obtido pelo m´etodo de tomarmos, por exemplo, o primeiro

elemento de Rw e considerar

q + p ≡ −17 − 10 · r

(mod 75),

r ∈ Rk

86

6.3 Onde come¸car para que a DPP e a DPN sejam ambas m´agicas?

Para determinar os geradores q −p incongruentes m´odulo n de DPN m´agicas, basta

resolver (57)

q − p − (q0 − p0) ≡ r− · δ−

k · δ−

w

(mod n)

(74)

(cid:110)

(cid:111)

0, 1, . . . ,

para cada r− ∈
. Essa congruˆencia nos diz que podemos obter to-
dos os poss´ıveis geradores de DPN m´agicas adicionando (m´odulo n) ao gerador q0 − p0 a
quantidade δ−

− 1 vezes.

n
k δ−
δ−

− 1

w

k · δ−

w por

n
k δ−
δ−

w

Para determinar os geradores q +p incongruentes m´odulo n de DPP m´agicas, basta

resolver (73)

(q + p) − (q0 + p0) ≡ −r+ · δ+

k · δ+

w

(mod n)

(75)

(cid:110)

(cid:111)

0, 1, . . . ,

para cada r+ ∈
. Essa congruˆencia nos diz que podemos obter to-
dos os poss´ıveis geradores de DPP m´agicas adicionando (m´odulo n) ao gerador q0 + p0 a
quantidade −(δ+

− 1 vezes.

n
k δ+
δ+

− 1

w

k · δ+

w ) por

n
k δ+
δ+

w

Admitindo que (p0, q0) satisfaz a (53) e (69) e somando (74) com (75) temos:

2q ≡ 2q0 + r− · δ−

k · δ−

w − r+ · δ+

k · δ+

w

(mod n)

Seja Q− = δ−
Seja Q+ = δ+
Uma vez que n ´e ´ımpar Q− e Q+ ser˜ao pares e podemos determinar o valor de q.

w ou Q− = (δ−
w ou Q+ = (δ+

w − n) se 2 (cid:45) δ−
w − n) se 2 (cid:45) δ−

w se 2 | δ−
w se 2 | δ+

k · δ−
w .
k · δ+
w .

k · δ−
k · δ+

k · δ−
k · δ+

k · δ−
k · δ+

q ≡ q0 + r− ·

Q−
2

− r+ ·

Q+
2

(mod n)

Subtraindo (74) de (75) temos:

(76)

2p ≡ 2p0 − r− · δ−

k · δ−

w − r+ · δ+

k · δ+

w

(mod n)

Uma vez que n ´e ´ımpar Q− e Q+ ser˜ao pares e podemos determinar o valor de p.

p ≡ p0 − r− ·

Q−
2

− r+ ·

Q+
2

(mod n)

87

(77)

A congruˆencia (77) para a coordenada inicial p ´e an´aloga a congruˆencia (3) para

a coordenada A. Observe que r− e r+ s˜ao contadores e
podem ser escolhidos
como “passo”ou “quebra de passo”. Portanto, pode-se obter todas as coordenadas iniciais

ou

p a partir de p0, acrescentando “passos”, por exemplo,

, por

n
k δ−
δ−

w

− 1 vezes, ao ﬁnal do

Q+
2

Q−
2

Q−
2

qual, soma-se a “quebra de passo”,
Q−
2

n
k δ−
δ−
zida. E assim por diante at´e se completar

− 1 passos

w

Q+
2

, completando outro ciclo, ent˜ao nova quebra de passo

n
k δ+
δ+

w

− 1 quebras de passos.

. Um novo ciclo ´e ent˜ao iniciado, acrescentando-se

Q+
2

´e introdu-

Da mesma maneira, pode-se obter todas as coordenadas iniciais q a partir de q0,
pois a congruˆencia (76) para a coordenada inicial q ´e an´aloga a equa¸c˜ao (4) para a coor-
denada B.

Exemplo 14. Sejam n = 55, α = 7, β = 4, a = 6 e b = 1.

mdc(αb − βa, n) = mdc(−17, 55) = 1

mdc(α, n) = mdc(β, n) = mdc(a, n) = mdc(b, n) = 1

δ+
k = mdc(α + β, n) = mdc(11, 55) = 11
δ+
w = mdc(a + b, n) = mdc(7, 55) = 1
δ−
k = mdc(α − β, n) = mdc(3, 55) = 1
δ−
w = mdc(a − b, n) = mdc(5, 55) = 5

R+

w = {0, 1, 2, 3, 4, . . . , 54} ,

r+
w =

= 0

R+

k = {5, 16, 27, 38, 49} ,

r+
k =

= 5

δ+
w − 1
2
δ+
k − 1
2
δ−
w − 1
2
δ−
k − 1
2

r−
w =

r−
k =

= 2

= 0

R−

w = {2, 7, 12, 17, . . . , 52} ,

R−

k = {0, 1, 2, 3, 4, . . . , 54} ,

Al´em disso,

q0 + p0 ≡ 1 − (α + β) · r+

w − (a + b) · r+
k

(mod n)

q0 + p0 ≡ 1 − 11 · 0 − 7 · 5 ≡ −34 ≡ 21

(mod 55)

88

Tabela 5 - Coordenadas iniciais para DPP e DPN m´agicas

r+
0
1
2
3
4

(p, q)

(35, 41)
(35 + 22 ≡ 2, 41 + 22 ≡ 8)
(2 + 22 ≡ 24, 8 + 22 ≡ 30)
(24 + 22 ≡ 46, 30 + 22 ≡ 52)
(46 + 22 ≡ 13, 52 + 22 ≡ 19)

r− = 0

Fonte: O autor, 2014.

q0 − p0 ≡ (α − β) · r−

w + (a − b) · r−
k

(mod n)

q0 − p0 ≡ 3 · 2 + 5 · 0 ≡ 6

(mod 55)

Segue que
p0 ≡ −20 ≡ 35 (mod 55)

q0 ≡ −14 ≡ 41 (mod 55)

Temos δ+

w · δ+

k = 11 e δ−

w · δ−

k = 5

Logo

Q+
2

≡

11 − 55
2

≡ −22 e

Q−
2

≡

5 − 55
2

≡ −25

p ≡ p0 − r− ·

Q−
2

− r+ ·

Q+
2

·

(mod n)

p ≡ 35 + 25 · r− + 22 · r+ (mod 55)

q ≡ q0 + r− ·

Q−
2

− r+ ·

Q+
2

(mod n)

q ≡ 41 − 25 · r− + 22 · r+ (mod n)

Sendo
(cid:110)
r− ∈

0, 1, . . . ,

r+ ∈

(cid:110)

0, 1, . . . ,

w

n
k δ−
δ−
n
k δ+
δ+

w

(cid:111)

− 1

(cid:111)

− 1

= {0, 1, . . . , 10}

= {0, 1, 2, 3, 4}

Ao ﬁnal do 1o. ciclo de 5 n´umeros, Tabela 5, o pr´oximo valor de (p, q) exigir´a uma
quebra de passo no procedimento. De fato, partindo das coordenadas iniciais (p0, q0) ao

serem somados 4 passos horizontais

voltaremos `a coordenada inicial (p0, q0). Ent˜ao,

adicionamos
`a coordenada q, obtendo (13+ 25 ≡ 38, 19−25 ≡
−6 ≡ 49). Em seguida, voltamos ao procedimento dos passo at´e completar outro ciclo de

`a coordenada p e −

Q+
2

Q−
2
Q+
2

89

Tabela 6 - Coordenadas iniciais para DPP e DPN m´agicas

r+
0
1
2
3
4

(p, q)

(38, 49)
(38 + 22 ≡ 5, 49 + 22 ≡ 16)
(5 + 22 ≡ 27, 16 + 22 ≡ 38)
(27 + 22 ≡ 49, 38 + 22 ≡ 5)
(49 + 22 ≡ 16, 5 + 22 ≡ 27)

r− = 1

Fonte: O autor, 2014.

5 n´umeros, Tabela 6. E assim por diante.
Com este procedimento s˜ao obtidas

n
w · δ+
δ+
k
ridade das 55 coordenadas iniciais (p, q) que garantem DPP e DPN m´agicas ´e exibida na
Figura 27).

= 55 coordenadas. A regula-

n
w · δ−
δ−
k

·

Figura 27 - Coordenadas iniciais para DPP e DPN m´agicas (parˆametros: n = 55,

α = 7, β = 4, a = 6, b = 1).

Fonte: O autor, 2014.

90

Exemplo 15. Considere n = 105, α = 11, β = 2, a = 31 e b = 11 .

mdc(αb − βa, n) = mdc(59, 105) = 1

mdc(α, n) = mdc(β, n) = mdc(a, n) = mdc(b, n) = 1

δ+
w = mdc(a + b, n) = mdc(42, 105) = 3
δ+
k = mdc(α + β, n) = mdc(13, 105) = 1
δ−
w = mdc(a − b, n) = mdc(20, 105) = 5
δ−
k = mdc(α − β, n) = mdc(9, 105) = 3

R+

w = {1, 4, 7, . . . , 103} ,

r+
w =

= 1

δ+
w − 1
2
δ+
k − 1
2
δ−
w − 1
2
δ−
k − 1
2

= 0

= 2

= 1

R+

k = {0, 1, 2, 3, . . . , 104} ,

R−

w = {2, 7, 12, . . . , 102} ,

r+
k =

r−
w =

R−

k = {1, 4, 7, . . . , 103} ,

r−
k =

Al´em disso,

q0 + p0 ≡ 1 − (α + β) · r+
q0 + p0 ≡ 1 − 13 · 1 − 42 · 0 ≡ −12 (mod 105)

w − (a + b) · r+

k (mod n)

q0 − p0 ≡ (α − β) · r−
q0 − p0 ≡ 9 · 2 + 20 · 1 ≡ 38 (mod 105)

w + (a − b) · r−

k (mod n)

Segue que

p0 ≡ −25 ≡ 80 (mod 105)
q0 ≡ 13 (mod 105)

Temos δ−

w · δ−

k = 15 e δ+

w · δ+

k = 3

Logo

Q+
2

≡

3 − 105
2

≡ −51 e

Q−
2

≡

15 − 105
2

≡ −45

p ≡ p0 − r− ·

Q−
2

− r+ ·

Q+
2

(mod n)

p ≡ 80 + 45 · r− + 51 · r+ (mod 105)

91

Tabela 7 - Coordenadas iniciais para DPP e DPN m´agicas

r+ = 0

r−
0
1
2
3
4
5
6

(p, q)

(80, 13)
(80 + 45 ≡ 20, 13 − 45 ≡ 73)
(20 + 45 ≡ 65, 73 − 45 ≡ 28)
(65 + 45 ≡ 5, 28 − 45 ≡ 88)
(5 + 45 ≡ 50, 88 − 45 ≡ 43)
(50 + 45 ≡ 95, 43 − 45 ≡ 103)
(95 + 45 ≡ 35, 103 − 45 ≡ 58)

Fonte: O autor, 2014.

q ≡ q0 + r− ·

Q−
2

− r+ ·

Q+
2

(mod n)

q ≡ 13 − 45 · r− + 51 · r+ (mod 105)

Sendo
(cid:110)
r− ∈

0, 1, . . . ,

r+ ∈

(cid:110)

0, 1, . . . ,

w

n
k δ−
δ−
n
δ+
k δ+

w

(cid:111)

− 1

(cid:111)

− 1

= {0, 1, 2, 3, 4, 5, 6}

= {0, 1, 2, 3, . . . , 34}.

Ao ﬁnal do 1o. ciclo de 7 n´umeros (Tabela 7), o pr´oximo valor de (p, q) exigir´a uma
quebra de passo no procedimento. De fato, (80 + 7 · 45 ≡ 80 (mod 105), 13 − 7 · 45 ≡
13 (mod 105)). Ent˜ao, adicionamos 51 `a coordenada p e 51 `a coordenada q, obtendo
(80 + 51 ≡ 26, 13 + 51 ≡ 64). Em seguida, voltamos ao procedimento dos passos at´e
completar outro ciclo de 7 n´umeros, Tabela 8. E assim por diante. A pr´oxima tabela ter´a
r+ = 1

Tabela 8 - Coordenadas iniciais para DPP e DPN m´agicas

r+ = 1

r−
0
1
2
3
4
5
6

(p, q)

(26, 64)
(26 + 45 ≡ 71, 64 − 45 ≡ 19)
(71 + 45 ≡ 11, 19 − 45 ≡ 79)
(11 + 45 ≡ 56, 79 − 45 ≡ 34)
(56 + 45 ≡ 101, 34 − 45 ≡ 94)
(101 + 45 ≡ 41, 94 − 45 ≡ 49)
(41 + 45 ≡ 86, 49 − 45 ≡ 4)

Fonte: O autor, 2014.

A ´ultima tabela ter´a r+ = 34. Com este procedimento s˜ao obtidas

n
w · δ−
δ−
k
tem DPP e DPN m´agicas ´e exibida na Figura 28.

= 245 coordenadas. A regularidade das 245 coordenadas iniciais (p, q) que garan-

92

n
w · δ+
δ+
k

·

Figura 28 - Coordenadas iniciais para DPP e DPN m´agicas (parˆametros: n = 105, α = 11,

β = 2, a = 31, b = 11).

Fonte: O autor, 2014.

Exemplo 16. Alguns casos especiais – um coeﬁciente ´e m´ultiplo de n. N˜ao podemos ter
α + β ≡ 0 e a + b ≡ 0. De fato,

93

α + β ≡ 0 ⇒ n | (α + β)

e

(a + b) ≡ 0 ⇒ n | (a + b)

Logo

n | b(α + β) − β(a + b) ⇒ n | (αb − βa) ⇒ mdc(αb − βa, n) = n,

o que impede o preenchimento do quadrado. Conforme a introdu¸c˜ao da se¸c˜ao 6 na p´agina
61, mdc(αb − βa, n) tem de ser igual a 1, que ´e a condi¸c˜ao para o preenchimento do
quadrado.

Tamb´em n˜ao podemos ter α + β ≡ 0 e mdc(a + b, n) = δ (cid:54)= 1. De fato,

α + β ≡ 0 ⇒ n | (α + β)

e mdc(a + b, n) = δ ⇒ δ | (a + b),

δ | n

Portanto

n | b(α + β)

e

δ | β(a + b) ⇒ δ | b(α + β),

δ | β(a + b)

⇒ δ | b(α + β) − β(a + b)

⇒ δ | (αb − βa)

⇒ mdc(αb − βa, n) = δ,

e o quadrado n˜ao preenche. Logo, nas equa¸c˜oes que determinam as diagonais principais
se um dos coeﬁcientes for m´ultiplo de n o outro ter´a de ser primo com n.

• Vamos tomar (α + β)w + (a + b)k ≡ 1 − q − p

(mod n).

(α + β) ≡ 0 ⇒ mdc(α + β, n) = n ⇒ k ∈

(cid:27)

(cid:26) n − 1
2

mdc(a + b, n) = 1 ⇒ w ∈ {0, 1, 2, . . . , n − 1} w assume os valores de um sistema
completo de res´ıduos m´odulo n mas k assume apenas um valor. Vamos determinar
a varia¸c˜ao de 1 − q − p quando w aumenta 1. Observe que k aumenta 0 pois ´e
constante.

(α + β)(w + 1) + (a + b)(k + 0) ≡ (α + β)w + (α + β) + (a + b)k

≡ (α + β)w + (a + b)k + (α + β)

≡ (α + β)w + (a + b)k.

Logo, 1 − q − p ´e constante, ter´a apenas um valor. Este valor ser´a igual a

94

(α + β)0 + (a + b)

(cid:19)

(cid:18) n − 1
2

≡ (a + b)

(cid:18)n − 1
2

(cid:19)

.

Logo, a diagonal principal positiva ser´a m´agica se

1 − q − p ≡ (a + b)

(cid:19)

(cid:18)n − 1
2

(mod n).

• Vamos tomar (α − β)w + (a − b)k ≡ q − p

(mod n).

(α − β) ≡ 0 ⇒ mdc(α − β, n) = n ⇒ k ∈

(cid:27)

(cid:26) n − 1
2

mdc(a − b, n) = 1 ⇒ w ∈ {0, 1, 2, . . . , n − 1} w assume os valores de um sistema
completo de res´ıduos m´odulo n mas k assume apenas um valor. Vamos determinar
a varia¸c˜ao de q − p quando w aumenta 1. Observe que k aumenta 0 pois ´e constante.

(α − β)(w + 1) + (a − b)(k + 0) ≡ (α − β)w + (α − β) + (a − b)k

≡ (α − β)w + (a − b)k + (α − β)

≡ (α − β)w + (a − b)k.

Logo, q − p ´e constante, ter´a apenas um valor. Este valor ser´a igual a

(α − β)0 + (a − b)

(cid:19)

(cid:18) n − 1
2

≡ (a − b)

(cid:18) n − 1
2

(cid:19)

.

Logo, a diagonal principal negativa ser´a m´agica se

q − p ≡ (a − b)

(cid:19)

(cid:18) n − 1
2

(mod n).

Observa¸c˜ao 13. A condi¸c˜ao necess´aria do quadrado preenchido pelo m´etodo do passo
uniforme ser m´agico nas linhas e colunas ´e de n ser ´ımpar. Se15 n > 3 for ´ımpar e primo,
podemos construir quadrados m´agicos nas linhas e colunas e ainda diab´olicos escolhendo
os coeﬁcientes α, β, a, b, α ± β, a ± b tais que nenhum seja m´ultiplo de n.

15 Em seu artigo, Lehmer (1929) faz a seguinte aﬁrma¸c˜ao: “...um quadrado diab´olico n˜ao pode ser
constru´ıdo pelo m´etodo do passo uniforme quando n for m´ultiplo de 3. Pois se α e β forem primos com
3, α + β e α − β n˜ao poderiam ser ambos primos com 3. Contudo, isso n˜ao signiﬁca que um quadrado
diab´olico n˜ao possa ser obtido por outros m´etodos quando n for m´ultiplo de 3”.

7 M´ETODO DE LA LOUB`ERE

95

De La Loub`ere apresentou o seguinte m´etodo de constru¸c˜ao de quadrados m´agicos

de ordem ´ımpar.

Coloque o n´umero 1 no topo da coluna central. Em seguida, suba, sucessiva-
mente, pela diagonal negativa que passa por 1, preenchendo, ordenadamente,
com os n´umeros 2, . . . , n, todas as posi¸c˜oes remanescentes. Quando essa dia-
gonal tiver sido preenchida com os n´umeros 1, 2, . . . , n escreva n + 1 imedia-
tamente abaixo da c´elula contendo n e preencha as c´elulas remanescentes da
nova diagonal negativa com os n´umeros n + 2, . . . , 2n. Continue este proce-
dimento. Cada vez que uma nova diagonal negativa for preenchida escreva
o pr´oximo n´umero imediatamente abaixo do n´umero anterior e suba nova-
mente preenchendo as posi¸c˜oes remanescentes da diagonal com os n´umeros
sucessivos.

Usaremos os resultados obtidos no presente trabalho para fazer a an´alise do m´etodo
de La Loub`ere para a constru¸c˜ao de quadrados m´agicos no sentido usual, isto ´e, linhas,
colunas e as duas diagonais principais m´agicas.

Um quadrado constru´ıdo pelo m´etodo de La Loub`ere ter´a os parˆametros α = 1,

e q = n. O determinante αb − βa = −1, primo com
β = 1, a = −1, b = −2, p =
n, vai garantir o preenchimento. Os parˆametros α, β, a e b ser˜ao sempre primos com n
´ımpar, o que garantir´a o quadrado m´agico nas linhas e colunas.

n + 1
2

∀n ´ımpar, n˜ao m´ultiplo de 3, a diagonal principal positiva ser´a m´agica, indepen-

dentemente de (p, q), uma vez que α + β = 2 e a + b = −3 ser˜ao primos com n.

∀n ´ımpar, m´ultiplo de 3, δ+

w = mdc(a + b, n) = mdc(−3, n) = 3 e δ+

k = mdc(α +

β, n) = mdc(2, n) = 1. Segue:

q0 + p0 ≡ 1 − (α + β) ·

(cid:19)

(cid:18) δ+

w − 1
2

− (a + b) ·

(cid:19)

(cid:18) δ+

k − 1
2

(mod n)

q0 + p0 ≡ 1 − 2 · 1 − 3 · 0 ≡ −1 (mod n)

Os valores de q + p (mod n) que d˜ao DPP m´agicas s˜ao obtidos por:

q + p ≡ q0 + p0 + t · δ+

w · δ+

k (mod n), onde 1 ≤ t ≤

n
w · δ+
δ+
k

Escrevendo n na forma n = 3(2s − 1) com s ∈ {1, 2, 3, . . .}, segue

=

3(2s − 1)
3

n
w · δ+
δ+
k
q + p ≡ −1 + t · δ+

= 2s − 1

w · δ+

k (mod n) com t = 1, 2, 3, . . . , 2s − 1.

Evidentemente, 2s−1 ´e ´ımpar, ent˜ao ∀n, ´ımpar m´ultiplo de 3, h´a uma quantidade ´ımpar de
somas q + p (mod n), incongruentes, que nos d˜ao DPP m´agicas. A primeira destas somas

96

q+p, ´e obtida fazendo-se t = 1. Seu valor ´e p+q ≡ −1+1·3 ≡ 2 e a ´ultima soma q+p ´e ob-

tida fazendo t = 2s−1. Seu valor ´e q+p ≡ −1+(2s−1)·3 ≡ 6s−4 ≡ 6

−4 ≡ n−1

(cid:19)

(cid:18) n + 3
6

(mod n). Ent˜ao, a soma central q + p, pode ser calculada simplesmente fazendo a m´edia

do primeiro q + p com o ´ultimo q + p, isto ´e,
Aﬁrmamos que a soma das coordenadas sugeridas pelo m´etodo de La Loub`ere, q = n e

(mod n).

≡

2 + n − 1
2

n + 1
2

n + 1
2

p =
vai ser igual, ∀n ´ımpar m´ultiplo de 3, `a soma central q +p (mod n) do conjunto
de solu¸c˜oes q + p que d˜ao DPP m´agicas. De fato, a soma das coordenadas m´odulo n, de
n + 1
2

≡
La Loub`ere, vai dar q + p ≡ n +
de La Loub`ere vai construir quadrados com a diagonal principal positiva m´agica.

(mod n). Portanto, ∀n ´ımpar, o m´etodo

n + 1
2

A diagonal principal negativa ser´a determinada por

(α − β)w + (a − b)k ≡ q − p (mod n)
(cid:19)

(cid:18) n + 1
2

(mod n)

(1 − 1)w + (−1 + 2)k ≡ n −
(cid:18) n − 1
2

0w + k ≡

(mod n)

(cid:19)

k ≡

(cid:19)

(cid:18) n − 1
2

(mod n)

Dessa feita, os elementos xi da DPN ter˜ao ki constante igual a

forma xi = 1 + wi +

(cid:18) n − 1
2
res´ıduos m´odulo n. Somando esses elementos temos

(cid:19)

(cid:19)

(cid:18) n − 1
2

, assumindo a

n com wi varrendo os valores de um sistema completo de

n
(cid:88)

i=1

n
(cid:88)

(cid:18)

xi =

1 + wi +

i=1

= n +

(cid:19)

(cid:18) n − 1
2

n

(cid:19)

(cid:18) n − 1
2
(cid:18) n − 1
2

n +

(cid:19)

=

n
(cid:88)

1 +

n
(cid:88)

wi +

(cid:19)

i=1

i=1
(cid:18) n2 + 1
2

(cid:19)

n2 =

n
(cid:88)

i=1

(cid:19)

(cid:18) n − 1
2

n

n

(soma m´agica)

Portanto, ∀n ´ımpar, o m´etodo de La Loub`ere vai construir quadrados com a diagonal
principal negativa m´agica.

Uma curiosidade do m´etodo: O n´umero central,

n2 + 1
2

ir´a se localizar sempre no

centro do quadrado

Substituindo x =

. Vamos mostrar porque isso acontece:

, α = 1 e a = −1 na congruˆencia

(cid:19)

n + 1
2
n + 1
2

,

(cid:18) n + 1
2
n2 + 1
, p =
2
(cid:21)
(cid:20)x − 1
n

A ≡ p + α(x − 1) + a

(mod n), vamos obter

97

A ≡

n + 1
2

+

(cid:18) n2 + 1
2

(cid:19)

− 1

−






n2 + 1
2

n

− 1




 (mod n)

A ≡

n + 1
2

+

(cid:19)

(cid:18) n2 − 1
2

−

A ≡

n + 1
2

+

(cid:19)

(cid:18) n2 − 1
2

−












n2
2

−

−

1
2

n
2

n
2

+

n




 (mod n)

(cid:18) n
2

n

−

(cid:19)

1
2

+

(cid:18) n
2

−

1
2

n

(cid:19)







(mod n)

A ≡

n + 1
2

+

(cid:19)

(cid:18) n2 − 1
2

−

(cid:20)(cid:18)n − 1

2

(cid:19)

(cid:19)(cid:21)

(mod n).

+

(cid:18)n − 1
2n
(cid:20)(cid:18)n − 1

(cid:19)(cid:21)

2

(mod n)

=

n − 1
2

e

(cid:20)(cid:18)n − 1
2n

(cid:19)(cid:21)

= 0,

Como n ´e ´ımpar maior ou igual a 3,

A ≡

A ≡

A ≡ n

n + 1
2

+

(cid:19)

(cid:18) n2 − 1
2

−

(cid:19)

(cid:18) n − 1
2

+

(mod n)

n
2

n
2
(cid:19)

n2
+
−
2
(cid:18) n − 1
2

+

1
2
n + 1
2

(mod n)

A ≡

n + 1
2

(mod n) ⇒ A =

n + 1
2

.

Analogamente, vamos substituir x =

B ≡ q + β(x − 1) + b

(cid:21)

(cid:20)x − 1
n

n2 + 1
2

, q = n, β = 1 e b = −2 na congruˆencia

(mod n), vamos obter

B ≡ n +

(cid:18) n2 + 1
2

(cid:19)

− 1

− 2






n2 + 1
2

n

− 1




 (mod n)

B ≡ n +

(cid:19)

(cid:18) n2 − 1
2

− 2

B ≡ n +

(cid:19)

(cid:18) n2 − 1
2

− 2












n2
2

−

−

1
2

n
2

n
2

+

n




 (mod n)

(cid:18) n
2

n

−

(cid:19)

1
2

+

(cid:18) n
2

−

1
2

n

(cid:19)







(mod n)

B ≡ n +

(cid:19)

(cid:18) n2 − 1
2

− 2

(cid:20)(cid:18) n − 1

(cid:19)

2

+

Como n ´e ´ımpar maior ou igual a 3,

(cid:19)(cid:21)

(cid:18) n − 1
2n
(cid:20)(cid:18)n − 1

(mod n).

(cid:19)(cid:21)

=

n − 1
2

e

(cid:20)(cid:18)n − 1
2n

(cid:19)(cid:21)

= 0,

2

B ≡ n +

(cid:19)

(cid:18) n2 − 1
2

− 2

(cid:19)

(cid:18) n − 1
2

(mod n)

98

(mod n)

B ≡

B ≡

+

n2
1
2
2
n2
1
+
+
2
2
(cid:18) n − 1
2

n
2
(cid:19)

−

(mod n)

n
2
n + 1
2

B ≡ n

+

(mod n)

B ≡

n + 1
2

(mod n) ⇒ B =

n + 1
2

.

CONCLUS ˜AO

99

Quando ﬁz a disciplina Aritm´etica no PROFMAT pude redescobrir esse campo
fecundo da matem´atica que bem explorado poderia proporcionar melhorias no ensino-
aprendizagem da matem´atica. Por trabalhar com os n´umeros naturais, familiares `as
crian¸cas desde as primeiras contagens, oferecia, ao meu ver, um campo vasto, seja para a
investiga¸c˜ao, seja para uma ampla variedade de problemas possibilitando, se bem explo-
rados, uma s´olida aprendizagem dos fundamentos para uma boa forma¸c˜ao matem´atica,
entendida aqui, n˜ao apenas como habilidade de fazer c´alculos ou resolver problemas com
sucesso e rapidez mas de adquirir a metodologia, a maneira matem´atica de se olhar para
as coisas do mundo. Seria a capacidade n˜ao s´o de resolver o problema matematizado mas
de matematizar o problema.

Pela primeira vez, pude reﬂetir sobre a minha forma¸c˜ao matem´atica. Retomando
minhas lembran¸cas da escola, incluindo a universidade, pareceu-me evidente uma pre-
dominˆancia acentuada da matem´atica do cont´ınuo: a resolu¸c˜ao de equa¸c˜oes, o estudo
das fun¸c˜oes, por exemplo, em detrimento da matem´atica discreta, em particular da
Aritm´etica. A ´Algebra com seus x’s e y’s e a Geometria com seus triˆangulos retˆangulos
ocupavam quase toda a mesa relegando a Aritm´etica a um papel secund´ario ou at´e mesmo
a ﬁcar na gaveta. De um certo modo, poderia at´e ser compreens´ıvel que seja assim no
ensino m´edio. Mas ﬁca a pergunta, e a inquieta¸c˜ao para os respons´aveis do ensino nos
primeiros anos do fundamental e sobretudo para o ensino de matem´atica nos anos iniciais.
A proposta para o TCC de detalhamento do artigo “Sobre congruˆencias associa-
das a certos quadrados m´agicos” de Lehmer (1929) me atraiu por atender a este novo
interesse em Aritm´etica al´em da proposta que era digamos muito mais matem´atica do
que pedag´ogica, tendo um objeto de algum modo aﬁm com a matem´atica do fundamental
nas escolas p´ublicas al´em de n˜ao propor nenhum indesej´avel levantamento de dados com
turmas.

Vale destacar o impasse causado pelo par´agrafo de Lehmer (1929, p. 531) estar
equivocado ou n˜ao. Por ter uma inﬂuˆencia japonesa mais r´ıgida em rela¸c˜ao `a autoridade
moral, encontrei uma grande resistˆencia em admitir que o mestre pudesse ter cometido um
deslize. Mas foi justamente o querer defendˆe-lo que possibilitou o desenvolvimento deste
trabalho. Pode-se aﬁrmar que tomou um rumo bem diferente do previsto inicialmente,
que era apenas detalhar e fundamentar cada passagem do artigo de Lehmer.

REFERˆENCIAS

100

CHABERT, J.; BARBIN, E. A History of Algorithms: From the Pebble to the Microchip.
Berlin, Heidelberg, New York: Springer Verlag, 1999.

HEFEZ, A. Elementos de aritm´etica. Rio de Janeiro: SBM, 2006. (Textos Universit´arios).

KRAITCHIK, M. Mathematical recreations. [S.l.]: W.W. Norton & company inc., 1942.

LEHMER, D. N. On the congruences connected with certain magic squares. Transactions
of the American Mathematical Society, v. 31, p. 529–551, 1929.

SANTOS, J. P. d. O. Introdu¸cao `a teoria dos n´umeros. Rio de Janeiro: Instituto de
Matem´atica Pura e Aplicada, 1998. (Cole¸cao Matem´atica Universi´aria).

SIVARAMAKRISHNAN, R. Certain Number-Theoretic Episodes In Algebra. Hoboken,
NJ: Taylor & Francis, 2006. (Chapman & Hall/CRC Pure and Applied Mathematics).

