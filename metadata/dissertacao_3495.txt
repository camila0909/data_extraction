JOÃO HENRIQUE BUENO DE GODOY FILHO

O PRINCÍPIO DA INCLUSÃO E EXCLUSÃO E
SUAS APLICAÇÕES

Dourados - MS

2016

JOÃO HENRIQUE BUENO DE GODOY FILHO

O PRINCÍPIO DA INCLUSÃO E EXCLUSÃO E SUAS

APLICAÇÕES

Dissertação de Mestrado apresentada ao Pro-
grama de Pós-Graduação em Matemática Pro-
ﬁssional, do Centro de Tecnologia da Univer-
sidade Federal da Grande Dourados, como
requisito parcial para obtenção do grau de
Mestre em Matemática. Área de concentra-
ção: Matemática

Universidade Federal da Grande Dourados - UFGD

Faculdade de Ciências Exatas e Tecnologia

Orientador: Prof. Dr. Lino Sanabria

Dourados - MS

2016

Este trabalho é dedicado a Jusara Maria Araujo Reinaldo Araujo e João Lucas Rogoski
Godoy.

Agradecimentos

Agradeço primeiramente a minha mãe pelo amor, pela criação, pelo exemplo de

cidadã e pela valiosa educação que tive.

Ao meu pai, pelo exemplo de um cidadão honesto e trabalhador que sempre foi.

Ao meu ﬁlho João Lucas, pelo carinho e amor.

A minha noiva Joyce Dalvi, pelo incentivo, paciência nos momentos ausentes e

amor incondicional a mim dispensado.

As minhas irmãs Thaisa e Tatiana pelo apoio e modelo ao qual posso me espelhar.

A todos os professores do corpo docente, pela dedicação, paciência e sabedoria. Em
especial ao meu orientador e professor Dr. Lino Sanabria pela qualidade na orientação
deste trabalho, pessoa esta pela qual tenho admiração e respeito.

A meus amigos do curso, em especial a Lin Ming Feng, um amigo indescritível.

Ao meu padrasto Alvacir Luziano Araujo que em 2004 plantou uma semente,

ﬁnanciando um curso preparatório pré-vestibular, e hoje colhe este frutos.

A Capes pela bolsa de estudos concedida.

"Conhecer os homens é ser inteligente; conhecer a si mesmo é ser iluminado.
Ultrapassar os outros é ter força; ultrapassar a si mesmo é ser forte.
Saber contentar-se é ser rico. Agir ﬁrmemente é ter propósito". (Lao Zi)

Resumo

O presente trabalho tem como objetivo o estudo do Princípio da Inclusão e Exclusão e
algumas de suas aplicações, resolvemos importantes problemas da análise combinatória,
tratamos das permutações caóticas, das funções sobrejetivas, da função phi de Euler e
por ﬁm o problema de Lucas. As principais fontes desta pesquisa são livros clássicos
de combinatória, porém as releituras deixam a escrita com uma característica simples e
motivadora.

Palavras-chaves: Contagem, Princípio da Inclusão-Exclusão, Permutações Caóticas

Abstract

This work aims to study the Inclusion and Exclusion Principle and some of its applications
, solve important problems in combinatorics , treat the chaotic permutations of sobrejetivas
functions phi function Euler and ﬁnally Luke’s problem. The main sources of this research
are classic combinatorial books, but the readings leave writing with a simple and motivating
feature .

Key-words: Counting, Principle of Inclusion and Exclusion, Permutations Chaotic

Lista de ilustrações

Figura 1.1ﬁgure–Diagrama da relação de dois conjuntos . . . . . . . . . . . . . . . . 14
Figura 1.2ﬁgure–Representação dos conjuntos através de diagrama . . . . . . . . . . 18
Figura 1.3ﬁgure–Retângulo 6X8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
Figura 5.1ﬁgure–Falta Nome da Figura . . . . . . . . . . . . . . . . . . . . . . . . . 40

Lista de tabelas

Tabela 2.1table– À guisa de justiﬁcativa . . . . . . . . . . . . . . . . . . . . . . . . 27

Sumário

1
1.1
1.2
1.3

2
2.1
2.2
2.3
2.4
2.5

3
3.1
3.2
3.3
3.4

4

5
5.1
5.2
5.2.1
5.2.2

Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

O PRINCÍPIO DA INCLUSÃO E EXCLUSÃO . . . . . . . . . . . . 13
Cardinalidade da união de dois conjuntos . . . . . . . . . . . . . . . . 13
Cardinalidade da união de três conjuntos . . . . . . . . . . . . . . . . 16
. . . . . . . . . . . . . . . . 17
Princípio da Inclusão e Exclusão - P.I.E.

PERMUTAÇÕES CAÓTICAS . . . . . . . . . . . . . . . . . . . . . 22
Termo geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
Probabilidade de permutação caótica . . . . . . . . . . . . . . . . . . 25
A permutação caótica por inversão . . . . . . . . . . . . . . . . . . . 26
Uma outra contagem de posição . . . . . . . . . . . . . . . . . . . . . 28
O problema do amigo oculto . . . . . . . . . . . . . . . . . . . . . . . 30

CONTAGEM E FUNÇÕES . . . . . . . . . . . . . . . . . . . . . . . 31
Funções . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
Função injetiva . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Função bijetiva . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Função sobrejetiva . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

A FUNÇÃO DE EULER . . . . . . . . . . . . . . . . . . . . . . . . . 35

O PROBLEMA DE LUCAS . . . . . . . . . . . . . . . . . . . . . . . 37
Os Lemas de Kaplansky . . . . . . . . . . . . . . . . . . . . . . . . . . 37
A solução de Kaplansky . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Determinando U5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Determinando Un . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

REFERÊNCIAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

Introdução

11

.

A combinatória é um ramo da matemática que estuda estruturas e relações discretas.
A principal área estudada é a contagem de objetos de coleções ﬁnitas que satisfazem
certos critérios. Os principiais princípios na análise combinatória é o princípio da adição,
o princípio da multiplicação, o princípio da complementação, o princípio injetivo e o
princípio bijetivo. Neste trabalho daremos a principal importância ao Princípio da Inclusão
e Exclusão e algumas importantes aplicações.

A área com grande interesse pelos estudantes e pesquisadores em matemática,
com crescimento explosivo nas últimas décadas, pela necessidade na teoria dos grafos, em
análise de algoritmos etc. Aparece com grande frequência em questões de Olimpíadas de
Matemática como OBMEP (Olimpíadas Brasileira de Matemática das Escolas Públicas),
OBM (Olimpíadas Brasileira de Matemática) e principalmente a IMO (Internacional
Mathematical Olympiad), esta foi a motivação para a escolha da área, bem como do tema
e a beleza das demonstrações dos teoremas aqui apresentados.

Uma técnica signiﬁcativa para resolver problemas de combinatória é contar o
número de elementos que não pertencem a união de vários conjuntos, não necessariamente
disjuntos, o Princípio da Inclusão e exclusão é um importante método da teoria dos
conjuntos e da combinatória, foi enunciado por Daniel Augusto da Silva (1814-1878) em
1852, à academia de Ciências de Lisboa e publicada em 1854, mais tarde em um trabalho
de James Joseph Sylvester em 1883. Por esta razão a equação 1.1 e equações semelhantes
são chamadas fórmula de “Da Silva", ou “Sylvester"ou também utilizado muitas vezes é a
“fórmula peneira". Esta história, assim como o conteúdo desenvolvido neste trabalho está
contada em (LINT; WILSON, 2001) que é o principal referencial.

Iniciaremos apresentando o princípio da inclusão e exclusão em 1.3 a fórmula é
realmente um exemplo de um princípio que é usado extensivamente na teoria dos números,
no que se refere como “métodos de peneira". Fórmula como esta nos permite encontrar o
número de primos ≤ n2, também chamado crivo de Eratóstenes.

Em seguida, o capítulo 2 é destinado às permutações caóticas, também conhecido
como desarranjo. Faremos a demonstração do termo geral usando o Princípio da Inclusão
e Exclusão, fazemos também da probabilidade da ocorrência de uma permutação caótica
como também um meio de determinar o termo geral por inversão e por ﬁm teremos será
resolvido o famoso problema do amigo oculto.

No capítulo 3 serão feitas inicialmente as contagens de funções injetivas e bijetivas.

SUMÁRIO

12

Em seguida, o destaque do capítulo está na resolução do problema de contar o número de
funções sobrejetivas.

No capítulo 4, apesar de curto, trataremos da função de phi de Euler, que é uma

importante aplicação do Principio da Inclusão e Exclusão.

E por ﬁm, no capítulo 5, faremos a resolução do problema de Lucas e, para esta

resolução, estudaremos o primeiro e o segundo Lema de Kaplansky.

1 O Princípio Da Inclusão e Exclusão

13

A utilização de linguagem dos conjuntos nos permite resolver diversos problemas
de contagem cuja resolução por outros meios seria bastante trabalhoso. Para ilustrar nosso
ponto de vista consideremos o problema de contar quantos são os inteiros, entre 1 e 1000,
que são divisíveis por 5 ou 7.

Para a solução deste problema, denotemos por A o conjunto dos inteiros entre 1 e
1000 que são divisíveis por 5 e B o conjunto dos inteiros entre 1 e 1000 que são divisíveis
por 7. Não é difícil determinar |A| e |B| (usaremos a notação |A| para indicar o número
de elementos do conjunto A).

A solução do nosso problema é a contagem dos elementos que estejam em A ou
estejam em B. Em símbolos, queremos |A ∪ B|. Não podemos simplesmente somar |A| + |B|
pois alguns elementos serão somados duas vezes, a saber, aqueles que são simultaneamente
múltiplos de 5 e de 7, ou melhor, os elementos de A ∩ B o conjunto dos inteiros entre 1 e
1000 que são divisíveis por 35. Em suma, a partir das observações feitas tem que, a solução
do problema é dado por:

|A ∪ B| = |A| + |B| − |A ∩ B|

A fórmula acima é a versão mais simples do problema que vamos tratar neste

trabalho e recebe o nome de Princípio da Inclusão e Exclusão.

Observe que ainda não respondemos a questão proposta, mas ela já foi traduzida

para a linguagem dos conjuntos.

1.1 Cardinalidade da união de dois conjuntos

Investigaremos inicialmente a cardinalidade da união de dois conjuntos, resultado
bastante utilizado na resolução de certos problemas, porém o foco do nosso trabalho está
na cardinalidade do complementar da união de conjuntos.

Dados dois conjuntos A e B, sendo ambos subconjunto de um conjunto S, que
suporem os disjuntos, isto é, A ∩ B = ∅. Neste caso é fácil ver que |A ∪ B| = |A| + |B|. O
mesmo não se veriﬁca quando A ∩ B 6= ∅. De fato, quando A ∩ B 6= ∅, os elementos que
são comum, são contados duas vezes. Assim,

Aﬁrmação: Dados A e B, subconjuntos de S, o número de elementos de A ∪ B é

dado por:

Capítulo 1. O Princípio Da Inclusão e Exclusão

14

|A ∪ B| = |A| + |B| − |A ∩ B|

justiﬁcativa:

Suponhamos que o número de elementos comuns a A e B seja n2 e que além disso
haja n1 elementos que pertençam a A e não a B e n3 elementos que pertençam a B mas
não a A. Vejamos a ﬁgura Figura 1.1.(MORGADO et al., 2001)

Figura 1.1 –

Diagrama da relação de dois conjuntos

Fonte: O Autor.

|A ∪ B| = n1 + n2 + n3

|A| + |B| − |A ∩ B| = (n1 + n2) + (n2 + n3) − n2

= n1 + n2 + n3

= |A ∪ B|

Exemplo 1.1 Quantos inteiros entre 1 e 1000 são divisíveis por 5 ou 7?

Para a solução deste problema, usaremos a notação bxc para representar o maior

dentre os inteiros ≤ x, ou seja, b1, 2c = 1, b5, 9c = 5.

Solução:

Sejam:

A o conjunto dos inteiros entre 1 e 1000 que são divisíveis por 5 e B o conjunto

dos inteiros entre 1 e 1000 que são divisíveis por 7.

Queremos calcular |A ∪ B|. Temos:

n123nnABCapítulo 1. O Princípio Da Inclusão e Exclusão

|A| =

|B| =

|A ∩ B| =

(cid:23)

(cid:23)

(cid:23)

(cid:22) 1000
5
(cid:22) 1000
7
(cid:22) 1000
35

= 200;

= 142;

= 28,

Pelo Princípio da Inclusão e Exclusão, temos:

|A ∪ B| = |A| + |B| − |A ∩ B| = 200 + 142 − 28 = 314

15

(cid:3)

Podemos também representar o número de inteiros entre 1 e 1000 que não são
divisíveis nem por 5, nem por 7. Neste caso, temos 1000 números entre 1 e 1000 e vimos que
existem 314 números que são divisíveis por 5 ou 7, é fácil ver que a resposta do problema
é 1000 − 314 = 686, visto que o problema trata de contar o complementar do conjunto, ou
seja, |A ∪ B|c segue abaixo uma solução formal para o problema.

Exemplo 1.2 Quantos inteiros entre 1 e 1000 não são divisíveis nem por 5, nem por 7?

Solução:

Como A ∪ B são subconjuntos de S. Então:

|S\{A ∪ B}| = |S| − |A ∪ B|

= |S| − (|A| + |B| − |A ∩ B|)

= |S| − |A| − |B| + |A ∩ B|

= 1000 − 200 − 142 + 28

= 686

Conforme veremos mais adiante, esta formulação melhor se adapta às aplicações

que serão apresentadas.

(cid:3)

Capítulo 1. O Princípio Da Inclusão e Exclusão

16

1.2 Cardinalidade da união de três conjuntos

Sejam os conjuntos A, B e C, subconjuntos de um conjunto S. A cardinalidade da

união de três conjuntos é:

|A ∪ B ∪ C| = |A| + |B| + |C| − |A ∩ B| − |A ∩ C| − |B ∩ C| + |A ∩ B ∩ C|

Justiﬁcativa.

|A ∪ B ∪ C| = |(A ∪ B) ∪ C|

= |A ∪ B| + |C| − |(A ∪ B) ∩ C|

= |A| + |B| − |A ∩ B| + |C| − |(A ∩ C) ∪ (B ∩ C)|

= |A| + |B| − |A ∩ B| + |C| − |A ∩ C| − |B ∩ C| + |A ∩ C ∩ B ∩ C|

= |A| + |B| + |C| − |A ∩ B| − |A ∩ C| − |B ∩ C| + |A ∩ B ∩ C|

Exemplo 1.3 Quantos são os anagramas da palavra ESCOLA que têm E em 1o lugar,
ou S em 2o lugar, ou C em 3o lugar?

Solução:

Deﬁna:

A o conjunto dos anagramas de ESCOLA que têm E em 1o lugar;

B o conjunto dos anagramas de ESCOLA que têm S em 2o lugar;

C o conjunto dos anagramas de ESCOLA que têm C em 3o lugar;

Fixando a letra E no 1o lugar, vemos que restam 5 possibilidades para alocar uma
letra no 2o lugar, 4 possibilidades para alocar uma letra no 3o lugar, e assim sucessivamente,
logo |A| = 5 × 4 × 3 × 2 × 1 = 5! = 120. De modo análogo temos que |B| = |C| = 120

Agora ﬁxando as letras E e S no 1o lugar e 2o lugar respectivamente, vemos que
restam 4 possibilidades para alocar uma letra no 3o lugar, 4 possibilidades para alocar
uma letra no 4o lugar, e assim sucessivamente, logo |A ∩ B| = 4 × 3 × 2 × 1 = 4! = 24. De
modo análogo temos que |A ∩ C| = |B ∩ C| = 4! = 24

Por ﬁm, ﬁxando as letras E, S e C no 1o lugar, 2o lugar e 3o lugar respectivamente,
vemos que restam 3 possibilidades para alocar uma letra no 4o lugar, 2 possibilidades para
alocar uma letra no 5o lugar e 1 possibilidade para alocar a última letra do 6o lugar, logo
|A ∩ B ∩ C| = 3! = 6.

Portanto, pelo princípio da inclusão e exclusão, |A ∪ B ∪ C| = |A| + |B| + |C| −

|A ∩ B| − |A ∩ C| − |B ∩ C| + |A ∩ B ∩ C| = 3 · 120 − 3 · 24 + 6 = 360 − 72 + 6 = 294.

Capítulo 1. O Princípio Da Inclusão e Exclusão

17

(cid:3)

Como o foco é a cardinalidade do complementar da união de objetos, segue agora

o mesmo exemplo com este foco.

Exemplo 1.4 Quantos são os anagramas da palavra ESCOLA, onde a letra E não ﬁgura
em primeiro lugar, ou S em segundo lugar, ou C em terceiro lugar.

A resposta é

|S\{A ∪ B ∪ C}| = |S| − |A ∪ B ∪ C|

= 720 − 294

= 426

1.3 Princípio da Inclusão e Exclusão - P.I.E.

Seja S um conjunto com N elementos; E1, . . . , Er subconjuntos não necessariamente
distintos de S. Para qualquer subconjunto de M = {1, . . . , r}, deﬁnimos N (M ) o número
de elementos de S em T
|m|=j N (M ).(LINT;
WILSON, 2001)

i∈M Ei e para 0 ≤ j ≤ r, deﬁnimos Nj := P

Teorema 1.1 O número de elementos de S que não pertence a algum dos Ei, 1 ≤ i ≤ r,
é:

N − N1 + N2 − N3 + · · · + (−1)rNr

(1.1)

Demonstração: (i) Se x ∈ S e x não é elemento de algum dos Ei, então x contribui

1 para a expressão 1.1.

(ii) Se x ∈ S e x pertence a exatamente k conjunto dos subconjuntos Ei, então a

contribuição dele para a equação 1.1 é

1 −

!

 k
1

+

!

 k
2

− · · · + (−1)k

!

 k
k

= (1 − 1)k = 0

(cid:3)

Comentário:

Quando um elemento x pertence a nenhum dos Ei, ele não é contado nas interseções,

logo não contribui para os Ni, 0 ≤ i ≤ r.

Capítulo 1. O Princípio Da Inclusão e Exclusão

18

Assim, ele é contado 1 única vez em N .

(cid:16)k
j

Se por outro lado x pertence a exatamente k dos subconjunto Ei, então sua
(cid:17)
, pois é o número de vezes que ele será contado. De fato,
contribuição ao número Nj é
quando escolhemos j subconjuntos dentre os Ei, se x não pertence a algum deles não fará
parte da interseção e portanto não será contado, logo para que x seja contado é necessário
tomar apenas subconjuntos que tenham x como elemento, e
é o número de modos de
escolher j subconjuntos dentre aqueles têm x como elemento.

(cid:16)k
j

(cid:17)

Exemplo 1.5 Seja S = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10} e E1 = {2, 3, 5, 7}, E2 = {2, 4, 7, 9}
subconjuntos de S. Determine quantos elementos de S que não são elementos de E1 ∪ E2.

Figura 1.2 –

Representação dos conjuntos através de diagrama

Fonte: O Autor.

Como N = 10, N1 = P

|M |=1 N (M ) = |E1| + |E2| = 4 + 4 = 8 e N2 =
|M |=2 N (M ) = |E1 ∩ E2| = 2 então, o número de elementos de S que não são elementos

P

de E1 ∪ E2 é N − N1 + N2 = 10 − 8 + 2 = 4

(cid:3)

Exemplo 1.6 (Crivo de Eratosthenes) Determine o número de primos ≤ n.

√

Seja n ≥ 2 um inteiro, e seja S o conjunto dos inteiros de 1 a n. Sejam p1 < p2 <
. . . < pr os primos ≤
n. Indiquemos por Ei um subconjunto de S formado pelos inteiros
que são divisíveis por pi (incluindo o próprio pi). Então E1 ∪ E2 ∪ . . . ∪ Er é o conjunto
dos inteiros de 1 a n que são compostos e mais os primos acima. Lembrando que 1 não é
primo, a quantidade de números primos de 1 a n é

12345678910ES2E1Capítulo 1. O Princípio Da Inclusão e Exclusão

19

n + r − 1 − |E1 ∪ E2 ∪ . . . ∪ Er| =
= n + r − 1 − N1 + N2 + . . . + (−1)rSr =
k
k
− P

+ P

k

j

1≤i<j<k≤r

1≤i<j≤r

j n
pipj

n
pipj pk

j n
pi

+ . . . + (−1)r j

k

n
p1p2...pr

= n + r − 1 − Pr

i=1

Esta fórmula foi apresentada por Legendre em 1808 para determinar a quantidade

de números primos ≤ n (PATERLINI, 2002)

Exemplo 1.7 Um Retângulo a × b é feito de quadrados unitários. Por quantos quadrados
unitários a diagonal do retângulo passa? (SHINE, 2015)

Vamos analisar o que acontece com um retângulo 6 × 8, veja a ﬁgura abaixo

Figura 1.3 –

Retângulo 6X8

Fonte: O Autor.

A letra A signiﬁca mudança na horizontal e a letra B, mudança na vertical.

Ao analisar o caso acima vemos que há duas repetições, uma no começo e outra
na casa (3, 4). Vemos também que mdc(6, 8) = 2 e (6, 8) = 2 · (3, 4). Como mcd(a, b) = t,
ocorre repetições nas casas da forma (k a
t ), k = 0, 1, . . . , t − 1. Logo devemos subtrair
mdc(a, b) no caso bidimensional e a resposta é a + b − mdc(a, b)

t , k b

(cid:3)

Podemos enunciar o mesmo problema diante de um Paralelepípedo m × n × p.
Denotemos de L, T e V os conjuntos dos cubos unitários cortados primeiramente na
longitudinal, transversal e vertical, respectivamente, queremos.

|L ∪ T ∪ V | = |L| + |T | + |V | − |L ∩ T | − |L ∩ V | − |T ∩ V | + |L ∩ T ∩ V |

= m + n + p − mdc(m, n) − mdc(m, p) − mdc(n, p) + mdc(m, n, p)

ABABAAAAABBBABCapítulo 1. O Princípio Da Inclusão e Exclusão

20

Outro tipo de problema em que podemos facilmente ver como tal técnica é aplicável,
é uma generalização do problema de enumerar soluções inteiras de equações. Vejamos
abaixo um exemplo com esta aplicação.

Exemplo 1.8 Encontre todas as soluções inteiras e não negativas da equação x1 + x2 +
x3 + x4 = 100, quando x1 > 0, x2 ≥ 0, 0 ≤ x3 ≤ 7 e 2 ≤ x4 ≤ 10.(KELLER; TROTTER,
2015)

Primeiramente, usaremos na solução deste problema, o número de soluções inteiras e
(cid:17)
.

não negativas de x1 +x2 +. . .+xn = p que é CRp
n+p−1 =
De acordo com (MORGADO et al., 2001) podemos observar com mais detalhes.

p+n−1 = (n+p−1)!

p!(n−1)! = C p

n = P p,n−1

(cid:16)n+p−1
p

Vamos conﬁgurar o problema para que o limite inferior de cada variável é da forma

xi ≥ 0.

Fazendo x1 = x0

1 + 1 e x4 = x0

4 + 2, temos:

• x1 > 0 ⇔ x1 − 1 > 0 − 1 ⇔ x0

1 > −1 ⇔ x0

1 ≥ 0

• 2 ≤ x4 ≤ 10 ⇔ 2 − 2 ≤ x4 − 2 ≤ 10 − 2 ⇔ 0 ≤ x0

4 ≤ 8.

Isso nos leva ao problema revisto de enumerar as soluções inteiras e não negativas
1 + x2 + x3 + x0

4 ≥ 0, x3 ≤ 7 e x0

4 = 97 com x0

1, x2, x3, x0

4 ≤ 8.

para x0

Para contar o número de soluções inteiras e não negativas para esta equação com

3 ≤ 7 e x0
x0

4 ≤ 8, devemos excluir qualquer solução em que x3 > 7 ou x0

4 > 8.

Temos

(cid:17)

(cid:16)92
3

soluções em x3 > 7, pois:

Fazendo x3 = a + 8 temos agora a seguinte equação x0
4 ≥ 0 e o número de soluções desta equação é

(cid:16)89+4−1
89

1 + x2 + a + x0
(cid:16)92
89

=

=

4 = 89 com
(cid:16)92
3

(cid:17)

(cid:17)

(cid:17)

.

1, x2, a, x0
x0

E o número de soluções com x0

4 > 8 é

(cid:17)

(cid:16)91
3

, desta forma:

Fazendo x0

o número de soluções desta equação é

4 = b + 9 temos a equação x0
(cid:16)88+4−1
88

1 + x2 + x3 + b = 88 com x0
(cid:16)91
(cid:17)
3
(cid:17)

(cid:16)91
88
(cid:17)

(cid:17)
.

=

=

(cid:17)

(cid:17)

(cid:16)92
3

e

(cid:16)91
3

de

(cid:16)100
3

1, x2, x3, b ≥ 0 e

Pode ser tentador que apenas subtraia

, o número total de

soluções com todas as variáveis não negativas.

No entanto, é necessário cuidado. Se ﬁzermos isso, teríamos que eliminar as soluções
soluções com

4 > 8 duas vezes. Notamos também que existem

(cid:17)

(cid:16)83
3

com ambos x3 > 7 e x0
ambos x3 > 7 e x0
4 > 8.

Este detalhe monstra que se trata do Princípio da Inclusão e Exclusão e de acordo

com teorema 1.1, vemos que a resposta deste problema é:

Capítulo 1. O Princípio Da Inclusão e Exclusão

21

Para dar conta disso, notamos que existem

(cid:17)

(cid:16)83
3

soluções com ambos x3 > 7 e

x0
4 > 8.

N − N1 + N2

!

 100
3

−

!

 92
3

−

!

 91
3

+

!

 83
3

= 6516

(1.2)

2 PERMUTAÇÕES CAÓTICAS

22

Neste capítulo iremos tratar de desarranjo, também conhecidos como permutação
caótica ou derangement (do francês) é uma permutação em que nenhum elemento do
conjunto permanece na sua posição de origem. Com essa interpretação desenvolveremos
o termo geral das permutações caóticas e com isso resolveremos clássico problema do
amigo oculto também conhecido como o problema das cartas mal endereçadas proposto
por Nicolaus Bernoulli (1687-1759).

2.1 Termo geral

Seja a função π : {1, . . . , n} → {1, . . . , n} uma bijeção que não possui pontos ﬁxos,
ou seja, nenhum elemento do conjunto permanece na sua posição de origem. Faremos um
exemplo da função π para n = 3.

Exemplo 2.1 Para a função π : {1, 2, 3} → {1, 2, 3}, temos o seguinte conjunto imagem.
Imπ = {(1, 2, 3), (1, 3, 2), (3, 2, 1), (3, 1, 2), (2, 1, 3), (2, 3, 1)}

Seja Sn = {π : {1, . . . , n} → {1, . . . , n} : π é bijeção }. Queremos saber quantos
elementos possui o conjunto Sn, neste caso temos n modos de escolher a imagem do
primeiro elemento, n − 1 modos de escolher a imagem do segundo elemento, . . ., 1 modo de
escolher a imagem que ocupará o último elemento, lembrando que nesta contagem, basta
a função ser injetiva (ou sobrejetiva). Portanto |Sn| = n!, ou seja, o número de elementos
de Sn é n!.

Deﬁnição 2.1 Uma permutação dn de {1, . . . , n} é chamada caótica quando π(i) 6= i para
todo i.

Deﬁna o conjunto Ei = {π ∈ Sn : π(i) = i} com i ∈ {1, . . . , n} como o conjunto

das permutações onde i situa-se na sua posição original.

Exemplo 2.2 Para n = 3 temos que E1 = {(1, 2, 3), (1, 3, 2)}; E2 = {(1, 2, 3), (3, 2, 1)};
E3 = {(1, 2, 3), (2, 1, 3)}.

Teorema 2.1 Seja S = Sn e ponha Ei, como sendo subconjuntos daquelas permutações π
com π(i) = i. Então,

dn =

n
X

i=0

(−1)i

!

 n
i

(n − i)! = n!

n
X

i=0

(−1)i
i!

(2.1)

Capítulo 2. PERMUTAÇÕES CAÓTICAS

23

Prova 1: De acordo com o capítulo anterior, basta calcularmos quantos elementos
possui Nj = P
subconjuntos de tamanho j e ﬁxado M
tal que |M | = j sobram n − j posições para permutar, logo N (M ) = (n − j)!. Daí,
j! . Portando, de acordo com o teorema 1.1, temos.
Nj =

|M |=j N (M ), com isto temos

j!(n−j)! · (n − j)! = n!

· (n − j)! = n!

(cid:16)n
j

(cid:16)n
j

(cid:17)

(cid:17)

dn = N − N1 + N2 − · · · + (−1)nNn

dn = n! − n! ·

− · · · + n! ·

+ n! ·

1
2!

1
2!

− · · · +

#

(−1)j
j!

1
1!
1
1!
(−1)j
j!

+

"
1 −

n
X

j=0

dn = n!

dn = n!

(−1)n
n!

(cid:3)

Prova 2:

De acordo com (BRUALDI, 2009), faremos também o método recursivo para as
permutações caóticas. Seja dn o número de permutações caóticas com n elementos, podemos
dividi-las em dois conjuntos, de acordo com o último elemento da permutação caótica.

• Se o último elemento é k e o k-ésimo elemento é n, hà n − 1 escolhas para k e dn−2

escolhas para as posições dos outros n − 2 elementos. Total: (n − 1)dn−2.

• Se o último elemento é k é o k-ésimo elemento não é n, hà n − 1 escolhas para k e
dn−1 escolhas para as posições dos outros n − 1 elementos (em que tratamos n como
se fosse k). Total: (n − 1)dn−1.

Então somando os dois casos temos dn = (n − 1)(dn−2 + dn−1), com d1 = 0 e d2 = 1.

Neste caso podemos reescrever a fórmula acima:

dn = (n − 1)dn−2 + (n − 1)dn−1

dn = ndn−1 − dn−1 + (n − 1)dn−2

dn − ndn−1 = −[dn−1 − (n − 1)dn−2]. (n ≥ 3)

Veja que o lado direito da expressão, é o mesmo que no lado esquerdo sendo n

substituído por n − 1. Assim podemos aplicar o método de recurssão.

Capítulo 2. PERMUTAÇÕES CAÓTICAS

24

dn − ndn−1 = −[dn−1 − (n − 1)dn−2]

= (−1)2[dn−2 − (n − 2)dn−3]
= (−1)3[dn−3 − (n − 3)dn−4]
...
= (−1)n−2(d2 − 2d1).

Desde que que d2 = 1 e d1 = 0, obtemos a simples recurssão.

dn = ndn−1 + (−1)n−2

O número de permutações caóticas é equivalente a,

dn = ndn−1 + (−1)n para n = 2, 3, 4, . . .

(2.2)

De acordo com a fórmula encontrada recursivamente, observe que:

d3 = 3d2 − 1 = 3 − 1 = 3!

  1
2!

−

!

1
3!

d4 = 4d3 + 1 = 4(3d2 − 1) + 1 = 4 · 3d2 − 4 + 1 = 4 · 3 − 4 + 1 = 4!

d5 = 5d4 − 1 = 5(4 · 3 − 4 − 1) − 1 = 5 · 4 · 3 − 5 · 4 + 5 − 1 =

dn = n!

  1
2!

−

1
3!

+

1
4!

−

1
5!

+ . . . + (−1)n 1
n!

!

. ∀n ≥ 2

  1
2!

!

  1
2!
1
3!

−

−

+

1
3!
1
4!

+

−

1
4!
1
5!

!

(2.3)

Usando a Princípio da Indução Finita, faremos a validade de que (2.2)⇒(2.3) para

todo n natural e n ≥ 2.

De fato, para n = 2, temo que d2 = 2!(1/2!) = 1.

Suponha, a hipótese da indução, que dn seja verdadeira para algum n − 1, ou seja:

dn−1 = (n − 1)!

  1
2!

−

1
3!

+

1
4!

+ . . . + (−1)n−1

!

1
(n − 1)!

Multiplicando ambos membros da igualdade por n, temos:

dn−1 = n(n − 1)!

  1
2!

−

1
3!

+

1
4!

+ . . . + (−1)n−1

!

1
(n − 1)!

Capítulo 2. PERMUTAÇÕES CAÓTICAS

25

Substituindo ndn−1 por dn − (−1)n.

dn − (−1)n = n(n − 1)!

  1
2!

−

1
3!

+

1
4!

+ . . . + (−1)n−1

dn = n!

dn = n!

  1
2!
  1
2!

−

−

1
3!
1
3!

+

+

1
4!
1
4!

+ . . . + (−1)n−1

+ . . . + (−1)n 1
n!

1
(n − 1)!
!

!

1
(n − 1)!
!

+ (−1)n

Portanto, pelo princípio da indução ﬁnita temos que dn é valido para todo n ∈ N.

(cid:3)

O teorema 2.1 pode ser formulado de modo recursivo a partir de n e n − 1. Segue

abaixo o desenvolvimento,

dn = n!

= n!

  1
0!
  1
0!

−

−

− · · · +

!

(−1)n
n!

1
2!

− · · · +

(−1)n−1
(n − 1)!

= n(n − 1)!

1
1!
= n · d(n−1) + (−1)n

−

+

1
2!

− · · · +

1
1!
1
1!
  1
0!

+

+

(−1)n
n!
(−1)n−1
(n − 1)!

!

!

+ (−1)n

(2.4)

2.2 Probabilidade de permutação caótica

Veremos a seguir que, à partir desta fórmula, para grandes valores de n, a probabi-
lidade de uma permutação caótica é próximo de e−1. Para tal mostração enunciaremos
primeiro a Série de Taylor.

Série de taylor Seja f : I → R, derivável tantas vezes quantas de deseje, em
todos os pontos do intervalo I. Se a é interior ao intervalo I e a + h ∈ I, então podemos
escrever, para todo n ∈ N:

f (a + h) = f (a) + f 0(a) · h +

f 00(a)
2!

· h2 + · · · +

f (n−1)(a)
(n − 1)!

· h(n−1) + rn(h),

onde rn(h) = f (n)(a+θnh)

· hn, para algum 0 < θn < 1.

n!
A série P∞

n=0

a.

f (n)(a)
n!

· hn chama-se a série de Taylor da função f em torno do ponto

Capítulo 2. PERMUTAÇÕES CAÓTICAS

26

Seja f : R → R a função exponencial: f (x) = ex. Então suas derivadas sucessivas
são todas iguais a ex , isto é, f n(x) = ex, para todo n ∈ N e todo x ∈ R. A fórmula de
Taylor em torno do 0 tem o aspecto:

ex = 1 + x +

x2
2!

+ · · · +

xn
n!

+

ecn
(n + 1)!

· xn+1

com |cn| < |x|. Evidentemente, para todo x ∈ R ﬁxo, o resto rn+1(x) = ecn
para 0 quando n → ∞. A série de Taylor converge para a ex e

(n+1)! · xn+1 tende

ex = 1 + x +

x2
2!

+ · · · +

xn
n!

+ · · ·

Fazendo x = −x temos

e−x = 1 + (−x) +

=

∞
X

j=0

(−1)j
j!

(−x)2
2!

+

(−x)3
3!

· · · +

(−x)n
n!

+ · · ·

(x)j

(2.5)

Tomando arbitrariamente uma permutação, a probabilidade de que ela seja uma

permutação caótica é:

p(n) =

n!

(−1)j
j!

n
P
j=0
n!

=

∞
X

j=0

(−1)j
j!

Usaremos a notação pn para a probabilidade de uma permutação caótica, onde

p(n) = P (π ∈ dn) tal que d(n) = {π ∈ Sn : π é desarranjo}.

Logo,

lim
n→∞

p(dn) = 1

e = e−1

2.3 A permutação caótica por inversão

Nesta seção veremos que podemos obter a equação 2.1 por meio por meio de

inversão.

Considere a série de potência D(x) :=

∞
P
n=0

dn

xn
n! (d0 = 1) e deﬁna F (x) := ex · D(x),

logo:

Capítulo 2. PERMUTAÇÕES CAÓTICAS

F (x) =





∞
X

j=0

xn
n!


 ·





∞
X

n=0

dn





xn
n!

∞
X

=

Am xm ,com

Am =

m=0
m
X

r=0
m
X

r=0
1
m!

=

=

·

1
r!
1
m!
m
X

r=0

·

dm−r
(m − r)!
m!
(m − r)!r!
 m
r

dm−r

!

dm−r

Substituindo a equação 2.7 em 2.6 temos:

F (x) =

∞
X





m
X

m=0

r=0

!

 m
r

dm−r





xm
m!

27

(2.6)

(2.7)

O número de permutações de 1, 2, · · · , m que têm exatamente r elementos no seu
· dm−r. Como toda permutação tem 0, 1, 2, · · · ou m elementos no
(cid:17)

(cid:17)

(cid:17)

dm−r é igual ao total de permutações, isto é,

dm−r = m!

lugar original é

lugar original,

(cid:16)m
r
(cid:16)m
r

m
P
r=0

m
P
r=0

(cid:16)m
r

Com isto

F (x) =

∞
X





m
X

r=0

!

 m
r

dm−r





xm
m!

m=0
∞
X

(m!)

xm
m!

m=0
∞
X

xm

=

=

m=0
= (1 − x)−1

Tabela 2.1 –

À guisa de justiﬁcativa

a) (1 + x + x2 + x3 + . . .)(1 − x) = (1 − x) + (x − x2) + (x2 − x3) + . . . = 1
Logo 1 + x + x2 + . . . = 1
1−x
b) Soma de Progressão Geométrica (P.G.)
1 + x + x2 + . . . + xn = 1−xn+1
1−x
Se |x| < 1, então lim
n→∞
1 + x + . . . + xn + . . . = 1
1−x

xn+1 = 0, logo

Vejamos que F (x) = ex · D(x) =

igualdade, temos:

∞
P
m=0

xm. Multiplicando e−x em ambos os lados da

Capítulo 2. PERMUTAÇÕES CAÓTICAS

28

F (x) = ex · D(x)

e−x · F (x) = D(x)
∞
X



D(x) =



j=0

substituindo a equação 2.5

(−1)j
j!


 ·





xj



xm



∞
X

m=0

∞
X

=

bAm xm ,com

bAm =

m=0
m
X

(−1)i
i!

Contudo,

i=0

D(x) =

∞
X





m
X

m=0

i=0

(−1)i
i!


xm

=

=

∞
X

m=0
∞
X

m=0


m!

m
X

i=0

(−1)i
i!





xm
m!

dm

xm
m!

dm = m!

m
X

j=0

(−1)i
i!

Portanto:

2.4 Uma outra contagem de posição

Nesta seção vamos considerar um problema de contagem de permutações em que
exige certas posições proibidas. Iremos usar o Princípio da Inclusão e Exclusão para contar
o número destas permutações.

Vamos introduzir o problema da seguinte maneira: suponha que uma classe de oito
meninos caminham todos os dias. Os estudantes caminham em linha, de modo que cada
menino exceto o primeiro é precedido por outro, ou seja, em ﬁla única. Para que a mesma
criança não veja a mesma pessoa na frente dele, no segundo dia, os alunos decidem alternar
posições para que nenhum menino é precedido pelo mesmo rapaz que o procederam no
primeiro dia. De quantas maneiras elas podem alternar posições?

Uma possibilidade é inverter a ordem dos meninos, para que o primeiro rapaz seja
agora o último, e assim por diante, porém existe ainda outras possibilidades. Se atribuirmos
aos rapazes os números 1, 2, . . . , 8, então nós determinamos o número de permutações do

Capítulo 2. PERMUTAÇÕES CAÓTICAS

29

conjunto {1, 2, . . . , 8} em que os padrões 12, 23, . . . , 78 não ocorram. Assim, 31542876 é
uma permutação admissível, mas 84312657 não é. De modo geral, para cada inteiro positivo
n, nós deixamos Qn como o número de permutações de {1, 2, . . . , n} em que nenhum dos
padrões 12, 23, . . . , (n − 1)n, ocorra. Usaremos o Princípio da Inclusão Exclusão para
calcular Qn.

Vejamos que se n = 1, então 1 é uma permutação permissível. Se n = 2, então 21 é
uma permutação permissível. Se n = 3, então 213, 321, 132 são permutações permissíveis.
Vejamos a solução da prova dada por (BRUALDI, 2009) do teorema.

Teorema 2.2 Para n ≥ 1,

Qn = n! −

!

 n − 1
1

(n − 1)! +

!

 n − 1
2

(n − 2)! − . . . + (−1)n−1

 n − 1
n − 1

!

1!

(2.8)

Prova: Seja N o conjunto de todas as n! permutações de {1, 2, . . . , n}, Logo
N = n!. Seja Pj a propriedade de que, em uma permutação, o padrão j(j + 1) não ocorre,
j ∈ {1, 2, . . . , n − 1}. Assim, a permutação (1, 2, . . . , n) é contada no número Qn se, e
apenas se, não tem nenhuma das propriedades, P1, P2, . . . , P(n−1). Seja Ei o conjunto de
permutações de {1, 2 . . . , n} que satisfaz a propriedade Pi, com j ∈ {1, 2, . . . , n − 1}.
Então, usando o teorema 1.1

Qn = N − N1 + N2 − N3 + · · · + (−1)n−1Nn−1

Calculemos o número de permutações de E1. Sabemos que uma permutação de
E1 ocorre se, e apenas se, o padrão 12 ocorre. Assim, uma permutação em E1 pode
ser considerada como uma permutação dos símbolos {12, 3, 4, . . . , n}. Concluímos que
|Ei| = (n − 1)! e em geral temos:

N1 = X

N (M ) =

|M |=1

!

 n − 1
1

(n − 1)!

Permutações que estão em dois dos conjuntos de E1, E2, . . . , En−1, contem dois
padrões. Esses padrões podem ser do tipo 12 e 23, ou do tipo 12 e 34, onde não possuem
elementos em comum. A permutação que contém dois padrões 12 e 23 contém o padrão 123
e a permutação contém n − 2 elementos, ou seja, {123, 4, . . . , n}, logo |E1 ∩ E2| = (n − 2)!
e a permutação que contém dois padrões 12 e 34, a permutação contém (n − 2)! elementos
{12, 34, 5, . . . , n}, logo |A1 ∩ A3| = (n − 2)!. Em geral:

N2 = X

N (M ) = X

|Ei ∩ Ej| =

|M |=2

1≤i≤j≤n

 n − 1
2

!

(n − 2)!

Capítulo 2. PERMUTAÇÕES CAÓTICAS

30

Geralmente, vemos que uma permutação que contém k padrões especiﬁcados na
lista 12, 23, . . . , (n−1)n pode ser considerados como uma permutação de (n−k) elementos
e portanto:

| \
ik∈M

| = (n − k)! para cada k subconjunto {i1, i2,

, ik} de {1, 2, . . . , n − 1}.

desde que k ∈ {1, 2, . . . , n − 1}.

Logo Nk = P

|M |=k N (M ) = P

1≤ik≤n−1

T

ik∈M =

(cid:17)

(cid:16)n−1
k

(n − k)!

portanto:

Qn = N − N1 + N2 − N3 + · · · + (−1)n−1Nn−1

Qn = n! −

!

 n − 1
1

(n − 1)! +

 n − 1
2

!

(n − 2)! − . . . + (−1)n−1

 n − 1
n − 1

!

1!

O número Q1, Q2, Q3, . . . estão intimamente relacionados com os números de

desarranjo. Com efeito, temos Qn = dn + dn−1, (n ≥ 2)

2.5 O problema do amigo oculto

Seja uma brincadeira de “amigo oculto”, na qual n pessoas escrevem seu nome
num pedaço de papel e o depositam num recipiente, de onde cada um pega aleatoriamente
um dos pedaços de papel. Qual a probabilidade de ninguém pegar seu próprio nome?

Foi publicada a solução deste clássico problema pelo professor Carlos Gustavo
Tamm de Araujo Moreira, na revista do professor de matemática número 15, sabendo
também que Leonhard Euler no século XVIII empenhou-se em solucionar o problema
conhecido como ‘o problema das cartas mal endereçadas” (consiste em descobrir de quantas
formas distintas pode-se colocar n cartas em n envelopes, endereçados a n destinatários
diferentes, de modo que nenhuma das cartas seja colocada no envelope correto).

Vemos que o número total de maneiras dos n itens serem permutados sem que
nenhum volte a sua posição de origem é d(n) e o número total de permutações dos n itens
é n!. Portanto a probabilidade procurada é:

p(n) =

(−1)j
j!

n! Pn

j=0
n!

≈

∞
X

j=0

(−1)j
j!

= e−1 ∼= 0, 37

(cid:3)

3 CONTAGEM E FUNÇÕES

31

O estudo de funções nos trazem problemas de contagem muito interessantes.
Iniciaremos o capítulo com as contagens mais simples, como a de funções. Trataremos
também a contagem das funções injetivas e bijetivas, porém a ordem de importância das
seções será com relação à diﬁculdade em sua contagem, com isso ﬁca explicito ao leitor que
trataremos primeiramente de funções injetivas e bijetivas e por ﬁm das funções sobrejetivas,
pois estas possuem um maior grau de diﬁculdade.

3.1 Funções

Iniciaremos a seção com a deﬁnição de função, assim, temos condições de contar
quantas são as funções f : A → B, sabendo que A possui n elementos e B possui m
elementos.

Deﬁnição 3.1 Dados dois conjuntos A, B, uma função f : A → B (lê-se “uma função
de A em B”) é uma regra que permite associar a cada elemento x ∈ A, um único elemento
f (x) ∈ B.

O conjunto A chama-se o domínio e B é o contra-domínio da função f . Para cada
x ∈ A, o elemento f (x) ∈ B chama-se a imagem de x pela função f , ou o valor assumido
pela função f no ponto x ∈ A. Escreve-se x 7→ f (x) para indicar que f transforma x em
f (x).

Iremos contar as funções f : A → B quando A possui n elementos e B possui m
elementos. De acordo com a deﬁnição dada, para cada elemento de A, devemos escolher
um elemento qualquer da imagem em B, ou seja, temos m para a escolha da imagem do
primeiro elemento de A, m modos para a escolha segundo elemento, m modos de escolher
a imagem do terceiro elemento e assim sucessivamente. Concluímos então que o número
de funções f : A → B é m × m × m × . . . × m
}

= mn

{z

|

n

elementos

Exemplo 3.1 O conjunto A possui 5 elementos e o conjunto B possui 8 elementos.
Quantas são as funções f : A → B?

A resposta para este problema é 85 = 32768 funções.

Capítulo 3. CONTAGEM E FUNÇÕES

32

3.2 Função injetiva

Uma função f : A → B chama-se injetiva quando elementos diferentes em A são

transformados por f em elementos diferentes em B. Ou seja, f é injetiva quando:

x 6= x0

em X ⇒ f (x) 6= f (x0)

Seja A um conjunto com n elementos e B com m elementos. Quantas são as funções

injetivas f : A → B (m ≥ n)?

Como elementos diferentes devem ter imagens diferentes, há m modos de escolher
a imagem do primeiro elemento de A, (m − 1) modos de escolher a imagem do segundo
elemento de A, e assim sucessivamente. Portanto, a resposta é m · (m − 1) · (m − 2) · · · (m −
n + 1).

Exemplo 3.2 O conjunto A possui 8 elementos e o conjunto B possui 10 elementos.
Quantas são as funções injetoras f : A → B?

A resposta é 10 × 9 × 8 × 7 × 6 × 5 × 4 × 3 = 1814400

3.3 Função bijetiva

Uma função f : A → B chama-se bijetiva quando é injetiva e sobrejetiva ao mesmo

tempo.

Para contar o número de funções bijetivas f : A → B, devemos primeiramente
notar que o número de elementos do conjunto A deve ser igual ao número de elementos do
conjunto B, ou seja, |A| = |B|, e neste caso, seja |A| = |B| = n. O valor de f (a1) pode ser
escolhido de n modos, o valor de f (a2) de n − 1 modos e assim sucessivamente. Portanto,
o número de funções bijetivas é n · (n − 1) · (n − 2) · · · (1) = n!. A demonstração rigorosa
para este caso, se dá pelo princípio da indução ﬁnita

Exemplo 3.3 Se A é um conjunto com 5 elementos, quantas são as funções f : A → A
bijetoras?

A resposta é 5! = 120 funções bijetivas.

3.4 Função sobrejetiva

Uma função f : A → B chama-se sobrejetiva quando, para qualquer elemento

y ∈ B, pode-se encontrar um elemento x ∈ A tal que f (x) = y.

Capítulo 3. CONTAGEM E FUNÇÕES

33

Mais geralmente, chama-se imagem do subconjunto X ⊂ A pela função f : A → B
ao subconjunto f (X) ⊂ B formado pelos elementos f (x), com x ∈ X. A função f : A → B
é sobrejetiva quando f (A) = B. O conjunto f (A), imagem do domínio A pela função f ,
chama-se também a imagem da função f .

Mostraremos agora quantas são as funções f : A → B sobrejetivas quando |A| = n

e |B| = p.

Primeiramente contamos quantas são as funções f : A → B, temos então pn funções
f : A → B, pois para cada um dos n elementos de A há p modos de escolher sua imagem.

Chamaremos os elementos de B de b1, b2, . . . , bp, vejamos que as funções que não são
sobrejetivas são aquelas em que b1, ou b2, . . ., ou bp não fazem parte do conjunto imagem
da função. Chamando, para j = 1, 2, . . . , p de Aj o conjunto das funções f : A → B em
que bj não pertence ao conjunto imagem, as funções que não são sobrejetivas são as que
pertencem a A1 ∪ A2 ∪ . . . ∪ Ap.

Portanto, o número de funções sobrejetivas é:

N − N1 + N2 − N3 + . . . + (−1)pNp =
(cid:17)
(cid:16)p
(cid:17)
(p − 1)n +
p

(p − 2)n + . . . + (−1)

(cid:16)p
2

(cid:17)

(cid:16)p
1

= pn −

(p − p)n =

= Pp

k=0 (−1)k(cid:16)p

k

(cid:17)

(p − k)n

Quando n = p, teremos o conjunto A com mesmo número de elementos de B e
como f é sobrejetiva, então cada elemento y ∈ B possui um único correspondente x ∈ A tal
que f (x) = y, logo f é injetora, ou seja, f é bijetora e neste caso, o número de sobrejeções
é n!, conforme na seção 3.3.

Por outro lado, se p > n, a deﬁnição 3.1 diz que, cada elemento x ∈ A possui um
único correspondente y ∈ B tal que f (x) = y, pelo princípio das Gavetas de Dirichlet,
chamamos cada elemento x ∈ A em objetos e y ∈ B em gavetas, como temos mais
gavetas que objetos, o princípio assegura que haverá gavetas sem objetos, logo o número
de sobrejeções é 0.

Portanto:

p
X

k=0

(−1)k

 p
k

!

(p − k)n =




n!


0

se p = n

se p > n

(3.1)

Existem muitas fórmulas análogas a esta que geralmente são difíceis de provar de
modo direto. A ocorrência de (−1)i é, em geral, um sinal de que a contagem de certo
objeto utilizando o P.I.E. pode produzir a prova, como neste exemplo. Entretanto, neste
caso é bastante útil ver outra demonstração.

Capítulo 3. CONTAGEM E FUNÇÕES

34

Seja P (x) um polinômio de grau n. com maior coeﬁciente an, ou seja, P (x) =
a0 + a1x + a2x2 + . . . + an−1xn−1 + anxn. Denotamos a sequência de valores P (0), P (1), . . .
de P . Consideramos agora a sequência de diferenças P (1) − P (0), P (2) − P (1), . . ..

Fazendo Q1(x) := P (x + 1) − P (x) temos :

Q1(x) : = P (x + 1) − P (x)

= a0 + a1(x + 1) + a2(x + 1)2 + . . . + an(x + 1)n − a0 − a1x − a2x2 − . . . + anxn
= a1(x + 1 − x) + a2((x + 1)2 − x2) + . . . + an((x + 1)n − xn)
 n
   n
0

= a1 + a2(2x + 1) + . . . + an

xn−1 + . . . +

 n
1

n − 1

x +

!!

!

!

Vemos que Q1(x) é um polinômio de grau (n − 1) com maior coeﬁciente nan.
Repetindo este procedimento várias vezes encontramos uma sequência Qp cujos termos
são Pp
P (x + p − k), correspondente ao polinômio Qp(x) de grau n − p com
maior coeﬁciente n(n − 1) . . . (n − p + 1)an. Se p = n, então todos os termos de Qp são
n!an e se p > n, então são todos 0. Tome P (x) = xn. Encontraremos novamente 3.1

k=0(−1)k(cid:16)p

(cid:17)

k

4 A FUNÇÃO DE EULER

35

A função tociente, ou função phi (lê-se ﬁ), também conhecida como função phi de
Euler, em homenagem ao matemático Leonhard Euler (1707-1783), tem muitas conexões
com a teoria dos números, porém este trabalho está em deﬁnir a função e mostrar uma
aplicação do princípio da inclusão e exclusão, como veremos neste capítulo. Deﬁnida para
um número inteiro x como sendo igual a quantidade de números menores ou igual a x
coprimos com respeito a ele.

Denotamos ϕ(n) o número de inteiros k com 1 ≤ k ≤ n onde m.d.c.(n, k) = 1

(m.d.c. - máximo divisor comum). Isto deﬁne uma importante função

ϕ : Z∗

+ → Z+,

ϕ(n) → |{k ∈ Z+/1 ≤ k ≤ n, m.d.c.(n, k) = 1}|

chamada função phi de Euler

Assim, para n = 12, temos, ϕ(12) = 4 pois os inteiros positivos que não superam
12 e são primos com 12 são 1, 5, 7, e 11 e para n = 9, ϕ(9) = 6 pois os inteiros positivos
que não superam 9 e são primos com 9 são 1, 2, 4, 5, 7, 8.

Calcular ϕ(2016) acaba se tornando uma tarefa bastante trabalhosa, neste caso,
teremos que analisar todos os número entre 1 e 2016 que são primos com 2016, vejamos
abaixo um teorema que facilita esta contagem.

Teorema 4.1 Se n = pa1

1 pa2

2 · · · par

r é a decomposição de n em fatores primos, então

ϕ(n) = n −

r
X

i=1

n
pi

+ X

1≤i<j≤r

n
pipj

− · · · = n

r
Y

i=1

(1 −

1
pi

)

(4.1)

Prova: Usando o Princípio da Inclusão-exclusão e fazendo:

Ei = {k ∈ N / k ≤ n, pi|k}, onde 1 ≤ i ≤ r.

Com isto temos que |Ei| = n
pi

e para s interseções temos:

Ai1 ∩ . . . ∩ Ais = {k ∈ N/ k ≤ n, pi1|k, · · · , pis|k}, logo |Ai1 ∩ . . . ∩ Ais| = n

pi1 ···pis

Portanto:

Capítulo 4. A FUNÇÃO DE EULER

ϕ(n) = N − N1 + N2 − N3 + · · · + (−1)rNr
!

  r

!

− · · · + (−1)r

= n −

X

n
pi
!

+

· · ·

X

n
pipj

1≤i<j≤r
!
1
pr

1 −

i=1
1
p1

1 −

= n

= n

r
Y

i=1

(1 −

1
pi

)

n
p1p2 . . . ps

36

(cid:3)

Exemplo 4.1 Usando o desenvolvimento do teorema acima, desenvolta o valor de ϕ(120).

Sabendo que a decomposição de 120 em fatores primos é 120 = 23 · 3 · 5

Fazendo E1 = {k ∈ N/ k ≤ 12, 2|k} = {2, 4, 6, 8, . . . , 120}, logo |E1| = 120

E2 = {k ∈ N/ k ≤ 12, 3|k} = {3, 6, 9, 12, . . . , 120}, logo |E2| = 120
N/ k ≤ 12, 5|k} = {5, 10, 15, 20, 25, . . . , 120}, logo |E3| = 120

5 = 24.

2 = 60.
3 = 40. E3 = {k ∈

Tomando as interseções dois a dois, temos E1 ∩ E2 = {k ∈ N/ k ≤ 12, 6|k} =
6 = 20. E1 ∩ E3 = {k ∈ N/ k ≤ 12, 10|k} =
10 = 12. E2 ∩ E3 = {k ∈ N/ k ≤ 12, 15|k} =
15 = 8.

{6, 12, 18, 24, . . . , 120}, logo |E1 ∩ E2| = 120
{10, 20, 30, 40, . . . , 120}, logo |E1 ∩ E3| = 120
{15, 30, 45, 60, . . . , 120}, logo |E2 ∩ E3| = 120

Tomando as interseções três a três, temos E1 ∩ E2 ∩ E3 = {k ∈ N/ k ≤ 12, 30|k} =

{30, 60, 90, 120}, logo |E1 ∩ E2 ∩ E3| = 120

30 = 4

Portanto, usando o princípio da inclusão-exclusão temos:

ϕ(120) = N − N1 + N2 − N3

= 120 − (|E1| + |E2| + |E3|) + (|E1 ∩ E2| + |E1 ∩ E3| + |E2 ∩ E3|

= 120 − (60 + 40 + 24) + (20 + 12 + 8) − 4

= 120 − 124 + 40 − 4

= 32

Assim, usando o teorema acima temos: ϕ(120) = 120(1 − 1

5) = 32, ou
seja, no conjunto {1, 2, 3, · · · , 120} há 32 números primos com 120. (MORGADO et al.,
2001)

3)(1 − 1

2)(1 − 1

 
 
 
5 O PROBLEMA DE LUCAS

37

O problema seguinte, introduzido por Lucas em 1891, é conhecido como o “problème

des ménages” (em francês“ménages” signiﬁca casais).

Queremos sentar n casais (n ≥ 3) em uma mesa circular, de modo que
pessoas de mesmo sexo não se sentem juntas e nenhum marido vai sentar-se
em ambos os lados de sua esposa. De quantos modo isso pode ser feito?

Este famoso problema foi criado e popularizado por François Édouard Anatole
Lucas (1842-1891) em seu livro (LUCAS, 1891) e publicado em 1891. Na verdade, um
problema equivalente foi proposto pela primeira vez por P. G. Tait, muito mais cedo, em
1876 e foi colonizada por A. Cayley e T. Muir de forma independente em 1877.(CHEN;
KOH, 1992)

Neste capítulo, vamos aplicar o Teorema 1.1 para resolver o problema acima de um
modo mais geral. Antes de fazer isso, vamos apresentar os lemas de Kaplansky, conforme
referência (KAPLANSKY, 1943).

5.1 Os Lemas de Kaplansky

Teorema 5.1 Primeiro Lema de Kaplansky: O número de maneiras de selecionar
p objetos, dois não consecutivos, de n objetos dispostos em uma linha é

(cid:17)

(cid:16)n−k+1
k

Seja f (n, k) o número desejado. Nós dividimos as seleções em dois subconjuntos:
aqueles que incluem o último dos objetos n e aqueles que não. Logo, selecionando o último
objeto para a contagem o número f (n − 2, k − 1) é o total de escolha sem o último objeto
(uma vez que o penúltimo objeto é proibido) e para o segundo caso o número f (n − 1, k).

f (n, k) = f (n − 1, k) + f (n − 2, k − 1)

(5.1)

com f (n, 1) = n, basta provar por indução que f (n, k) =

Prova: Como n > k > 1, temos que f (3, 2) = 1 =

(cid:17)

(cid:16)n−k+1
k
(cid:16)3−2+1
2

(cid:17)

.

Por hipótese de indução,

f (n − 1, k) =

!

 k − k
k

e

f (n − 2, k − 1) =

!

 n − k
k − 1

Substituindo em 5.1, vem que

Capítulo 5. O PROBLEMA DE LUCAS

38

f (n, k) =

=

!

+

 n − k
k
 n − k + 1
k

!

 n − k
k − 1

!

aplicando o Teorema da Diagonais

Portanto pelo Princípio da Indução Finita, temos que a relação f (n, k) =

é verdadeiro para todo n ∈ N.

(cid:17)

(cid:16)n−k+1
k

(cid:3)

Exemplo 5.1 Seja o conjunto {1, 2, 3, 4, 5, 6}, quantos subconjuntos com 3 elementos
podemos formar sem que haja números consecutivos?

Vamos dividir em dois casos, conforme visto acima:

f (6 − 1, 3)=1, é o conjunto {1, 3, 5} cujo o elemento 6 não ﬁgura.

f (6 − 2, 3 − 1)=3, são os conjuntos {1, 3, 6}, {1, 4, 6}, {2, 4, 6} cujo o elemento 6

ﬁgura.

Portanto f (n, k) = f (n − 1, k) + f (n − 2, k − 1) = 1 + 3 = 4

(cid:3)

Teorema 5.2 Segundo Lema de Kaplansky: O número de maneiras de selecionar k
objetos, sem que haja dois consecutivos, de n objetos dispostos em um círculo é g(n, k) =

n
n−k

(cid:17)

(cid:16)n−p
p

Prova: O segundo Lema de Kaplansky difere do primeiro só na imposição de
a restrição adicional onde nenhuma seleção de incluir tanto o primeiro quanto o último
objeto, o número de tais opções é f (n − 4, k − 2). Por isso o resultado desejado é:

Capítulo 5. O PROBLEMA DE LUCAS

39

g(n, k) = f (n, k) − f (n − 4, k − 2)
 n − k + 1
k

−

=

!

!

 n − 4 − (k − 2) + 1
k − 2
(n − k − 1)!
(k − 2)!(n − 2k + 1)!

−

(n − k + 1)!
k!(n − 2k + 1)!
(n − k + 1)!(k − 2)! − k!(n − k − 1)!
k!(k − 2)!(n − 2k + 1)!

=

=

=

=

=

=

(n − k − 1)!(k − 2)!n(n − 2k + 1)
k!(n − 2)!(n − 2k + 1)(n − 2k)!
n(n − k − 1)!
k!(n − 2k)!

n(n − k)!
(n − k)k!(n − 2k)!
 n − k
k

n
n − k

!

(cid:3)

5.2 A solução de Kaplansky

Iremos apresentar nesta sessão a solução dada por Kaplansky (KAPLANSKY, 1943).
De acordo com (MORGADO et al., 2001) e (NUNES, 2015), veremos o desenvolvimento.

Numeremos os lugares de 1 a 2n. A exigência de pessoas de mesmo sexo não se
sentarem juntas exige que os homens ocupem os lugares pares e as mulheres os ímpares
ou vice-versa. Escolhido qual o sexo que ocupará os lugares ímpares (2 modos), devemos
colocar os homens nos lugares a eles reservados (n! modos). Só falta colocar as n mulheres
nos n lugares restantes, sendo vedada a colocação de alguma mulher ao lado de seu
marido.Un.

A resposta do problema de Lucas é 2(n!)Un onde Un é o número de modos de
colocar as n mulheres nos lugares vazios, sendo vedada a colocação de alguma mulher ao
lado de seu marido.

Para facilitar a visualização do problema, de acordo com (MORGADO et al., 2001),

a ﬁgura 5.1 ilustra o caso para 5 casais, ou seja (n = 5).

5.2.1 Determinando U5

Devemos colocar as cinco senhoras M1, M2, M3, M4, M5 nos lugares agora
numerados 1, 2, 3, 4, 5 de modo que M1 não pode ocupar os lugares 5 e 1, M2 não pode

Capítulo 5. O PROBLEMA DE LUCAS

40

ocupar 1 e 2, M3 não pode ocupar 2 e 3, M4 não pode ocupar 3 e 4 e M5 não pode ocupar
4 e 5.

Deﬁnamos, para 1 ≤ i ≤ 5,

A = conjunto das permutações das mulheres;

Ai = conjunto das permutações das mulheres em que Mi ocupa o i-ésimo lugar;

A0

i = Conjunto das permutações das mulheres em que Mi ocupa o (i − 1) − ésimo

lugar. (obs:1 − 1 = 5)

Figura 5.1 –

Falta Nome da Figura

Fonte: O Autor.

Para o calculo de U5, iremos aplicar o Princípio da Inclusão e Exclusão. De acordo

com o teorema 1.1 temos que:

U5 = N − N1 + N2 − N3 + N4 − N5

Notemos que N = |A| = 5! = 120.

Cálculo de N1

Como 1 ≤ i ≤ 5, vejamos que,

N1 = X

N (M ) = X

|Ai| + X

|A0

i| = 10(5 − 1)! = 240

|M |=1

1≤i≤5

1≤i≤5

já que, ﬁxando um dos elementos temos que |Ai| = |A0

i| = (5 − 1)!

Cálculo de N2

12345H1H5H4H2H3Capítulo 5. O PROBLEMA DE LUCAS

41

Vamos de agora em diante obter a cardinalidade dos conjuntos envolvidos tomados
dois a dois, três a três, quatro a quatro e cinco a cinco. Para melhor compreensão, vamos
discriminar os conjuntos A0

i e Ai, onde 1 ≤ i ≤ 5, como segue abaixo.

Conjunto Mulher cuja posição está deﬁnida Posição deﬁnida

A0
1
A1
A0
2
A2
A0
3
A3
A0
4
A4
A0
5
A5

M1
M1
M2
M2
M3
M3
M4
M4
M5
M5

5

1

1

2

2

3

3

4

4

5

Diante da tabela acima, vemos duas situações:

• A mesma mulher não pode ocupar duas posições diferentes ao mesmo tempo, logo:

|A0

1 ∩ A1| = |A0

2 ∩ A2| = |A0

3 ∩ A3| = |A0

4 ∩ A4| = |A0

5 ∩ A5| = 0

• Duas mulheres diferentes não podem ocupar a mesma posição ao mesmo tempo,

logo:

|A1 ∩ A0

2| = |A2 ∩ A0

3| = |A3 ∩ A0

4| = |A4 ∩ A0

5| = |A5 ∩ A0

1| = 0

Desta forma chegamos a conclusão que a interseção de dois conjuntos consecutivos
é sempre vazia e diante do fato, podemos aplicar o segundo lema de Kaplansky para a
contagem de tais conjuntos.

Aplicando o segundo lema de Kaplansky, onde n = 10 e k = 2 temos:

g(10, 2) =

10
10 − 2

!

 10 − 2
2

= 35

Fixados os dois elementos, a cardinalidade de sua interseção será (5 − 2)!

Portanto N2 = P

|M |=2 N (M ) = g(10, 2)(5 − 2)! = 35.6 = 210

Cálculo de N3

N3 = P

|M |=3 N (M ) = g(10, 3)(5 − 3)! = 50.2 = 100.

Cálculo de N4

Capítulo 5. O PROBLEMA DE LUCAS

N4 = P

|M |=4 N (M ) = g(10, 4)(5 − 4)! = 25.1 = 25.

Cálculo de N5

N5 = P

|M |=5 N (M ) = g(10, 5)(5 − 5)! = 2.1 = 2.

Por ﬁm:

U5 = N − N1 + N2 − N3 + N4 − N5

= 102 − 240 + 210 − 100 + 25 − 2

= 13

e a resposta do problema para 5 casais é 2(n!)Un = 2 · (5!) · 13 = 3120 modos.

42

(cid:3)

5.2.2 Determinando Un

Renumere os espaços vazios disponíveis as mulheres por 1, 2, 3, . . . , n

Deﬁnamos, para 1 ≤ i ≤ n, os conjuntos

A = conjunto das permutações das mulheres;

Ai = conjunto das permutações das mulheres em que Mi ocupa o i-ésimo lugar;

A0

i = Conjunto das permutações das mulheres em que Mi ocupa o (i − 1) − ésimo

lugar. (obs:1 − 1 = n)

Aplicando o Teorema 1.1 temos que:

Un = N − N1 + N2 − N3 + . . . + Nn−1 − Nn

Vejamos as cardinalidades:

Assim temos N = |A| = n!

Por outro lado, |Ai| = |A0

i| = (n − 1)!, assim,

N1 = X

N (M ) = X

|Ai| + X

|A0

i| = 2n(n − 1)!

|M |=1

1≤i≤n

1≤i≤n

Agora, vamos dispor os 2n conjuntos da seguinte maneira: A0

1, A1, A0

2, A2, . . . , A0

n, An

Em relação as interseções de k desses conjuntos, elas podem ser de dois tipos:

• A mesma mulher não pode ocupar duas posições diferentes ao mesmo tempo, logo:

|A0

i ∩ Ai| = 0

Capítulo 5. O PROBLEMA DE LUCAS

43

• Duas mulheres diferentes não podem ocupar a mesma posição ao mesmo tempo,

logo:

|Ai ∩ A0

i+1| = 0

Considerando a condição que nenhum dos conjuntos considerados na interseção
sejam consecutivos, então usaremos para a contagem o Segundo Lema de Kaplansky, temos
que o número de interseções a serem consideradas é dada por

g(2n, k) =

2n
2n − k

 2n − k
k

!
,

k = 2, 3, . . . , n.

e a cardinalidade da interseção de k conjuntos é dada por (n − k)!, k = 2, . . . , n.

Portanto a soma das cardinalidades da interseção de k conjuntos escolhidos dentre

A0

1, A1, A0

2, A2, . . . , A0

n, An é dada por:

Nk = g(2n, k) · (n − k)! =

2n
2n − k

 2n − k
k

!

· (n − k)!,

k = 2, 3, . . . , n.

Logo,

= n! − 2n(n − 1)! +

(n − 2)! − . . . + (−1)n

Un = N − N1 + N2 − N3 + . . . + Nn−1 − Nn

2n
2n − 2
 2n − k
k

!

!

 2n − 2
2

· (n − k)!

=

n
X

k=0

(−1)k

2n
2n − k

2n
2n − n

 2n − n
n

!

(n − n)!

Portanto, a solução do Problema de Lucas é dada por:

2n!Un = 2n!

n
X

k=0

(−1)k

2n
2n − k

 2n − k
k

!

· (n − k)!

Referências

44

BRUALDI, R. A. Introductory Combinatorics: Fifth edition. China: China Machine Press,
2009. Citado 2 vezes nas páginas 23 e 29.

CHEN, C.-C.; KOH, K.-M. Principles and Techniques in Combinactorics. Singapore:
Word Scientiﬁc, 1992. Citado na página 37.

KAPLANSKY, I. Solution of the “problème des ménages”. Bull. Amer. Math. Soc.,
American Mathematical Society, v. 49, n. 10, p. 784–785, 10 1943. Disponível em:
<http://projecteuclid.org/euclid.bams/1183505432>. Citado 2 vezes nas páginas 37 e 39.

KELLER, M. T.; TROTTER, W. T. Applied Combinatorics: Preliminary edition.
Lexington, Virginia and Atlanta, Georgia: CreativeCommons Attribution-NonCommercial,
2015. Citado na página 20.

LINT, J. H. V.; WILSON, R. M. A Course in Combinactorics. Cambridge: Cambridge
University Press, 2001. Citado 2 vezes nas páginas 11 e 17.

LUCAS, F. E. A. Théorié de nombres. Paris: Reprinted by Blanchard, 1891. Citado na
página 37.

MORGADO, A. C. et al. Análise Combinatória e Probabilidade. Rio de Janeiro: Sociedade
Brasiliera de Matemática, 2001. Citado 4 vezes nas páginas 14, 20, 36 e 39.

NUNES, S. As Permutações Caóticas, O Problema de Lucas e a Teoria dos Permanentes.
Dissertação (Mestrado) — Universidade Federal do Ceará, Fortaleza, 2015. Citado na
página 39.

PATERLINI, R. Uma fórmula de legendre. Hipertexto Pitágoras, p. 1, 2002. Citado na
página 19.

SHINE, C. Princípio da inclusão-exclusão. contagem de pólya. Polo Olímpico de
Treinamento, v. 05, p. 1–2, 2015. Citado na página 19.

