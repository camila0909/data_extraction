Universidade Federal de Juiz de Fora

PROFMAT - Mestrado Proﬁssional em Matemática em Rede Nacional

Welton Carlos Rodrigues

Cadeias de Markov: Uma aula para alunos do ensino médio

Juiz de Fora

2013

Welton Carlos Rodrigues

Cadeias de Markov: Uma aula para alunos do ensino médio

Dissertação apresentada ao Programa de Pós-
graduação PROFMAT (Mestrado Proﬁssional
em Matemática em Rede Nacional) na Univer-
sidade Federal de Juiz de Fora, como requisito
parcial para obtenção do grau de Mestre em Ma-
temática, na área de concentração em Matemá-
tica Aplicada.

Orientador: Prof. Dr. Luís Fernando Crocco
Afonso

Juiz de Fora

2013

Rodrigues, Welton Carlos.

Cadeias de Markov: Uma aula para alunos do ensino médio /

Welton Carlos Rodrigues. - 2013.

44f. : il.

Dissertação (Mestrado Proﬁssional em Matemática em Rede Nacional)

Universidade Federal de Juiz de Fora, Juiz de Fora, 2013.

1. Matemática. 2. Cadeias de Markov. 3. Probabilidades.

I. Título

CDU 51

Welton Carlos Rodrigues

Cadeias de Markov: Uma aula para alunos do ensino médio

Dissertação aprovada pela Comissão Examina-
dora abaixo como requisito parcial para a ob-
tenção do título de Mestre em Matemática pelo
Mestrado Proﬁssional em Matemática em Rede
Nacional na Universidade Federal de Juiz de
Fora, na área de concentração em Matemática
Aplicada.

Prof. Dr. Luís Fernando Crocco Afonso
(orientador)
PROFMAT - UFJF

Prof. Dr. Sandro Rodrigues Mazorche
PROFMAT - UFJF

Prof. Dr. Gladson Octaviano Antunes
UNIRIO

Juiz de Fora, 09 de agosto de 2013.

AGRADECIMENTOS

Agradeço

A Deus, em primeiro lugar, pois sem ele esta vitória não seria possível.

Ao meu orientador Prof. Dr. Luís Fernando Crocco Afonso, que me apoiou, incentivou e

proporcionou essa conquista.

À minha lindinha Lídia, pelo amor, carinho, paciência, companheirismo e incentivo.

Aos meus queridos pais, Geni e Manoel, pelo amor, incentivo e principalmente pelas ora-

ções.

À toda minha família e amigos, que se ﬁzeram presentes em todos os momentos. Em

especial ao Thiago.

À Universidade Federal de Juiz de Fora e ao Departamento de Matemática.

À Sociedade Brasileira de Matemática - SBM.

À CAPES pelo apoio ﬁnanceiro recebido.

RESUMO

Esta dissertação tem como objetivo principal apresentar os conceitos básicos das cadeias de
Markov, uma teoria pouco explorada no ensino básico e que é bastante útil na tomada de deci-
sões futuras. Como esses processos de Markov utilizam dois importantes conteúdos de mate-
mática, probabilidades e matrizes, permite-se também um complemento para esses estudos.
Palavras-Chave: Matemática. Cadeias de Markov. Probabilidades.

ABSTRACT

This master thesis’ main objective is to present the basic concepts of Markov chains, a theory
underexplored on basic education, which is a very useful instrument on taking decisions. The
study of Markov processes also helps students deepen their understanding of matrices and pro-
babilities.
Key-words: Mathematics. Markov chains. Probabilities.

SUMÁRIO

INTRODUÇÃO

1 CADEIAS DE MARKOV

8

10

1.1 Considerações iniciais

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

10

1.2 Cadeias de Markov .

.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11

1.3 Elementos das cadeias de Markov . . . . . . . . . . . . . . . . . . . . . . . .

13

2 VETOR DE ESTADO ESTACIONÁRIO

3 RESOLVENDO PROBLEMAS

CONSIDERAÇÕES FINAIS

REFERÊNCIAS

25

34

43

44

8

INTRODUÇÃO

Um dos estudos mais importantes e interessantes no ensino básico é sem dúvida o de proba-

bilidades. Através dessa teoria podemos, por exemplo, prever o clima de uma região no ﬁm de

semana, ponderar sobre as chances de um jogador em determinada partida, etc. Mesmo sendo

uma teoria aplicada a diversos fenômenos de nosso dia a dia e de extrema necessidade ela ainda

é de difícil entendimento por parte dos alunos, fazendo assim com que estes mesmos ﬁquem

desinteressados e confusos com este estudo. Pensando nisso, introduziremos com este trabalho

as cadeias de Markov como um método de resolução de problemas, a ﬁm de fortalecer esse

estudo.

Iniciamos chamando a atenção para dois problemas que ocorrem com frequência em nosso

dia a dia, um relacionado à migração de pessoas em um país e outro de um guarda trabalhando

nos cruzamentos do trânsito de determinada região. Nestes dois exemplos precisamos indicar

as probabilidades dos eventos acontecerem com o decorrer do tempo. Isso poderia ser feito

através do diagrama de árvore, que acabamos por perceber não ser uma boa opção pela falta

de praticidade, uma vez que seus galhos aumentam muito com o passar do tempo. Partindo

desse ponto pensamos numa outra maneira para resolver os problemas, as cadeias de Markov.

Ainda no primeiro capítulo introduzimos as deﬁnições relacionadas a essa teoria como diagrama

de transição, vetor de probabilidade, matriz de transição, vetor de estado e os teoremas. No

segundo capítulo estudaremos o comportamento de estados ao longo do tempo, procurando

assim um vetor de estado que mostra o comportamento da cadeia de Markov, considerando um

longo período de observação.

Já no terceiro e último capítulo apresentamos alguns problemas do cotidiano com o intuito

de fortalecer o pensamento probabilístico dos alunos, desenvolvendo conceitos como simulação

aleatória e do acaso, seguindo as orientações dos PCN(Parâmetros Curriculares Nacionais):[6].

Segundo PCN, (1997, p.40), temos:

9

“Com relação à probabilidade, a principal ﬁnalidade é que o aluno com-

preenda que muitos dos acontecimentos do cotidiano são de natureza

aleatória e que se podem identiﬁcar possíveis resultados desses aconte-

cimentos e até estimar o grau da possibilidade acerca do resultado de

um deles. As noções de acaso e incerteza, que se manifestam intuitiva-

mente, podem ser exploradas na escola, em situações em que o aluno

realiza experimentos e observa eventos”.

Acreditamos que o material a seguir possa ser trabalhado com alunos de ensino médio

(possivelmente através de uma Iniciação Cientíﬁca Junior), utilizando para tanto, um total de 4

aulas de 50 minutos cada.

Gostaríamos de ressaltar que o presente trabalho é fortemente inﬂuenciado por [3].

10

1

CADEIAS DE MARKOV

1.1 Considerações iniciais

Processos que evoluem com o passar do tempo são de grande importância em nossas vidas,

portanto métodos probabilísticos que estimam resultados futuros nos auxiliam em atividades

industriais, comercias e humanas. Citamos um exemplo onde esse resultado futuro pode ser

bastante útil.

[Problema 1] Um país é divido em três regiões demográﬁcas. Observa-se que, cada ano, 5% dos

moradores da região 1 mudam para a região 2 e 5% mudam para a região 3. Dos moradores da

região 2, 15% mudam para região 1 e 10% mudam para a região 3. Finalmente, dos moradores

da região 3, 10% mudam para a região 1 e 5% mudam para a região 2. Em longo prazo, qual a

porcentagem da população em cada uma das três regiões?

As respostas ao exemplo acima podem fornecer importantes dados para este país, indi-

cando investimentos industriais, ações sociais, planejamentos diversos como saúde, educação,

transporte, lazer e outros.

Vejamos outra situação onde processos que sofrem mudanças a cada momento aparece em

nosso dia a dia.

[Problema 2] Um guarda de trânsito é designado para controlar o tráfego nos seis cruzamentos

indicados na ﬁgura 1.1. Ele é instruído a permanecer em cada cruzamento por uma hora e,

em seguida, seguir para um cruzamento adjacente. Para evitar que ele estabeleça um padrão,

ele deve escolher o novo cruzamento de maneira aleatória, com qualquer escolha igualmente

provável. Por exemplo, se ele estiver no cruzamento 5, seu próximo cruzamento poderá ser 1,

4 ou 6, cada um com probabilidade 1/3. Estando no cruzamento 1, por exemplo, poderia ir para

2, 3, 4, 5 ou 6, todos com mesma probabilidade, ou seja, com probabilidade 1/5 . Todo dia,

ele começa no cruzamento em que parou no dia anterior. Se o guarda inicialmente começa no

cruzamento 1, quais as probabilidades de ele estar em cada cruzamento 10 horas após o início

de seu trabalho?

11

Figura 1.1: Guarda de trânsito

Como poderíamos resolver este problema? O diagrama de árvore seria a melhor maneira?

Este diagrama (ﬁgura 1.2) não parece ser a melhor opção conforme também descrito por

[1], pois com o passar do tempo seus galhos aumentam muito, fazendo com que a interpretação

dos resultados se torne algo difícil e desinteressante. Vejamos que após a primeira hora o guarda

de trânsito tem cinco opções (2, 3, 4, 5 ou 6). Destas cinco opções ele teria mais 13 novas opções

ao ﬁm da segunda hora; ao ﬁm da terceira hora 47; após quatro horas 143 casos, ou seja, 143

galhos. Precisaríamos de um método um pouco mais simples ou até mesmo mais prático para

solucionar o problema. Pensando nisso nossa proposta para esse trabalho é buscar um método

de resolução para problemas como os dois citados acima e outros que se evoluem com o passar

do tempo.

1.2 Cadeias de Markov

Suponha um sistema físico ou matemático sofrendo mudanças tais que a cada momento

ele pode ocupar um dentre um número ﬁnito de estados. Por exemplo, um país é dividido em

três regiões demográﬁcas, um morador desse país poderia estar em uma dentre as três regiões

possíveis e a cada período ﬁxo de tempo ele pode permanecer na atual região ou migrar para

uma das outras duas restantes. O sistema pode mudar de um estado para outro, sendo observado

em períodos ﬁxos de tempo (um minuto, uma hora, um dia, a cada ano e assim por diante). Se o

estado do sistema em qualquer observação não puder ser medido com certeza, mas se podemos

prever a probabilidade de o sistema estar em um determinado estado a partir do conhecimento

do estado do sistema anterior, ou seja, a probabilidade de um sistema estar em um estado futuro

é dado a partir de seus estados anteriores. Esse processo de mudança de um estado para o outro

é chamado uma cadeia de Markov ou um processo de Markov, chamado assim em homenagem

ao matemático Andrei Andreyevich Markov.

Markov nasceu no dia 14 de junho de 1856 em Ryazan, na Rússia. Morreu no dia 20 de

12

Figura 1.2: Diagrama de árvore

13

Figura 1.3: Andrei Andreyevich Markov 1856 - 1922

julho de 1922 em Petrograd (hoje St Petesburg), Rússia. Estudou na universidade de St Petes-

burg também na Rússia, onde mais tarde se tornaria professor. Seus primeiros trabalhos foram

em teoria dos números, análise, frações contínuas, limites de integrais, teoria da aproximação

e convergência de séries. Por volta de 1900, Markov estudou as sequências de variáveis mu-

tuamente independentes, esperando estabelecer as leis da probabilidade de forma mais geral.

Markov é particularmente lembrado pelo seu estudo de cadeias de Markov. Em 1923 Norbert

Winter se tornou o primeiro a tratar rigorosamente um processo contínuo de Markov. Tempos

depois, por volta de 1930, Andrei Kolmogorov fundamenta essa teoria [5].

Para o entendimento das cadeias de Markov e suas diversas aplicações, precisamos de al-

guns conhecimentos prévios como diagrama de transição, vetor de probabilidade, matriz de

transição e vetor de estado que serão deﬁnidos na próxima seção.

1.3 Elementos das cadeias de Markov

Para deﬁnirmos os elementos essências das cadeias de Markov, faremos uso do exemplo a

seguir.

[Exemplo 1] (Planos de telefonia) Uma empresa de telefonia móvel, oferece a seus clientes

três opções de planos, denotados por 1, 2 e 3. Um cliente no ato do contrato escolhe o plano

desejado, podendo a cada ano mudar de plano ou permanecer no atual. Os registros da empresa

mostram que o padrão de migração anual dos clientes é dado da seguinte maneira:

Estando o cliente no plano 1 a probabilidade de que ele continue nesse plano é de 0,5

14

Estando o cliente no plano 1 a probabilidade de que ele mude para o plano 2 é de 0,3

Estando o cliente no plano 1 a probabilidade de que ele mude para o plano 3 é de 0,2

Estando o cliente no plano 2 a probabilidade de que ele mude para o plano 1 é de 0,25

Estando o cliente no plano 2 a probabilidade de que ele continue nesse plano é de 0,5

Estando o cliente no plano 2 a probabilidade de que ele mude para o plano 3 é de 0,25

Estando o cliente no plano 3 a probabilidade de que ele mude para o plano 1 é de 0,3

Estando o cliente no plano 3 a probabilidade de que ele mude para o plano 2 é de 0,6

Estando o cliente no plano 3 a probabilidade de que ele continue nesse plano é de 0,1

Consideremos que o cliente tenha optado pelo plano 2 na assinatura do contrato, ou seja, no

instante t = 0 (t em anos).

Deﬁnição 1. (Diagrama de transição) O diagrama de transição é uma representação gráﬁca de

uma cadeia de Markov, neste diagrama podemos visualizar as transições de um estado para

outro e também suas probabilidades. Considerando o exemplo1 (planos de telefonia), podemos

desenhar um diagrama de transição conforme a ﬁgura 1.4.

Figura 1.4: Diagrama de transição

Deﬁnição 2. (Vetor de probabilidade) O vetor de probabilidade contém as probabilidades de

transição de um estado para outro em um intervalo de tempo. Assim se um sistema possui k

estados, um vetor de probabilidade será uma matriz coluna como esta:

15

Vj =



















































p1 j
p2 j
.

.

.

pi j
.

.

.

pk j

Neste vetor temos que a probabilidade de um sistema estando no estado j passar para o estado

1 é p1 j , estando no estado j passar para o estado 2 é p2 j, ou seja, estando no estado j a
probabilidade de passar para o estado i é pi j.

Considerando agora o exemplo 1 (planos de telefonia), temos três vetores de probabilidade que

podem ser escritos da seguinte maneira:

V1 =







0, 5

0, 3

0, 2







V1 indica que as probabilidades de um cliente permanecer no plano 1 já estando neste é 0,5;

de ir para o 2 é 0,3 e de ir para o 3 é 0,2.

V2 =







0, 25

0, 5

0, 25







V2 indica que as probabilidades de um cliente ir para o plano 1 estando no 2 é 0,25; de

permanecer no 2 é 0,5 e de ir para o 3 é 0,25.

V3 =







0, 3

0, 6

0, 1







V3 indica que as probabilidades de um cliente ir para o plano 1 estando no 3 é 0,3; de ir para

16

o 2 é 0,6 e de permanecer no 3 é 0,1.

Observemos que a soma das probabilidades em cada vetor resulta em 1. Isto não é apenas

coincidência, os vetores de probabilidade têm essa propriedade. E isso acontecerá sempre, pois

se um sistema, com k estados, está no estado j numa observação, é certo de que estará num dos

k possíveis estados na próxima observação. Assim se Pj = [pi j] for um vetor de probabilidade
qualquer com k estados, então, dado qualquer j, temos:

p1 j + p2 j + ... + pk j = 1

(1.1)

Uma matriz com a propriedade acima é denominada matriz de probabilidade ou matriz de

Markov.

Esses vetores de probabilidade formam o que denominamos matriz de transição de uma

cadeia de Markov. Que será deﬁnida agora.

Deﬁnição 3. (Matriz de transição) Como todo estado possui um vetor de probabilidade, a matriz

de transição em uma cadeia de Markov é a matriz tal que a j-ésima coluna é o j-ésimo vetor de

probabilidade. Essa matriz será sempre quadrada, ou seja, o número de linhas será igual ao

número de colunas. [3]

A matriz P = [pi j] é denominada matriz de transição da cadeia de Markov

Sendo uma cadeia de Markov de k estados, a matriz de transição tem o formato a seguir.

P =















p11 p12
p21 p22
.
.

... p1k
... p2k
.
.

.

.

.

.

.

.

.

.

pk1 pk2

... pkk















Nessa matriz, p11 é a probabilidade de que estando no estado 1 o sistema continue em 1, p12
é a probabilidade de mudança do estado 2 para o estado 1, p32 é a probabilidade de mudança
de estado do 2 para 3, e assim por diante.

Assim os pi j dessa matriz, conforme já citados anteriormente, representam as probabilida-

des de que o sistema vá mudar do estado j para o estado i após uma unidade de tempo.

Considerando novamente o exemplo 1 (planos de telefonia), temos a seguinte matriz de transi-

ção:

17







P =

0, 5 0, 25 0, 3

0, 3

0, 5

0, 6

0, 2 0, 25 0, 1







,

onde os vetores coluna de P representam os vetores V1, V2 e V3 já citados.

Deﬁnição 4. (Vetor de estado) O vetor estado de uma observação em uma cadeia de Markov

com k estados é um vetor coluna x cujo i-ésimo componente é a probabilidade de o sistema

estar, naquela observação, no i-ésimo estado [3].

Suponhamos, agora, que saibamos o vetor estado inicial (chamaremos de x(0)) de uma ca-

deia de Markov, ou seja, o vetor de alguma observação inicial. O teorema a seguir nos permitirá

determinar os vetores estados nas observações subsequentes, ou seja, determinaremos.

x(1), x(2), x(3), ..., x(n), ...

Teorema 1.1. Se P for a matriz de transição de uma cadeia de Markov e x(n) o vetor estado na

enésima observação, então:

x(n+1) = Px(n)

Por simplicidade de notação, demonstraremos esta proposição para o caso de uma cadeia de

Markov com três estados. A demonstração do caso geral é análoga.

Seja a matriz de transição







P =

p11 p12 p13
p21 p22 p23
p31 p32 p33







,

onde cada pi j dessa matriz, é a probabilidade de, estando o sistema no estado j, ele ir para o
estado i, após uma unidade de tempo.

Seja também o vetor de estado em uma observação qualquer t = n

18

x(n) =







α (n)
β (n)
γ (n)







Onde

α (n) é a probabilidade de o sistema estar no estado 1 no instante t = n

β (n) é a probabilidade de o sistema estar no estado 2 no instante t = n

γ (n) é a probabilidade de o sistema estar no estado 3 no instante t = n

Qual é a probabilidade de o sistema estar em cada estado no instante t = n + 1 ?

Sendo x(n+1) esse vetor de estado, temos

x(n+1) =







α (n+1)
β (n+1)
γ (n+1)







Onde

α (n+1) = p(passar de 1 para 1 ∩ estar em 1 no instante t = n) + p(passar de 2 para 1
∩ estar em 2 no instante t = n) + p(passar de 3 para 1 ∩ estar em 3 no instante t = n) =
p11α (n) + p12β (n) + p13γ(n).

β (n+1) = p(passar de 1 para 2 ∩ estar em 1 no instante t = n) + p(passar de 2 para 2
∩ estar em 2 no instante t = n) + p(passar de 3 para 2 ∩ estar em 3 no instante t = n) =
p21α (n) + p22β (n) + p23γ(n).

α (n+1) = p(passar de 1 para 3 ∩ estar em 1 no instante t = n) + p(passar de 2 para 3
∩ estar em 2 no instante t = n) + p(passar de 3 para 3 ∩ estar em 3 no instante t = n) =
p31α (n) + p32β (n) + p33γ(n).

Como P(A|B) = P(A∩B)
P(B)

temos P(A ∩ B) = P(A|B).P(B) .

Portanto

x(n+1) =







α (n+1)
β (n+1)
γ (n+1)













=

p11α (n) + p12β (n) + p13γ (n)
p21α (n) + p22β (n) + p23γ (n)
p31α (n) + p32β (n) + p33γ (n)













=

p11 p12 p13
p21 p22 p23
p31 p32 p33



















α (n)
β (n)
γ (n)

= Px(n)

Deste teorema, segue que

19

x(1) = Px(0)

x(2) = Px(1) = P(Px(0)) = P2x(0)

x(3) = Px(2) = P(P2x(0)) = P3x(0)

.

.

.

x(n) = Px(n−1) = P(P(n−1)x(0)) = Pnx(0)

Assim, sabendo o vetor inicial x(0) e a matriz de transição P determinamos x(n) com n =

1, 2, 3...

De novo no exemplo 1 (planos de telefonia). Como sabemos que o cliente escolhe inicialmente

o plano 2, nosso vetor de estado na primeira observação será:

x(0) =







,







0

1

0

onde as entradas dessa matriz a11, a21 e a31 representam respectivamente as probabilidades de
o cliente estar em cada plano (1, 2 ou 3) quando começadas as observações, ou seja no instante

zero.

Assim, a partir do teorema1.1, podemos determinar as observações seguintes.

x(1) = Px(0) =







0, 5 0, 25 0, 3

0, 3

0, 5

0, 6

0, 2 0, 25 0, 1



















=







0

1

0

0, 25

0, 5

0, 25







logo, as probabilidades de que o cliente esteja em cada plano após o primeiro ano são:

Plano 1 25%

Plano 2 50%

Plano 3 25%

De modo análogo,

20

x(2) = Px(1) = P2x(0) =

x(4) = Px(3) = P4x(0) =

x(6) = Px(5) = P6x(0) =



















0, 325

0, 475

0, 2

0, 346

0, 452

0, 202

0, 347

0, 451

0, 202



















, x(3) = Px(2) = P3x(0) =

, x(5) = Px(4) = P5x(0) =

, x(7) = Px(6) = P7x(0) =



















0, 341

0, 455

0, 204

0, 347

0, 451

0, 202

0, 347

0, 451

0, 202



















Onde x(1), x(2), x(3), x(4), x(5), x(6) e x(7) representam os vetores estado nas primeiras sete
observações. Como as observações são feitas a cada ano, os x(i) com i = {1, 2, 3, 4, 5, 6, 7}

representam as probabilidades de o cliente estar nos planos 1, 2 e 3 a cada ano a partir do

primeiro.

Para acharmos os produtos das matrizes x(1), x(2), x(3), x(4), x(5), x(6) e x(7), utilizamos o soft-

ware Maxima, um sistema de computação algébrica (CAS, abreviação do termo em inglês Com-

puter Algebra Systems). A escolha desse software deve-se ao fato de o Maxima ser um programa

livre, assim pode ser obtido gratuitamente na internet. No site http://wxmaxima.sourceforge.net

podemos baixar o programa que pode ser instalado tanto no Windows quanto no Linux. Com

o programa, podemos manipular expressões matemáticas, plotar gráﬁcos em duas e três dimen-

sões além de inúmeras vantagens do ponto de vista numérico, onde esses sistemas, no caso o

Maxima, podem ser considerados poderosas calculadoras cientíﬁca, capaz de efetuar cálculos

com grande precisão e rapidez [2]. Em nosso trabalho utilizaremos o software para efetuar

multiplicações de matrizes e resolver sistemas de equações.

Podemos observar que a partir do quinto ano de observação, o vetor de estado do sistema

permanece igual a







0, 347

0, 451

0, 202







Isto signiﬁca, que a partir do quinto ano a probabilidade de o cliente encontrar-se no plano

1, ﬁca em torno de 35%, 45% no plano 2 e 20% no plano 3.

Daremos agora, após estas deﬁnições, uma solução para o problema do guarda de trânsito [Pro-

blema 2], que neste caso funcionará melhor que o diagrama de árvore.

Os possíveis cruzamentos que o guarda de trânsito pode ocupar são de 1 a 6, logo temos

seis estados possíveis. Portanto, nossa matriz de transição terá 6 linhas e 6 colunas, da seguinte

forma.

21















P =

1
3

1
3

1
1
0 1
3
2
2
5 0 1
1
3 0 0 0
2 0 1
1
1
3 0 0
5
5 0 1
1
3 0
3 0 1
5 0 0 1
1
2
5 0 0 0 1
1
3 0

3 0 1















Onde as entradas pi j são as probabilidades de estando o guarda no cruzamento j ir para o

cruzamento i.

Assim p11 = 0, pois a probabilidade dele estando no 1, permanecer no 1 é zero, p12 = 1/2,
pois a probabilidade de o guarda estando no cruzamento 2, ir para o cruzamento 1 é um meio,

p45 = 1/3, pois estando no cruzamento 5 a probabilidade dele ir para o 4 é um terço, ou seja,
ele tem três opções (1, 4 ou 6), cada um com igual probabilidade. E assim por diante.

Sabendo que ele começa sua jornada de trabalho no cruzamento 1, nosso vetor de estado

inicial será,

x(0) =





























1

0

0

0

0

0

Como mostrado antes, as entradas dessa matriz representam as probabilidades do guarda de

trânsito estar em cada cruzamento no início de seu trabalho, ou seja, numa observação inicial
x(0).

Fazendo uso do teorema 1.1 suas prováveis localização, após 10 horas de trabalho são:

22

x(10) = P10x(0) =















0, 279

0, 110

0, 168

0, 165

0, 168

0, 110















A utilização do software, Maxima, reduz bastante nosso trabalho. Os passos para solução

no programa foram:

1) No comando Álgebra, na barra de tarefas, escolhemos a opção Introduzir matriz.

2) Aparecerá uma janela para informarmos o número de linhas, o número de colunas, o tipo da

matriz e também o nome dessa matriz.

(Para nosso exemplo, devemos escolher, número de linhas e colunas 6, tipo da matriz geral e

nome P).

3) Clicando em ok aparecerá uma janela com as entradas da matriz. Devemos preenchê-la com

os valores das probabilidades de transição. Feito isso clicamos novamente em ok.

(Nossa matriz de transição está pronta).

23

4) Agora devemos inserir a matriz de estado inicial que chamaremos de X0. Passando pelos

mesmos passos devemos escolher número de linhas 6, número de colunas 1, tipo da matriz

geral e nome X0. Clicando em ok, inserimos os valores nas entradas dessa matriz e clicamos

novamente em ok.

(Nossa matriz de estado inicial também está pronta)

5) Devemos agora efetuar o produto das matrizes, ou seja, x(10) = P10x(0) . Escolhendo na barra

de tarefas do Maxima a opção Cálculo e em seguida Calcular produto, abrirá uma janela com os

seguintes campos para preenchimento. Expressão, variável, de e para. Devemos colocar nesses

campos as seguintes informações: Expressão (P ˆˆ10).X0, variável k, de 1 para 1.

6) Clicando em ok, aparecerá na tela do Maxima a matriz procurada, em nosso caso x(10). Se a

matriz conter as entradas na forma fracionária, podemos com o comando Numérico em seguida

Para ﬂoat alterar os valores para o modo decimal. Consideramos no exemplo acima três casas

decimais, que entendemos ser uma aproximação conveniente.

24

25

2

VETOR DE ESTADO ESTACIONÁRIO

Processos de Markov são usados para determinar o comportamento de um sistema após um

longo período de tempo. Assim, veriﬁcar se uma cadeia de Markov atinge ou não o equilíbrio é

de fundamental importância.

Podemos observar em nosso exemplo 1 (planos de telefonia) que os vetores de estado con-

vergem a um vetor ﬁxo à medida que o número de observações aumenta. Mas será que isso

sempre ocorre? Vejamos que a resposta a essa pergunta é não.

Considere as matrizes de transição P e do vetor de estado inicial x(0). Onde,

Temos que:

(cid:34)

P =

0 1

1 0

(cid:35)

(cid:34)

, x(0) =

(cid:35)

0, 7

0, 3

P(2) =

(cid:34)

0 1

1 0

(cid:35) (cid:34)

0 1

1 0

(cid:35)

(cid:34)

=

(cid:35)

1 0

0 1

P(3) = PP(2) =

P(4) = PP(3) =

P(5) = PP(4) =

(cid:34)

(cid:34)

(cid:34)

0 1

1 0

0 1

1 0

0 1

1 0

(cid:35) (cid:34)

(cid:35) (cid:34)

(cid:35) (cid:34)

1 0

0 1

0 1

1 0

1 0

0 1

(cid:35)

(cid:34)

=

(cid:35)

(cid:34)

=

(cid:35)

(cid:34)

=

(cid:35)

(cid:35)

(cid:35)

0 1

1 0

1 0

0 1

0 1

1 0

Seguindo com a mesma ideia

P(2n) = I =

(cid:35)

(cid:34)

1 0

0 1

P(2n+1) = P =

(cid:35)

(cid:34)

0 1

1 0

26

Logo,

Com n ∈ N.

Portanto,

x(2n) = P(2n)x(0) =

(cid:35) (cid:34)

0, 7

0, 3

(cid:35)

(cid:34)

=

(cid:35)

0, 7

0, 3

(cid:34)

1 0

0 1

e

x(2n+1) = P(2n+1)x(0) =

(cid:34)

0 1

1 0

(cid:35) (cid:34)

0, 7

0, 3

(cid:35)

(cid:34)

=

(cid:35)

0, 3

0, 7

x(0) = x(2) = x(4) = ... =

e

x(1) = x(3) = x(5) = ... =

(cid:35)

(cid:35)

(cid:34)

(cid:34)

0, 7

0, 3

0, 3

0, 7

Este sistema oscila indeﬁnidamente entre os dois vetores estado

não converge a nenhum vetor ﬁxo.

(cid:34)

0, 7

0, 3

(cid:35)

(cid:34)

,

0, 3

0, 7

(cid:35)

e portanto,

Agora se exigirmos que a matriz de transição em uma cadeia de Markov satisfaça a uma

certa condição, podemos mostrar que o sistema se aproxima de um vetor de estado ﬁxo, essa

condição é descrita na deﬁnição que segue.

Deﬁnição 5. (Matriz de transição regular) Uma matriz de transição é regular se uma potência

positiva da matriz tem todas as entradas positivas [3].

E a cadeia de Markov com essa propriedade será denominada cadeia de Markov regular. Em

nosso exemplo (planos de telefonia) a cadeia de Markov é regular, pois as entradas da matriz de

transição são todas positivas.

De volta ao exemplo do guarda de trânsito [Problema 2].















2
5
1
15
1
6
2
15
1
6
1
15

1
6
4
15
1
10
4
15
1
10
1
10

5
18
1
15
31
90
1
15
8
45
1
15

2
9
8
45
1
15
13
45
1
15
8
45

5
18
1
15
8
45
1
15
31
90
1
15















1
6
1
10
1
10
4
15
1
10
4
15

Temos que P2 =

é regular.

, portanto pela deﬁnição 5, a matriz de transição

Consideremos a tabela 2.1 que informa a probabilidade de cada posição do guarda de trân-

sito com o decorrer das horas.

Tabela 2.1: Horas

27

Cruz.
C(n)
1
C(n)
2
C(n)
3
C(n)
4
C(n)
5
C(n)
6

0
1
0
0
0
0
0

1
0
0,2
0,2
0,2
0,2
0,2

4

5

15

10

16

17

20

30

3
2
0,4
0,223 0,304 0,264 0,279 0,279 0,278 0,277 0,277 0,277
0,067 0,135 0,097 0,120 0,110 0,111 0,111 0,111 0,111 0,111
0,167 0,158 0,176 0,159 0,168 0,166 0,167 0,167 0,167 0,167
0,132 0,191 0,150 0,178 0,165 0,167 0,166 0,167 0,167 0,167
0,167 0,158 0,176 0,159 0,168 0,166 0,167 0,167 0,167 0,167
0,067 0,135 0,097 0,120 0,110 0,111 0,111 0,111 0,111 0,111

Observamos que a partir de n = 17 os vetores estado, desse sistema, convergem a um vetor

ﬁxo, considerando três casas decimais.

Veremos com o teorema abaixo que toda cadeia de Markov regular possui um vetor de

estado ﬁxo denominado vetor estacionário da cadeia de Markov.

Teorema 2.1. Se P for uma matriz de transição regular em uma cadeia de Markov, então:

a) Quando n → ∞, Pn tende a matriz

Q =















q1 q1
q2 q2
.
.

... q1
... q2
.
.

.

.

.

.

.

.

.

.

qk qk

... qk















b) os q são números positivos tais que q1 + q2 + q3 + ... + qk = 1

Este teorema não será demonstrado, pois envolve resultados mais elaborados de Álgebra

Linear, fugindo do propósito até aqui apresentado. Ao leitor interessado, sugerimos um texto

mais especializado, como por exemplo [4].

Teorema 2.2. Se P for uma matriz de transição regular e x um vetor de probabilidade qualquer

então:

a) Quando n → ∞

28

Pnx →





























q1
q2
.

.

.

qk

= q

em que q é um vetor de probabilidade ﬁxo, independente de n, cujas entradas são todas positivas.

Este vetor é chamado vetor de estado estacionário.

b) O vetor de estado estacionário q é o único vetor de probabilidade que satisfaz a equação

Pq = q.

Demonstração. a) Seja

x =





























x1
x2
.

.

.

xk

Um vetor de probabilidade

Quando n → ∞ , do teorema 2.1, temos:

Pn → Q =















q1 q1
q2 q2
.
.

... q1
... q2
.
.

.

.

.

.

.

.

.

.

qk qk

... qk















29

Logo

Pnx → Qx =

=





























q1 q1
q2 q2
.
.

... q1
... q2
.
.

.

.

.

.

.

.

.

.

qk qk

... qk





























q1(x1 + x2 + ... + xk)
q2(x1 + x2 + ... + xk)
.

.

.

qk(x1 + x2 + ... + xk)















=

x1
x2
.

.

.

qk














=





























q1
q2
.

.

.

qk

q1x1 + q1x2 + ... + q1xk
q2x1 + q2x2 + ... + q2xk
.

.

.

qkx1 + qkx2 + ... + qkxk
















= q













pois x1 + x2 + ... + xk = 1. Mostrando que Pn transforma qualquer vetor de probabilidade x no
vetor de probabilidade q.

b) Pelo teorema 2.1, quando n → ∞ , Pn → Q e Pn+1 → Q. Como PPn = Pn+1, temos
PQ = Q. Sabemos que todas as colunas de Q são iguais ao vetor de probabilidade q. Ao

igualarmos as colunas correspondentes da equação matricial PQ = Q, temos:

PQ = P[(q) (q) ... (q)] = [P(q) P(q) ... P(q)] e Q = [(q) (q) ... (q)]

Logo Pq = q.

Usando que AB = A[(b1) (b2) ... (bk)] = [A(b1) A(b2) ... A(bk)], ou seja, o j-ésimo vetor

coluna de AB = A[j-ésimo vetor coluna de B]. (Multiplicação matricial coluna por coluna).

Para mostrarmos que q é o único vetor de probabilidade que satisfaz essa equação, supo-

nhamos, por absurdo, que exista outro vetor u tal que Pu = u.

Deste (mesmo teorema, item a) temos

Pnu → q e como Pu = u, temos, Pnu = u para todo, n ∈ N assim u → q. Portanto u = q.

Da (parte b) deste teorema podemos escrever, o sistema linear homogêneo;

Pq = q =⇒ Pq = Iq =⇒ Iq − Pq = 0

(I − P)q = 0

que possui uma solução única q com q1 + q2 + ... + qk = 1

30

(2.1)

Aplicaremos esse resultado para encontrarmos os vetores de estado estacionário em nossos

exemplos.

No exemplo (planos de telefonia), temos que:







P =

0, 5 0, 25 0, 3

0, 3

0, 5

0, 6

0, 2 0, 25 0, 1







e seja q =













q1
q2
q3

o vetor de estado estacionáio, assim,

(I − P)q = 0 =⇒







0, 5 −0, 25 −0, 3

−0, 3

0, 5 −0, 6

−0, 2 −0, 25

0, 9



















=













0

0

0

q1
q2
q3

O que dá o seguinte sistema





0, 5q1 − 0, 25q2 − 0, 3q3 = 0
−0, 3q1 + 0, 5q2 − 0, 6q3 = 0
−0, 2q1 − 0, 25q2 + 0, 9q3 = 0

10t e q3 = 7
12t
60 t = 1 =⇒ t = 60
12t = 1 =⇒ 173
173

As soluções desse sistema são q1 = t, q2 = 13

Assim, q1 = 60

Como q1 + q2 + q3 = 1, temos t + 13

10t + 7
173 e q3 = 35
173, q2 = 78
173.


60
173
78
173
35
173
fere com o resultado já observado anteriormente, veja página 19.

Consequentemente q =

0, 347

0, 202

0, 451

















(cid:39)





é o vetor de estado estacionário, o que con-

Utilizamos novamente o software Maxima na resolução do sistema acima. Os passos para

a solução do problema através do programa, foram:

1) No comando equações, na barra de tarefas, escolhemos a opção resolver sistema algébrico.

2) Aparecerá uma janela para informarmos o número de equações, para este exemplo (3), abrirá

outra janela que devemos inserir as equações.

31

3) Clicando em ok, temos na tela do Maxima a solução desejada.

Resolvendo agora o exemplo do guarda de trânsito [Problema 2].

Sendo P a matriz de transição e q o vetor de estado estacionário, temos;















P =

Portanto,

1
3

1
3

0 1
1
1
3
2
2
1
5 0 1
3 0 0 0
1
2 0 1
1
3 0 0
5
5 0 1
1
3 0
1
3 0 1
5 0 0 1
2
5 0 0 0 1
1
3 0

3 0 1















e q =





























q1
q2
q3
q4
q5
q6

(I − P)q = 0 =⇒















1 − 1
− 1
5
5 − 1
− 1
2
− 1
0 − 1
3
5
0 − 1
− 1
3
5
0 − 1
− 1
3
5

2 − 1
3 − 1
3 − 1
3 − 1
2
1 − 1
0
0
0
3
1 − 1
0
3
1 − 1
0
3
1 − 1
2
1

0

0

0

0











































q1
q2
q3
q4
q5
q6





























0

0

0

0

0

0

=

32

Que dá o sistema






3 q4 − 1

3 q5 − 1

2q2 + q3 − 1

q1 − 1
2 q2 − 1
5 q1 + q2 − 1
− 1
5q1 − 1
− 1
− 1
5q1 + 0q2 − 1
5q1 + 0q2 + 0q3 − 1
− 1
− 1
5 q1 + 0q2 + 0q3 + 0q4 − 1

3 q3 − 1
2 q6 = 0
3q3 + 0q4 + 0q5 + 0q6 = 0
3 q4 + 0q5 + 0q6 = 0
3q5 + 0q6 = 0
2 q6 = 0
3 q5 + q6 = 0

3 q4 + q5 − 1

3 q3 + q4 − 1

De solução q1 = t, q2 = q6 = 2

5t e q3 = q4 = q5 = 3
5t

Como

Assim

6
∑
i=1

qi = 1

t +

2
5

t +

3
5

t +

3
5

t +

3
5

t +

2
5

t = 1 =⇒

18
5

t = 1 =⇒ t =

5
18

(cid:39) 0, 277

q =





























5
18
1
9
1
6
1
6
1
6
1
9















0, 277

0, 111

0, 167

0, 167

0, 167

0, 111















(cid:39)

É o vetor de estado estacionário.

Que informa a proporção de tempo que o guarda de trânsito permanece, a longo tempo, em

cada cruzamento.

Resolvendo o problema inicial (regiões do país) [Problema 1].

A matriz de transição P será:







P =

90% 15% 10%

5% 75% 5%

5% 10% 85%













=

9
10
1
20
1
20

3
20
3
4
1
10







1
10
1
20
17
20

Portanto, resolvendo a equação matricial













q1
q2
q3

(I − P)q = 0 onde q =

Temos;

33











(1 − P)q =

20 − 1
10 − 3
1
10
− 1
4 − 1
1
20
20
3
20 − 1
− 1
10
20
24 , q2 = 1
Com solução q1 = 13
6 e q3 = 7
24 .














0, 5416







q1
q2
q3

= 0 =⇒





1
10 q1 − 3
− 1
20 q1 + 1
20 q1 − 1
− 1

20 q2 − 1
4q2 − 1
10 q2 + 3

10 q3 = 0
20q3 = 0
20 q3 = 0

Portanto q =









(cid:39)









0, 1667

0, 2917

é o vetor de estado estacionário.

13
24
1
6
7
24

Concluindo assim que em longo prazo, aproximadamente, 54,16% dos moradores estarão

na região 1; 16,67% estarão na região 2 e 29,17% estarão morando na região 3.

34

3

RESOLVENDO PROBLEMAS

A seguir resolvemos alguns exemplos de probabilidade utilizando as cadeias de Markov.

Nestes exemplos utilizaremos o software já citado Maxima.

Exemplo 3.1 Considere uma partícula realizando movimentos aleatórios sobre os vértices de

um paralelepípedo regular ﬁgura 3.1. Suponha que a cada passo a partícula escolha saltar para

um vértice vizinho, tendo as probabilidades de saltar para cada um deles da seguinte maneira.

Figura 3.1: Paralelepípedo

Saltar sobre as arestas das faces superior ou inferior com probabilidade 3/10

Saltar sobre as arestas das faces laterais com probabilidade 1/5

Saltar sobre as diagonais de cada face superior ou inferior com probabilidade 1/5

Pede-se:

a) Encontre uma matriz de transição para esse sistema.

b) Se a partícula inicia seus movimentos no vértice 1, com qual probabilidade ela estará em

cada vértice ao longo de 5 passos.

c) Considerando um longo tempo, determine o vetor de estado estacionário desse sistema.

Considerando o sistema como um processo de Markov, temos:

35

a)

P =





















0
3
10
1
5
3
10
1
5
0

0

0

3
10
0
3
10
1
5
0
1
5
0

0

1
5
3
10
0
3
10
0

0
1
5
0

3
10
1
5
3
10
0

0

0

0
1
5

1
5
0

0

0

0
3
10
1
5
3
10

0
1
5
0

0
3
10
0
3
10
1
5

0

0
1
5
0
1
5
3
10
0
3
10





















0

0

0
1
5
3
10
1
5
3
10
0

b) Sabendo que a partícula inicia seus movimentos no vértice 1, temos:

x(0) =









































1

0

0

0

0

0

0

0

E portanto

x(1) =





















0

0, 3

0, 2

0, 3

0, 2

0

0

0





















,

x(2) =





















0, 26

0, 12

0, 18

0, 12

0

0, 12

0, 08

0, 12





















,

x(3) =





















0, 108

0, 18

0, 14

0, 18

0, 14

0, 072

0, 108

0, 072





















,

x(4) =





















0, 164

0, 125

0, 151

0, 125

0, 086

0, 125

0, 099

0, 125





















,

x(5) =





















0, 123

0, 144

0, 127

0, 144

0, 127

0, 106

0, 123

0, 106





















Informa as probabilidades dessa partícula estar em cada um dos vértices nos cinco primeiros

passos.

c) Fazendo uso da equação 2.1

(I − P)q = 0 =⇒





















0

0

1 − 3

10 − 1
1 − 3

− 3
10
5 − 3
− 1
10
− 3
5 − 3
10 − 1
10
− 1
0
0
5
− 1
0
5
0

0

0
− 1
5
0

0

0

10 − 1
5
0

5 − 3
10 − 1
5
1 − 3
10
1

0
− 1
5
0

0

0

0
− 1
0
5
− 1
0
0
0
5
5 − 3
10 − 1
1 − 3
10
10 − 1
1 − 3
5
1 − 3
10
1

0
0 − 3
10
− 1
5 − 3
0
10
5 − 3
10 − 1
5 − 3
− 1
10

36





























































q1
q2
q3
q4
q5
q6
q7
q8









































0

0

0

0

0

0

0

0

=

Que dá o sistema






10 q4 − 1

5 q3 − 3
10q3 − 1
10 q2 + q3 − 3
5q2 − 3

q1 − 3
10 q2 − 1
10q1 + q2 − 3
− 3
5 q1 − 3
− 1
− 3
10q1 − 1
5q1 + 0q2 + 0q3 + 0q4 + q5 − 3
− 1
5 q2 + 0q3 + 0q4 − 3
0q1 − 1
5q3 + 0q4 − 1
0q1 + 0q2 − 1
5 0q4 − 3
0q1 + 0q2 + 0q3 − 1

5 q5 − 0q6 + 0q7 + 0q8 = 0
5q4 + 0q5 − 1
5 q6 + 0q7 + 0q8 = 0
10 q4 + 0q5 + 0q6 + 0q7 + 0q8 = 0
5q8 = 0
10q8 = 0
5 q8 = 0
10 q8 = 0
10 q7 + q8 = 0

10 q3 + q4 + 0q5 + 0q6 + 0q7 − 1
5q7 − 3
10 q7 − 1
10 q6 + q7 − 3
5 q6 − 3

10 q6 − 1
10 q5 + q6 − 3
5 q5 − 3
10 q5 − 1

De solução q1 = q2 = q3 = q4 = q5 = q6 = q7 = q8 = t e como

1
8 = 0, 125

8
∑
i=1

qi = 1 =⇒ 8t = 1 =⇒ t =

Portanto, após muitos movimentos a partícula terá probabilidade 0,125 de estar em cada

vértice. O que já era esperado.

Exemplo 3.2 Um ratinho é colocado dentro de uma caixa com quatro compartimentos, como

mostra a ﬁgura 3.2. Ele é treinado a mudar de compartimento toda vez que um alarme soa,

passando por uma das portas. Supondo que o ratinho ocupe inicialmente o compartimento 4

e que a escolha da porta seja de maneira aleatória sem interferências de escolhas anteriores,

calcule a probabilidade de o ratinho ocupar o compartimento 1 após o alarme ter soado 5 vezes.

Calcule também as probabilidades de o ratinho estar em cada compartimento após n soadas do

alarme, considerando n um número grande.

Considerando o sistema como um processo de Markov, temos:

37

Figura 3.2: Labirinto

Matriz de transição










P =

p11 p12 p13 p14
p21 p22 p23 p24
p31 p32 p33 p34
p41 p42 p43 p44



















=

0 1
1
3 0
3
2 0 1
1
1
3
2
3 0 1
1
1
2
2
1
0 1
3 0
3










Onde cada pi j representa a probabilidade de estando o ratinho no compartimento j dele ir para
o compartimento i com i, j ∈ {1, 2, 3, 4}.

Vetor de estado inicial x(0) =



















0

0

0

1

Uma vez que o ratinho ocupa inicialmente o compartimento 4.

Portanto fazendo uso do teorema 1.1, temos:

x(5) = P(5)x(0) =










0, 16

0, 34

0, 34

0, 16










Logo a probabilidade dele ocupar o compartimento 1, após 5 soadas do alarme é 16%

aproximadamente.

Agora considerando n um número grande. Ou seja, queremos, se possível, o vetor de estado

estacionário para esse sistema. Temos que a matriz de transição é regular, pois para n = 2 temos

P2 =










1
3
1
6
1
6
1
3

1
9
4
9
1
3
1
9

1
9
1
3
4
9
1
9










1
3
1
6
1
6
1
3

que possui todas as entradas positivas.

38

Usando agora a equação 2.1, temos:


(I − P)q = 0 =⇒








1 − 1
− 1
2
− 1
2 − 1
3
3 − 1
0 − 1
3

3 − 1
0
3
3 − 1
1 − 1
2
1 − 1
2
1




























q1
q2
q3
q4



















0

0

0

0

=

Com sistema






q1 − 1
3 q2 − 1
− 1
2q1 + q2 − 1
2q1 − 1
− 1
0q1 − 1

3 q3 + 0q4 = 0
3 q3 − 1
2 q4 = 0
3q2 + q3 − 1
2 q4 = 0
3q2 − 1
3q3 + q4 = 0

de solução:

qi = 1 =⇒ t + 3

2 + 3

2t + t = 1 =⇒ t = 1
5

q1 = q4 = t e q2 = q3 = 3

2t. Como

4
∑
i=1

Portanto q =



















1
5
3
10
3
10
1
5










0, 2

0, 3

0, 3

0, 2










=

Assim podemos concluir que o ratinho permanece 20% do tempo no compartimento 1, 30%

no compartimento 2, 30% no compartimento 3 e 20% no compartimento 4, considerando muitas

soadas no alarme.

Exemplo 3.3 Uma folha está localizada num dos três pontos A, B ou C, no círculo da ﬁgura 3.3.

Cada período ﬁxo de tempo a folha se move para um ponto adjacente ou permanece estável da

seguinte maneira, move-se no sentido anti-horário com probabilidade 1/3, no sentido horário

com probabilidade 1/2 e permanece estável com probabilidade 1/6.

Figura 3.3: Círculo

a) Construa a matriz de transição P.

b) Considerando inicialmente que a folha encontra-se no ponto A, determine a probabilidade

dela estar no ponto C após 1, 2, 3 e 4 movimentos.

39

c) Qual a probabilidade dessa folha estar no ponto C após muitos movimentos.




a) Matriz de transição P =





1
6
1
2
1
3

1
3
1
6
1
2






1
2
1
3
1
6


b) Vetor de estado inicial x(0) =





Portanto x(1) =







0, 167

0, 5

0, 333







, x(2) =











0, 361

0, 278

0, 361

, x(3) =







0, 333

0, 347

0, 320







, x(4) =







0, 331

0, 331

0, 338







1

0

0







Indicam os vetores estado nos 4 primeiros movimentos dessa folha.

c) (I − P)q = 0 =⇒







3 − 1
6 − 1
5
2
6 − 1
5
− 1
2
3
5
3 − 1
− 1
6
2



















=













0

0

0

q1
q2
q3

Com sistema





6q1 − 1
5
2 q1 + 5
− 1
3 q1 − 1
− 1

3q2 − 1
6 q2 − 1
2 q2 + 5

2q3 = 0
3 q3 = 0
6 q3 = 0

De solução q1 = q2 = q3 = t. Como q1 + q2 + q3 = 1 =⇒ t + t + t = 1 =⇒ t = 1
3

Portanto

q =













1
3
1
3
1
3

Assim, após muitos movimentos a probabilidade dessa folha estar no ponto C é 1/3.

O último exemplo será baseado em jogos, que entendemos ser uma ferramenta pedagógica

que permite ao aluno criar suas próprias soluções, desenvolve o raciocínio lógico e dedutivo, o

jogo será disputado numa melhor de 3, sendo o dado lançado 3 vezes, mesmo que um jogador

já tenha vencido a partida.

Exemplo 3.4 Jogo de dados com empate: Sempre três lançamentos

40

Tomemos um dado normal e dois jogadores A e B. Para cada lançamento de dados estabe-

lecemos os seguintes resultados: se o lançamento der um número primo A ganha um ponto; se

o lançamento der um número composto B ganha um ponto, se o lançamento der 1 há empate.

O jogo termina após três lançamentos.

Expressemos a pontuação na forma (x, y, z) onde x,y e z são os números de pontos ganhos por

A, por B e o número de empates, respectivamente. Desejamos:

a) As probabilidades de cada resultado ﬁnal.

b) A probabilidade de o jogador A vencer a partida.

c) A probabilidade de o jogador B vencer a partida.

d) Determine também a probabilidade de o jogo terminar empatado.

Considerando o sistema como um processo de Markov e sendo os possíveis placares do jogo

ﬁgura 3.4 os estados da cadeia, temos:

Figura 3.4: Estados

Assim a matriz de transição será uma matriz quadrada de ordem 20.

41

P =





















































0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
1
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
1
3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
1
6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 1
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 1
1
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
3
6 0 1
0 1
2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1
3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1
1
3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
6
0 0 0 1
6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 1
2 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0
0 0 0 0 1
1
2 0 0 0 0 0 1 0 0 0 0 0 0 0 0
3
0 0 0 0 1
6 0 1
2 0 0 0 0 0 1 0 0 0 0 0 0 0
0 0 0 0 0 1
2 0 0 0 0 0 0 1 0 0 0 0 0
0 0 0 0 0 1
2 0 0 0 0 0 1 0 0 0 0 0
6
0 0 0 0 0 0 1
2 0 0 0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 1
3 0 0 0 0 0 0 0 0 1 0 0 0
0 0 0 0 0 0 0 1
1
3 0 0 0 0 0 0 0 0 1 0 0
6
0 0 0 0 0 0 0 0 1
1
3 0 0 0 0 0 0 0 0 1 0
6
0 0 0 0 0 0 0 0 0 1
6 0 0 0 0 0 0 0 0 0 1

3 0 1
3 0 1
1
6 0 0 1





















































Onde cada entrada pi j da matriz é a probabilidade de estando o jogo com o resultado j ele

ir para o resultado i, após um ponto marcado.

Obs: As entradas p1111 , p1212 , p1313, ... ,p2020 são todas iguais a 1, pois estando o jogo em
um desses estados (11, 12,13,...,20) não será mais possível sair deles, o jogo termina. Esses

estados são chamados estados absorventes. [5]

Como o jogo se inicia no estado 1, o vetor de estado inicial será:

(cid:104)

x(0) =

1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

(cid:105)t

onde t signiﬁca transposta.

Assim, com três lançamentos, temos:

x(3) = P3x(0) =

(cid:104)

0 0 0 0 0 0 0 0 0 0 1
8

1
4

1
8

1
6

1
6

1
24

1
27

1
18

1
36

1
216

(cid:104)

(cid:39)

0

0

0

0

0

0

0

0

0

0

0, 125

0, 25

0, 125

0, 167

0, 167

0, 041

0, 037

0, 055

0, 028

0, 005

(cid:105)t

(cid:105)t

Esse vetor indica que

42

P(3, 0, 0) =

P(2, 0, 1) =

1
8

1
8

P(1, 1, 1) =

P(0, 3, 0) =

1
6

1
27

= 0, 125 P(2, 1, 0) =

= 0, 125 P(1, 2, 0) =

(cid:39) 0, 167 P(1, 0, 2) =

(cid:39) 0, 037 P(0, 2, 1) =

P(0, 1, 2) =

1
36

(cid:39) 0, 028 P(0, 0, 3) =

1
4

1
6

= 0, 250

(cid:39) 0, 167

1
24

1
18

(cid:39) 0, 041

(cid:39) 0, 055

1
216

= 0, 005

P(A) =

1
8

+

1
4

+

1
8

+

1
24

=

13
24

P(B) =

1
6

+

1
27

+

1
18

+

1
36

=

31
108

P(E) =

1
6

+

1
216

=

37
216

Portanto,

43

CONSIDERAÇÕES FINAIS

Estar atento ao nível de diﬁculdade que os alunos têm em receber o conhecimento de um

determinado conteúdo, é uma observação importante que o professor deve fazer. Acompa-

nhando como é difícil à compreensão por parte dos alunos aos conceitos relacionados com as

probabilidades, foi apresentado as cadeias de Markov.

Estas apresentam conceitos essenciais e são acessíveis a todo aluno do ensino médio, pois

o conteúdo pode ser repassado sem muito rigor como um tópico dentro de probabilidades, uma

vez que os pré-requisitos necessários são: conceitos básicos de matrizes, sistemas lineares e

probabilidades. As cadeias nos permitem resolver problemas probabilísticos com temas coti-

dianos que se tornariam inviáveis de serem solucionados em sala de aula através das técnicas

encontradas na maioria dos livros. Outra grande vantagem de se utilizar as cadeias de Markov,

está na organização dos dados para a resolução do problema, onde os alunos são direcionados

ao preenchimento das matrizes e ao conhecimento destas. O uso agregado do software Maxima,

possibilita aos alunos maior facilidade em assimilar o assunto, pois não há desvio da atenção

destes para cálculos e utiliza a tecnologia, uma ferramenta que dominam muito bem.

As cadeias de Markov por todas as vantagens apresentadas, só tendem a propiciar profes-

sores e alunos um ambiente de trabalho onde a troca de experiências e as discussões a cerca do

assunto sejam aliados no processo de ensino-aprendizagem.

Por ﬁm, esperamos que este trabalho seja utilizado por professores e levado aos alunos do

ensino médio (possivelmente através de uma Iniciação Cientíﬁca Junior).

44

REFERÊNCIAS

[1] BOLDRINE, J. L.; COSTA, S. I. R.; FIGUEIREDO, V. L.; WETZLER, H. G. Álgebra

Linear. São Paulo: Harper e Row, 1980.

[2] GIRALDO, V.; CAETANO, P.; MATTOS, F. Recursos computacionais no ensino de mate-

mática MA-36 Coleção Profmat. Rio de Janeiro: SBM, 2012.

[3] HOWARD, A.; RORRES, C. Álgebra Linear com aplicações. Porto Alegre: Bookman,

2012.

[4] KEMENY, J. G.; SNELL, J. L. Finite Markov Chains. New York: Springer-Verlag, 1960.

[5] VIEIRA, F. Z. G. Cadeias de Markov Homogêneas Discretas. Campinas: Universidade

Estadual de Campinas - Dissertação de Mestrado, 2011.

[6] MEC. Parâmetros Curriculares Nacionais: Matemática/Secretaria de Educação. Brasília:

MEC, 1997.

