IMPA - INSTITUTO NACIONAL DE MATEM ´ATICA PURA E

APLICADA
PROFMAT - PROGRAMA DE MESTRADO PROFISSIONAL EM
MATEM ´ATICA
TRABALHO DE CONCLUS ˜AO DE CURSO

Fun¸c˜oes Geratrizes: conceitos b´asicos e exemplos

Daniel Moror´o

PROFESSOR ORIENTADOR:

ROBERTO IMBUZEIRO OLIVEIRA

RIO DE JANEIRO
30 de Novembro de 2016

Conte´udo

1 Introdu¸c˜ao

3

2 Deﬁni¸c˜oes de Fun¸c˜oes Geratrizes

5
5
2.1 Deﬁni¸c˜oes Formais
2.2 Manipulando Fun¸c˜oes Geratrizes
9
2.3 Deﬁni¸c˜oes Anal´ıticas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
(Algumas) S´eries Not´aveis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
2.4

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 N´umeros de Catal˜ao

21
3.1 Alguns Exemplos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
3.2 A Recorrˆencia de Segner . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
3.3 A OGF para c(n)’s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4 ´Arvores Rotuladas: A F´ormula de Cayley

31
4.1 Teorema da Contagem Rotulada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
´Arvores Rotuladas com Ra´ız . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
4.2
´Arvores Rotuladas
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
4.3
4.4 Demonstra¸c˜oes Pendentes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
4.5 Um Problema Adicional: Grafos Conexos . . . . . . . . . . . . . . . . . . . . . . . . 39

5 Representa¸c˜oes em Forma de Soma e o Teorema de Schur

41
5.1 Teorema da Contagem n˜ao Rotulada . . . . . . . . . . . . . . . . . . . . . . . . . . 41
5.2 O Problema do Troco . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
5.3 O Teorema de Schur

Bibliograﬁa

47

1

Lista de Figuras

1.1 Triangula¸c˜oes de um quadril´atero e de um pent´agono . . . . . . . . . . . . . . . . .
1.2 Algumas das 16 ´arvores rotuladas com 4 v´ertices . . . . . . . . . . . . . . . . . . . .

3
4

3.1 Caminhos de Catal˜ao de comprimento 2 e 3 . . . . . . . . . . . . . . . . . . . . . . 21
. . . . . . . . . . . . . . . . 22
3.2 Caminhos de Catal˜ao e seu equivalente em parˆenteses.
´Arvores Planas e seus respectivos arranjos de parˆenteses.
3.3
. . . . . . . . . . . . . . . 24
triangula¸c˜oes de alguns pol´ıgonos convexos. Dispon´ıvel em [Cat] p.3 . . . . . . . . . 24
3.4
3.5 Apertos de m˜ao para os casos 2, 4, 6 e 8. Dispon´ıvel em [Cat] p.3 . . . . . . . . . . 25
3.6 Uma estrat´egia para calcular e(5)
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
3.7 Uma estrat´egia para calcular s(6) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4.1 Uma ´arvore (esq), duas ´arvores rotuladas (centro) e duas ´arvores rotuladas com ra´ız

(dir), todas com 6 v´ertices. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
4.2 Duas ﬂorestas rotuladas com ra´ız. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
4.3 Decomposi¸c˜ao de uma permuta¸c˜ao em ciclos (cima). Cartas correspondentes (abaixo) 32
4.4 Decomposi¸c˜ao de uma ﬂoresta em blocos disjuntos (esq). Cartas (´arvores) equiva-

lentes aos blocos destacados (dir)
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
´arvores rotuladas com ra´ız de 3 v´ertices . . . . . . . . . . . . . . . . . . . . . . . . . 36
4.5
4.6 Exemplo com 4 v´ertices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

5.1 Visualizando as cartas n˜ao rotuladas. . . . . . . . . . . . . . . . . . . . . . . . . . . 42

2

Cap´ıtulo 1

Introdu¸c˜ao

A Matem´atica Discreta tem angariado cada vez mis espa¸co nas escolas de ensino fundamental
e m´edio do Brasil. Temas como An´alise Combin´at´oria e Teoria de Grafos est˜ao sendo exigidos no
Exame Nacional do ensino M´edio e pouco a pouco vem sendo difundidos nas s´eries mais b´asicas
de forma¸c˜ao.

Durante o curso de Matem´atica Discreta oferecido no PROFMAT em 2014, foi aprofundada a
mat´eria de sequˆencias, assunto que, assim como os outros mencionados, sofre alguma abordagem
nas salas de aula.

Nesse sentido de amplia¸c˜ao de horizontes, esse trabalho ´e uma tentativa de apresentar a profes-
sores e alunos entusiastas algum conte´udo sobre fun¸c˜oes geratrizes, fornecendo, al´em de conceitos
b´asicos, algumas ferramentas e exemplos cl´assicos referentes a esse assunto, com o qual tive contato
somente quando aluno em progresso avan¸cado na gradua¸c˜ao.

A estrutura desse trabalho foi elaborada da seguinte maneira:

cap. ii) Deﬁni¸c˜oes iniciais. Todo o aparato alg´ebrico necess´ario sobre s´eries formais de potˆencias
´e apresentado, passando rapidamente por alguns resultados sobre fun¸c˜oes anal´ıticas;

cap. iii) N´umeros de Catal˜ao. Vemos, entre outros, o seguinte problema: Considere um pol´ıgono
convexo de n lados. De quantas formas podemos triangulariz´a-lo atrav´es de suas diagonais
de maneira que as diagonais escolhidas n˜ao se cruzem? Para uma vizualiza¸c˜ao do proposto,
segue uma imagem com as triangula¸c˜oes do quadrado e do pent´agono:

Figura 1.1: Triangula¸c˜oes de um quadril´atero e de um pent´agono

3

Note que o quadarado possui 2 triangula¸c˜oes e o pent´agono possui 5. ´E apresentada a
sequˆencia dessas triangulariza¸c˜oes, bem como outros problemas com os quais ela est´a relaci-
onada. Por ﬁm mostramos uma abordagem por fun¸c˜oes geratrizes para obter uma f´ormula
posicional para seus termos;

cap. iv) ´Arvores Rotuladas e a F´ormula de Cayley. Nesse cap´ıtulo exibimos uma f´ormula
posicional para o n´umero de ´arvores rotuladas de n v´ertices (Ver pr´oxima ﬁgura). Em outras
palavras resolvemos o problema Quantos grafos rotulados, conexos e sem ciclos existem com
n v´ertices?

Deﬁnimos alguns conceitos sobre esse tipo de grafo e, ap´os alguns passos, chegamos a uma
demonstra¸c˜ao do resultado, devido a Arthur Cayley;

Figura 1.2: Algumas das 16 ´arvores rotuladas com 4 v´ertices

cap. v) O problema do Troco. Fun¸c˜oes geratrizes em forma de soma s˜ao apresentados para
concluirmos um bel´ıssimo resultado anal´ıtico, o Teorema de Schur, que d´a uma aproxima¸c˜ao
para o problema de calcular o n´umero de maneiras de ”trocar”uma quantia n em valores de
moedas de um determinado sistema ﬁnanceiro.

4

Cap´ıtulo 2

Deﬁni¸c˜oes de Fun¸c˜oes Geratrizes

Este cap´ıtulo se dedica a apresentar o objeto central de estudo neste trabalho e algumas ferra-

mentas para sua utiliza¸c˜ao.

2.1 Deﬁni¸c˜oes Formais

Deﬁni¸c˜ao 2.1. Uma s´erie formal de potˆencias ´e uma express˜ao do tipo:

F (x) =

(cid:88)

n≥0

anxn

(com an ∈ C).

Deﬁni¸c˜ao 2.2. Uma fun¸c˜ao geratriz ordin´aria (OGF) ´e uma s´erie formal de potˆencias cujos
coeﬁcientes s˜ao os elementos de uma dada sequˆencia.

Ser´a usado o s´ımbolo:

{an}∞
0

OGF−→ F

signiﬁcando que F ´e a fun¸c˜ao geratriz da sequˆencia an.

Deﬁni¸c˜ao 2.3. Uma sequˆencia inﬁnita de n´umeros complexos ´e uma lista ordenada {an}∞
0 :=
(a1, a2, a3, . . . ) onde s˜ao determinados o primeiro, o segundo termo, o terceiro e assim sucessi-
vamente.

A palavra ”formal”siginiﬁca que xn representa nada mais do que uma marca¸c˜ao para a posi¸c˜ao
do n-´esimo termo de uma sequˆencia, sem considerar tomar valores particulares ou quest˜oes sobre
convergˆencia.

Exemplo 2.1. Tomamos a P.G. com raz˜ao 1
´e (cid:0)5, 5
5 + 5x

4, 5
2, 5
22 + 5x3
2 + 5x2

23 + · · · = (cid:80)

2 e primiero termo 5. A sequˆencia que a determina
8, ...(cid:1), enquanto a s´erie formal de potˆencias associada a ela ´e a express˜ao: G(x) =

5 (cid:0) x

(cid:1)n.

2

n≥0

Exemplo 2.2. A sequˆencia de n´umeros de n´umeros (1, 1, 2, 5, 14, 42, 132, . . . ) tem sua s´erie
formal de potˆencias deﬁnida por C(x) = 1 + x + 2x2 + 5x3 + 14x4 + 42x5 + 132x6 + . . .

´E comum usarmos a nota¸c˜ao:

[xn] F (x) := an

5

para nos referirmos ao coeﬁciente de xn em F (x) = (cid:80)

anxn. Nos exemplos anteriores [x4] C(x) =

n≥0

14 enquanto que [xn] G(x) = 5
2n .

Observe que enquanto no primeiro exemplo ´e muito f´acil apresentar uma f´ormula posicional
(que depende apenas da posi¸c˜ao) para as parecelas da s´erie, o segundo parece nem sequer possuir
alguma f´ormula. Mais adiante exibiremos uma f´ormula posicional para essa sequˆencia (de Catal˜ao).
E ´e exatamente essa a ﬁnalidade principal das fun¸c˜oes geratrizes neste trabalho: apresentar
uma f´ormula posicional para deternimadas sequˆencias, ou seja, determinar uma express˜ao capaz
de calcular o n-´esimo termo de uma sequˆencia munindo apenas o valor ”n”de sua posi¸c˜ao.
Mas para isso ´e necess´ario adentrarmos mais no estudo das s´eries formais de potˆencias.

Deﬁni¸c˜ao 2.4. O conjunto C [[X]] =

(cid:26)

F (x)

F (x) = (cid:80)

anxn ; an ∈ C

(cid:27)

´e o conjunto das

(cid:12)
(cid:12)
(cid:12)
(cid:12)

n≥0

s´eries formais de potˆencias com coeﬁcientes em C.

Se a esse conjunto, inclu´ımos as opera¸c˜oes:

O.1)

(cid:18)

anxn

(cid:80)
n≥0

(cid:19)

+

(cid:18)

bnxn

(cid:80)
n≥0

(cid:19)

= (cid:80)

n≥0

(an + bn)xn;

O.2)

(cid:18)

anxn

(cid:80)
n≥0

(cid:19) (cid:18)

bnxn

(cid:80)
n≥0

(cid:19)

= (cid:80)

n≥0

n
(cid:80)
i≥0

(ai · bn−i)xn;

(C [[X]] , O.1, O.2) ser´a um dom´ınio de integridade. Essas opera¸c˜oes s˜ao semelhantes as usuais
opera¸c˜oes polinomiais. O.2 ´e chamado produto de Cauchy. A ideia para compreendˆe tal opera¸c˜ao
´e que uma parcela xn do esquerdo sempre surge quando coletamos dois coeﬁcientes de graus que
somem n e, assim, a parcela xn do lado direito ser´a a soma de todas essas duplas de coeﬁcientes.

Como (cid:80)

n≥0

n
(cid:80)
i≥0

ai.bn−i = (cid:80)

n≥0

n
(cid:80)
i≥0

bi.an−i, o dom´ınio ´e comutativo. O elemento neutro de O.2 ´e

1(x) = 1 + 0x + 0x2 + 0x3 + 0x4 + · · ·

Deﬁni¸c˜ao 2.5. S´eries rec´ıprocas F (x) e G(x) s˜ao aquelas tais que F (x).G(x) = 1(x). Denota-
remos G(x) = (F (x))−1 ou G(x) = 1
F (x)
Exemplo 2.3. As s´eries (1 − x) e (cid:80)

xn s˜ao rec´ıprocas. De fato:

(1 − x) .

(cid:88)

xn =

n≥0

(cid:88)

n
(cid:88)

n≥0

n≥0

i≥0

ai.1,

onde ai =






1, se i = 0;
−1, se i = 1;

0, c.c.

= a0 + (a0 + a1) + (a0 + a1 + a2) + (a0 + a1 + a2 + a3) + · · ·

= a0 + (a0 + a1) + (a0 + a1) + (a0 + a1) + · · ·

= 1 + 0x + 0x2 + 0x3 + · · · .

De modo mais geral, temos que (cid:80)

1−rx n˜ao possui
nenhum sentido anal´ıtico aqui, isto ´e, representa apenas a s´erie formal de potˆencias rec´ıproca
de (cid:80)

1−rx . ´E importante ressaltar que

rxn = 1

rxn.

n≥0

1

n≥0

6

(C [[X]] , O.1, O.2) n˜ao ´e um corpo pois n˜ao s˜ao todas as s´eries formais de potˆencias que

adimitem rec´ıprocos. O teorema a seguir revela aqueles que o possuem.

Proposi¸c˜ao 2.1. F (x) admite rec´ıproco se e somente se a (cid:54)= 0. Al´em disso, (F (x))−1 ´e ´unico.

Demonstra¸c˜ao. Seja (F (x))−1 = (cid:80)

bnxn.

n≥0

(⇒) Por hip´otese F (x). (F (x))−1 = 1(x). Ou seja:

n
(cid:88)

i≥0

aibn−i = cn =

(cid:26) 1, se n = 0;
0, c.c.

Portanto c0 = 1 = a0b0 =⇒ b0 = 1
a0

=⇒ a0 (cid:54)= 0, pois a0 e b0 ∈ C. E mais ainda:

c1 = 0 = a0b1 + a1b0 =⇒ b1 = −

c2 = 0 = a0b2 + a1b1 + a2b0 =⇒ b2 = −

c3 = 0 = a0b3 + a1b2 + a2b1 + a3b0 =⇒ b3 = −

...

n
(cid:88)

i≥0

cn = 0 =

aibn−i =⇒ bn = −

a1b0
a0
a1b1 + a2b0
a0

a1b2 + a2b1 + a3b0
a0

1
a0

n
(cid:88)

i≥1

aibn−i.

Este processo calcula todos os termos bn em fun¸c˜ao dos an, o que garante a unicidade de (F (x))−1
(⇐) Se a0 (cid:54)= 0 ent˜ao existe b0 = 1
. Logo ´e poss´ıvel construir unicamente os termos bn, pelo
a0
processo descrito anteriormente, de tal forma que F (x). (F (x))−1 = 1(x).

(cid:3)

Exemplo 2.4. O exemplo 2.2 que mostrava a seguinte s´erie formal de potˆencias C(x) = 1 + x +
2x2 + 5x3 + 14x4 + 42x5 + 132x6 + . . . possui rec´ıproco. Os primeiros 7 termos de (C(x))−1 est˜ao
calculados a seguir:

7

bn

b0

b1

b2

b3

b4

b5

1
a0

= 1
1

− a1b0
a0

= − 1.1
1

− a1b1+a2b0
a0

= − 1.(−1)+2.1

1

− 1.(−1)+2.(−1)+5.1
1

− 1.(−2)+2.(−1)+5.(−1)+14.1
1

valor

1

-1

-1

-2

-5

− 1.(−5)+2.(−2)+5.(−1)+14.(−1)+42.1
1

-14

b6 − 1.(−14)+2.(−5)+5.(−2)+14.(−1)+42.(−1)+132.1

1

-42

Deﬁni¸c˜ao 2.6. Sejam duas s´eries formais F (x) = (cid:80)

anxn e G(x) = (cid:80)

bnxn. A composi¸c˜ao

n≥0

n≥1

dessas s´eries formais F (G(x)) ´e a express˜ao

F (G(x)) :=

an(G(x))n.

(cid:88)

n≥0

Note que a composi¸c˜ao s´o est´a bem deﬁnida quando o coeﬁciente independente de G(x), b0, ´e
igual a zero. Essa exigˆencia reside na seguinte situa¸c˜ao: imagine uma parcela gen´erica do ´ultimo
somat´orio an(b0 + b1x + b2x2 + . . . )n. Imagine agora que seja necess´ario encontrar [x8] da nossa
composi¸c˜ao. Se b0 (cid:54)= 0, todas as potˆencias (b0+b1x+b2x2+. . . )n contribuir˜ao com algum coeﬁciente
de grau 8 (Por exemplo, quando n = 43, basta selecionar o coeﬁciente b0 35 vezes, b1 4 vezes e b4
1 vez). Quando b0 = 0 apenas as parcelas com n ≤ 8 ter˜ao contribui¸c˜oes de grau 8 para fazer.
Ganha-se ent˜ao um processo ﬁnito com a tal condi¸c˜ao.

Assim ´e poss´ıvel deﬁnir outro importante conceito: o de s´eries formais inversas.

Deﬁni¸c˜ao 2.7. Duas s´eries formais F (x) = (cid:80)

anxn e G(x) = (cid:80)

bnxn s˜ao consideradas inversas

quando:

n≥1

n≥1

F (G(x)) = G(F (x)) = x,

Denotaremos G(x) = (F (x))(−1) (com −1 entre parˆenteses para diferenciar da s´erie rec´ıproca

(F (x))−1).

N˜ao ´e dif´ıcil ver que, se F (x) e G(x) s˜ao fun¸c˜oes inversas, ent˜ao a1 e b1 s˜ao diferentes de 0.

8

Deﬁni¸c˜ao 2.8. Os operadores:

DF (x) =

nanxn−1, e

(cid:88)

n≥0

D−1F (x) =

an
n + 1

(cid:88)

n≥0

xn+1

s˜ao denominados derivada e derivada inversa da OGF F(x).

Proposi¸c˜ao 2.2. A derivada deﬁnida em 2.8 sofre das propriedades:

D.1) D(F (x) + G(x)) = DF (x) + DG(x);

D.2) D(F (x)G(x)) = DF (x)G(x) + F (x)DG(x), e

D.3) D(F (G(x))) = DF (G(x))DG(x).

O que signiﬁca que a deﬁi¸c˜ao 2.8 de derivada funciona exatamente como a derivada para fun¸c˜oes

nesses 3 casos. Deixaremos essas demonstra¸c˜oes para o leitor.

Antes de prosseguirmos para a pr´oxima sec¸c˜ao, apresentamos mais uma deﬁni¸c˜ao que ser´a

utilizada:

Deﬁni¸c˜ao 2.9. O operador

1
xk

F (x)
xk

:=

(cid:88)

n≥k

anxn−k

que ´e v´alido apenas quando F (x) = (cid:80)

anxn, isto ´e, em fun¸c˜oes geratrizes cujos coeﬁcientes s˜ao

todos nulos at´e o grau k − 1.

Por ﬁm, se [xn] F = an:

n≥k

[xn] (c.F ) = c [xn] F = c.an,

[xn] (xkF ) = (cid:2)xn−k(cid:3) F = an−k e

[xn]

(cid:19)

(cid:18) F
xk

= (cid:2)xn+k(cid:3) F = an+k,

com c ∈ C.

2.2 Manipulando Fun¸c˜oes Geratrizes

Se {an}∞
0

OGF−→ F e {bn}∞

0

OGF−→ G, decorre das deﬁni¸c˜oes de O.1 e O.2 que:

P.1) {an + bn}∞
0

OGF−→ F + G e,

P.2) {(cid:80)n

i=0 aibn−i}∞

0

OGF−→ F.G

Aﬁm de nos auxiliar com os c´alculos envolvendo sequˆencias, enunciamos a:

9

Proposi¸c˜ao 2.3. Sejam inteiros k > 0 e p ≥ 0. Se {an}∞
0
seguintes propriedades:

OGF−→ F , ent˜ao s˜ao verdadeiras as

P.3) {an+k}∞
p

OGF−→

F (x) − a0 − a1x − · · · ap+(k−1)xp+(k−1)
xk

;

P.4) {an−k}∞
k

OGF−→ xkF ;

P.5) {an−k}∞
p

OGF−→ xk (cid:0)F (x) − a0 − a1x − · · · ap−(k+1)xp−(k+1)(cid:1) , com p > k;

P.6) (cid:8)nkan

(cid:9)∞
0

OGF−→ (xD)kF

P.7) {1}∞
0

OGF−→

1
1 − x

P.8)

(cid:41)∞

(cid:40) n

(cid:88)

ai

i≥0

0

OGF−→

F
1 − x

Demonstra¸c˜ao. P.3. Deﬁna {an+k}∞
p

OGF−→ G = (cid:80)

an+kxn

n≥p

G =

(cid:88)

an+k xn

xkG =

n≥p
(cid:88)

an+k xn+k

xkG + a0 + a1x1 + · · · + ap+k−1xp+k−1 =

n≥p

p+k−1
(cid:88)

anxn +

(cid:88)

an+k xn+k = F (x)

n≥p

n≥0
F (x) − a0 − a1x − · · · − ap+k−1xp+k−1
xk

G =

P.4. Deﬁna {an−k}∞
k

OGF−→ G = (cid:80)

an−kxn

n≥p

G =

(cid:88)

an−k xn

an−k xn−k

n≥k
(cid:88)

G
xk =
G
xk =
G = xkF (x).

n≥k
(cid:88)

n≥k

an−kxn−k = F (x)

P.5. Deﬁna {an−k}∞
p>k

OGF−→ G = (cid:80)

an−kxn

n≥p

G =

(cid:88)

an−k xn

n≥p>k

10

G
xk =

G
xk + a0 + a1x − · · · − ap−k−1xp−k−1 =

(cid:88)

n≥p>k

p−k−1
(cid:88)

n≥0

an−k xn−k

anxn +

(cid:88)

n≥p

an−k xn−k = F (x)

G = xk(F (x) − a0 − a1x − · · · − ap−k−1xp−k−1).

P.6. Deﬁna {nan}∞
0

OGF−→ G = (cid:80)

anxn

n≥0

G =

(cid:88)

nanxn

n≥0
(cid:88)

anxnxn−1

=

=

n≥0
(cid:88)

n≥0

= xD

anxD(xn)



xn







(cid:88)

n≥an

= xDF.

Isto prova a veracidade para k = 1. Assumindo v´alida para k − 1, demonstra-se indutivamente,
com passagens an´alogas, a igualdade para o caso geral.
1−x ´e a OGF de (cid:80)

xn, o que signiﬁca que {1}∞
0

P.7. No exemplo 2.3, vimos que

OGF−→ F .

1

n≥0

P.8. Observando que F

1−x = F. 1

1−x:

F.

1
1 − x

O.2 e P.7=

(cid:88)

n
(cid:88)

n≥0

i≥0

ai.1xn =

(cid:88)

n≥0

(a0 + a1 + a2 + · · · + an)xn

(cid:3)

Portando essas ferramentas, ´e poss´ıvel apresentar alguns problemas elementares:

Problema 1. Determinar o n-´esimo termo da s´erie de potˆencias
calcule [xn]

1
(1−x)2

1

(1−x)2 . Em outras palavras,

Solu¸c˜ao. Nos basta observar:

1
(1 − x)2 =

1
(1 − x)

·

1
(1 − x)

O.2=

(cid:88)

n
(cid:88)

n=0

i=0

1.1xn =

n
(cid:88)

i=0

(n + 1)xn

Problema 2. Seja a sequˆencia deﬁnida pela recorrˆencia

an+1 = an + 3

(n ≥ 0, a0 = 1) .

uma P.A. de raz˜ao 3 e primeiro termo a0 = 1. Determine a f´ormula do termo geral dessa sequˆencia
atr´av´es de fun¸c˜oes geratrizes.

11

Certamente o leitor conhece este resultado. Apesar de n˜ao ser o m´etodo mais pr´atico para o de-
terminarmos, ﬁca aqui essa solu¸c˜ao com o ﬁm de nos habituarmos `a t´ecnica em si, que aplicaremos
com frequˆencia.
Solu¸c˜ao. Seja F (x) a OGF da sequˆencia. Podemos multiplicar a igualdade por x e somar sobre
os valores de n para qual ela ´e v´alida. Assim:

(cid:88)

an+1xn =

anxn + 3

(cid:88)

xn P.3 e P.7→

(cid:88)

n≥0

n≥0
F (x) − a0
x

= F (x) + 3.

F (x) − 1 = xF (x) + 3x.

n≥0
1
1 − x
1
1 − x

F (x)(1 − x) = 3x

F (x) =

+ 1

1
1 − x
3x
(1 − x)2 +

1
(1 − x)

Para determinarmos o termo geral desta sequˆencia, tomamos [xn] ambos os lados da igualdade:

[xn] F (x) = [xn]

O.1= [xn]

(cid:18)

3
(1 − x)2 +
(cid:19)
(cid:18) 3x

(cid:19)

1
(1 − x)

(cid:18) 1

(cid:19)

+ [xn]

(1 − x)2
(cid:18)

(cid:19)

1
(1 − x)2

(1 − x)
(cid:18) 1

(cid:19)

(1 − x)

+ [xn]

= 3[xn−1]

= 3n + 1,

Problema 3. Encontrar a OGF da recorrˆencia

an+1 = 3an + 2

(n ≥ 0;

a0 arbitr´ario) ,

bem como uma express˜ao para seu termo geral.

Solu¸c˜ao. Tentaremos encontrar a OGF dessa sequˆencia da mesma forma que no exemplo anterior,
ou seja, multiplicando por xn e somando para aqueles n nos quais a sequˆencia ´e v´alida:

(cid:88)

an+1xn = 3

anxn + 2

(cid:88)

xn

(cid:88)

n≥0

n≥0
F (x) − a0
x

= 3F (x) + 2.

F (x) − a0 = 3xF (x) + 2x.

n≥0
1
1 − x
1
1 − x

12

F (x)(1 − 3x) =

2x
(1 − x)

+ a0

F (x) =

2x
(1 − x)(1 − 3x)

+

a0
(1 − 3x)

E como encontrar [xn] dessa fun¸c˜ao? Separando os fatores do denominador por fra¸c˜oes parciais!

2x
(1 − x)(1 − 3x)

=

A
1 − x

+

B
1 − 3x

Assim, multplicando os dois lados da igualdade a cima por (1−x) e fazendo x = 1, determinamos

A = −1. Multiplicando por (1 − 3x) e fazendo x = 1

3 encontramos B = 1. Portanto:

F (x) =

1
1 − 3x

−

1
1 − x

+

a0
1 − 3x

e o termo geral da sequˆencia ser´a (a0 + 1)3n − 1,

F (x) =

a0 + 1
1 − 3x

,

−

1
1 − x
(n ≥ 0).

Poder´ıamos ter resolvido simplesmente a igualdade polinomial A(1 − 3x) + B(1 − x) = 2x e
encontrar´ıamos os coeﬁcientes A e B da mesma forma. Entretanto, ao passo que o n´umero de
fra¸c˜oes aumenta os c´alculos se tornam maiores e o m´etodo utilizado no problema se torna mais
eﬁcaz. (No cap´ıtulo 5, teremos uma ideia concreta sobre esse fato)

No entanto, h´a um ponto em aberto: a opera¸c˜ao ”fazer x = 1” n˜ao tem sentido em C [[X]], onde
x n˜ao assume valores espec´ıﬁcos. Para justiﬁcarmos o seu uso posteriormente e acrescentarmos
ferramentas poderosas `as manipula¸c˜oes, apresentamos uma bordagem anal´ıtica das s´eries.

2.3 Deﬁni¸c˜oes Anal´ıticas

Nesta sec¸c˜ao apresentaremos algumas deﬁni¸c˜oes e resultados essenciais ao estudo das fun¸c˜oes
geratrizes, com a ﬁnalidade de justiﬁcar algumas manipula¸c˜oes alg´ebricas, pois sobre algumas
condi¸c˜oes uma s´erie formal corresponde a fun¸c˜ao complexa.

Deﬁni¸c˜ao 2.10. Seja B(0, R) uma bola aberta de raio R > 0 e uma fun¸c˜ao f : B → C. f ´e
anal´ıtica ao redor de 0 em C quando f ´e continuamente diferenci´avel, isto ´e:

dif.1) existe f (cid:48) de f em todo ponto de B (f (cid:48) tamb´em ´e uma fun¸c˜ao B → C);

dif.2) f (cid:48) ´e cont´ınua.

Teorema 2.1 (Hadamard). Seja uma s´erie de potˆencias F (x) = (cid:80)

anxn. Existe um ´unico n´umero

n≥0

0 ≤ R ≤ ∞, deﬁnido por:

R =

1
lim supn→∞ |an| 1

n

(cid:18) 1
∞

= 0, e

(cid:19)

= ∞

1
0

para o qual a s´erie converge para uma fun¸c˜ao f (x) quando |x| < R e diverge |x| > R. Esse n´umero
R ´e chamado Raio de Convergˆencia da s´erie.

13

Teorema 2.2. Seja uma fun¸c˜ao f (x) deﬁnida pela s´erie de potˆencias (cid:80)

anxn com raio de con-

n≥0

vergˆencia R. Ent˜ao:

(a) para cada k ≥ 1, temos que:

n(n − 1)(n − 2) . . . (n − k + 1)anxn−k

(cid:88)

n≥k

tamb´em possui raio de convergˆencia R;

(b) f ´e inﬁnitamente diferenci´avel em B(0, R) e al´em disso, f (k) ´e calculada pela express˜ao em

(a), para k ≥ 1 e x ∈ B(0, R) ;

(c) para cada n ≥ 0 temos que:

an =

1
n!

f (k)(x)

(cid:12)
(cid:12)
(cid:12)
(cid:12)n=0

anxn ´e anal´ıtica em |x| < R. Al´em disso, se a s´erie diverge em |x| > R, a fun¸c˜ao f (x) possui

anxn possui raio de convergˆencia R > 0, ent˜ao a fun¸c˜ao f (x) =

Proposi¸c˜ao 2.4. Se a s´erie (cid:80)
(cid:80)
n≥0
pelo menos uma singularidade em |x| = R

n≥0

Esses teoremas reunidos signiﬁcam que quando uma s´erie converge numa bola aberta de raio
R positivo centrado na origem, F (x), a s´erie de potˆencias, se comporta como uma f (x), a fun¸c˜ao
anal´ıtica, dentro desse aberto. Ainda mais, a derivada e antiderivada da fun¸c˜ao coincidem com as
da deﬁi¸c˜ao 2.8 para s´erie de potˆencias e ´e poss´ıvel calcular R em fun¸c˜ao dos coeﬁcientes da s´erie,
coeﬁcientes esses que ser˜ao dados pela expans˜ao da F´ormula de Taylor da fun¸c˜ao.

Como O.1 e O.2 s˜ao opera¸c˜oes que funcionam tanto para s´eries como para fun¸c˜oes, se houver
um raio de convergˆencia para as s´eries pode-se trabalhar com elas sob o aspecto de s´eries formais
ou como se fossem fun¸c˜oes anal´ıticas.

Voltando ao exemplo

2x
(1 − x)(1 − 3x)

, a s´erie tem um raio de convergˆencia 1

3, (a singularidade

mais pr´oxima da origem). Por tanto podemos trabalhar com a fun¸c˜ao equivalente.

Nota. As demonstra¸c˜oes desses teoremas da An´alise Complexa fogem ao foco principal deste
trabalho. Demonstra¸c˜oes de 2.1 podem ser encontradas em [Wil] p.46-47, [Szp] cap.7,p.8 e [Con]
p.31. A demonstra¸c˜ao de 2.2 ´e encontrada em [Con] p.35-37 e a proposi¸c˜ao 2.4 ´e encontrada em
[Wil] p.47-48 e [Con] p.37.

Problema 4. Escreva, utilizando fun¸c˜oes geratrizes uma express˜ao para o termo geral da re-
corrˆencia

an+1 = 2an + n (n ≥ 0, a0 = 1)

Solu¸c˜ao. Multiplicando por xn e somando sobre n ≥ 0:

an+1xn = 2

(cid:88)

n≥0

(cid:88)

n≥0

anxn +

(cid:88)

n.1xn P.6→

n≥0

14

F (x) − a0
x

= 2F (x) + xD

F (x) − 1 = 2xF (x) + x2

(cid:18) 1

(cid:19)

1 − x
1
(1 − x)2

F (x)(1 − 2x) = 1 +

x2
(1 − x)2

F (x) =

F (x) =

F (x) =

1
1 − 2x

+

x2
(1 − 2x)(1 − x)2

1 − 2x + x2
(1 − 2x)(1 − x)2

2
1 − 2x

−

1
(1 − x)2

Note, na segunda passagem, que j´a estamos derivando a fun¸c˜ao

1
1−x. E que mais uma vez

expandimos a F (x) em fra¸c˜oes parciais. Tomando o coeﬁciente [xn] de ambos os lados:

[xn] F (x) = [xn]

[xn] F (x) = 2 [xn]

1 − 2x
[xn] F (x) = 2n+1 − (n + 1)

(cid:18) 2

1 − 2x
(cid:18) 1

(cid:19)

−

(cid:19)

1
(1 − x)2
(cid:18)

− [xn]

(cid:19)

1
(1 − x)2

Problema 5. Encontre a OGF para an = 1
n

(n ≥ 1).

Solu¸c˜ao. Seja F (x) = (cid:80)

n≥1

xn
n . Note que:

DF (x) =

nxn
n

(cid:88)

n≥0

=

(cid:88)

n≥0

xn =

1
1 − x

, ou seja:

F (x) = D−1

(cid:18) 1

(cid:19)

1 − x

= − log(1 − x)

2.4

(Algumas) S´eries Not´aveis

Nos problemas anteriores, percebe-se uma que uma estrat´egia comum para determinarmos o
coeﬁciente de xn numa fun¸c˜ao geratriz mais elaborada ´e separarmos a mesma em fun¸c˜oes geratrizes
mais simples, cujas quais sabemos seus coeﬁcientes. Seguem algumas fun¸c˜oes not´aveis que nos
ajudar˜ao nesse intuito.

Deﬁni¸c˜ao 2.11. A s´erie (cid:80)

n≥0

xn
n! = ex ´e a fun¸c˜ao expoencial em tdodo plano complexo.

15

Deﬁni¸c˜ao 2.12. A s´erie (cid:80)

n≥1

(−1)n+1

n = log(1 + x), na bola B(0, 1).

Deﬁni¸c˜ao 2.13. A s´erie (cid:80)

(cid:1)xn = (1 + x)k, com k ∈ R, tamb´em na bola B(0, 1)

(cid:0)k
n

n≥0

Para que as deﬁni¸c˜oes fa¸cam sentido, pensemos, para a deﬁni¸c˜ao 2.11, na fun¸c˜ao complexa
ex. Ela ´e anal´ıtica em todo o plano complexo e portanto admite inﬁnitas derivadas e assim ´e
poss´ıvel calcular sua expans˜ao em s´erie de Taylor avaliada em x = 0, que culmina na identidade a
cima; mesmo racioc´ınio funciona para a dﬁni¸c˜ao 2.13 e at´e para a deﬁni¸c˜ao 2.12, mas esta poderia
tamb´em ser pensada a partir do problema 5, alterando x por −x na fun¸c˜ao.

Sobre o exemplo 2.13, note que o n´umero binomial:

(cid:19)

(cid:18)k
n

:=

(cid:40) 1

se k = 0;

k(k − 1)(k − 2)(k − 3)...(k − (n − 1))
n!

c.c.

(2.1)

´e escrito dessa forma para todo k ∈ R e que, em particular, quando k ∈ N, tal n´umero condiz com
a deﬁni¸c˜ao usual (cid:0)k

n!(k−n)! . Mais precisamente, observando uma expans˜ao binomial,

(cid:1) = k!

n

(a + b)k = ak +

k
1

ak−1b +

(k)(k − 1)
2 · 1

ak−2b2 +

(k)(k − 1)(k − 2)
3 · 2 · 1

ak−3b3 + · · · ,

quando k ´e inteiro positivo, h´a uma parcela a partir da qual surge um fator (k − k) no numerador
e, desta em diante, todas s˜ao eliminadas do desenvolvimento. Por´em, quando k /∈ N, tal parcela
n˜ao surge e temos uma expans˜ao com uma inﬁnidade de termos.

Problema 6. Seja k ∈ N. Prove as igualdades:






k
(cid:80)
n≥0
k
(cid:80)
n≥0

(cid:0)k
n

(cid:1) = 2k;

(cid:0)k
n

(cid:1)(−1)k = 0

.

Al´em disso, se k = 0 ambas as igualdades tem 1 como resultado.

Solu¸c˜ao. Da deﬁni¸c˜ao 2.13, sabemos que, quando k (cid:54)= 0:

(1 + x)k =

(cid:19)

(cid:18)k
0

x0 +

(cid:18)k
1

(cid:19)

x1 + · · · +

(cid:19)

(cid:18)k
k

xk

,
que ´e v´alido para todo valor x ∈ C. Se ﬁzermos x = 1 e x = −1 de ambos os lados da igualdade:

(1 + 1)k = 2k =

(cid:19)

(cid:18)k
0

+

(cid:19)

(cid:18)k
1

+ · · · +

(cid:19)

(cid:18)k
k

k
(cid:88)

=

n≥0

(cid:19)

(cid:18)k
n

16

(1 − 1)k = 0 =

(cid:19)

(cid:18)k
0

(−1)0 +

(cid:18)k
1

(cid:19)

(−1)1 + · · · +

(cid:19)

(cid:18)k
k

k
(cid:88)

(−1)k =

n≥0

(cid:19)

(−1)n

(cid:18)k
n

Al´em disso, quando k = 0, a equa¸c˜ao (2.1) garante a segunda parte da igualdade.

Problema 7. Encontre uma OGF para a sequˆencia

Conclua ainda, uma f´ormula para

n
(cid:80)
j≥0

naturais.

an = n3

(n ≥ 0)

j3 = (13 + 23 + · · · + n3), a soma dos cubos dos n primeiros

Solu¸c˜ao. Da propriedade P.6, sabemos que {n3.1}∞
0
constatamos que:

OGF−→ S = (xD)3 (cid:0) 1

1−x

(cid:1). Ap´os os c´alculos,

S(x) =

6x3
(1 − x)4 +

6x2
(1 − x)3 +

x
(1 − x)2 ,

ou seja [xn]S = n3. Se quisermos encontrar

n
(cid:80)
j≥0

1
1−x :

j3, pela propriedade P.8, basta multiplicar S por

S
1 − x
Tomando [xn] de ambos os lados da igualdade, temos:

6x3
(1 − x)5 +

6x2
(1 − x)4 +

=

x
(1 − x)3

[xn]

(cid:18) S

(cid:19)

1 − x

= 6[xn−3]

(cid:19)

(cid:18)

1
(1 − x)5

+ 6[xn−2]

(cid:19)

(cid:18)

1
(1 − x)4

+ [xn−1]

(cid:19)

(cid:18)

1
(1 − x)3

(2.2)

e portanto [xn]S est´a condicionado ao coeﬁciente da express˜ao em 1

(1−x)k .

(n ≥ 3; a0 = 0; a1 =?; a2 =?)

Para determinamos esse coeﬁciente, note que:

(cid:18)

[xn]

(cid:19)

1
(1 + x)k

= [xn] (1 − x)−k

def 2.13=

(cid:19)

(−1)n

(cid:18)−k
n

=

−k(−k − 1)(−k − 2) · · · (−k − (n − 1))
n!

(−1)n

=

k(k + 1)(k + 2) · · · (k + (n − 1))
n!

=

(k + n − 1 − (n − 1))(k + n − 1 − (n − 1) + 1) · · · (k + n − 1)
n!

17

(cid:19)

(cid:18)−k
n

=

(cid:19)

(cid:18)k + n − 1
n

(k (cid:54)= 0)

(2.3)

Veja ainda que, no caso k inteiro positivo, podemos utilizar a rela¸c˜ao de Stifel. Ent˜ao escreve-

mos:

(cid:19)

(cid:18)k + n − 1
n

=

(cid:19)

(cid:18)k + n − 1
k − 1

(2.4)

Voltando a (2.2) e aplicando a equa¸c˜ao (2.4):

[xn]S = 6

(cid:18)n + 1
4

(cid:19)

+ 6

(cid:19)

(cid:18)n + 1
3

+

(cid:19)

(cid:18)n + 1
2

(n ≥ 3; a0 = 0; a1 = 1; a2 = 9)

=

(n + 1)n(n − 1)(n − 2)
4

+ (n + 1)n(n − 1) +

(n + 1)n
2

=

(n + 1)n(n2 − 3n + 2 + 4n − 4 + 2)
4

=

(n + 1)n(n2 + n)
4

=

(cid:18) (n + 1)n
2

(cid:19)2

(n ≥ 0)

Que soluciona o problema e revela uma interessante igualdade matem´atica:

13 + 23 + · · · + n3 = (1 + 2 + · · · + n)2.

Exemplo 2.5. Mencionemos outro exemplo de s´eries formais rec´ıprocas: (cid:80)

n≥0

xn

n! e (cid:80)

n≥0

(−1)n xn
n! .

Observadas como fun¸c˜oes anal´ıticas, essas s´eries s˜ao ex e e−x. Portanto facilmente comprovamos

que ex.e−x = 1.

Por´em, do ponto de vista formal, a demonstra¸c˜ao desse fato traz informa¸c˜oes importantes.

Aplicando O.2 :

xn
n!

(cid:88)

n≥0

(cid:88)

n≥0

(−1)n xn
n!

(cid:88)

n
(cid:88)

=

n≥0

i≥0

1
i!

1
(n − i)!

(−1)n−i xn

18

=

=

=

(cid:88)

n
(cid:88)

n≥0

i≥0

n!
i!(n − i)!

(−1)n−i xn
n!

(cid:88)

n
(cid:88)

n≥0

i≥0

(cid:18)n
i

(cid:19)
(−1)n−i xn
n!

(cid:88)

n
(cid:88)

n≥0

i≥0

(cid:18)n
i

(cid:19)
(−1)n xn
n!

(n ≥ 0)

P rob. 6= 1(x)

As s´eries que apresentam essa marca¸c˜ao xn

n! s˜ao de extrema importˆancia para o estudo das

fun¸c˜oes geratrizes e merecem deﬁni¸c˜ao:

Deﬁni¸c˜ao 2.14. Uma fun¸c˜ao geratriz exponencial (EGF) ´e uma s´erie formal de potˆencias
escrita na forma:

(cid:88)

an

n≥0

xn
n!

E a manipula¸c˜ao feita no exemplo anterior:

O.3)

(cid:32)

(cid:88)

n≥0

anxnn!

(cid:33) (cid:32)

(cid:88)

n≥0

(cid:33)

=

bn

xn
n!

(cid:88)

n
(cid:88)

n≥0

i≥0

(cid:19)

(cid:18)n
i

(ai.bn−i)

xn
n!

;

´e uma varia¸c˜ao de O.2 . Para entender a generaliza¸c˜ao, vejamos duas EGF’s quaisquer:

(cid:32)

an
n!

(cid:88)

n≥0

xn

(cid:33) (cid:32)

(cid:88)

n≥0

(cid:33)

bn
n!

xn

O.2=

=

=

(cid:88)

n≥0

(cid:88)

n≥0

(cid:88)

n
(cid:88)

i≥0
n
(cid:88)

i≥0
n
(cid:88)

n≥0

i≥0

ai
i!

bn−i
(n − i)!

xn

ai.bn−i

xn
n!

n!
i!(n − i)!
(cid:18)n
i

(cid:19)

(ai · bn−i)

xn
n!

Problema 8. Uma permuta¸c˜ao ´e dita ca´otica quando nehum dos seus elementos est´a na sua
posi¸c˜ao inicial.

(cid:18) 1 2 3 4 5
2 5 4 3 1

(cid:19)

−→ ´e ca´otica

(cid:18) 1 2 3 4 5
2 5 1 4 3

(cid:19)

−→ n˜ao ´e ca´otica.

Encontre a f´ormula para o n´umero de permuta¸c˜oes ca´oticas de n elementos (Dn).

19

Solu¸c˜ao. Qualquer permuta¸c˜ao de n elementos ´e constru´ıda escolhendo-se i elementos que per-
(cid:1) maneiras de se escolher esses
manecer˜ao na sua posi¸c˜ao inicial e n − i que n˜ao estar˜ao. H´a (cid:0)n
elementos ﬁxos. Os n − i que sobraram tem de ser arrumados caoticamente e isso pode ser feito
de Dn−i maneiras diferentes.

i

n
(cid:88)

i=0

(cid:88)

n≥0
(cid:88)

n=0

(cid:19)

Dn−i

(n ≥ 0)

(cid:18)n
i

n
(cid:88)

(cid:19)

(cid:18)n
i

1.Dn−i

xn
n!

i=0
xn
n!

(cid:88)

n=0

Dn

xn
n!

= exD(x)

n! =

(cid:88)

n!

n≥0

xn
n!

=

(cid:88)

xn O.3=

n≥0
1
1 − x

D(x) =

e−x
1 − x

Tomando [xn] de ambos os lados da ´ultima igualdade:

Dn
n!

P.8= 1 − 1 +

1
2!

−

1
3!

+ · · · +

(−1)n
n!

(cid:18)

Dn = n!

1 − 1 +

1
2!

−

1
3!

+ · · · +

(cid:19)

(−1)n
n!

H´a uma outra solu¸c˜ao envolvendo o Princ´ıpio da Inclus˜ao-Exclus˜ao que pode ser encontrada

em [Pro] p28-30.

20

Cap´ıtulo 3

N´umeros de Catal˜ao

Alguns elementos dessa sequˆencia s˜ao exibidos no exemplo 2.2. A seguir, apresentaremos v´arios

problemas aonde tais n´umeros surgem.

3.1 Alguns Exemplos

Caminhos de Catal˜ao

Tome a origem de um plano cartesiano e considere apenas o 1o quadrante. A partir da´ı, s˜ao

permitidas as opera¸c˜oes:

C.1) (x, y) → (x + 1, y + 1)

C.2) (x, y) → (x + 1, y − 1) e,

contanto que a ordenada do ´ultimo ponto (digamos x2n) seja zero, n´os teremos um caminho de
Catal˜ao de tamanho n. Tal condi¸c˜ao garante que o n´umero de ”passos”dados ´e sempre par.

Figura 3.1: Caminhos de Catal˜ao de comprimento 2 e 3

21

Na ﬁgura 3.1, vemos que existem exatamente 2 modos de escrever um caminho de catal˜ao de
tamanho 2. Tal n´umero vai para 5 quando o caminho tem tamanho 3 e 14, quando o caminho
tem tamanho 4. Denotemos por c(n) a quantidade de caminhos de Catal˜ao de tamanho n. Por
exemplo c(2) = 2; c(4) = 14 e assim sucessiivamente (c(0) = 1, por conven¸c˜ao).

Parˆenteses Bem Escritos

Considere uma arruma¸c˜ao v´alida de 2n parˆenteses, isto ´e, uma arruma¸c˜ao aonde n˜ao se fecha
parˆentese sem antes tˆe-lo aberto. A tabela a seguir exibe a quantidade p(n) dessas arruma¸c˜oes
para alguns casos:

n arruma¸c˜oes
0
1
2
3
4

*
( )
( )( ); (( ))
( )( )( ); (( ))( ); ( )(( )); (( )( )); ((( )))
( )( )( )( ); (( ))( )( ); ( )(( ))( ); ( )( )(( )); (( ))(( )); ((( )))( ); ( )((( )));
(( )( ))( ); ( )(( )( )); (( )( )( )); ((( ))( )); (( )(( ))); ((( )( )); (((( ))))

p(n)
1
1
2
5
14

Tabela 3.1: Exemplos de Parˆenteses Bem Escritos. Dispon´ıvel em [Cat] p.1

´E f´acil ver que essas arruma¸c˜oes s˜ao equivalentes aos caminhos de Catal˜ao (ver 3.2): Uma

abertura de parˆentese corresponde a C.1 enquanto um fechamento corresponde a C.2.

Figura 3.2: Caminhos de Catal˜ao e seu equivalente em parˆenteses.

Dessa forma p(n) = c(n) e mais uma vez encontramos 1, 2, 5 e 14 bem como os primeiros

elementos do exemplo 2.2.

22

´Arvores Planas com Ra´ız

Uma ´arvore ´e um grafo conexo sem ciclos e, nesse trabalho, quando mencionarmos apenas
”´arvore”, esta ser´a sem ra´ız, que ´e nada al´em do que um v´ertice distinto dos demais. A palavra
”plana”signiﬁca que os grafos est˜ao ”ﬁxados num plano”e por tanto espelhamentos contam grafos
diferentes.

Os n´umeros t(n) de grafos com essas caracter´ısticas para 1, 2, 3, 4 e 5 v´ertices n s˜ao apresentados

na tabela abaixo:

n Estruturas

1

2

3

4

5

t(n)

1

1

2

5

14

Tabela 3.2: Exemplos de ´Arvores Planas. Dispon´ıvel em [Kgc] p.1

A ra´ız aqui s˜ao os v´ertices no n´ıvel mais baixo do grafo. Essas estruturas (de n v´ertices) tamb´em
se relacionam com os parˆenteses bem escritos (com n − 1 pares) da seguinte forma: A partir da
ra´ız, percorremos todos os ramos da ´arvore, da esquerda pra direita, sempre sobre suas arestas.
Cada movimento para cima corresponde a uma abertura de parˆentese enquanto uma movimento
para baixo corresponde a um fechamento. Em outras palavras, temos que t(n) = c(n − 1)

23

Figura 3.3: ´Arvores Planas e seus respectivos arranjos de parˆenteses.

Triangula¸c˜ao de Pol´ıgonos Convexos

Uma triangula¸c˜ao ´e a parti¸c˜ao de um pol´ıgono convexo atrav´es de suas diagonais, sem que elas

se cruzem. A ﬁgura 3.4 mostra as triˆangula¸c˜oes poss´ıveis para alguns pol´ıgonos.

Figura 3.4: triangula¸c˜oes de alguns pol´ıgonos convexos. Dispon´ıvel em [Cat] p.3

Observe novamente o in´ıcio da sequˆencia num´erica do exemplo 2.2, que coincide com os valores

apresentados, se admitirmos que o ”pol´ıgono de 2 v´ertices”possui uma triangula¸c˜ao.

Apertando as M˜aos

Considerando um n´umero par de pessoas sentadas ao redor de uma mesa de quantas maneiras

diferentes essas pessoas podem se cumprimentar sem que haja bra¸cos cruzados?

24

Figura 3.5: Apertos de m˜ao para os casos 2, 4, 6 e 8. Dispon´ıvel em [Cat] p.3

Que novamente corresponde com os outros exemplos. Precisamos de uma teoria que comprove

que esses objetos relamente falam sobre a mesma sequˆencia.

3.2 A Recorrˆencia de Segner

Proposi¸c˜ao 3.1. Os n´umeros c(n) de caminhos Catal˜ao relacionam-se entre si atrav´es da seguinte
f´ormula recursiva:

c(n) =

n
(cid:88)

l≥1

c(l − 1)c(n − l)

(n > 0;

c(0) = 1)

(3.1)

= c(0)c(n − 1) + c(1)c(n − 2) + · · · + c(n − 2)c(1) + c(n − 1)c(0).

Essa f´ormula ´e devida primeiramente ao matem´atico h´ungaro Johann Segner publicada em

[Seg] p203-209.
Demonstra¸c˜ao. Para o exemplo dos caminhos ´e interessante observar que alguns destes ”tocam”o

eixo x antes do ´ultimo passo (x2l = 0 com l < n). No caso dos parˆenteses signiﬁca dizer que
reconhecemos uma ”express˜ao v´alida”antes do passo x2l.

Existem tamb´em os outros caminhos que retornam ao eixo x apenas no ´ultimo passo. Esses
chamaremos de caminhos primitivos e denotaremos esses por p(l). Por exemplo, na ﬁgura 3.1, o
primeiro caminho da primeira coluna, assim como os dois primeiros da segunda s˜ao primitivos.
Surge ent˜ao a quest˜ao:

25

Quantos caminhos primitivos de tamanho l existem?

A resposta ´e c(l − 1), pelo seguinte argumento: tome uma arruma¸c˜ao v´alida qualquer de l − 1
pares de parˆenteses, primitiva ou n˜ao. Ao adicionar um parˆentese aberto no in´ıcio da arruma¸c˜ao
e outro parˆentese fechado no ﬁm, teremos um caminho primitivo! Reciprocamente, se temos uma
arruma¸c˜ao primitiva de parˆenteses com l pares (l > 1), essa come¸ca com dois parˆenteses abertos e
termina com dois fechados. Se retirarmos os extremos, sobram l − 1 pares numa arruma¸c˜ao v´alida
de parˆenteses. (se l = 1 basta retirarmos os dois parˆenteses existentes).

Dando prosseguimento a discuss˜ao, podemos pensar ent˜ao que um caminho de catal˜ao de

tamanho n pode ser constru´ıdo ao se fazer 2 escolhas:

1) Qual o tamanho l de sua componente primitiva? e

2) Qual o tamanho n − l do restante do caminho?

Para cada l, o n´umero de caminhos ser´a p(l)c(n − l) = c(l − 1)c(n − l) e c(n) ser´a obtido

somando essa igualdade sobre l:

c(n) =

n
(cid:88)

l≥1

p(l)c(n − l)

c(n) =

n
(cid:88)

l≥1

c(l − 1)c(n − l)

Assumindo que c(n) = 0, se n ´e negativo, (3.1) passa a ser v´alida para todo n (cid:54)= 0.

(cid:3)

E agora conectaremos essa recorrˆencia com os outros exemplos dados anteriormente.

Caminhos, Parˆenteses e ´Arvores

Para os exemplos dos parˆenteses e das ´arvores planas n˜ao h´a nada a fazer, pois esses exemplos
s˜ao biun´ıvocamente correspondentes aos caminhos (ver ﬁguras 3.2 e 3.3). Existe uma demonstra¸c˜ao
espec´ıﬁca para o primeiro exemplo e uma ideia para o segundo em [Cat] p6-7 e p8, respectivamente.

Triangula¸c˜oes de Pol´ıgonos

Chamemos esse n´umero de triˆangula¸c˜oes de e(n) se o pol´ıgono possuir n v´ertices.
Um triˆangulo possui uma ´unica triangula¸c˜ao, enquanto que um quadril´atero possui duas trian-
gula¸c˜oes poss´ıveis. Assim, e(3) = 1 e e(4) = 2. Como j´a convencionado antes, o ”pol´ıgono de dois
v´ertices”possui uma triangula¸c˜ao, isto ´e, e(2) = 1

Tentando calcular o n´umero de triangula¸c˜oes do pent´agono, rotulamos os seus v´ertices no
sentindo hor´ario e ﬁxamos em sua base os r´otulos A e B. A partir da´ı, constru´ımos um por vez,
todos os triˆangulos de base AB e um outro v´ertice K do pent´agono, separando-o em dois pol´ıgonos
(um deles sempre de lado AK e outro sempre de lado BK (ver ﬁgura 3.6):

a) triˆangulo ABC: temos um ”pol´ıgono de dois v´ertices”sobre o lado AC e um quadril´atero
sobre o lado BC, que podem ser triangularizados de e(2) e e(4) modos, respectivamente
→ e(2)e(4) = 1 · 2 = 2

26

Figura 3.6: Uma estrat´egia para calcular e(5)

b) triˆangulo ABD: surgem triˆangulos sobre os lados AD e BD. Ambos podem ser triangulari-

zados de e(3) maneiras diferentes → e(3)e(3) = 1 · 1 = 1

c) triˆangulo ABE: Agora um quadril´atero sobre AE e um ”pol´ıgono de dois lados”sobre BE →

e(4)e(2) = 2 · 1

O que nos diz que e(5) = 1 · 2 + 1 · 1 + 2 · 1. Esse ´e o passo indutivo para demonstrar a seguinte

proposi¸c˜ao:

Proposi¸c˜ao 3.2. O n´umero de triˆangula¸c˜oes e(n) de um pol´ıgono con n v´ertices ´e dada pela
express˜ao:

e(n) = e(2)e(n − 1) + e(3)e(n − 2) + · · · + e(n − 2)e(3) + e(n − 1)e(2)

(n > 2; e(2) = 1)

Visto que ﬁxamos e(2) = 1 = c(0), conclu´ımos que e(n) = c(n − 2). Em outras pralavras, o

n´umero de triˆangula¸c˜oes de um pol´ıgono de n lados ´e n´umero de Catal˜ao com tamanho n − 2.

Aperto de M˜aos

O n´umero de maneiras em que um grupo par de pessoas podem apertar as m˜aos sem que hajam
bra¸cos cruzados ser´a chamado s(2n). Evidentemente, s(2) = 1 e s(4) = 2 e podemos assumir que
s(0) = 1 (ver ﬁgura 3.5). Para determinarmos s(6), podemos tomar uma estrat´egia semelhante a
que tomamos anteriormente, rotulando os v´ertices do hex´agono no sentido hor´ario, s´o que agora
ﬁxamos apenas o v´ertice A e a partir da´ı, constru´ımos um por vez, os segmentos AK onde K ´e
outro v´ertice do hex´agono, dividindo os v´ertices remanescentes em dois semiplanos (ver ﬁgura 3.7)

a) segmento AB: Nenhuma pessoa num semiplano e 4 pessoas em outro (que apertam as m˜aos

sem cruzar de s(4) maneiras → s(0)s(4) = 2

b) segmento AD: Duas pessoas num dos semiplanos (que v˜ao apertar as m˜aos sem cruzar de
s(2) maneiras diferentes e outras 2 pessoas no outro semiplano (tamb´em com s(2) maneiras
de apertar as m˜aos) → s(2)s(2) = 1

27

Figura 3.7: Uma estrat´egia para calcular s(6)

c) segmento AF : 4 Pessoas num semiplano e nenhuma pessoa no outro → s(4)s(0) = 2.

Observe que os segmentos AC e AE foram exclu´ıdos, por separar os v´ertices em grupos ´ımpares,
o que foge ao problema e sendo assim, conlu´ı-se que s(6) = 5. Do mesmo modo que antes, esse ´e
o passo indutivo que comprova a estrutura recorrente de s(2n) como sendo:

s(2n) =

(cid:88)

k≥0

s(2k)s(2(n − k − 1))

(n > 0; s(0) = 1)

E portanto, na verdade, temos s(2n) = c(n).
Visto tantos problemas que s˜ao relacionados, as fun¸c˜oes geratrizes d˜ao uma excelente solu¸c˜ao

r´apida, para todos eles. Vejamso a seguir.

3.3 A OGF para c(n)’s

Nessa se¸c˜ao pretendemos:

1) Apresentar uma fun¸c˜ao geratriz C(x) ordin´aria para os termos c(n);

2) Exibir uma f´ormula posicional para esses termos.

Antes de mais nada notemos que, a n˜ao ser que n = 0 o n´umero de arruma¸c˜oes v´alidas
de parˆenteses ´e menor que o n´umero de total arruma¸c˜oes de parˆenteses (incluindo as maneiras
inv´alidas). Assim 0 < c(n) ≤ 2n. Portanto pelo teorema 2.1, temos C(x) anal´ıtica em alguma bola
B (cid:0)0, 1

(cid:1). Retomemos a equa¸c˜ao (3.1):

2

c(n) =

n
(cid:88)

l≥1

c(l − 1)c(n − l)

(n > 0; c(0) = 1)

Podemos multiplicar a igualdade por xn e somar sobre n > 0, encontramos:

c(n)xn =

(cid:88)

n>0

(cid:40) n

(cid:88)

(cid:88)

n>0

l≥1

c(l − 1)c(n − l)xn

(cid:41)

28

(cid:41)

(cid:41)

C(x) − c(0) = x

(cid:40) n

(cid:88)

(cid:88)

c(l − 1)c(n − l)xn−1

l≥1

n>0
(cid:40) n−1
(cid:88)

C(x) − 1 = x

(cid:88)

n

C(x) − 1 = x

(cid:88)

n>0

C(x) − 1 = x

(cid:88)

c(l − 1)xl−1c(n − l)xn−l

l−1≥0
(cid:40)n−1
(cid:88)

c(i)xic(n − 1 − i)xn−1−i

(cid:41)

i≥0
(cid:40) n

(cid:88)

c(i)xic(n − i)xn−i

O.2−→

(cid:41)

i≥0

n≥0
C(x) − 1 = x (C(x))2
x (C(x))2 − C(x) + 1 = 0.

Analisando como uma equa¸c˜ao de segundo grau (aqui j´a a fun¸c˜ao anal´ıtica), chegamos `as

poss´ıveis solu¸c˜oes:

1 ±

C(x) =

√

1 − 4x
2x

Descobriremos quais das duas solu¸c˜oes utilizarmos fazendo com que tenhamos C(0) = c(0) = 1

do lado esquerdo da igualdade.

Para o sinal positivo:

C(0) = c(0) = 1 = lim
x→0

1 +

√

1 − 4x
2x

= ∞

o que ´e inconsistente.
Para o sinal negativo:

C(0) = c(0) = 1 = lim
x→0

1 −

√

1 − 4x
2x

= lim
x→0

D (cid:0)1 −

√

1 − 4x(cid:1)

D(2x)

= lim
x→0

√

1
1 − 4x

= 1

Com o primeiro objetivo alcan¸cado, podemos partir para uma f´ormula expl´ıcita que determine

os c(n).

Utilizaremos, com esse ﬁm, a expans˜ao binomial de

ﬁni¸c˜ao 2.13:

√

1 − 4x = (1 − 4x)

1
2 , a exemplo da de-

Ent˜ao, recordando a equa¸c˜ao (2.1) do n´umero binomial:

[xn] (1 + x)k =

(cid:19)

(cid:18)k
n

=

k(k − 1)(k − 2) · · · (k − (n − 1))
n!

(k (cid:54)= 0; a0 = 1)

e aplicando a k = 1
2:

(cid:104)

[xn]

1 − (1 − 4x)

(cid:105)

1
2

= −

(cid:0) 1
2

(cid:1) (cid:0) 1

2 − 1(cid:1) · · · (cid:0) 1

2 − (n − 1)(cid:1)

(n)(n − 1)(n − 2) · · · (1)

29

(−4)n

(n > 0; a0 = 0)

= −

(1)(1 − 2)(1 − 4) · · · (1 − 2(n − 1))
2n(n)(n − 1)(n − 2) · · · (1)

(−4)n

= (−1)n (1)(3)(5) · · · (2(n − 1) − 1)

n!

(−2)n

2·1
(2) (3)

(1)

=

2·2
(4) · · · (2(n − 1) − 1)
2n−1(n − 1)!(n)!

2·(n−1)
(2(n − 1))

2n

= 2

[2(n − 1)]!
(n − 1)!n!

Assim teremos:

(cid:34)

[xn]

1 − (1 − 4x) 1
2x

2

(cid:35)

=

=

1
2

1
2

(cid:16)

[xn+1]

1 − (1 − 4x)

(cid:17)

1
2

(n ≥ 0)

· 2

[2(n + 1 − 1)]!
(n + 1 − 1)!(n + 1)!

=

(2n)!
n!n!

·

1
n + 1

=

(cid:19)

1
n + 1

(cid:18)2n
n

Assim, todos os exemplos apresentados nesse cap´ıtulo possuem a mesma solu¸c˜ao contida numa

(poderosa) f´ormula posicional. Antes de terminarmos o cap´ıtulo, um problema.

Problema 9 (IME, 2015). De quantas maneiras podemos decompor um ene´agono convexo em
triˆangulos tra¸cando suas diagonais, de forma que essas diagonais n˜ao se cortem?

Solu¸c˜ao. Com o resultado acima, temos:

e(9) = c(7) =

1
7 + 1

(cid:19)

(cid:18)2 · 7
7

=

3432
8

= 429

30

Cap´ıtulo 4

´Arvores Rotuladas: A F´ormula de
Cayley

J´a deﬁnimos o conceito de ´arvore anteriormente. Lembremos que a men¸c˜ao da palavra ”´arvore”,
neste trabalho, incute que a mesma n˜ao possui ra´ız. Uma ´arvore rotulada de n v´ertices ´e uma
´arvore onde todos os ditos v´ertices est˜ao numerados com um dos valores de 1 at´e n. Esse conceito
pode ser ampliado para ´arvres rotuladas com ra´ız. Mais ainda, o conceito de ﬂoresta n˜ao foi
abordado. Uma ﬂoresta rotulada com ra´ızes ´e uma uni˜ao disjunta de ´arvores rotuladas com ra´ız.

Figura 4.1: Uma ´arvore (esq), duas ´arvores rotuladas (centro) e duas ´arvores rotuladas com ra´ız
(dir), todas com 6 v´ertices.

Figura 4.2: Duas ﬂorestas rotuladas com ra´ız.

Nesse cap´ıtulo, objetivamos provar a F´ormula de Cayley:

31

Proposi¸c˜ao 4.1 (Cayley). Seja a(cid:48)

n o n´umero de ´arvores rotuladas com n v´ertices, (n > 0). Ent˜ao:

n = nn−2
a(cid:48)

Esta f´ormula e aﬁrmada e demonstrada por Arthur Caley em 1889 em [Cal] p26-28. Mas, antes
de alcan¸car esse resultado, ser´a necess´ario garantir informa¸c˜oes preliminares. A ideia central ´e
tentar contabilizar as ´arvores rotuladas com ra´ız de n v´ertices primeiro (an). Notando que dada
uma ´arvore rotulada poemos fazer a escolha da ra´ız de n maneiras, ser´a f´acil, a partir desse ponto,
valorarmos a(cid:48)
n

4.1 Teorema da Contagem Rotulada

Em [Wil], Wilf apresenta o conceito de cartas, m˜aos e pilhas (p73-75) e logo ap´os, com ajuda
desses conceitos prova dois teoremas importantes (p79-81 e p92-94), que relacionam a fun¸c˜ao
geratriz de uma estrutura (m˜ao) com a fun¸c˜ao geratriz de suas componentes disjuntas (cartas).

Para exempliﬁcar, tomemos o n´umero de permuta¸c˜oes n elementos. Qualquer que seja a per-

muta¸c˜ao (m˜ao) podemos desmenbr´a-la em permuta¸c˜oes c´ıclicas menores e disjuntas (cartas)

Figura 4.3: Decomposi¸c˜ao de uma permuta¸c˜ao em ciclos (cima). Cartas correspondentes (abaixo)

No exemplo, as cartas tem tamanho 3 e 2. Todas as cartas que possuirem o mesmo tamanho
s˜ao agrupadas em pilhas. Assim, a pilha D4 ´e a pilha cm todas as cartas (permuta¸c˜oes c´ıclicas)
de tamanho 4 De maneira geral dn ´e o n´umero de elementos de Dn. Eis um dos teoremas:

32

Teorema 4.1. Sejam dn e hn os n´umeros de elementos da pilha Dn e de m˜aos com n elementos.
Se as cartas e m˜aos s˜ao rotuladas e se {dn}∞
0

EGF−→ D(x) e {hn}∞

EGF−→ H(x), ent˜ao:

0

H(x) = eD(x).

Aplicando 4.1 ao exemplo, sabe-se que H(x) = 1

1−x (pois [(cid:2) xn

n!

(cid:3) H = n!). Assim:

1
1 − x

= eD(x)

log

(cid:18) 1

(cid:19)

1 − x

= D(x),

(cid:3) D = (n − 1)!. Por´em, caso n˜ao tiv´essemos exibido
E como j´a vimos no problema 5, dn = (cid:2) xn
anteriormente, aplicando a f´ormula de Taylor, encotramos os dn, isto ´e, o n´umero de peruta¸c˜oes
circulares de n elementos (os coeﬁcientes e xn
n! em D(x)):

n!

D(x) =

=

=

(cid:88)

n=1

(cid:88)

n=1

(cid:88)

n=1

(cid:18)

log

1
1 − x

(cid:19)(n)(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)x=0

xn
n!

(n − 1)!(1 − x)−n(cid:12)

(cid:12)x=0

xn
n!

(n − 1)! ·

xn
n!

dn = (n − 1)!

Ou seja o n´umero de permuta¸c˜oes circulares ´e (n − 1)!. No pr´oximo cap´ıtulo, exibiremos um

exemplo com o segundo teorema mencionado.

4.2

´Arvores Rotuladas com Ra´ız

Seja fn o n´umero de ﬂorestas rotuladas com ra´ızes de n v´ertices e H(x) sua EGF. Seja tamb´em
an o n´umero de ´arvores rotuladas com ra´ız de n v´ertices, bem como D(x) sua EGF. Tal composi¸c˜ao
coincide com o teorema 4.1 (vide ﬁgura 4.4) e assim:

H(x) = eD(x)

Demos o primeiro passo em dire¸c˜ao `a F´ormula de Cayley. Mas chegamos ao impasse de n˜ao

sabermos nenhuma das fun¸c˜oes geratrizes explicitamente.

Uma igualde que relaciona ´arvores e ﬂorestas, descoberta por P´olya, resolve esse empecilho:

an+1 = (n + 1)fn

(n ≥ 0).

33

Figura 4.4: Decomposi¸c˜ao de uma ﬂoresta em blocos disjuntos (esq). Cartas (´arvores) equivalentes
aos blocos destacados (dir)

(Demonstraremos essa igualdade adiante). Multiplicando por

ambos os lados da igualdade, obt´em-se:

xn+1
(n + 1)!

e somando em n de

an+1 = (n + 1)fn →

(cid:88)

n≥0

(cid:88)

n≥0

an+1

xn+1
(n + 1)!

= x

an+1

xn+1
(n + 1)!

= x

(cid:88)

n≥0

(cid:88)

n≥0

D(x) = xH(x).

(n + 1)

fn xn
(n + 1)!

fn xn
n!

Logo, substituindo o resultado do teorema 4.1 nessa ´ultima equa¸c˜ao, encontramos D(x) = xeD(x)
ou equivalentemente

D(x) = (cid:0)xe−x(cid:1)(−1) ,

pois fazendo G(x) = xe−x, G(D(x)) = D(x)e−D(x) = xeD(x)e−D(x) = x.

34

Salientamos dois detalhes:

1) D(x) existe como s´erie formal inversa de xe−x pois a mesma atende aos requisitos da com-
posi¸c˜ao de s´eries formais e de s´eries formais inversas, descritos nas deﬁni¸c˜oes 2.6 e 2.7;

2) xe−x possui raio de convergˆencia R = ∞ e por isso faz sentido trabalh´a-la como fun¸c˜ao

anal´ıtica.

Mesmo apesar de termos ”melhorado”o resultado inical (pois agora, pelo menos, podemos
calcular os elementos de D(−1)), precisaremos de uma outra ferramenta para encontrarmos os an
de D(x).

Teorema 4.2 (F´ormula de Invers˜ao de Lagrange). Sejam f (x) = (cid:80)
s´eries formais de potˆencias inversas, ou seja, f (g(x)) = g(f (x)) = x. Ent˜ao:

n≥1 anxn e g(x) = (cid:80)

i≥1 bixi

[xn]g(x) =

1
n

[x−1]

(cid:18) 1

(cid:19)

f n(x)

(4.1)

Assim, tomando g(x) = D(x) e f (x) = xe−x, conclu´ımos que:

an
n!

= [xn]D(x) = [xn](xe−x)(−1) =

=

=

=

1
n
1
n
1
n
1
n

(cid:18)

[x−1]

(cid:19)

1
(xe−x)n
(cid:19)

[x−1]

(cid:18) enx
xn

[xn−1]enx

nn−1
(n − 1)!

Comparando os extremos da sucess˜ao de igualdades, chegamos ao resultado de que an = nn−1,

isto ´e: existem nn−1 ´arvores rotuladas com ra´ız de n v´ertices.

4.3

´Arvores Rotuladas

Como uma consequˆencia da f´ormula fechada para an, chegamos ao n´umero de grafos conexos,
n). Note que as ra´ızes numa ´arvore da se¸c˜ao anterior

ac´ıclicos e rotulados (´arvores rotuladas) (a(cid:48)
podem ser escolhidas de n maneiras diferentes.

Assim, cada a(cid:48)

n est´a sendo contado n vezes em an:

a(cid:48)
n =

an
n

=

nn−1
n

= nn−2

Como exemplo, temos a ﬁgura 4.2. Quando desprovidos de ra´ızes, os trˆes grafos de cada linha

contam apenas uma vez.

Isso p˜oe ﬁm a demonstra¸c˜ao da f´ormula de Cayley.
Nota. Arthur Caley apresenta uma outra demnstra¸c˜ao para sua f´ormula em [Cal] p26-28. A
demonstra¸c˜ao apresentada neste trabalho segue a de P´olya (ver [Mn] p26 e [Wil] p89-91 e p167-169)

35

Figura 4.5: ´arvores rotuladas com ra´ız de 3 v´ertices

4.4 Demonstra¸c˜oes Pendentes

Demonstra¸c˜ao da rela¸c˜ao de P´olya

Lema 4.1 (P´olya). Sejam an o e fn como descritos anteriormente. Ent˜ao:

an+1 = (n + 1)fn

(n ≥ 0),

Demonstra¸c˜ao. Tome uma ﬂoresta, rotulada e com ra´ızes, de n v´ertices. Adicione um novo

v´ertice v `a ﬂoresta, conecte-o `as ra´ızes originais e marque v como nova raiz rotulada ”n + 1. O
v´ertice v ´e a nova ra´ız de uma ´arvore rotulada com n + 1 v´ertices. Agora mude o r´otulo de v para
algum outro valor em [n] e renomeie os v´ertices da ﬂoresta mantendo a ordem de rotula¸c˜ao original
da ﬂoresta. Como essa escolha de r´otulo para v pode ser feita de n modos, essa ﬂoresta inicial
deu origem a n + 1 ´arvores. Se repetirmos o processo com cada uma das fn ﬂorestas, obteremos
(n + 1)fn ´arvores com n + 1 v´ertices.

Agora, selecione uma ´arvore rotulada de n + 1 v´ertices de ra´ız v digamos n + 1. Ao retiramos
sua ra´ız, obtemos uma ﬂoresta f ao nomearmos como novas ra´ızes os v´ertices conectados a v.
Se praticarmos essa opera¸c˜ao com uma ´arvore de ra´ız v com um valor de [n], e renomearmos os
v´ertices segundo a ordem original de rotula¸c˜ao, a ´arvore f se repetir´a mais n vezes (n + 1 no total).
Sendo assim, cada ﬂoresta de n v´ertices ´e contabilizada n + 1 vezes a partir das ´arvores de n + 1
v´ertices e portanto a igualdade ´e v´alida.

36

(cid:3)

(cid:3)

Figura 4.6: Exemplo com 4 v´ertices

F´ormula de Invers˜ao de Lagrange

Aqui precisaremos de dois lemas preliminiares:

Lema 4.2. Dada uma s´erie formal de potˆencias h(x) =

(cid:88)

n≥N ∈Z

hnxn, temos que:

(cid:2)x−1(cid:3) h(cid:48)(x) = 0

Demonstra¸c˜ao.

h(x) =

(cid:88)

n≥N ∈Z

hnxn → h(cid:48)(x) =

(cid:88)

n≥N ∈Z

nhnxn−1 → [x−1]h(cid:48)(x) = 0

37

Lema 4.3. Dada uma s´erie formal de potˆencias f (x) = (cid:80)

n≥1 anxn, e com a1 (cid:54)= 1, temos que:

[x−1]f i(x)f (cid:48)(x) =

(cid:26) 0, se i (cid:54)= −1
1, se i = −1

Demonstra¸c˜ao.

Se i (cid:54)= −1, ent˜ao f i(x)f (cid:48)(x) = 1
Se i = −1, ent˜ao:

1+i (f 1+i(x))(cid:48) e decorre do lema anterior que [x−1]f i(x)f (cid:48)(x) = 0

[x−1]f i(x)f (cid:48)(x) = [x−1]

(cid:19)

(cid:18) f (cid:48)(x)
f (x)

= [x−1]

= [x−1]

(cid:19)

(cid:18) a1 + 2a2x + 3a3x2 + · · ·
a1x + a2x2 + a3x3 + · · ·
(cid:20)2a3
a1

(cid:18) 1
x

a2
a1

a2
2
a2
1

−

+

+

(cid:21)

x + · · ·

(cid:19)

= 1

(cid:3)

E agora recordemos o teorema principal:
Teorema 4.2 (F´ormula de Invers˜ao de Lagrange). Sejam f (x) = (cid:80)
s´eries formais de potˆencias inversas, ou seja, f (g(x)) = g(f (x)) = x. Ent˜ao:

n≥1 anxn e g(x) = (cid:80)

i≥1 bixi

Demonstra¸c˜ao.

[xn]g(x) =

1
n

[x−1]

(cid:18) 1

(cid:19)

f n(x)

x = g(f (x)) =

bif i(x)

(cid:88)

i≥1

Derivando em ambos os extremos da igualdade, obtemos:

1 =

(cid:88)

i≥1

ibif i−1(x)f (cid:48)(x)

O objetivo ´e fazer com que o ´ındice bn ﬁque junto com o termo f −1(x)f (cid:48)(x) (Por ora ele est´a junto
com a potˆencia n − 1 de f (x)). Dividindo por f n(x):

1
f n(x)

=

=

(cid:88)

i≥1

n−1
(cid:88)

i≥1

ibif i−1−n(x)f (cid:48)(x)

ibi

1
i − n

(cid:0)f i−n(x)(cid:1)(cid:48) + nbn

f (cid:48)(x)
f (x)

(cid:88)

+

ibi

i>n

1
i − n

(cid:0)f i−n(x)(cid:1)(cid:48)

Tomando [x−1] dos extremos da igualdade e aplicando o lema 4.3:

[x−1]

(cid:18) 1

(cid:19)

f n(x)

= 0 + nbn + 0 = n[x−1]g(x),

que ´e equivalente `a equa¸c˜ao (4.1).

38

(cid:3)

Nota. (4.1) ´e um caso particular da demonstra¸c˜ao da F´ormula de Invers˜ao, baseada em [MSU].

Outras desmonstra¸c˜oes completas podem ser encontradas em [St2] p36-42.

Terminamos ent˜ao a longa prova para contabilizar o n´umero de grafos conexos ac´ıclicos e
rotulados. Antes de seguirmos para o pr´oximo cap´ıtulo, contemos tamb´em os grafos conexos
rotulados (c´ıclicos ou n˜ao).

4.5 Um Problema Adicional: Grafos Conexos

Problema 10. Determine uma recorrˆencia para o n´umero de grafos rotulados conexos de n
v´ertices.

Solu¸c˜ao. Observe que todo grafo pode ser decomposto em componentes conexas (semlhante `a
ﬁgura 4.4). Como esses grafos s˜ao rotulados, podemos aplicar o teorema 4.1:

G(x) = eGc(x),

onde G(x) e Gc(x) s˜ao, respectivamente, as fun¸c˜oes geratrizes exponenciais dos grafos e dos grafos
conexos de n v´ertices.

Temos que G(x) = (cid:80)

2(n
2)
n! xn e gn (o n´umero de grafos conexos de n v´ertices) s˜ao
os valores a serem descobertos, que est˜ao no expoente de eD(x). Para a retirarmos esse expoente,
utiliza-se o m´etodo ”xDlog”que consiste em aplicarmos essas 3 opera¸c˜oes seguidamente (explicada
em [Wil] p32):

n! xn = (cid:80)

n≥0

n≥0

hn

(cid:40)

(cid:88)

xn = exp

(cid:41)

gn
n!

xn

hn
n!

(cid:88)

n≥1

(cid:32)

(cid:88)

(cid:33)

xn

=

(cid:88)

n≥1

xn

gn
n!

n≥1
(cid:32)

(cid:33)

log

(cid:32)

hn
n!

hn
n!

n≥1

(cid:88)

n≥1

D

log

xn

= D

(cid:33)

gn
n!

(cid:88)

n≥1

xn

D.3)
multip. por x
−→

(cid:80)
n≥1

nhn
n! xn−1

(cid:80)
n≥1

hn
n! xn

x =

ngn
n!

(cid:88)

n≥1

xn−1.x

nhn
n!

nhn
n!

(cid:88)

n≥1

(cid:88)

n≥1

(cid:32)

xn =

hn
n!

(cid:88)

n≥1

xn

xn =

(cid:88)

n
(cid:88)

n≥1

i≥0

(cid:18)n
i

(cid:33) (cid:32)

(cid:88)

(cid:33)

O.3−→

ngn
n!

xn

n≥1

(cid:19)

igi.hn−i

(h ≥ 1; h0 = g0 = 1)

39

Chegando ent˜ao na recorrˆencia:

nhn =

n
(cid:88)

i≥0

(cid:19)

(cid:18)n
i

igi.hn−i

(h ≥ 1; h0 = g0 = 1)

Substituindo hn por 2(n

2), encontramos:

n2(n

2) =

(cid:19)

2 )
igi2(n−i

n
(cid:88)

i≥0

(cid:18)n
i

Notemos que a fun¸c˜ao G(x) tem raio de convergˆencia R = 0 e portanto n˜ao ´e poss´ıvel encontrar

fun¸c˜ao anal´ıtica nesse caso.

Substituindo os primeiros valores na f´ormula, encontramos:

gn

1

1

4

38

(cid:1)5.g5.2(0
2)

728

n

1

2

3

4

5

1.2(1

2) = (cid:0)1

(cid:1)1.g1.2(0
2)

1

2.2(2

2) = (cid:0)2

(cid:1)2.1.2(2

2) + (cid:0)2

(cid:1)1.g2.2(0
2)

1

1

1

1

2

2

2

2

3.2(3

2) = (cid:0)3

(cid:1)1.1.2(3

2) + (cid:0)3

(cid:1)2.1.2(1

2) + (cid:0)3

(cid:1)3.g3.2(0
2)

3

4.2(4

2) = (cid:0)4

(cid:1)1.1.2(3

2) + (cid:0)4

(cid:1)2.1.2(2

2) + (cid:0)4

(cid:1)3.4.2(1

2) + (cid:0)4

(cid:1)4.g4.2(0
2)

4

5.2(5

2) = (cid:0)5

(cid:1)1.1.2(4

2) + (cid:0)5

(cid:1)2.1.2(3

2) + (cid:0)5

(cid:1)3.4.2(3

2) + (cid:0)5

(cid:1)4.38.2(1

2) + (cid:0)5

4

5

3

3

40

Cap´ıtulo 5

Representa¸c˜oes em Forma de Soma e o
Teorema de Schur

5.1 Teorema da Contagem n˜ao Rotulada

Aqui retomamos o conceito de cartas e m˜aos do cap´ıtulo anterior, num outro exemplo:

Problema 11. Considere que uma cesta de frutas deve ser montada com n frutas, entre laranjas,
ma¸c˜as e pˆeras, com as seguintes caracter´ısticas:

• O n´umero de ma¸c˜as e o de laranjas deve ser par;

• O n´umero de pˆeras deve ser m´ultiplo de 3.

De quantas formas diferentes podemos montar ma cesta com 12 frutas? E com 63?

Exibimos agora o seundo teorema que foi mencionado no cap´ıtulo anterior:

Teorema 5.1. Sejam dn e hn os n´umeros de elementos da pilha Dn e de m˜aos com n elementos.
Se as cartas e m˜aos n˜ao s˜ao rotuladas e se {dn}∞
0

OGF−→ D(x) e {hn}∞

OGF−→ H(x), ent˜ao:

0

H(x) =

(cid:89)

n=1

1
(1 − xn)dn

Nesse exemplo, as ´unicas pilhas com cartas s˜ao D2 e D3 e d2 = 2 e d3 = 1. Logo:

H(x) =

1
(1 − x2)2 (1 − x3)

Ao usar a expans˜ao em fra¸c˜oes parciais:

H(x) =

1
12

1
(1 − x)3 +

1
6

1
(1 − x)2 +

29
144

1
(1 − x)

+

1
8

1
(1 + x)2 +

5
16

1
(1 + x)

−

1
9

(cid:16)

w1
1 − x
w1

(cid:17) −

1
9

(cid:16)

w2
1 − x
w2

(cid:17)

Com w1 = cis (cid:0) 2π

3

(cid:1) e w2 = cis (cid:0) −2π

3

(cid:1).

41

Figura 5.1: Visualizando as cartas n˜ao rotuladas.

E portanto [xn] H(x) est´a condicionada ao coeﬁciente de xn em 1

(1−x)k .

Recordemos a equa¸c˜ao (2.4), que reescrevemos abaixo:

[xn]

(cid:18)

1
(1 − x)k

(cid:19)

=

(cid:19)

(cid:18)k + n − 1
n

=

(cid:19)

(cid:18)k + n − 1
k − 1

(k ∈ N)

Da´ı:

[xn] H(x) =

(cid:19)

1
12

(cid:18)n + 2
2

+

1
6

(n + 1) +

29
144

+

1
8

(n + 1) (−1)n +

5
16

As duas ´ultimas parcelas do coeﬁciente tem periodicidade 3:

(cid:40) 1
9
− 2
9

se n ≡ 0 ou 2 mod3
se n ≡ 1 mod3

Chegamos ent˜ao as f´ormulas para o termo geral an da sequˆencia:

(−1)n −

−

w1
9wn
1
(cid:123)(cid:122)
(cid:124)
1 +w1−n
9 (w1−n

w2
9w2
1
(cid:125)
)

2

1

144an =





6n2 + 60n + 144
6n2 + 24n − 30
6n2 + 24n + 18
6n2 + 60 + 96

se n ≡ 0 ou 2 mod6
se n ≡ 1 mod6
se n ≡ 3 ou 5 mod6

se n ≡ 4 mod6

42

Ent˜ao, a12 = 12 (o que n˜ao apresentaria muitos problemas em ser calculado explicitamente) e

a63 = 176

5.2 O Problema do Troco

Problema 12. Considere um pa´ıs aonde o sistema monet´ario tem as moedas de 5 centavos, 11
centavos e 21 centavos. Dispondo apenas destes valores, de quantas maneiras podemos trocar a
quantia de 1,54? (154 centavos)

154 = 1 · 5 + 4 · 11 + 5 · 21
154 = 3 · 5 + 5 · 11 + 4 · 21
154 = 14 · 5 + 2 · 11 + 4 · 21
154 = 5 · 5 + 6 · 11 + 3 · 21

154 = 16 · 5 + 1 · 11 + 3 · 21
154 = 7 · 5 + 7 · 11 + 2 · 21
154 = 18 · 5 + 2 · 11 + 2 · 21
154 = 9 · 5 + 8 · 11 + 1 · 21

154 = 20 · 5 + 3 · 11 + 1 · 21
154 = 0 · 5 + 14 · 11 + 0 · 21
154 = 11 · 5 + 9 · 11 + 0 · 21
154 = 22 · 5 + 4 · 11 + 0 · 21

N˜ao exige muito esfor¸co encontrar a resposta (12) a esta quest˜ao espec´ıﬁca, por´em, ao au-
mentarmos o valor do montante ou a quantidade de moedas, a tarefa se torna bem desagrad´avel.
Tentaremos facilit´a-la:

Em termos gerais, seja (a1, a2, · · · aM ) um sistema monet´ario com M valores distintos de moedas
e um montante n. Quantas s˜ao as formas de trocar esse montante n em termos dessas M moedas?
Ou em outras palavras, quantas s˜ao as combina¸c˜oes lineares n˜ao negativas da lista que resultam

em n?

n = x1a1 + x2a2 + · · · xM aM ,

com n, ai ∈ Z∗

+ e xi ∈ Z+

Em [Wil] p96 ´e apresentada a conex˜ao deste problema com o teorema 5.1, de modo que as
m˜aos s˜ao o montante n decomposto por diversas c´opias repetidas das moedas (a1; a2; . . . aM ).
Logo, considerando as pilhas Dk das moedas, podemos ter:

dk =

(cid:40)

1, se k ∈ {a1, a2, . . . , aM };
0, c. c.

Isso signiﬁca que, com exce¸c˜ao de Da1, Da2, · · · DaM , todas pilhas est˜ao vazias e as que n˜ao

est˜ao cont´em apenas uma carta cada.

Consequentemente, a fun¸c˜ao geratriz que procuramos ser´a, pelo teorema 5.1:

H(x) =

1
i=1(1 − xai)

(cid:81)M

=

1
(1 − xa1)(1 − xa2) · · · (1 − xaM )

O que nos remete novamente, ao uso da expans˜ao por fra¸c˜oes parciais que s´o ser´a poss´ıvel se

analisarmos mais atentamente os polos dessa fun¸c˜ao.

O primeiro fato interessante ´e que todos esses polos s˜ao ra´ızes da unidade. Al´em disso,
x = 1 surge obrigatoriamente M vezes na fatora¸c˜ao do denominador, pois (cid:0)1 − xk(cid:1) = (1 −
x) (cid:0)1 + x + x2 + · · · + xk−1(cid:1). Temos ent˜ao x = 1 um polo de multiplicidade M. Os outros po-
los w, sem perda de generalidade, podem ser considerados primitivos, isto ´e w = cis (cid:0) 2πr
(cid:1), com
m.d.c(r, s) = 1. Diremos ainda que w ter´a multiplicidade Mw ≤ M . Portanto, ao reescrevermos
H(x) por fra¸c˜oes parciais, seu formato ser´a:

s

43

H(x) =

M
(cid:88)

j=1

Aj
(1 − x)j +

(cid:88)

Mw≤M
(cid:88)

j=1

wai =1
w(cid:54)=1
i∈[M ]

Awj
(cid:0)1 − x

w

(cid:1)j

(5.1)

Surge, ent˜ao a quest˜ao:

Como contabilizar Mw?

O n´umero de vezes que essa ra´ız primitiva est´a intimamente relacionado com o valor s do

denominador e com o valor dos ai, pelo seguinte:
Lema 5.1. Se w = cis (cid:0) 2πr

s

(cid:1), com m.d.c(r, s) = 1 ´e tal que wai = 1 ent˜ao s divide ai.

Demonstra¸c˜ao. De fato wai = 1 =⇒

w = cis

(cid:19)

(cid:18) 2πr
s

= cis

(cid:19)

(cid:18) 2πr(cid:48)
a1

=⇒

=⇒

2πr
s

r
s

=

=

r(cid:48)(cid:48)
ai

2πr(cid:48)
ai

+ 2kπ =⇒

=⇒ sr(cid:48)(cid:48) = rai

m.d.c.(r,s)=1

=⇒ s | ai

(cid:3)

O que signiﬁca dizer que s (cid:54) | ai e m.d.c.(r, s) = 1 ent˜ao w = cis (cid:0) 2πr
unidade, Esse argumento amarra um ponto crucial para a pr´oxima sec¸c˜ao.

s

(cid:1) n˜ao ´e ra´ız ai-´esima da

Lema 5.2. Se m.d.c.(a1, a2, · · · aM ) = 1, ent˜ao Mw < M , para todo w

Demonstra¸c˜ao. Se m.d.c.(a1, a2, . . . , aM ) = 1 =⇒

∀ s ∈ N, ∃ ai ∈ (a1, a2, · · · aM ) tal que s (cid:54) |ai =⇒ wai (cid:54)= 1 =⇒ Mw < M.

(cid:3)

5.3 O Teorema de Schur

Teorema 5.2 (Schur). Se hn ´e o n´umero de representa¸c˜oes de n como uma combina¸c˜ao linear
n˜ao negativa de a1, a2, · · · aM inteiros positivos coprimos, ent˜ao

nM −1
(M − 1)!a1a2 · · · am
Em particular, existe n tal que qualquer outro inteiro maior faz com que hn ≥ 1

(n → ∞)

hn ∼

Demonstra¸c˜ao. Analisemos o comportamento dos coeﬁcientes em xn de

(cid:17)j quando j

(cid:16)

1

1 −

x
w

cresce indeﬁnidamente:

44

[xn]

1
(cid:0)1 − x

w

(cid:1)j =

1
wn

(cid:19)

(cid:18)n + j − 1
n

=

1
wn

(cid:19)

(cid:18)n + j − 1
j − 1

(n + j − 1)(n + j − 2)(n + j − 3) · · ·

n+j−1−(j−2)
(n + 1)

wn(j − 1)!

=

Para valores de n muito grandes, temos:

[xn]

1
(cid:0)1 − x

w

(cid:1)j ∼

nj−1
(j − 1)!

.

Voltemos a equa¸c˜ao (5.1), relembrando o ´ultimo par´agrafo da sec¸c˜ao anterior:

H(x) =

M
(cid:88)

j=1

Aj
(1 − x)j +

(cid:88)

Mw<M
(cid:88)

j=1

wai =1
w(cid:54)=1
i∈[M ]

Awj
(cid:0)1 − x

w

(cid:1)j .

(5.2)

(5.3)

E por (5.2):

hn = AM

(cid:18)n + M − 1
M − 1

(cid:19)

+

M −1
(cid:88)

j=1

(cid:19)

(cid:18)n + j − 1
j − 1

Aj

+

Aj
wn

(cid:18)n + j − 1
j − 1

(cid:19)
,

(cid:88)

Mw<M
(cid:88)

j=1

wai =1
w(cid:54)=1
i∈[M ]

onde a primeira parcela foi extra´ıda do primeiro somat´orio em (5.3). Pela coprimalidade dos
a(cid:48)
is, todas as contribui¸c˜oes para hn, com exce¸c˜ao da primeira, s˜ao polinˆomios de grau < M e
portanto n˜ao inﬂuenciar˜ao o coeﬁciente (quando n → ∞). Assim,

hn ∼ AM

(cid:18)n + M − 1
M − 1

(cid:19)

∼

AM · nM −1
(M − 1)!

Como AM ´e coeﬁciente da expans˜ao em fra¸c˜oes parciais,

AM =

(cid:104)

(cid:105)
(1 − x)M H(x)



x=1

=

=
















(1 − x)M
M
(cid:89)

(1 − xai)







i=1

1
(cid:32) ai(cid:88)

M
(cid:89)

i=1

j=1

x=1









(cid:33)

x=1

xj−1

45









=

M
(cid:89)

i=1

1

(cid:0)1 + x + x2 · · · + xai−1(cid:1)









x=1

=

1
a1a2 · · · aM

O que p˜oe ﬁm `a demonstra¸c˜ao.

(cid:3)

46

Bibliograﬁa

[Wil] Wilf, Herbert S. Generatingfunctionology.

Academic Press, 1994.

[St2] Stanley, Richard. Enumerative Combinatorics Vol.2.

Cambrigde University Press, 1999.

[Cal] Caley, Arthur. The collected mathematical papers of Arthur Cayley, Vol XIII.

Cambridge University Press, 1889

[Mn] Moon, J.W. Counting Labelled Trees.

Canadian Mathematical Congress, 1970.

[Con] Conway, John B. Functions of One Complex Variable.

Springer-Verlag, 1978.

[Seg] Segner, J. Enumratio modorum, quibus ﬁguare planae reclinea per diagonales dividuntur in
triangula, Novi Commentarii Academiae Scientiarum Petropolitanae, Vol7 (1758/59) p203-
209.

[Pro] dos Santos J´unior, Edson P. Permuta¸c˜oes Ca´otias e Aplica¸c˜oes.

Universidade Federal de Goi´as - PROFMAT, 2014.
Dispon´ıvel em https://repositorio.bc.ufg.br/tede/handle/tede/3595. Acessado em novembro
de 2016

[Szp] Szpankowski, Wojciech. Average Case Analysis of Algorithms on Sequences.

Dispon´ıvel em https://www.cs.purdue.edu/homes/spa/book.html. Acessado em novembro de
2016

[Cat] Davis, Tom. Catalan Numbers.

Dispon´ıvel em http://mathcircle.berkeley.edu/BMC6/pdf0607/catalan.pdf. Acessado em no-
vembro de 2016

[MSU] Magyar, Peter. MTH 880, 10/03 - Cayley Trees. Lagrange Inversion.

Dispon´ıvel em http://users.math.msu.edu/users/magyar/Math880/Lagrange.pdf. Acessado
em novembro de 2016

[Kgc] Choo, Koo-Guan. Rooted Trees.

Dispon´ıvel em http://www.maths.usyd.edu.au/u/kooc/catalan/cat6root.pdf. Acessado em
novembro de 2016.

47

