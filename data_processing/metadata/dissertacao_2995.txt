UNIVERSIDADE ESTADUAL DE CAMPINAS

Instituto de Matem´atica Estat´ıstica e Computa¸c˜ao

Cient´ıfica

Yuri Tobias Aquiel Correa Ramos

Aplica¸c˜oes de Cadeias de Markov no Ensino
M´edio

CAMPINAS
2017

YURI TOBIAS AQUIEL CORREA RAMOS

APLICAC¸ ˜OES DE CADEIAS DE MARKOV NO ENSINO
M´EDIO

Disserta¸c˜ao apresentada ao Instituto de
Matem´atica, Estat´ıstica e Computa¸c˜ao
Cient´ıfica da Universidade Estadual de
Campinas como parte dos requisitos exi-
gidos para a obten¸c˜ao do t´ıtulo de Mes-
tre em Matem´atica.

Orientadora: Profa. Dra. Laura Let´ıcia Ramos Rifo
Este exemplar corresponde `a vers˜ao fi-

nal da dissertac¸˜ao defendida pelo aluno

Yuri Tobias Aquiel Correa Ramos, e ori-

entada pela Profa. Dra. Laura Let´ıcia

Ramos Rifo.

Campinas

2017

Agência(s) de fomento e nº(s) de processo(s): CAPES Ficha catalográficaUniversidade Estadual de CampinasBiblioteca do Instituto de Matemática, Estatística e Computação CientíficaMaria Fabiana Bezerra Muller - CRB 8/6162      Ramos, Yuri Tobias Aquiel Correa, 1991-  R147aRamAplicações de cadeias de Markov no ensino médio / Yuri Tobias AquielCorrea Ramos. – Campinas, SP : [s.n.], 2017.      RamOrientador: Laura Leticia Ramos Rifo.  RamDissertação (mestrado profissional) – Universidade Estadual deCampinas, Instituto de Matemática, Estatística e Computação Científica.       Ram1. Probabilidades. 2. Matrizes (Matemática). 3. Markov, Cadeias de. I.Rifo, Laura Leticia Ramos,1970-. II. Universidade Estadual de Campinas.Instituto de Matemática, Estatística e Computação Científica. III. Título. Informações para Biblioteca DigitalTítulo em outro idioma: Applications of Markov chains in high schoolPalavras-chave em inglês:ProbabilitiesMatricesMarkov chainsÁrea de concentração: Matemática em Rede NacionalTitulação: MestreBanca examinadora:Laura Leticia Ramos Rifo [Orientador]Paulo Regis Caron RuffinoClaudia Monteiro PeixotoData de defesa: 23-02-2017Programa de Pós-Graduação: Matemática em Rede NacionalPowered by TCPDF (www.tcpdf.org)Disserta¸c˜ao de Mestrado Profissional defendida em 23 de

fevereiro de 2017 e aprovada pela Banca Examinadora

composta pelos Profs. Drs.

Prof(a). Dr(a) Laura Let´ıcia Ramos Rifo

Prof(a). Dr(a) Paulo Regis Caron Ruffino

Prof(a). Dr(a) Claudia Monteiro Peixoto

A Ata da defesa com as respectivas assinaturas dos membros encontra-se no
processo de vida acad^emica do aluno.

Agradecimentos

Agrade¸co aos meus pais, Luiz Carlos Ramos e Ana Maria Corr^ea Ramos, que
sempre me incentivaram, a minha irm˜a Keryma pelo apoio e ajuda constante
durante esses anos.

A Aline Zueet, sem a qual esse sonho talvez nunca se realizasse, sua dedica¸c˜ao,

ajuda e imenso incentivo me guiaram diariamente rumo a esse objetivo.

A todos os professores e colegas de curso, os quais com brilhantismo enrique-

ceram cada dia de estudo nesses ´ultimos anos.

`A professora e orientadora Laura Let´ıcia Ramos Rifo, pelas valiosas informa¸c˜oes,

e excelentes momentos de discuss˜ao sobre a educa¸c˜ao matem´atica em nosso pa´ıs.
Agrade¸co `a Coordena¸c˜ao de Aperfei¸coamento de Pessoal de N´ıvel Superior
(CAPES) pela bolsa de estudos, sem a qual o deslocamento e tempo de dedica¸c˜ao
aos estudos n˜ao seria poss´ıvel.

Resumo

Este estudo prop˜oe dois problemas instigantes para aplica¸c˜ao no ensino m´edio.
S˜ao discutidas diversas faces de tais problemas, com propostas de solu¸c˜oes sem-
pre voltadas para o uso das Cadeias de Markov e suas matrizes de transi¸c˜ao. As
propostas de atividades pr´aticas e planos de aulas foram planejadas e discutidas
de forma a propiciar ao professor a melhor forma de se aplicar esses conceitos.
A matem´atica do ensino m´edio muitas vezes ´e engessada, e os problemas da
Ru´ına do Jogador e da Fuga da Caverna mostram, atrav´es de uma pr´atica inves-
tigativa, computacional e te´orica, o uso de um processo estoc´astico aplicado ao
conhecimento que um aluno do ensino m´edio pode dominar. O ´ultimo cap´ıtulo
traz alguns c´alculos mais avan¸cados de esperan¸ca, sendo reservado ao professor a
possibilidade de maior aprofundamento no chamado Andar do B^ebado, levando
alunos com maior interesse em um aprofundamento das matrizes de transi¸c˜ao de
uma Cadeia de Markov.

Palavras-chave: Probabilidade, Esperan¸ca, Cadeias de Markov.

Abstract

This study proposes two instigating problems for application in high school.
Several aspects of such problems are discussed, with a proposed solution always
focused on the use of Markov Chains and their transition matrices. The proposals
for practical activities and lesson plans were planned and discussed in order to
provide the teacher with the best way to apply these concepts. High school
mathematics is often plastered, and the problems of Player Ruin and Cave Escape
show through a computational, theoretical, and investigative practice the use of
a stochastic process applied to the knowledge that a high school student can
master. The last chapter brings some more advanced calculations of expected
value, being reserved to the teacher the possibility of further deepening in the
called Drunkard’s Walk, leading students with greater interest in a deepening of
the transition matrices of a Markov Chain.

Keywords: Probability, Expected Value, Markov Chains.

Sum´ario

Agradecimentos

1 Conceitos Preliminares

1.1 Progress˜ao Geom´etrica . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . .
1.2 Probabilidade Condicional
1.3 Vari´aveis Aleat´orias . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 Esperan¸ca Matem´atica de uma Vari´avel Aleat´oria . . . . . . . . .
1.5 Cadeias de Markov . . . . . . . . . . . . . . . . . . . . . . . . . .

2 A Ru´ına do Jogador

. . . . . . . . . . . . . . . . . . . .
2.1 Algumas observa¸c˜oes gr´aficas
2.2 Matriz de transi¸c˜ao . . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Atividade Pr´atica . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.4 Plano de Aula . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 A Fuga da Caverna

3.1 An´alise Computacional . . . . . . . . . . . . . . . . . . . . . . . .
3.2 Plano de Aula . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Um pouco sobre o Andar do B^ebado

4.1 Forma Can^onica . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . .
4.2 A Matriz Fundamental

5 Considera¸c˜oes Finais

5

9
9
10
12
12
13

15
20
23
26
28

35
38
40

44
45
46

50

9

Cap´ıtulo 1

Conceitos Preliminares

Neste cap´ıtulo faremos uma introdu¸c˜ao aos conceitos b´asicos necess´arios na
solu¸c˜ao dos problemas trabalhados a seguir. Supomos aqui que o leitor j´a est´a
familiarizado com o c´alculo de probabilidades, a um n´ıvel como o apresentado
em [5] ou [6].

1.1 Progress˜ao Geom´etrica

Uma sequ^encia real, onde cada termo for igual ao anterior multiplicado por um
valor constante 𝑞 ∈ R, ser´a chamada de progress˜ao geom´etrica, e 𝑞 ´e denominado
raz˜ao da progress˜ao.

Exemplo 1 A sequ^encia (1, 2, 4, 8, 16, 32, 64), ´e uma progress˜ao geom´etrica, pois,
cada termo ´e igual ao dobro do termo anterior, ou seja, a raz˜ao ´e 𝑞 = 2.

Conhecendo a raz˜ao e um termo da progress˜ao geom´etrica poderemos calcu-
lar os valores de qualquer outro termo termos da sequ^encia. Dada a sequ^encia
(𝑎1, 𝑎2, 𝑎3, 𝑎4, 𝑎5, ...), note que 𝑎2 = 𝑎1𝑞, ou seja, como 𝑎3 = 𝑎2𝑞 ent˜ao temos
𝑎3 = 𝑎1𝑞2. Portanto 𝑎𝑛 = 𝑎1𝑞𝑛−1, pois do termo 1 at´e o termo 𝑛, efetuamos a
multiplica¸c˜ao pela raz˜ao 𝑛 − 1 vezes.

Exemplo 2 Em uma progress˜ao geom´etrica, o terceiro termo vale 54 e o sexto
termo vale 1458. Quanto vale o quinto termo dessa progress˜ao?

10

Sabemos que 𝑎6 = 𝑎3𝑞3, pois, de 𝑎3 at´e 𝑎6 avan¸camos 3 termos, e ent˜ao
1458 = 54𝑞3, logo 𝑞 = 3, para calcular o quinto termo faremos 𝑎5 = 𝑎3𝑞2,
portanto 𝑎5 = 486.

Podemos somar os primeiros termos de uma progress˜ao geom´etrica, obtendo
uma express˜ao em fun¸c˜ao do primeiro termo e da raz˜ao, como mostra o seguinte
resultado.

Teorema 1 A soma dos 𝑛 primeiros termos de uma progress˜ao geom´etrica (𝑎𝑛),
de raz˜ao 𝑞 ̸= 1, ´e 𝑆𝑛 = 𝑎1

)︁

.

(︁ 1−𝑞𝑛
1−𝑞

Demonstra¸c˜ao Baseada em [4].

Seja

𝑆𝑛 = 𝑎1 + 𝑎2 + 𝑎3 + 𝑎4 + ... + 𝑎𝑛−1 + 𝑎𝑛

(1.1)

Em que 𝑎𝑖+1 = 𝑞 · 𝑎𝑖 com 𝑖 = 1, 2, · · · , 𝑛 − 1. Multiplicando por 𝑞 obtemos:

𝑞𝑆𝑛 = 𝑎2 + 𝑎3 + 𝑎4 + 𝑎5 + ... + 𝑎𝑛 + 𝑎𝑛+1.

(1.2)

Subtraindo as equa¸c˜oes 1.1 e 1.2, temos que 𝑆𝑛 − 𝑞𝑆𝑛 = 𝑎1 − 𝑎𝑛+1. Colocando

𝑆𝑛 em evid^encia 𝑆𝑛(1 − 𝑞) = 𝑎1 − 𝑎1𝑞𝑛, obtemos finalmente

𝑆𝑛 = 𝑎1

(︂ 1 − 𝑞𝑛
1 − 𝑞

)︂

.

(cid:3)

1.2 Probabilidade Condicional

Nas palavras de Ross [6], a probabilidade condicional ´e:

“[...] um dos conceitos mais importantes da teoria da probabilidade.
A import^ancia desse conceito ´e dupla. Em primeiro lugar, estamos

11

frequentemente interessados em calcular probabilidades quando temos
alguma informa¸c˜ao parcial a respeito do resultado de um experimento;
em tal situa¸c˜ao as probabilidades desejadas s˜ao condicionais. Em
segundo lugar, mesmo quando n˜ao temos nenhuma informa¸c˜ao parcial
sobre o resultado de um experimento as probabilidades condicionais
podem ser frequentemente utilizadas para computar mais facilmente
as probabilidades desejadas. ”

Exemplo 3 Considere o lan¸camento de um dado e denotemos por X a face ob-
servada. Seja 𝐼 o evento “X ´e par”e 𝐶 o evento “X ´e primo”.

Supondo que o dado ´e balanceado e que, portanto, todas as faces t^em mesma
probabilidade de serem obtidas em um lan¸camento qualquer, podemos calcular a
probabilidade do evento C da seguinte maneira. Dentre os resultados poss´ıveis do
lan¸camento de um dado {1, 2, 3, 4, 5, 6}, apenas os n´umeros 2, 3 e 5 s˜ao primos,
de forma que:

.

=

1
2

𝑃 (𝐶) =

3
6
Por´em, se soubermos que o evento I ocorreu, qual ´e a probabilidade de C
ter ocorrido? Com esta nova informa¸c˜ao, a probabilidade ir´a se alterar. Como
temos a informa¸c˜ao de que o evento I ocorreu, ent˜ao os resultados poss´ıveis s˜ao
{2, 4, 6} e, destes, apenas o 2 ´e um n´umero primo. Portanto a probabilidade de
C, sabendo que I ocorreu ´e igual a 1
3.

A informa¸c˜ao de que o evento 𝐼 ocorreu mudou a probabilidade do evento 𝐶,
de forma que o evento 𝐶 est´a condicionado ao evento 𝐼. A nota¸c˜ao que usaremos
para uma probabilidade condicional ser´a

𝑃 (𝐶|𝐼),

representando assim a probabilidade condicional de C dado que I ocorreu.

Defini¸c˜ao 1 Se 𝑃 (𝐼) > 0, ent˜ao para qualquer evento C no mesmo espa¸co de
probabilidades, a probabilidade condicional de C dado I ´e dada por

𝑃 (𝐶|𝐼) =

𝑃 (𝐶 ∩ 𝐼)
𝑃 (𝐼)

.

12

1.3 Vari´aveis Aleat´orias

Considere um experimento aleat´orio e seu espa¸co amostral, Ω, o conjunto de
todos os poss´ıveis resultados desse experimento. Uma vari´avel aleat´oria (v.a.) ´e
qualquer fun¸c˜ao real observ´avel definida em Ω.

Exemplo 4 Considere um experimento onde ser˜ao feitos tr^es lan¸camentos de
uma moeda balanceada, com espa¸co amostral contendo todas as ternas formadas
por cara ou coroa, Ω = {(𝐶, 𝐶, 𝐶), (𝐶, 𝐶, 𝐾), . . . , (𝐾, 𝐾, 𝐾)}, em que cada com-
ponente indica o lan¸camento correspondente, 𝐶 denota resultado cara e 𝐾, coroa.
Supondo que a moeda ´e balanceada, estes resultados s˜ao igualmente prov´aveis,
cada um com probabilidade 1/8 de ocorrer. Suponha que estamos interessados
apenas no n´umero de caras obtidas no experimento. Associaremos assim os
n´umeros 0 quando o experimento n˜ao obtiver nenhuma cara em sua sequ^encia, 1
quando houver apenas 1 cara, 2 para o caso de se obter duas caras, e 3 para o
caso onde todas as tr^es moedas resultem em caras.

Observe que esta associa¸c˜ao num´erica a cada resultado poss´ıvel do experi-

mento define uma vari´avel aleat´oria. Denotemos esta v.a. por 𝑁 .

Podemos determinar as probabilidades associadas `a v.a. 𝑁 atrav´es da pro-
babilidade definida em Ω, da seguinte maneira. Denotando por 𝑃 𝑟[𝑁 = 𝑘] a
probabilidade de que 𝑁 = 𝑘, temos:

𝑃 𝑟[𝑁 = 0] = 𝑃 ((𝐾, 𝐾, 𝐾)) =

1
8

,

𝑃 𝑟[𝑁 = 1] = 𝑃 ((𝐶, 𝐾, 𝐾), (𝐾, 𝐶, 𝐾), (𝐾, 𝐾, 𝐶)) =

𝑃 𝑟[𝑁 = 2] = 𝑃 ((𝐶, 𝐶, 𝐾), (𝐾, 𝐶, 𝐶), (𝐶, 𝐾, 𝐶)) =

𝑃 𝑟[𝑁 = 3] = 𝑃 ((𝐶, 𝐶, 𝐶)) =

1
8

.

,

3
8
3
8

,

1.4 Esperan¸ca Matem´atica de uma Vari´avel Aleat´oria

Como descrito em [6], a esperan¸ca matem´atica, ou valor esperado de uma vari´avel
aleat´oria 𝑋 discreta, com fun¸c˜ao de probabilidade 𝑝(𝑥), denotada por E[𝑋], ´e

13

obtida por

E[𝑋] =

𝑥𝑝(𝑥)

∑︁

𝑥

Obtemos uma m´edia ponderada dos poss´ıveis valores de 𝑋, com cada va-
lor sendo ponderado pela probabilidade que a vari´avel aleat´oria 𝑋 seja o valor
considerado.

Veja que, no Exemplo 4 da se¸c˜ao anterior, a esperan¸ca da vari´avel aleat´oria

𝑁 ´e

E(𝐶) = 0 ·

1
8

+ 1 ·

3
8

+ 2 ·

3
8

+ 3 ·

1
8

=

3
2

.

1.5 Cadeias de Markov

Uma cadeia de Markov ´e um processos estoc´astico, no qual a distribui¸c˜ao de

probabilidade dos passos futuros, dependem apenas do estado presente.

Uma defini¸c˜ao mais formal pode ser encontrada em [6], onde considera-se
uma sequ^encia de vari´aveis aleat´orias 𝑋0, 𝑋1, 𝑋2, · · · , e um conjunto dos valores
poss´ıveis para essas vari´aveis, 𝑆 = {0, 1, 2, ..., 𝑀 }. Nessa sequ^encia, chamamos
𝑋𝑛 o estado da cadeia no instante 𝑛, e 𝑆 o conjunto dos estados poss´ıveis, de
forma que tal sistema estar´a no estado 𝑖 em um instante 𝑛, quando 𝑋𝑛 = 𝑖, para
𝑖 ∈ 𝑆. Dizemos que a sequ^encia (𝑋𝑛) ´e uma cadeia de Markov se, dado que
𝑋𝑛 = 𝑖, ent˜ao

𝑃𝑖𝑗 := 𝑃 𝑟[𝑋𝑛+1 = 𝑗 | 𝑋0 = 𝑥0, · · · , 𝑋𝑛−1 = 𝑥𝑛−1, 𝑋𝑛 = 𝑥𝑛]

n˜ao depende dos valores de 𝑋1, . . . , 𝑋𝑛−1.

Tais probabilidades podem ser dispostas em uma matriz, chamada de Matriz
de Transi¸c˜ao. Essa matriz ´e do tipo linha estoc´astica, isto ´e, a soma de todas as
entradas de cada linha sempre somam 1,

14

⎛

⎜
⎜
⎜
⎜
⎝

𝑃00 𝑃01
𝑃00 𝑃11
...
...
𝑃𝑚0 𝑃𝑚1

· · · 𝑃0𝑚
· · · 𝑃1𝑚
...
. . .
· · · 𝑃𝑚𝑚

⎞

⎟
⎟
⎟
⎟
⎠

∑︀

𝑗 𝑃(𝑖𝑗) = 1, para todo 𝑖.

Exemplo 5 Adaptado de [5]. Vamos supor que a chance de chover amanh˜a
depende exclusivamente do fato de chover ou n˜ao hoje. Al´em disso, suponha
que se chover hoje, amanh˜a chover´a com uma probabilidade 𝛼, e que, caso n˜ao
tenhamos chuva hoje, amanh˜a ir´a chover com probabilidade 𝛽.

A matriz de transi¸c˜ao para essa Cadeia de Markov ´e

(︃

𝛼 1 − 𝛼
𝛽 1 − 𝛽

)︃

.

considerando que 0 ≤ 𝛼, 𝛽 ≤ 1, esse processo estar´a no estado 0 quando

chove, e no estado 1 quando n˜ao chove.

Ou seja, a entrada 𝑖𝑗 dessa matriz ´e a probabilidade de mudan¸ca de um
estado 𝑖 para um estado 𝑗. A probabilidade de que se estiver chovendo hoje,
amanh˜a tamb´em estar´a chovendo ´e 𝑃00 = 𝛼. Como s´o existem dois estados
poss´ıveis, chove ou n˜ao chove, ent˜ao a probabilidade de n˜ao chover amanh˜a,
dado que choveu hoje ser´a a probabilidade complementar 𝑃01 = 1 − 𝛼. O mesmo
racioc´ınio, nos leva a que 𝑃10 = 𝛽 e 𝑃11 = 1 − 𝛽.

Defini¸c˜ao 2 Chamaremos de estado recorrente de uma cadeia de Markov, um
estado que possui uma probabilidade 𝑞 = 1 de retornar a ele mesmo. Caso essa
probabilidade 𝑞 seja menor que 1, o estado ser´a chamado de transiente.

Defini¸c˜ao 3 Em uma cadeia de Markov, um estado 𝑖 ser´a chamado de absor-
vente se, uma vez atingido, a cadeia n˜ao o deixa mais. Em termos das probabi-
lidades de transi¸c˜ao, um estado 𝑖 ´e dito absorvente se

𝑃𝑖𝑗 =

⎧
⎪⎨

⎪⎩

1,

𝑠𝑒

𝑗 = 𝑖

.

0,

𝑐𝑎𝑠𝑜

𝑐𝑜𝑛𝑡𝑟´𝑎𝑟𝑖𝑜

15

Cap´ıtulo 2

A Ru´ına do Jogador

O primeiro problema a ser explorado ser´a “A Ru´ına do jogador”. Blaise Pascal

prop^os tal problema em 1656. O problema pode ser descrito como:

Um jogador joga uma sequ^encia de jogos independentes contra um oponente.
Em cada rodada ele ganha 1 ponto com probabilidade 𝑝 ou perde 1 ponto com
probabilidade 𝑞, onde 𝑞 = 1 − 𝑝. Considerando que o jogador possui 𝑘 pontos
inicialmente, se ele atingir uma quantidade 𝐾 de pontos ele ganhar´a o jogo ou
caso chegue a 0 pontos, perder´a.

Buscamos a probabilidade de que o jogador chegue a ru´ına, ou seja, que
atinja 0 pontos no decorrer do jogo. Essa an´alise ser´a feita primeiramente de
forma alg´ebrica com probabilidade condicional seguindo a apresenta¸c˜ao de Ross
em [5]. Se denotarmos a pontua¸c˜ao do jogador como 𝑋𝑛 em uma certa rodada
𝑛, teremos uma Cadeia de Markov com as seguintes probabilidades de transi¸c˜ao:

𝑃00 = 𝑃𝐾𝐾 = 1.

𝑃𝑖,𝑖+1 = 𝑝 = 1 − 𝑃𝑖,𝑖−1, 𝑖 = 1, 2, ..., 𝐾 − 1.

Essa Cadeia de Markov possui dois estados absorventes, vit´oria e derrota, nos
outros casos estar´a em um estado transiente. O que nos diz que eventualmente
um dos estados absorventes ser´a atingido1, de forma que o jogador ganhar´a ou
perder´a em algum momento.

1A demonstra¸c˜ao encontra-se no Cap´ıtulo 4.

16

Vamos procurar a probabilidade 𝑃𝑖 de que, dada uma pontua¸c˜ao inicial 𝑖, o
jogador ir´a chegar a 𝐾 pontos em algum momento. Para iniciarmos o c´alculo
dessa probabilidade vamos condicionar 𝑃𝑖 na primeira rodada:

𝑃𝑖 = 𝑝𝑃𝑖+1 + 𝑞𝑃𝑖−1.

Dessa forma a probabilidade do jogador chegar a 𝐾 tendo iniciado com 𝑖
pontos, ser´a dada pela soma da probabilidade dele vencer a primeira rodada e
atingir 𝐾 com o montante de 𝑖 + 1 e dele perder a primeira rodada e chegar a 𝐾
com o montante de 𝑖 − 1. Para 𝑖 = 1, 2, ..., 𝐾 − 1 e como p+q=1 ent˜ao podemos
escrever:

(𝑝 + 𝑞)𝑃𝑖 = 𝑝𝑃𝑖+1 + 𝑞𝑃𝑖−1.

Essa substitui¸c˜ao ir´a facilitar o desenvolvimento dessa rela¸c˜ao, de forma que

poderemos isolar 𝑝 e 𝑞:

𝑝𝑃𝑖 + 𝑞𝑃𝑖 = 𝑝𝑃𝑖+1 + 𝑞𝑃𝑖−1

𝑝𝑃𝑖+1 − 𝑝𝑃𝑖 = 𝑞𝑃𝑖 − 𝑞𝑃𝑖−1

𝑝(𝑃𝑖+1 − 𝑃𝑖) = 𝑞(𝑃𝑖 − 𝑃𝑖−1).

Nessa equa¸c˜ao 𝑝 e 𝑞 s˜ao constantes, portanto criamos a raz˜ao 𝑞
𝑝 :

𝑃𝑖+1 − 𝑃𝑖 =

𝑞
𝑝

(𝑃𝑖 − 𝑃𝑖−1).

Se o jogador iniciar o jogo com pontua¸c˜ao 0, ele n˜ao ter´a chance de ganhar,

ou seja, 𝑃0 = 0. Tomando na equa¸c˜ao anterior 𝑖 = 1 :

𝑃2 − 𝑃1 =

𝑞
𝑝

(𝑃1 − 𝑃0) =

𝑞
𝑝

𝑃1.

Mas dessa forma, se 𝑃2−𝑃1 = 𝑞

𝑝 𝑃1 ent˜ao ao tomarmos 𝑖 = 2 podemos escrever:

𝑃3 − 𝑃2 =

𝑞
𝑝

(𝑃2 − 𝑃1) =

)︂

(︂ 𝑞
𝑝

)︂ (︂ 𝑞
𝑝

𝑃1 =

)︂2

(︂ 𝑞
𝑝

𝑃1.

De uma forma geral, seguindo esse racioc´ınio, para 𝑖 = 𝑛 + 1, vamos ter a

17

seguinte equa¸c˜ao:

𝑃𝑛 − 𝑃𝑛−1 =

𝑞
𝑝

(𝑃𝑛−1 − 𝑃𝑛−2) =

)︂𝑛−1

(︂ 𝑞
𝑝

𝑃1.

Essa equa¸c˜ao nos d´a o c´alculo da probabilidade 𝑃𝑛 desde que conhecidas as
probabilidades de 𝑃𝑛−1 e 𝑃𝑛−2, por´em esse c´alculo ainda n˜ao ´e pr´atico, para
eliminar os termos que n˜ao nos ´e ´util nesse momento, considere a soma das 𝑖
primeiras equa¸c˜oes dessa forma:

𝑃𝑛 − 𝑃𝑛−1 =

)︂𝑛−1

(︂ 𝑞
𝑝

𝑃1.

A soma ser´a:

(𝑃2 − 𝑃1) + (𝑃3 − 𝑃2) + · · · + (𝑃𝑖−1 − 𝑃𝑖−2) + (𝑃𝑖 − 𝑃𝑖−1) =

=

)︂

(︂ 𝑞
𝑝

𝑃1 +

)︂2

(︂ 𝑞
𝑝

𝑃1 + · · · +

)︂𝑖−1

(︂ 𝑞
𝑝

𝑃1.

Esse tipo de soma do lado esquerdo da equa¸c˜ao ´e chamado de soma telesc´opica,
cancelando termo a termo e colocando 𝑃1 em evid^encia do lado direito teremos

((cid:0)(cid:0)𝑃2 − 𝑃1) + ((cid:0)(cid:0)𝑃3 − (cid:0)(cid:0)𝑃2) + · · · + ((cid:8)(cid:8)(cid:8)𝑃𝑖−1 − (cid:8)(cid:8)(cid:8)𝑃𝑖−2) + (𝑃𝑖 − (cid:8)(cid:8)(cid:8)𝑃𝑖−1) =

= 𝑃1

)︂

[︃(︂ 𝑞
𝑝

+

(︂ 𝑞
𝑝

)︂2

+ · · · +

)︂𝑖−1]︃

.

(︂ 𝑞
𝑝

ou seja,

𝑃𝑖 − 𝑃1 = 𝑃1

)︂

[︃(︂ 𝑞
𝑝

+

(︂ 𝑞
𝑝

)︂2

+ · · · +

)︂𝑖−1]︃

.

(︂ 𝑞
𝑝

(2.1)

Note que dessa forma temos a soma de uma progress˜ao geom´etrica, para

resolv^e-la, vamos considerar como deve se comportar equa¸c˜ao para 𝑞

𝑝 = 1.

𝑃𝑖 − 𝑃1 = 𝑃1

[︀1 + 12 + · · · + 1𝑖−1]︀ = (𝑖 − 1)𝑃1 ⇒ 𝑃𝑖 = 𝑖𝑃1.

(2.2)

Por outro lado se 𝑞
soma ser´a dada por:

𝑝 ̸= 1 temos uma progress˜ao geom´etrica de raz˜ao 𝑞

𝑝 , ent˜ao a

18

)︂

[︃(︂ 𝑞
𝑝

+

(︂ 𝑞
𝑝

)︂2

+ · · ·

)︂𝑖−1]︃

𝑞
𝑝

=

(︂ 𝑞
𝑝

Substituindo na equa¸c˜ao 2.1 teremos:

(︂

1 −

(︁ 𝑞
𝑝
1 − 𝑞
𝑝

)︁𝑖)︂

.

𝑃𝑖 − 𝑃1 = 𝑃1

𝑞
𝑝

⎡

⎢
⎢
⎣

(︂

1 −

(︁ 𝑞
𝑝
1 − 𝑞
𝑝

)︁𝑖)︂

⎤

.

⎥
⎥
⎦

Isolando 𝑃𝑖, teremos

𝑞
𝑝

⎡

⎢
⎢
⎣

𝑃𝑖 = 𝑃1

(︂

1 −

(︁ 𝑞
𝑝
1 − 𝑞
𝑝

)︁𝑖)︂

⎤

⎥
⎥
⎦

− 𝑃1 =

)︁𝑖

1 −

(︁ 𝑞
𝑝
1 − 𝑞
𝑝

𝑃1.

Logo 𝑃𝑖 ter´a as seguintes equa¸c˜oes de acordo com 𝑞
𝑝

𝑃𝑖 =

⎧
⎪⎪⎨
⎪⎪⎩

𝑝)𝑖
1−( 𝑞
1− 𝑞
𝑝

𝑃1

𝑖𝑃1

𝑠𝑒

𝑞
𝑝 ̸= 1

.

𝑠𝑒

𝑞
𝑝 = 1

(2.3)

Caso o jogador comece com 𝐾 pontos temos a probabilidade 𝑃𝐾 = 1, ou seja
ele j´a come¸ca vitorioso, e portanto tem probabilidade 1 de vit´oria, substituindo
essa possibilidade na equa¸c˜ao 2.3, quando 𝑖 = 𝐾, obtemos duas novas rela¸c˜oes
para 𝑃1.

A primeira para o caso em que 𝑞

𝑝 ̸= 1,

)︁𝐾

1 −

(︁ 𝑞
𝑝
1 − 𝑞
𝑝

𝑃𝐾 =

A segunda para 𝑞

𝑝 = 1

𝑃1 = 1 ⇒ 𝑃1 =

(︁ 𝑞
𝑝

)︁
)︁𝐾 .

1 −

1 −

(︁ 𝑞
𝑝

(2.4)

𝑃𝐾 = 𝐾𝑃1 = 1 ⇒ 𝑃1 =

1
𝐾

.

19

(2.5)

Perceba ainda que como 𝑞

𝑝 = 1 e 𝑝 = 1 − 𝑞 ent˜ao 𝑝 = 1
2.

Substitu´ımos os valores de 𝑃1 encontrados nas equa¸c˜oes 2.4 e 2.5 em 2.2,

obtendo

𝑃𝑖 =

⎧
⎪⎪⎪⎨
⎪⎪⎪⎩

1−( 𝑞
1−( 𝑞

𝑝)𝑖
𝑝)𝐾

𝑠𝑒 𝑝 ̸= 1
2

.

𝑖
𝐾

𝑠𝑒 𝑝 = 1
2

Por fim considere 𝐾 → ∞, teremos 𝑖

𝐾 → 0 visto que i ´e um n´umero inteiro,
2 a probabilidade de chegar a 𝐾 ´e zero. Por outro lado se

dessa forma para 𝑝 = 1
𝑝 < 𝑞, podemos calcular o limite

lim
𝐾→∞

1−( 𝑞
1−( 𝑞

𝑝)𝑖
𝑝)𝐾 = 0.

Ou seja, para 𝑝 ≤ 𝑞, a probabilidade de vit´oria ´e nula.

Para 𝑝 > 𝑞, temos como limite

lim
𝐾→∞

1−( 𝑞
1−( 𝑞

𝑝)𝑖
𝑝)𝐾 = 1 −

)︁𝑖

(︁ 𝑞
𝑝

.

Portanto, quando 𝐾 → ∞, 𝑃𝑖 ir´a tender para os valores

𝑃𝑖 →

⎧
⎪⎪⎨

⎪⎪⎩

1 −

)︁𝑖

(︁ 𝑞
𝑝

,

𝑠𝑒 𝑝 > 1
2

.

0,

𝑠𝑒 𝑝 ≤ 1
2

Conclu´ımos que caso a probabilidade de vit´oria seja maior que 1

2, a pontua¸c˜ao
do jogador ir´a aumentar indefinidamente, enquanto que para uma probabilidade
menor ou igual a 1
2, o jogador ir´a perder com probabilidade 1 contra um advers´ario
com pontos infinitos.

20

2.1 Algumas observa¸c˜oes gr´aficas

Uma boa an´alise das compara¸c˜oes entre a influ^encia dos valores de 𝑝 no re-
sultado do jogo podem ser vistas em [3], algumas situa¸c˜oes desse artigo podem
ajudar na compreens˜ao dessa influ^encia, principalmente com aux´ılio gr´afico. Ve-
jamos alguns gr´aficos baseados nos exemplos de [3]. Em todos eles est˜ao fixadas
as varia¸c˜oes da pontua¸c˜ao inicial 𝑘 do jogador entre 1, 4, 10 e 19.

Para os casos de 𝑝 = 0, 5 e 𝑝 = 0, 49 figuras 2.1 e 2.2 respectivamente, podemos
notar nos gr´aficos que a probabilidade de vit´oria diminui constantemente, se
aproximando de 0 quanto maior o valor de 𝐾. No caso em que o jogador tem
uma chance menor que 0,5 de vit´oria essa chance cai ainda mais rapidamente.

Figura 2.1: Gr´afico com probabilidade de vit´oria com 𝑝 = 𝑞 = 1
2.

Com as probabilidades de vit´oria do jogador acima de 0,5, gr´afico da figura
2.3, podemos notar que a probabilidade de vit´oria decresce at´e se estabilizar em
um certo limite. ´E poss´ıvel encontrar esse limite utilizando a equa¸c˜ao de 𝑃𝑘,
𝑝)𝑘
definida no come¸co do cap´ıtulo, ´e necess´ario calcular lim
𝑝)𝐾 atribuindo os
𝐾→∞

1−( 𝑞
1−( 𝑞

valores apropriados para 𝑝, 𝑞, e 𝑘.

Primeiramente, note que como 𝑝 > 𝑞, ent˜ao 𝑞

𝑝 < 1, dessa forma temos

21

Figura 2.2: Gr´afico com probabilidade de vit´oria 𝑝 = 0, 51 e derrota 𝑞 = 0, 49,
ou seja, 𝑝 > 𝑞.

lim
𝐾→∞

1 −

)︁𝑘
)︁𝐾 =

(︁ 𝑞
𝑝
(︁ 𝑞
𝑝

1 −

)︁𝑘

(︁ 𝑞
𝑝

= 1 −

)︂𝑘

.

(︂ 𝑞
𝑝

(cid:0)(cid:0)(︁ 𝑞
)︁𝐾
(cid:0)
𝑝
(cid:0)
Esse resultado, mostra que o valor constante L depende apenas dos valores

1 −

1 −

de 𝑝, 𝑞 e 𝑘, ou seja, como 𝑝 = 0, 51, 𝑞 = 0, 49 calculamos que

para 𝑘 = 1, temos

1 −

)︂𝑘

(︂ 𝑞
𝑝

= 1 −

)︂1

(︂ 0, 49
0, 51

≈ 0, 04,

1 −

)︂𝑘

(︂ 𝑞
𝑝

= 1 −

)︂4

(︂ 0, 49
0, 51

≈ 0, 15,

para 𝑘 = 4, temos

para 𝑘 = 10, temos

1 −

)︂𝑘

(︂ 𝑞
𝑝

= 1 −

)︂10

(︂ 0, 49
0, 51

≈ 0, 33,

22

Figura 2.3: Gr´afico com probabilidade de vit´oria 𝑝 = 0, 49 e derrota 𝑞 = 0, 51,
ou seja, 𝑝 < 𝑞.

para 𝑘 = 19, temos

1 −

)︂𝑘

(︂ 𝑞
𝑝

= 1 −

)︂19

(︂ 0, 49
0, 51

≈ 0, 53.

23

2.2 Matriz de transi¸c˜ao

Uma abordagem mais acess´ıvel aos alunos que j´a dominam os conceitos b´asicos
de matrizes, seria a interpreta¸c˜ao do problema considerando, por exemplo, a
probabilidade de vit´oria 𝑝 = 0.5, e que chegar´a a vit´oria com 𝐾 = 4 pontos.

Montaremos a matriz 𝐴 = 𝑎𝑖𝑗 tal que 𝑎𝑖𝑗 ser´a a probabilidade de que dado
um estado 𝑖, ele passe para o estado 𝑗. Perceba que como o jogador s´o poder´a
ganhar 1 ponto ou perder 1 ponto em cada rodada, ent˜ao a probabilidade do
estado 𝑖 passar para o estado 𝑗, de tal forma que 𝑗 > 𝑖 + 1 ou 𝑗 < 𝑖 − 1 ´e 0, isso
significa que estando por exemplo no estado 𝑖 = 3, os ´unicos estados acess´ıveis
s˜ao 𝑗 = 2 ou 𝑗 = 4.

Devemos considerar ainda que ao atingir 0 pontos a partida acaba, ent˜ao a
probabilidade do estado 𝑖 = 0 mudar pra qualquer outro estado diferente ´e zero,
assim como ao atingir 4 pontos a probabilidade de voltar a uma pontua¸c˜ao menor
´e zero, pois o jogador j´a saiu vitorioso.

Temos ent˜ao uma limita¸c˜ao dos estados acess´ıveis, sendo poss´ıvel variar os
estados de 0 a 4, que indicam respectivamente, derrota e vit´oria. Uma matriz
gen´erica 5 × 5, tem seus elementos dispostos considerando sua posi¸c˜ao em rela¸c˜ao
a linha e coluna

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

𝑎00 𝑎01 𝑎02 𝑎03 𝑎04
𝑎10 𝑎11 𝑎12 𝑎13 𝑎14
𝑎20 𝑎21 𝑎22 𝑎23 𝑎24
𝑎30 𝑎31 𝑎32 𝑎33 𝑎34
𝑎40 𝑎41 𝑎42 𝑎43 𝑎44

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

´E muito vantajoso para nosso c´alculo, o uso dessa disposi¸c˜ao. Levando em
conta o posicionamento de cada uma das entradas 𝑎𝑖𝑗, sendo a posi¸c˜ao da linha
𝑖, o estado atual, e a posi¸c˜ao da coluna 𝑗 o estado alcan¸cado ap´os uma rodada.

Vamos agora montar uma matriz, onde cada entrada 𝑎𝑖𝑗 ser´a dada pela pro-
babilidade de passar de 𝑖 pontos para 𝑗 pontos, tomando as condi¸c˜oes discutidas,
temos que ganhando ou perdendo, a chance de permanecer nesse estado ´e 1.

𝑎00 = 𝑎44 = 1.

24

A probabilidade de vit´oria 𝑝 = 0, 5 e de derrota 𝑞 = 0, 5 mostra que necessa-
riamente haver´a uma mudan¸ca de estado, ou seja ocorrer´a uma vit´oria ou uma
derrota.

𝑎𝑖𝑗 = 0, 5

𝑠𝑒

𝑖 = 𝑗 + 1

𝑜𝑢 𝑖 = 𝑗 − 1.

Nos outros casos a probabilidade de mudan¸ca ´e 0, visto que s´o ´e poss´ıvel obter
ou perder um ponto por rodada, al´em de que, necessariamente a pontua¸c˜ao ir´a
se alterar ap´os cada rodada.

Com essas considera¸c˜oes temos a seguinte matriz A

𝐴 =

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

1
0.5
0
0
0

0
0
0.5
0
0

0
0.5
0
0.5
0

0
0
0.5
0
0

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

0
0
0
0.5
1

A matriz 𝐴 ser´a denominada de matriz de transi¸c˜ao.

Considere agora a matriz 𝐵𝑟, que mostrar´a a probabilidade 𝑏0,𝑖 de que um
jogador chegue a cada uma das pontua¸c˜oes com o decorrer das rodadas, ou seja,
a posi¸c˜ao da coluna 𝑖 dar´a a probabilidade de se obter at´e aquela rodada 𝑟, a
pontua¸c˜ao 𝑖.

Com uma pontua¸c˜ao inicial de 2 pontos, temos a matriz

(︁

𝐵1 =

0 0 1 0 0

)︁

.

Ou seja, na primeira rodada temos 2 pontos com probabilidade 1.

Com a matriz de transi¸c˜ao e a matriz de probabilidade 𝐵1, podemos calcular

as probabilidades das pontua¸c˜oes de 𝐵2 na segunda rodada

25

𝐵2 = 𝐵1 · 𝐴 =

(︁

0 0 1 0 0

)︁

·

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

1
0.5
0
0
0

(︁

=

0 0.5 0 0.5 0

0
0.5
0
0.5
0

0
0
0.5
0
0

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

0
0
0
0.5
1

=

0
0
0.5
0
0

)︁

.

A matriz 𝐵2 mostra que nesse momento temos a chance de 0, 5 de chegar a
1 ponto, e 0, 5 de chegar a 3 pontos, observe tamb´em que a chance de continuar
com dois pontos ´e 0, ´e not´avel, pois o jogador nunca permanecer´a com a mesma
pontua¸c˜ao, a n˜ao ser que o jogo tenha acabado com uma vit´oria ou uma derrota.

Aplicando novamente a matriz de transi¸c˜ao, obteremos as probabilidades de
pontua¸c˜oes de 𝐵3, ou seja, saberemos qual ´e a probabilidade de cada pontua¸c˜ao
na terceira rodada

𝐵3 = 𝐵2 · 𝐴 =

(︁

0 0.5 0 0.5 0

)︁

·

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

1
0.5
0
0
0

(︁

=

0.25 0 0.5 0 0.25

0
0.5
0
0.5
0

0
0
0.5
0
0

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

0
0
0
0.5
1

=

0
0
0.5
0
0

)︁

.

Observe que para a terceira rodada, temos uma probabilidade de 0,5 de vol-
tarmos a pontua¸c˜ao inicial de 2 pontos, probabilidades 0,25 de perder a partida
e 0,25 de ganhar a partida.

Note que h´a dois pontos de absor¸c˜ao nos quais a probabilidade n˜ao decai, ou
seja, cada vez que repetimos esse processo aumentamos a probabilidade de se
chegar a uma vit´oria ou uma derrota. Esse processo pode ser repetido v´arias ve-
zes, sempre usando a multiplica¸c˜ao de matrizes para encontrar as probabilidades
de cada estado.

26

O software R pode ser uma ferramenta importante para a an´alise desse pro-
blema em propor¸c˜oes maiores, a atividade pr´atica a seguir mostra como utilizar
o programa para calcular outros exemplos.

2.3 Atividade Pr´atica

Em [1] s˜ao discutidos momentos para a introdu¸c˜ao de matrizes no ensino m´edio
com exemplos aplic´aveis em Cadeias de Markov, venho propor o mesmo problema
descrito anteriormente, por´em com c´alculos feitos atrav´es do R.

Considere o jogo com um dado honesto, em que o jogador ganha um ponto
ao conseguir um n´umero maior do que 2 e perder´a um ponto para um n´umero
menor ou igual a 2. O jogador come¸car´a com 4 pontos e ganhar´a caso atinja
6 pontos, ou ser´a derrotado ao perder todos os pontos. Vamos calcular com o
Software R a probabilidade de uma vit´oria ou de uma derrota ap´os 5 rodadas.
Usaremos o comando matrix para criar a matriz de transi¸c˜ao dadas as condi¸c˜oes
discutidas na Se¸c˜ao 2.2.

Figura 2.4: Comando gerador da matriz nula.

Faremos com que 𝐴 seja a matriz de transi¸c˜ao e aplicaremos no programa
a entrada A <-matrix(0,ncol=7,nrow=7), que ir´a gerar uma matriz de zeros
7x7 (figura 2.4), e adicionaremos manualmente as entradas das probabilidades
de transi¸c˜ao, nesse exemplo com as pontua¸c˜oes poss´ıveis variando de 0 a 6, foi
necess´aria uma matriz 7x7, no entanto para matrizes maiores pode ser necess´aria

27

uma automatiza¸c˜ao para inser¸c˜ao das probabilidades, uma sugest˜ao de programa
para efetuar esse trabalho, dentro do pr´oprio ambiente do software R sabendo
que a vit´oria em cada rodada ocorre tirando 3, 4, 5 ou 6 no dado, ou seja as
probabilidades de mudan¸ca de estado ser˜ao dadas por 𝑎𝑖,𝑗 = 2
3 se 𝑗 = 𝑖 − 1, e em
caso de derrota ter´ıamos 𝑎𝑖,𝑗 = 1

3 se 𝑗 = 𝑖 + 1, seria:

1 A [1 ,1] < -1

2 A [7 ,7] < -1

3 for ( i in 1:7) {

4

5

6

7

8

9

10

11

for ( j in 1:7) {

if ( j == i -1) {

A [i , j ] < -2/3

}

if ( j == i +1) {

A [i , j ] < -1/3

}

}

12 }

13 A [1 ,2] < -0

14 A [7 ,6] < -0

Criando esse la¸co, o sistema ir´a testar cada entrada da matriz A, de acordo
com sua posi¸c˜ao espec´ıfica relativa a linha e a coluna, sempre que for identificado
um caso de vit´oria, ou seja 𝑗 = 𝑖 − 1, ir´a substituir o valor dessa entrada pela
probabilidade de 2
3, al´em
disso no in´ıcio do programa foram adicionadas as probabilidades de permanecer
nos pontos absorventes, que pela pr´opria defini¸c˜ao ser´a sempre 1.

3, nos casos de derrota, 𝑗 = 𝑖+1, a probabilidade ser´a de 1

Incluindo as probabilidades de transi¸c˜ao, teremos a matriz da figura ??.

Consideramos a matriz do estado inicial das probabilidades de pontua¸c˜ao do

jogador, como ele tem inicialmente 4 pontos temos a matriz 𝐵 da figura ??.

Utilizando as matriz de transi¸c˜ao 𝐴, podemos calcular as probabilidades de
pontua¸c˜ao em cada uma das jogadas poss´ıveis, em particular gostar´ıamos de saber
as probabilidades ap´os 5 rodadas, portanto aplicaremos a matriz de transi¸c˜ao 5
vezes, assim como descrito na Figura 2.7 .

28

Figura 2.5: Matriz de transi¸c˜ao.

Figura 2.6: Matriz B.

Figura 2.7: Resultado das probabilidades ap´os 5 rodadas.

Note que a probabilidade de vit´oria ap´os 5 rodadas ´e de aproximadamente
0, 16, ou seja 16% enquanto a derrota chega a aproximadamente 0, 197, que s˜ao
equivalentes a 19, 7%.

Com pequenas altera¸c˜oes nos passos anteriores ´e poss´ıvel fazer testes com

diferentes probabilidades.

2.4 Plano de Aula

ANO: Segundo ano do Ensino M´edio.

29

CONTE ´UDO: Probabilidade e Matrizes.

MATERIAIS: Um dado de seis faces.

OBJETIVOS: Construir e utilizar matrizes para a solu¸c˜ao de um problema
pr´atico, usar estimativas para comparar e prever o resultado esperado.

TEMPO ESTIMADO: 2 a 5 aulas.

Trechos desse plano de aula podem ser omitidos a crit´erio do professor, a
an´alise pr´atica tem como fun¸c˜ao provocar a discuss˜ao, al´em de permitir tentativas
de previs˜ao dos resultados da etapa te´orica.

Aula 1: Apresenta¸c˜ao do problema e Pr´atica investigativa

Apresentar aos alunos o problema da Ru´ına do Jogador assim como descrito no
cap´ıtulo 2:

Um jogador joga uma sequ^encia de jogos independentes contra um
oponente. Em cada jogo ele ganha 1 ponto com probabilidade 𝑝 ou
perde 1 ponto com probabilidade 𝑞, onde 𝑞 = 1 − 𝑝. Considerando
que o jogador possui 𝑘 pontos inicialmente, caso atinja uma certa
quantidade 𝐾 de pontos ele ganhar´a o jogo ou se chegar a 0 perder´a.

Cada rodada nesse jogo ´e independente da anterior, sendo preservada as pro-
babilidades de vit´oria ou derrota em cada nova rodada, por´em a quantidade de
pontos que cada jogador possui influ^encia diretamente o resultado final, portanto
deve-se propor aos alunos uma investiga¸c˜ao dessas possibilidades.

Previamente, o professor pode ter trabalhado com os alunos as probabilidades
associadas aos resultados do lan¸camento de dois dados honestos. Essas probabi-
lidades podem variar de acordo com o jogo, desde que efetivamente calculadas,
de forma que se possa verificar atrav´es do c´alculos as reais chances de vit´oria ou
derrota.

Para que os alunos estejam familiarizados com a ideia do jogo, uma simula¸c˜ao
mais simples e r´apida deve ser feita, cada jogador ter´a inicialmente 3 pontos,

30

denotaremos esses jogadores de A e B, jogar˜ao sucessivamente um ´unico dado,
sendo que os n´umeros ´ımpares dar˜ao a vit´oria ao jogador A e n´umeros pares ao
jogador B. Em um dado comum, numerado de 1 a 6, temos a probabilidade de
6 ou 1
3
2 para a queda de um n´umero par, ou um n´umero ´ımpar, fazendo com que
ambos os jogadores tenham a mesma probabilidade de vit´oria em cada rodada.
O jogo deve acontecer at´e que um dos jogadores chegue a 0 pontos, todos os

resultados devem ser marcados em uma tabela como no modelo a seguir:

Tabela 2.1: Tabela de pontua¸c˜ao por rodada
Rodada Vit´oria Pontua¸c˜ao

A B

A B

0
1
2
3
4
5
...

Um exemplo de jogo pode acontecer como anotado na Tabela 2.2. Nela ve-
mos que o jogador A ganhou as rodadas 1 e 2, sendo derrotado na rodada 3, e
finalizando o jogo ao ganhar as rodadas 4 e 5.

Essa configura¸c˜ao de jogo pode ser usado algumas vezes, sempre disputando

em duplas.

Ap´os o entendimento dos alunos desse processo de anota¸c˜oes e pr´atica do
jogo, o professor deve iniciar um debate em sala propondo um novo modelo de

Tabela 2.2: Tabela de pontua¸c˜ao por rodada
Rodada Vit´oria Pontua¸c˜ao

A B

X
X

X

X

A B
3
3
2
4
1
5
2
4
1
5
0
6

0
1
2
3
4
5

31

regras. Esse novo modelo ir´a dar uma probabilidade de vit´oria maior de rodada
ao jogador A, no entanto far´a com que ele inicie o jogo com uma pontua¸c˜ao
menor.

Nessa nova simula¸c˜ao o jogador A iniciar´a com 4 pontos e o jogador 𝐵 com
2 pontos, por´em o crit´erio da vit´oria ser´a diferente, o jogador A ganhar´a quando
o dado cair nos n´umeros 1 ou 2 e o jogador B caso o dado revele os n´umeros 3,
4, 5 ou 6.

Antes das duplas iniciarem as disputas, o professor deve propor uma discuss˜ao
sobre a melhor escolha, quem ter´a mais chance de vit´oria, o jogador A come¸cando
com mais pontos, por´em menor chance de vit´oria em cada rodada, ou o jogador
B com menor pontua¸c˜ao inicie, mas com chance de vit´oria maior a cada rodada?

Novamente deve-se anotar os resultados na tabela para consulta futura.

Aula 2 e 3: Modelagem dos dados te´oricos

Nessa etapa, o professor dever´a guiar os alunos at´e uma representa¸c˜ao interes-

sante para a apresenta¸c˜ao e an´alise dos dados.

Considerando a simula¸c˜ao inicial, em que a probabilidade de vit´oria de cada
jogador era de 50% em cada rodada, ´e poss´ıvel saber as probabilidades de pon-
tua¸c˜ao de um jogador em cada uma das rodadas?

Pensando no jogo em si, podemos notar que ap´os cada rodada, necessaria-
mente a pontua¸c˜ao dos jogadores tem que mudar. Isso acontece sempre, visto
que n˜ao h´a empates, ou se ganha ou se perde a rodada, al´em disso, n˜ao ´e poss´ıvel
ganhar mais do que 1 ponto em cada rodada, ou seja se o jogador tiver por exem-
plo 2 pontos em uma rodada, ele n˜ao pode na rodada seguinte chegar a 4 ou a 0
pontos por exemplo, sendo que inevitavelmente ele estar´a com 1 ou 3 pontos na
rodada seguinte.

Para evitar ambiguidades, vamos estabelecer uma nota¸c˜ao para as probabi-
lidades 𝑎𝑖,𝑗 em que 𝑖 indicar´a a pontua¸c˜ao atual, e 𝑗 a pontua¸c˜ao na rodada
seguinte, temos por exemplo que a probabilidade 𝑎2,3 = 𝑎2,1 = 0, 5, pois existe
a mesma chance do jogador perder ou ganhar a rodada, 𝑎2,4 = 0 j´a que ´e im-
poss´ıvel em uma ´unica rodada passar de 2 para 4 pontos. Duas probabilidades
importantes s˜ao 𝑎0,0 e 𝑎6,6, ap´os atingir a pontua¸c˜ao m´ınima de zero pontos, ou

32

a pontua¸c˜ao m´axima de 6 pontos, o jogo acaba, e portanto a probabilidade do
jogador continuar com 0 pontos, ou com 6 pontos ser´a de 1, logo 𝑎0,0 = 𝑎6,6 = 1.
Considerando o jogador A, sabemos que iniciar´a com 3 pontos, portanto a proba-
bilidade de possuir 3 pontos ´e 1, e naturalmente, a probabilidade de ter qualquer
pontua¸c˜ao diferente de 3 ´e 0.

Com essas informa¸c˜oes, podemos agora calcular as probabilidades de pon-
tua¸c˜ao em cada rodada. Esse c´alculo pode ser feito manualmente conhecendo
todas as probabilidades, mas existe um modo muito mais simples, que inclusive
pode facilitar muito a implementa¸c˜ao do mesmo em um sistema computacional,
esse modo exigir´a uma organiza¸c˜ao dos dois conjuntos de dados mencionados:
Probabilidades de mudan¸ca entre cada pontua¸c˜ao e Probabilidade da pontua¸c˜ao
do jogador em cada rodada.

Organizaremos esses conjuntos de dados matricialmente, ou seja, iremos se-
parar em linhas e colunas todas as informa¸c˜oes. Chamaremos de M a matriz com
todas as probabilidades de mudan¸ca entre pontua¸c˜oes, e de 𝑋𝑟 a probabilidade
de pontua¸c˜oes do jogador em cada rodada 𝑟.

𝑀 =

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝

𝑎0,0 𝑎0,1 𝑎0,2 𝑎0,3 𝑎0,4 𝑎0,5 𝑎0,6
𝑎1,0 𝑎1,1 𝑎1,2 𝑎1,3 𝑎1,4 𝑎1,5 𝑎1,6
𝑎2,0 𝑎2,1 𝑎2,2 𝑎2,3 𝑎2,4 𝑎2,5 𝑎2,6
𝑎3,0 𝑎3,1 𝑎3,2 𝑎3,3 𝑎3,4 𝑎3,5 𝑎3,6
𝑎4,0 𝑎4,1 𝑎4,2 𝑎4,3 𝑎4,4 𝑎4,5 𝑎4,6
𝑎5,0 𝑎5,1 𝑎5,2 𝑎5,3 𝑎5,4 𝑎5,5 𝑎5,6
𝑎6,0 𝑎6,1 𝑎6,2 𝑎6,3 𝑎6,4 𝑎6,5 𝑎6,6

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

Conhecendo cada entrada dessa matriz, podemos substituir cada um deles
pelo valor correspondente como discutido, de forma que obteremos a seguinte
matriz

33

𝑀 =

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝

1
0.5
0
0
0
0
0

0
0
0.5
0
0
0
0

0
0.5
0
0.5
0
0
0

0
0
0.5
0
0.5
0
0

0
0
0
0.5
0
0.5
0

0
0
0
0
0.5
0
0

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

0
0
0
0
0
0.5
1

´E muito importante entender essa matriz 𝑀 , como uma matriz de transi¸c˜ao,
pois nela temos descrito todas as probabilidades poss´ıveis desse jogo com as
condi¸c˜oes dadas. A matriz 𝑋𝑟 ser´a representada de forma que cada entrada
corresponde a probabilidade de uma pontua¸c˜ao poss´ıvel no jogo, representaremos
tais entradas como 𝑥𝑛, em que 𝑛 representa a pontua¸c˜ao.

(︁

𝑋𝑟 =

𝑥0 𝑥1 𝑥2 𝑥3 𝑥4 𝑥5 𝑥6

)︁

.

Inicialmente sabemos que o jogador possui 3 pontos, ou seja 𝑥3 = 1 e todas

as outras entradas iguais a 0.

(︁

𝑋0 =

0 0 0 1 0 0 0

)︁

.

Para calcularmos efetivamente todas as probabilidades para as rodadas se-
guintes, precisamos analisar a possibilidade de mudan¸ca de uma pontua¸c˜ao para
a outra a partir dos dados da matriz 𝑀 , aplicando-as na matriz 𝑋0, ou seja, mul-
tiplicaremos cada uma das probabilidades 𝑋𝑟 com cada entrada de 𝑀 do tipo
𝑎𝑟,𝑗, e somando em seguida termo a termo esses produtos de modo a obter a pro-
babilidade de chegar a cada uma das pontua¸c˜oes poss´ıveis. Na pr´atica ter´ıamos
que se

(︁

𝑋𝑟 =

𝑥0 𝑥1 𝑥2 𝑥3 𝑥4 𝑥5 𝑥6

)︁

.

ent˜ao

34

[𝑋𝑟+1]𝑡 =

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝

𝑥0𝑎0,0 + 𝑥1𝑎1,0 + 𝑥2𝑎2,0 + 𝑥3𝑎3,0 + 𝑥4𝑎4,0 + 𝑥5𝑎5,0 + 𝑥6𝑎6,0
𝑥0𝑎0,1 + 𝑥1𝑎1,1 + 𝑥2𝑎2,1 + 𝑥3𝑎3,1 + 𝑥4𝑎4,1 + 𝑥5𝑎5,1 + 𝑥6𝑎6,1
𝑥0𝑎0,2 + 𝑥1𝑎1,2 + 𝑥2𝑎2,2 + 𝑥3𝑎3,2 + 𝑥4𝑎4,2 + 𝑥5𝑎5,2 + 𝑥6𝑎6,2
𝑥0𝑎0,3 + 𝑥1𝑎1,3 + 𝑥2𝑎2,3 + 𝑥3𝑎3,3 + 𝑥4𝑎4,3 + 𝑥5𝑎5,3 + 𝑥6𝑎6,3
𝑥0𝑎0,4 + 𝑥1𝑎1,4 + 𝑥2𝑎2,4 + 𝑥3𝑎3,4 + 𝑥4𝑎4,4 + 𝑥5𝑎5,4 + 𝑥6𝑎6,4
𝑥0𝑎0,5 + 𝑥1𝑎1,5 + 𝑥2𝑎2,5 + 𝑥3𝑎3,5 + 𝑥4𝑎4,5 + 𝑥5𝑎5,5 + 𝑥6𝑎6,5
𝑥0𝑎0,6 + 𝑥1𝑎1,6 + 𝑥2𝑎2,6 + 𝑥3𝑎3,6 + 𝑥4𝑎4,6 + 𝑥5𝑎5,6 + 𝑥6𝑎6,6

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

A matriz 𝑋𝑟+1 foi transposta para uma melhor visualiza¸c˜ao das entradas

obtidas pela multiplica¸c˜ao.

Podemos notar que esse resultado ´e exatamente o mesmo que obtido pela

multiplica¸c˜ao 𝑋𝑟 · 𝑀 , ou seja 𝑋𝑟 · 𝑀 = 𝑋𝑟+1.

Os alunos devem aplicar esses conceitos no c´alculo dessa primeira simula¸c˜ao,
obtendo as probabilidades de vit´oria de cada um ap´os 5 ou mais rodadas. Caso
haja tempo suficiente, o professor pode propor ainda uma compara¸c˜ao entre os
resultados obtidos pela multiplica¸c˜ao das matrizes, com os anotados por cada
dupla, sendo ainda mais interessante a compara¸c˜ao com a m´edia dos resultados
obtidos pela turma toda.

35

Cap´ıtulo 3

A Fuga da Caverna

Considere uma caverna, como o desenho na Figura 3.1, com 3 passagens, das
quais duas est˜ao conectadas e voltam ao mesmo local em um tempo de 2 horas,
e uma terceira que leva at´e a sa´ıda em 3 horas. Considerando que ao voltar a
caverna n˜ao ´e poss´ıvel distinguir as tr^es passagens e a escolha de cada passagem
tem mesma probabilidade, qual o tempo esperado para a fuga dessa caverna?

Figura 3.1: Representa¸c˜ao do mapa da caverna.

Consideremos inicialmente o n´umero de tentativas at´e que a fuga seja con-
cretizada, ou seja, caso ocorra sucesso na n-´esima tentativa, ocorreram 𝑛 − 1
falhas e 1 sucesso. Como os eventos s˜ao independentes, ent˜ao a probabilidade
de ocorrerem sucessivamente ser´a igual a multiplica¸c˜ao da probabilidade de cada

36

falha vezes o sucesso

𝑃 =

)︂𝑛−1

(︂ 2
3

·

1
3

.

Dessa forma podemos calcular as probabilidades de sucesso da fuga de acordo
com o n´umero de tentativas, os valores para as primeiras tentativas podem ser
vistas na tabela 1.

Tabela 3.1: Probabilidade de fuga de acordo com o n´umero de tentativas

3

Tentativas C´alculo
1 𝑃 = (︀ 2
2 𝑃 = (︀ 2
3 𝑃 = (︀ 2
4 𝑃 = (︀ 2
5 𝑃 = (︀ 2

3

3

3

3

3

9

)︀0 · 1
)︀1 · 1
)︀2 · 1
)︀3 · 1
)︀4 · 1

3 = 1
3 = 2
3 = 4
3 = 8
3 = 16

27

81

243

Probabilidade
33,33%
22,22%
14,81%
9,88%
6,58%

Note que a chance acumulada de fuga nas duas primeiras tentativas ´e de
aproximadamente 55,55%, e aumenta em cada nova tentativa, faremos o c´alculo
da soma de todas as tentativas

)︂𝑛−1

∞
∑︁

𝑖=1

(︂ 2
3

·

1
3

=

1
3

∞
∑︁

𝑖=1

(︂ 2
3

)︂𝑛−1

.

temos a soma de uma P.G. infinita com raz˜ao menor que 1, e portanto igual

a

2
3
1 − 1
3

= 1.

dessa forma um sucesso acabar´a ocorrendo com probabilidade 1.

Podemos perceber pela fun¸c˜ao de probabilidade que com o passar do tempo a
probabilidade de fuga diminui, ou seja, existe uma chance maior da fuga ocorrer
nas primeiras tentativas. Naturalmente isso nos leva a perguntar: Qual seria o
tempo esperado para que a fuga aconte¸ca?

A no¸c˜ao de tempo esperado pode ser calculado como visto no Cap´ıtulo 1
Se¸c˜ao 1.4 desse trabalho. Considere a vari´avel aleat´oria 𝑋, tal que 𝑃 𝑟[𝑋 = 𝑛] =
(︀ 2
3 que relaciona a probabilidade de fuga para 𝑛 tentativas, esse vari´avel
3

)︀𝑛−1 · 1

aleat´oria ´e dita geom´etrica, podemos calcular a esperan¸ca de 𝑋 por

E(𝑋) =

)︂𝑛−1

∞
∑︁

𝑖=1

𝑛 ·

(︂ 2
3

·

1
3

.

Considerando as somas parciais de:
𝑆1 = 1
3
𝑆2 = 1
𝑆3 = 1
...
𝑆𝑛 = 1

3 + 2 · 1
3 + 2 · 1

3 · 2
3 · 2

3 + 3 · 1

3 · (︀ 2

3 + 2 · 1

3 + 3 · 1

3 · (︀ 2

3 · 2

)︀2

3

3

3

)︀2 · · · (𝑛 − 1) · 1

3 · (︀ 2

3

)︀𝑛−2 + 𝑛 · 1

3 · (︀ 2

3

)︀𝑛−1 .

Multiplicando 𝑆𝑛 por 2

3 encontramos:

2

3𝑆𝑛 = 1

3 · 2

3 + 2 · 1

3 · (︀ 2

3

)︀2 · · · (𝑛 − 1) · 1

3 · (︀ 2

3

)︀𝑛−1 + 𝑛 · 1

3 · (︀ 2

3

)︀𝑛 .

E a subtra¸c˜ao 𝑆𝑛 − 2

3𝑆𝑛 = 1

3𝑆𝑛 = 1

3 + 1

3 · (︀ 2

3

)︀ + 1

3 · (︀ 2

3

)︀2 + · · · + 1

3 · (︀ 2

3

)︀𝑛−1 − 𝑛 1

3 · (︀ 2

3

37

)︀𝑛 .

3 · (︀ 2
Note que 𝐴 = 1
gress˜ao geom´etrica infinita (cap´ıtulo 1.1) e portanto temos que

)︀2 + · · · + 1

3 · (︀ 2

3 · (︀ 2

)︀ + 1

3 + 1

3

3

3

)︀𝑛−1 ´e a soma de uma Pro-

𝐴 =

1

3)𝑛
3 ·( 2
3 − 1
(1− 2
3 )2

.

E assim 𝑆𝑛 = 𝐴 − 𝑛 1

3 · (︀ 2

3

)︀𝑛 =

1

3)𝑛
3 ·( 2
3 − 1
3 )2 − 𝑛 1
(1− 2

3 · (︀ 2

3

)︀𝑛 .

Como ∑︀∞

𝑛=1

𝑛

3 · (︀ 2

3

)︀𝑛−1 = lim𝑛→∞ 𝑆𝑛 =

1
3
(1− 2

3)2 = 3.

Concluindo que E(𝑋) = 3.
Dessa forma o n´umero de tentativas esperadas para a fuga ´e 𝑛 = 3, note que se
𝑛 = 3 ent˜ao o n´umero de erros 𝑛 − 1 = 2, como cada erro tem o tempo de 2 horas
e adicionado o tempo de sa´ıda de 3 horas, fornece um total de 7 horas para o
tempo esperado de fuga.

38

3.1 An´alise Computacional

O software R possui fun¸c˜oes pr´oprias que calculam resultados de v´arios tipos de
distribui¸c˜oes de probabilidade, dentre elas a distribui¸c˜ao geom´etrica. O problema
da Fuga da Caverna baseia-se em testar os caminhos da caverna at´e encontrar o
caminho que leve a sa´ıda, dessa forma temos um experimento aleat´orio indepen-
dente, com probabilidade 𝑝 de sucesso e 1-p de fracasso, que ser´a repetido at´e que
se obtenha um sucesso. Essa caracter´ıstica define as distribui¸c˜oes geom´etricas.

O comando rgeom(n,p) gera uma sequ^encia com 𝑛 resultados de uma dis-
tribui¸c˜ao geom´etrica, sendo p a probabilidade de sucesso do experimento. Com
aux´ılio desse comando ´e f´acil gerar 100 resultados dessa distribui¸c˜ao (Figura 3.2).

Figura 3.2: Comando rgeom.

O R considera uma tentativa com o valor 0, dessa forma foi feita uma corre¸c˜ao
somando 1 a todos os resultados x=x+1, desses 100 resultados podemos ainda
calcular a m´edia com o comando mean(x) (Figura 3.3).

Figura 3.3: Fun¸c˜ao mean(x).

A m´edia dos 100 resultados foi de 2,98, muito pr´oximo ao valor esperado (3)

obtido no c´alculo da esperan¸ca.

39

Efetuar opera¸c˜oes com o aux´ılio do computador pode ser um diferencial para
o entendimento da esperan¸ca como a m´edia ponderada de uma vari´avel aleat´oria.

Outro experimento interessante que pode ser feito com aux´ılio computacional
do R, ´e a an´alise de frequ^encia num´erica das tentativas necess´arias para a sa´ıda.
Com a simula¸c˜ao gerada pelo comando rgeom(n,p), usaremos a fun¸c˜ao table que
fornecer´a o acumulado de cada n´umero do vetor 𝑥, figura , e com essa informa¸c˜ao
montamos o gr´afico desses valores na figura 3.4.

Figura 3.4: Fun¸c˜ao table.

Figura 3.5: Gr´afico dos valores acumulador por n´umero de tentativas at´e a fuga.

40

3.2 Plano de Aula

S´ERIE: Ensino M´edio.

CONTE ´UDO: Probabilidade, Matrizes e Cadeias de Markov.

MATERIAIS: Mapa da caverna.

OBJETIVOS: Atrav´es de um jogo de tabuleiro, perceber a no¸c˜ao de tempo
esperado e c´alculo de probabilidades atrav´es de matrizes de transi¸c˜ao.

TEMPO ESTIMADO: 2 a 5 aulas.

Aula 1: Apresenta¸c˜ao do problema

O professor deve apresentar nessa primeira aula o problema da Fuga da Caverna:

Considere uma caverna, como o desenho na figura X, com 3 passagens,
das quais duas est˜ao conectadas e voltam ao mesmo local em um
tempo de 2 horas, e uma terceira que leva at´e a sa´ıda em 3 horas.
Considerando que ao voltar a caverna n˜ao ´e poss´ıvel distinguir as tr^es
passagens e a escolha de cada passagem tem mesma probabilidade,
qual o tempo esperado para a fuga dessa caverna?

A crit´erio do professor pode ser explorado a fundo o problema como proposto
nesse cap´ıtulo. Uma proposta interessante nessa etapa, ´e o c´alculo da m´edia de
tentativas da turma para encontrar a sa´ıda da caverna. Isso pode ser feito com o
uso de um dado de seis faces, cada aluno pode estipular dois n´umeros para cada
passagem da caverna, e jogar´a o dado at´e que consiga realizar a fuga, anotando
o n´umero de tentativas.

Como visto na figura, temos uma probabilidade de 1

3, de acessar cada uma
das passagens da caverna, ap´os algumas tentativas o professor dever´a auxiliar os
alunos no c´alculo da m´edia de tentativas necess´arias. Essa m´edia se aproximou
da esperan¸ca?

41

Aula 2: Estado de uma Cadeia de Markov e um novo de-

safio

Nesse segundo momento, o professor deve apresentar aos alunos um novo mapa
de cavernas:

Figura 3.6: Mapa das cavernas.

O mapa foi planejado de forma que j´a indique qual caminho se deve percorrer
ao tirar determinado n´umero no dado. Iniciando ent˜ao na caverna A, os alunos
em grupos ou individualmente, far˜ao jogadas sucessivas de um dado, e seguindo
o caminho pr´oprio de cada n´umero, at´e atingir a caverna S, onde se localiza a
sa´ıda. Fica a crit´erio do professor alterar essas regras, sendo poss´ıvel alterar as
probabilidades de cada caminho.

Para viabilizar uma an´alise desse mapa como uma Cadeia de Markov, o pro-
fessor pode definir a no¸c˜ao de estado de uma Cadeia de Makov, como cada uma
das 5 cavernas, ou seja, vamos dizer que cada uma dessas cavernas representam

42

um estado, portanto a cada nova jogada de um dado, haver´a uma probabilidade
de se mover pelos t´uneis em dire¸c˜ao a uma nova caverna, ou at´e mesmo em alguns
casos permanecer na que o aluno j´a se encontra.

Inicialmente, os alunos jogando em grupos, devem tentar fugir da caverna,

registrando o caminho percorrido at´e a sa´ıda.

Aulas 3,4 e 5: Modelagem do problema e c´alculos matrici-

ais

Para calcularmos as probabilidades de fuga a cada lance, vamos interpretar como
proposto anteriormente cada caverna como estado de uma Cadeia de Markov, ou
seja, interpretaremos as probabilidades de que, estando em uma caverna, qual a
chance de atingirmos outra. Os alunos, considerando as indica¸c˜oes do mapa da
caverna, devem calcular e preencher uma tabela, onde est˜ao ser˜ao indicadas as
probabilidades 𝑃𝑖,𝑗, de estando em uma caverna 𝑖, qual a probabilidade de chegar
a uma caverna 𝑗, como o modelo:

Tabela 3.2: Tabela de Probabilidades
S

D

C

B

Cavernas A
A
B
C
D
S

𝑃𝐴,𝐴 𝑃𝐴,𝐵 𝑃𝐴,𝐶 𝑃𝐴,𝐷 𝑃𝐴,𝑆
𝑃𝐵,𝐴 𝑃𝐵,𝐵 𝑃𝐵,𝐶 𝑃𝐵,𝐷 𝑃𝐵,𝑆
𝑃𝐶,𝐴 𝑃𝐶,𝐵 𝑃𝐶,𝐶 𝑃𝐶,𝐷 𝑃𝐶,𝑆
𝑃𝐷,𝐴 𝑃𝐷,𝐵 𝑃𝐷,𝐶 𝑃𝐷,𝐷 𝑃𝐷,𝑆
𝑃𝑆,𝑆
𝑃𝑆,𝐶
𝑃𝑆,𝐴 𝑃𝑆,𝐵

𝑃𝑆,𝐷

A tabela com as probabilidades ser´a

Tabela 3.3: Tabela de Probabilidades de, dada uma caverna, qual a probabilidade
de chegarmos a outra

Cavernas A B C D S
0
A
B
0
1
C
2
1
D
6
1
S

1
2
1
6
1
3
1
3
0

1
2
1
3
1
6
1
6
0

0
1
3
0
1
6
0

0
1
6
0
1
6
0

43

Ao construir a tabela, podemos perceber as caracter´ısticas de uma matriz de
transi¸c˜ao, a soma das probabilidades de cada linha sempre somam 1, e al´em disso
nota-se tamb´em a presen¸ca de um estado absorvente a sa´ıda, pois uma vez que
se chega a sa´ıda, o estado n˜ao ir´a se alterar. ´E poss´ıvel calcular com esses valores
a probabilidade de chegarmos a algum estado depois de um n´umero de rodadas,
iremos calcular os primeiros passos, e comparar com as m´edias de tentativas que
a sala em conjunto obteve.

Denotaremos de 𝑃 a matriz com as probabilidades de mudan¸ca de estado

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

𝑃 =

1
3

2 0 1

0 1
2 0
1
1
1
6 0
6
3
0 1
1
2
1
1
1
1
6
6
6
6
0 0 0 0 1

6 0 1

3
1
3

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

Com a matriz de transi¸c˜ao, o aluno poder´a estimar as probabilidades para
cada rodada, novamente uma compara¸c˜ao entre os valores obtidos com o uso das
tabelas, e a forma te´orica, deve ser explorado.

Uma boa tarefa para se prop^or na conclus˜ao dessa aula, ´e a manipula¸c˜ao
das probabilidades de cada uma das passagens, de forma que o aluno crie seus
pr´oprios mapas e tente montar a matriz de transi¸c˜ao com as probabilidades,
desafiando os colegas em novas partidas.

44

Cap´ıtulo 4

Um pouco sobre o Andar do
B^ebado

Esse cap´ıtulo ´e baseado em [2].
Um exemplo muito pr´oximo da Ru´ına do Jogador, o Andar do b^ebado pode

ser descrito como:

Um homem anda entre quatro quarteir˜oes ao longo de uma avenida, contare-

mos cada esquina como na figura 4.1:

Figura 4.1: Andar do b^ebado. [2] p. 417.

Caso ele se encontre nos pontos 1, 2 ou 3, ele escolher´a caminhar ou pra
esquerda, ou para a direita com probabilidades iguais, ele repetir´a o processo at´e
que esteja em casa, no ponto 0, ou no bar, ponto 4.

Temos assim um Cadeia de Markov, com 4 estados, sendo que os estados 0 e

4 s˜ao absorventes.

Podemos encontrar a matriz 𝑃 de transi¸c˜ao, adicionando as probabilidade de
mudan¸ca entre os estados. Essa matriz nos d´a a mesma ideia da matriz citada no

cap´ıtulo 2, sobre a Ru´ına do Jogador, o que ´e natural, pois ambos os problemas
se equivalem

45

𝑃 =

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

1
0.5
0
0
0

0
0
0.5
0
0

0
0.5
0
0.5
0

0
0
0.5
0
0

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

0
0
0
0.5
1

Snell, faz alguns questionamentos interessantes sobre esse problema em [2]:
Qual a probabilidade de que esse processo chegue eventualmente a um estado
absorvente? Qual o n´umero de vezes em m´edia cada estado ser´a visitado at´e ser
absorvido?

As respostas fornecidas por ele, podem ser tamb´em consideradas para o pro-
blema da Ru´ına, como observado, os processos possui exatamente a mesma matriz
de transi¸c˜ao, por´em nomeamos os estados absorventes da Ru´ına, como vit´oria e
derrota.

4.1 Forma Can^onica

Para colocar a matriz de transi¸c˜ao em sua forma can^onica ´e necess´ario alterar a
ordem dos estados, colocando os estados transientes primeiro, e os absorventes
depois, isso significa que na matriz do andar do b^ebado desceremos a primeira
linha at´e a pen´ultima, e a mesma a¸c˜ao ser´a feita com as colunas

𝑃 =

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

0
0.5
0
0
0

0.5
0
0.5
0
0

0
0.5
0
0
0

0.5
0
0
1
0

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

0
0
0.5
0
1

Desse modo, a forma can^onica da matriz ´e composta por 4 outras matrizes,
os n´umero em vermelho representam uma matriz identidade 𝐼, de verde teremos
uma matriz quadrada 𝑄, al´em de uma matriz nula no canto inferior esquerdo, e

46

uma matriz n˜ao nula 𝑅 no canto superior direito

𝑃 =

(︃

)︃

.

Q R
I
0

Nesse contexto, Snell apresenta que ao calcular 𝑃 𝑛, teremos como resultado

uma nova matriz igual a

𝑃 𝑛 =

(︃

)︃

.

𝑄𝑛 *
𝐼
0

Sendo que o asterisco * ´e uma matriz desnecess´aria para esse momento. A
matriz 𝑄𝑛 representa as probabilidade de chegarmos a um dos estados transientes
ap´os 𝑛 passos.

Com isso, vamos responder a primeira pergunta: Qual a probabilidade de que

esse processo chegue eventualmente a um estado absorvente?

A resposta ´e 1, dada uma Cadeia de Markov absorvente, a probabilidade de
que o processo atinja um estado absorvente ´e 1, ou seja, 𝑄𝑛 → 0 quando 𝑛 → ∞.

Estando em qualquer um dos estados n˜ao absorventes, ´e poss´ıvel atingir um es-
tado absorvente. Vamos considerar que 𝑘𝑖 ´e o menor n´umero de passos necess´arios
para chegar a um estado absorvente, e 𝑝𝑗 a probabilidade de que, come¸cando
nesse estado, o processo n˜ao chegar´a a um estado absorvente em 𝑘𝑖 passos, logo
𝑝𝑗 < 1, pois sabemos que ´e poss´ıvel chegar a esse estado, ent˜ao a probabilidade
de n˜ao chegar tem que ser menor que 1. Agora tome 𝑘 como o maior dentre os 𝑘𝑖
poss´ıveis, e 𝑝 o maior entre os 𝑝𝑖, assim a probabilidade de n˜ao ser absorvido em
𝑘 passos ´e menor ou igual a 𝑝, de forma que, n˜ao ser absorvido em 2𝑚 passos,
tem probabilidade menor ou igual a 𝑝 · 𝑝 = 𝑝2 (pois 𝑝 ´e a probabilidade de um
evento independente). Naturalmente, como 𝑝 < 1 ent˜ao a probabilidade de n˜ao
chegar a um estado absorvente tende a 0, logo 𝑄𝑛 → 0 quando 𝑛 → ∞.

4.2 A Matriz Fundamental

Uma matriz 𝑁 , como descreve Snell [2], ser´a dita fundamental para a matriz de
transi¸c˜ao 𝑃 de uma cadeia de markov absorvente quando 𝑁 = (𝐼 − 𝑄)−1.

47

Vamos provar inicialmente que para uma Cadeia de Markov absorvente, a
matriz 𝐼 − 𝑄 tem uma inversa que denotaremos por 𝑁 , e 𝑁 = 𝐼 + 𝑄 + 𝑄2 + · · · .
Sendo que as entradas de 𝑁 ser˜ao o n´umero esperado de vezes que a cadeia passa
por aquele estado.

Para mostrar isso, seja (𝐼 − 𝑄)𝑥 = 0, logo 𝑥 = 𝑄𝑥. Iterando essa igualdade,
podemos escrever que 𝑥 = 𝑄𝑛𝑥, mas j´a mostramos que 𝑄𝑛 → 0, de forma que
𝑄𝑛𝑥 → 0, e portanto 𝑥 = 0, ou seja (𝐼 − 𝑄)−1 = 𝑁 existe. Efetuaremos uma
soma telesc´opica, como j´a descrito na primeira demonstra¸c˜ao do cap´ıtulo 2,

(𝐼 − 𝑄)(𝐼 + 𝑄 + 𝑄2 + · · · + 𝑄𝑛) = 𝐼 − 𝑄𝑛+1.

Multiplicando por 𝑁 dos dois lados teremos

𝑁 (𝐼 − 𝑄)(𝐼 + 𝑄 + 𝑄2 + · · · + 𝑄𝑛) = 𝑁 (𝐼 − 𝑄𝑛+1).

Mas como 𝑁 = (𝐼 − 𝑄)−1, ent˜ao

(𝐼 − 𝑄)−1(𝐼 − 𝑄)(𝐼 + 𝑄 + 𝑄2 + · · · + 𝑄𝑛) = 𝐼 + 𝑄 + 𝑄2 + · · · + 𝑄𝑛 = 𝑁 (𝐼 − 𝑄𝑛+1).

Nesse ponto, faremos com que 𝑛 → ∞, teremos ent˜ao

𝑁 (𝐼 − (cid:8)(cid:8)(cid:8)

(cid:26)𝑄𝑛
𝑄𝑛+1) = 𝐼 + 𝑄 + 𝑄2 + · · · + (cid:26)

𝑁 = 𝐼 + 𝑄 + 𝑄2 + · · ·

Vamos definir agora uma vari´avel aleat´oria 𝑋 (𝑘)(se¸c˜ao 1.3), que ser´a igual a 1
caso uma cadeia esteja em um estado 𝑠𝑗 ap´os k passos, e 0 caso contr´ario. Dessa
forma, temos que

e

𝑃 (𝑋 (𝑘) = 1) = 𝑞(𝑘)
𝑖𝑗

𝑃 (𝑋 (𝑘) = 0) = 1 − 𝑞(𝑘)
𝑖𝑗 .

48

𝑞(𝑘)
𝑖𝑗 ´e uma das entradas de 𝑄𝑘. A esperan¸ca dessa vari´avel aleat´oria ser´a E(𝑋 (𝑘)) =
𝑖𝑗 , sabemos disso porque a entrada 𝑞(𝑛)
𝑞(𝑘)
𝑖𝑗 de 𝑄𝑛 representa exatamente a proba-
bilidade de se estar em um estado 𝑠𝑖 tendo iniciado em um estado 𝑠𝑗. Como essa
vari´avel aleat´oria tem por resultados apenas 1 e 0, ent˜ao o c´alculo da esperan¸ca
ser´a E(𝑋 (𝑘)) = 1 · 𝑞(𝑘)
𝑖𝑗 .

O n´umero esperado de vezes que a cadeia se encontra em um estado 𝑠𝑗 nos
primeiros 𝑛 passos, dado que come¸cou em 𝑠𝑖 ser´a dada pela soma das esperan¸cas
de 𝑋 𝑘 para cada 𝑘 de 1 a 𝑛

E(𝑋 (0))+E(𝑋 (1))+· · · E(𝑋 (𝑛)) = E(𝑋 (0)+𝑋 (1)+· · ·+𝑋 (𝑛)) = 𝑞(0)

𝑖𝑗 +𝑞(1)

𝑖𝑗 +· · ·+𝑞(𝑛)
𝑖𝑗 .

fazendo 𝑛 → ∞, temos

E(𝑋 (0) + 𝑋 (1) + · · · ) = 𝑞(0)

𝑖𝑗 + 𝑞(1)

𝑖𝑗 + · · ·

Mas definimos 𝑁 e provamos que 𝑁 = 𝐼 + 𝑄 + 𝑄2 + · · · , dessa forma temos
𝑖𝑗 + 𝑞(1)
que as entradas 𝑛𝑖𝑗 de 𝑁 s˜ao iguais a 𝑞(0)
𝑖𝑗 + · · · , provando que 𝑁 ´e a matriz
tal que suas entradas 𝑛𝑖𝑗 s˜ao iguais ao n´umero esperado de vezes que a cadeia
passa por um estado 𝑠𝑗, tendo come¸cado em 𝑠𝑖.

Finalmente retomando a matriz de transi¸c˜ao j´a alterada para a forma can^onica

que representa o processo do Andar do B^ebado

𝑃 =

⎛

⎜
⎜
⎜
⎜
⎜
⎜
⎝

0
0.5
0
0
0

0.5
0
0.5
0
0

0
0.5
0
0
0

0.5
0
0
1
0

⎞

⎟
⎟
⎟
⎟
⎟
⎟
⎠

.

0
0
0.5
0
1

A cor verde representa as entradas da matriz 𝑄

𝑄 =

⎛

⎜
⎝

0
0.5
0

0.5
0
0.5

0
0.5
0

⎞

⎟
⎠ ,

de forma que

49

𝐼 − 𝑄 = 𝑥 =

⎛

⎜
⎝

1
−0.5
0

−0.5
1
−0.5

0
−0.5
1

⎞

⎟
⎠ .

Usando o software R, podemos calcular a inversa dessa matriz x, com o co-

mando solve(x)

Figura 4.2: Comando solve(x) para calcular a inversa de x.

logo a inversa ser´a

𝑁 = (𝐼 − 𝑄)−1 = 𝑥−1 =

⎛

⎜
⎝

1.5 1 0.5
1
2
1
0.5 1 1.5

⎞

⎟
⎠ .

Interpretamos essa matriz 𝑁 , observando suas linhas, por exemplo, se inici-
armos a caminhada pelo estado 1, ou seja a primeira linha dessa matriz 𝑁 , o
n´umero esperado de vezes que passaremos pelos estados 1, 2 e 3 antes de ser
absorvido ser´a respectivamente 1, 5, 1, 0, 5. Por outro lado ao inciarmos pelo
estado 2, o equivalente a linha do meio da matriz 𝑁 , o n´umero esperado de vezes
que passaremos pelos estados 1, 2 e 3 ser´a respectivamente 1, 2 e 1.

50

Cap´ıtulo 5

Considera¸c˜oes Finais

A matem´atica, assim como todas as ci^encias, avan¸ca constantemente. Sempre
h´a publica¸c˜oes de novos artigos e estudos, que permitem uma maior compreens˜ao
da nossa realidade. A escola precisa acompanhar parte desse desenvolvimento,
visando educar um aluno para o seu futuro, onde ele deve ter independ^encia e
capacidade para contribuir com as pesquisas futuras.

Nesse aspecto, esse trabalho trata de dois problemas, com uma premissa ini-
cial relativamente simples, e procura abrir as possibilidades de an´alise, procu-
rando um avan¸co em duas vias pedag´ogicas de grande impacto, o l´udico e a
constru¸c˜ao pr´atica de um novo conhecimento, fortemente baseado na explora¸c˜ao
e independ^encia do aluno. O professor nesse caso, faz o papel de orientador,
aquele que guia o aluno na descoberta de um novo mundo de possibilidades, mas
deixando esse aluno como protagonista de suas descobertas.

No ensino b´asico nos deparamos com uma escola engessada, onde o professor,
detentor de todo o conhecimento, deve apenas transferir parte desse conhecimento
aos alunos, enquanto os mesmos fazem um papel passivo dentro da rela¸c˜ao de
ensino aprendizagem. Tanto a Ru´ına do Jogador, quando a Fuga da Caverna,
proporcionam uma rela¸c˜ao competitiva e de coopera¸c˜ao na busca e an´alise de
resultados favor´aveis, onde alunos e professores podem se dispor a aprender um
com o outro, com um objetivo comum.

Em suma, os problemas propostos visam contribuir para uma aproxima¸c˜ao
de professores e alunos, de modo a perceber e fortalecer alguns conceitos ma-

tem´aticos, que muitas vezes s˜ao deixados sem uma boa fundamenta¸c˜ao no ensino,
como ´e o caso das matrizes. Como descrito nos problemas propostos, a pr´atica
investigativa pode instigar os alunos, al´em de motiv´a-los, de forma que busquem
as respostas de suas d´uvidas atrav´es de sua pr´opria pesquisa.

51

52

Refer^encias Bibliogr´aficas

[1] CASTRO, D. M. S. CADEIAS DE MARKOV: Uma Aplica¸c˜ao para
o Ensino de Matrizes e Probabilidades. Maio de 2015. 58 f. Mestrado
PROFMAT. Universidade Federal de Alagoas, Macei´o, 2015. Dispon´ıvel em:

https://sca.profmat-sbm.org.br/tcc_get.php?cpf=04921741484&d=
20161118234903&h=9b37aa56ab999a3da976f1244a4310a962c14b2a Acesso
em: 18 de novembro 2016

[2] GRINSTEAD, M. C.; SNELL, J. L. Introduction to Probability:Second
Revised Edition. 2ª Edi¸c˜ao. American Mathematical Society, 1997. Dispon´ıvel
em: https://math.dartmouth.edu/~prob/prob/prob.pdf Acesso em: 18
de novembro 2016

[3] MOREIRA JUNIOR, F. J.; BORTOLOTTI, S. L. V. ; COELHO, A. S. .
Considera¸c˜oes sobre a Ru´ına do Jogador. In: 19° SINAPE - Simp´osio
Nacional de Probabilidade e Estat´ıstica, 2010, S˜ao Pedro, SP. Resumos. S˜ao
Paulo: ABE - Associa¸c˜ao Brasileira de Estat´ıstica, 2010. Dispon´ıvel em:
http://www.ime.unicamp.br/sinape/sites/default/files/Artigo SINAPE Ru´ına
do Jogador.pdf Acesso em: 18 de novembro 2016

[4] MORGADO, A. C.; CARVALHO, P.C.P. Matem´atica Discreta. 1ª Edi¸c˜ao.

Rio de Janeiro: Sociedade Brasileira de Matem´atica, 2014.

[5] ROSS, S. Introduction to Probability Models. 9ª Edi¸c˜ao. Berkley: Else-

vier, 2007.

[6] ROSS, S. Probabilidade: Um curso moderno com aplica¸c˜oes. 8ª ed.

Porto Alegre: Artmed Editora, 2010

[7] SILVA, T. C. M.; JUNIOR, VALDIVINO V. . Cadeias de Markov: Con-
ceitos e Aplica¸c˜oes em Modelos de Difus˜ao de Informa¸c˜ao. In: 63ª
Reuni˜ao Anual da SBPC, 2011, Goi^ania. XIX Semin´ario de Inicia¸c˜ao Ci-
ent´ıfica da UFG - PIVIC, 2011.

53

