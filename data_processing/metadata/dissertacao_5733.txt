Universidade Federal do ABC
Centro de Matem´atica, Computac¸˜ao e Cognic¸˜ao

Aritm´etica Modular e Criptograﬁa

Jeovah Pereira de Alencar
Orientador: Prof. Dr. Antonio Cˆandido Faleiros

Disserta¸c˜ao apresentada junto ao Programa de
Mestrado Proﬁssionalizante em Matem´atica da
Universidade Federal do ABC, para obten¸c˜ao do
T´ıtulo de Mestre em Matem´atica.

Santo Andr´e - SP
Agosto de 2013.

Aritm´etica Modular e Criptograﬁa

Este exemplar corresponde `a reda¸c˜ao
ﬁnal da disserta¸c˜ao devidamente cor-
rigida e defendida por Jeovah Pereira
de Alencar e aprovada pela comiss˜ao
julgadora.

Santo Andr´e, 22 de agosto de 2013.

Prof. Dr. Antonio Cˆandido Faleiros
Orientador

Banca examinadora:

1. Prof. Dr. Antonio Cˆandido Faleiros - UFABC (Presidente)

2. Prof. Dr. Adail de Castro Cavalheiro - UnB (Membro Titular)

3. Prof. Dr. Daniel Miranda Machado - UFABC (Membro Titular)

Disserta¸c˜ao apresentada junto ao Programa
de Mestrado Proﬁssional em Matem´atica da
UFABC, como requisito parcial para ob-
ten¸c˜ao do T´ıtulo de Mestre em Matem´atica.

Este exemplar foi revisado e alterado em rela¸c˜ao `a vers˜ao ori-
ginal, de acordo com as observa¸c˜oes levantadas pela banca no dia
da defesa, sob responsabilidade ´unica do autor e com a anuˆencia de
seu orientador.

Santo Andr´e, 27 de agosto de 2013.

Assinatura do autor:

Assinatura do orientador:

Dedico este trabalho `a minha m˜ae, que est´a sempre no meu cora¸c˜ao e no
meu pensamento, e `a minha fam´ılia, em especial ao meu ﬁlho Pedro.

Agradecimentos

Agrade¸co primeiramente a Deus por me conduzir at´e aqui, ao Pro-
grama de Mestrado Proﬁssional em Matem´atica (PROFMAT), `a CAPES
pelo aux´ılio concedido, `a UFABC e seus professores, ao meu orientador Prof.
Dr. Antonio Cˆandido Faleiros e aos colegas de turma do mestrado. A todos
minha sincera gratid˜ao.

8

Resumo

Acreditando que a aritm´etica modular possa ser introduzida no ensino m´edio
e usando como centro de interesse a criptograﬁa, discorremos sobre as cifras
de C´esar, Vigen`ere e de Hill, mostrando a aritm´etica modular por detr´as de
cada uma delas, at´e chegarmos `a moderna criptograﬁa de chave p´ublica RSA
utilizada na Internet. O texto ´e uma introdu¸c˜ao `a aritm´etica modular, mos-
trando algumas de suas aplica¸c˜oes, como por exemplo, criptograﬁa, c´alculo
de d´ıgitos de veriﬁca¸c˜ao e regras de divisibilidade.

Palavras-Chave

Aritm´etica Modular, Criptograﬁa, Criptograﬁa RSA

9

Abstract

We believe modular arithmetic can be introduced to high school students
and cryptography plays an important motivational role. We discourse about
the ciphers of Caesar, Vigenere and Hill, and the modular arithmetic behind
each one, until we reach the modern RSA public key encryption used on the
Internet. The text is an introduction to modular arithmetic, with some of
its applications, for example, cryptography, calculation of check digits and
divisibility rules.

Keywords

Modular Arithmetic, Cryptography, RSA public key encryption

10

Sum´ario

1 Aritm´etica Modular para o Ensino M´edio

1.1
1.2 Propriedades e Opera¸c˜oes

13
Introdu¸c˜ao . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
. . . . . . . . . . . . . . . . . . . . 19
1.2.1 Propriedades da Congruˆencia M´odulo m . . . . . . . . 19
1.2.2 Adi¸c˜ao e Multiplica¸c˜ao Modular . . . . . . . . . . . . . 20
1.2.3
Inversos M´odulo m . . . . . . . . . . . . . . . . . . . . 22
1.2.4 Equa¸c˜oes M´odulo m . . . . . . . . . . . . . . . . . . . 24
1.2.5 Potencia¸c˜ao . . . . . . . . . . . . . . . . . . . . . . . . 25
1.3 C´alculo de potˆencias xy mod m com aux´ılio da base 2 . . . . . 26

2 Criptograﬁa e Aritm´etica Modular

31
2.1 Criptograﬁa . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
. . . . . . . . . . . . . . . . . . . . . 32
2.1.1 A Cifra de C´esar
2.1.2 A Matem´atica da Cifra de C´esar
. . . . . . . . . . . . 33
2.1.3 A Cifra de Vigen`ere . . . . . . . . . . . . . . . . . . . . 35
2.1.4 A Matem´atica da Cifra de Vigen`ere . . . . . . . . . . . 38
. . . . . . . . . . . . . . . . . . . . . . 42
2.1.5 Cifr´ario de Hill
2.2 Criptograﬁa de Chave P´ublica . . . . . . . . . . . . . . . . . . 47
Introdu¸c˜ao . . . . . . . . . . . . . . . . . . . . . . . . . 47
2.2.1
2.2.2 O M´etodo de Diﬃe-Hellman . . . . . . . . . . . . . . . 49

3 Criptograﬁa RSA

53
Introdu¸c˜ao . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
3.1
3.2 A matem´atica do RSA . . . . . . . . . . . . . . . . . . . . . . 54
3.3 Uma Fun¸c˜ao e dois Teoremas Importantes
. . . . . . . . . . . 56
3.4 Como Funciona a Criptograﬁa RSA . . . . . . . . . . . . . . . 60
. . . . . . . . . . . . 61
3.5 Exempliﬁcando o uso da RSA . . . . . . . . . . . . . . . . . . 63

3.4.1 Algoritmo Estendido de Euclides

11

12

SUM ´ARIO

4 Aplica¸c˜oes da Aritm´etica Modular

71
4.1 C´alculo do d´ıgito do CPF e do CNPJ . . . . . . . . . . . . . . 71
4.2 C´alculo do d´ıgito do RG . . . . . . . . . . . . . . . . . . . . . 73
4.3 C´alculo do d´ıgito ISBN-13 . . . . . . . . . . . . . . . . . . . . 74
4.4 Crit´erios de Divisibilidade . . . . . . . . . . . . . . . . . . . . 75
4.4.1 Divisibilidade por 3 . . . . . . . . . . . . . . . . . . . . 75
4.4.2 Divisibilidade por 4 . . . . . . . . . . . . . . . . . . . . 76
4.4.3 Divisibilidade por 5 . . . . . . . . . . . . . . . . . . . . 77
4.4.4 Divisibilidade por 6 . . . . . . . . . . . . . . . . . . . . 78
4.4.5 Divisibilidade por 11 . . . . . . . . . . . . . . . . . . . 78
4.4.6 Divisibilidade por 7, 11 e 13 . . . . . . . . . . . . . . . 79
4.4.7 Outros crit´erios de Divisibilidade . . . . . . . . . . . . 80
4.5 Considera¸c˜oes Finais . . . . . . . . . . . . . . . . . . . . . . . 81

Cap´ıtulo 1

Aritm´etica Modular para o
Ensino M´edio

1.1

Introdu¸c˜ao

O matem´atico su´ı¸co Leonhard Euler (1707-1783) foi quem introdu-
ziu, por volta de 1750, a aritm´etica modular (tamb´em chamada aritm´etica
do rel´ogio). Em 1801, Carl Friedrich Gauss, matem´atico alem˜ao, utilizou
e desenvolveu a aritm´etica modular em seu livro “Disquisitiones Arithmeti-
cae”. Durante muito tempo n˜ao houve aplica¸c˜oes importantes da aritm´etica
modular at´e que na segunda metade do s´eculo XX uma aplica¸c˜ao surpre-
endente dessa id´eia veio resolver um problema que desaﬁava matem´aticos e
cript´ografos, o problema da troca de chaves criptogr´aﬁcas.

Vamos utilizar uma ideia simples para ilustrar o conceito b´asico da
aritm´etica modular. Imagine um rel´ogio comum de ponteiros registrando 3
horas. Se quisermos saber que hora ele estar´a marcando ap´os se passarem
38 horas, veriﬁcamos que o resultado ´e 5 horas e n˜ao 41. A cada 12 horas
o ponteiro volta ao ponto de partida, portanto ap´os 36 horas (3 voltas com-
pletas) o ponteiro estar´a novamente sobre as 3 horas, adicionando mais 2
horas chegamos ao resultado. A ideia permanece v´alida para um rel´ogio com
um n´umero qualquer de subdivis˜oes. Um rel´ogio com 7 subdivis˜oes apenas,
numeradas sequencialmente no sentido hor´ario, por exemplo. Se o ponteiro
est´a sobre o n´umero 5 e o fazemos saltar 43 subdivis˜oes, a adi¸c˜ao comum
resultaria 48, mas n˜ao temos esse resultado no mostrador do rel´ogio. Agora,
o ponteiro volta ao 5 a cada 7 saltos, ou seja, ap´os 42 voltas completas, que
´e o m´ultiplo de 7 mais pr´oximo de 43, o ponteiro estar´a novamente sobre o
5, adicionando 1 chegamos ao resultado: 6.

13

14 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

A aritm´etica modular normalmente ´e tratada no ensino superior.
Entretanto, devido `a facilidade de compreens˜ao do conceito, suas bases po-
dem ser introduzidas j´a no ensino m´edio. Evidentemente, com uma lin-
guagem matem´atica apropriada para esta etapa do ensino e sem que sejam
feitas todas as demonstra¸c˜oes dos teoremas e proposi¸c˜oes. Aqueles cujas de-
monstra¸c˜oes n˜ao sejam essenciais `a compreens˜ao do conte´udo seriam apenas
enunciados e utilizados quando necess´ario. A aritm´etica modular est´a pre-
sente em m´etodos criptogr´aﬁcos como a cifra de C´esar, a cifra de Vigen`ere e
mais recentemente na criptograﬁa de chave p´ublica RSA, da qual ´e a base.
O assunto est´a relacionado `a seguran¸ca digital e ao cotidiano de quem utiliza
a internet, em especial os jovens, para se comunicar, se relacionar nas redes
sociais, fazer compras e transa¸c˜oes banc´arias. Isto apenas j´a constitui uma
excelente motiva¸c˜ao para o seu estudo.

As transa¸c˜oes comercias pela internet bem como a correspondˆencia
dos usu´arios da rede s˜ao protegidas por criptograﬁa baseada na aritm´etica
modular. Al´em desta importante aplica¸c˜ao h´a outras, como veremos mais
adiante. A ideia b´asica da aritm´etica modular ´e bem simples. Fixado um
inteiro m, todos os demais n´umeros inteiros a s˜ao substitu´ıdos pelo resto
de sua divis˜ao euclidiana por m e representados por a mod m = b, b ∈
{0, 1, . . . , m − 1}. Desse modo, o conjunto Z dos n´umeros inteiros se trans-
forma no conjunto Zm = {0, 1, . . . , m − 1}, denominado conjunto dos inteiros
m´odulo m (cujos elementos s˜ao os restos poss´ıveis da divis˜ao de um inteiro
a qualquer por m).

Assim como no conjunto dos n´umeros racionais temos as fra¸c˜oes equi-
valentes, dizemos que dois inteiros que d˜ao o mesmo resto quando divididos
por m s˜ao congruentes (equivalentes) m´odulo m. Por exemplo,

11 mod 7 = 4, assim como 25 mod 7 = 4

Portanto, 11 e 25 s˜ao congruentes m´odulo 7 e representamos 11 ≡ 25
mod 7. A congruˆencia m´odulo m tamb´em pode ser veriﬁcada se ﬁzermos a
diferen¸ca entre os dois inteiros e o resultado for um m´ultiplo de m. No caso
do exemplo, 25 − 11 = 14 = 2 · 7, o que tamb´em mostra que 11 e 25 s˜ao con-
gruentes m´odulo 7. A congruˆencia m´odulo m ´e uma rela¸c˜ao de equivalˆencia
que subdivide o conjunto Z em m classes de equivalˆencia, cada uma corres-
pondendo a um resto da divis˜ao euclidiana por m.

Proposi¸c˜ao 1. Dois inteiros p e q s˜ao congruentes m´odulo m, m ∈ Z,
m > 1 se, e somente se, p − q for divis´ıvel por m e representamos

p ≡ q mod m.

1.1.

INTRODUC¸ ˜AO

15

Demonstra¸c˜ao. Sejam p = k1m + r1 e q = k2m + r2, ent˜ao r1 = p mod m e
r2 = q mod m.

(=⇒)

Se p e q s˜ao congruentes m´odulo m, ent˜ao

p ≡ q mod m =⇒ p mod m = q mod m =⇒ r1 = r2 =⇒

p−q = k1m+r1 −k2m−r2 = (k1 −k2)m+(r1 −r2) =⇒ p−q = (k1 −k2)m =⇒

m|p − q.

(⇐=)

Se p − q ´e m´ultiplo de m, ent˜ao

p − q = km =⇒ p = km + q =⇒ p mod m = (km + q) mod m =⇒

p mod m = km mod m + q mod m =⇒ p mod m = q mod m =⇒

p ≡ q mod m.

Exemplo 1. Determinar o valor de x = 139 mod 11.

Solu¸c˜ao Basta efetuar a divis˜ao euclidiana de 139 por 11, cujo resultado
´e quociente 12 e resto 7. Portanto, x = 7.

Exemplo 2. Dentre os inteiros 111, 370, 341, 80 e 203 qual(is) ´e(s˜ao) con-
gruente(s) a 139 m´odulo 11?

Solu¸c˜ao Procuramos x ≡ 139 mod 11, x ∈ {111, 370, 341, 80, 203}.
Pela proposi¸c˜ao 1 acima, x ´e tal que 11|(x − 139). Veriﬁcamos que somente
x = 370 ´e solu¸c˜ao.

370 − 139 = 231 = 21 · 11

16 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

Exemplo 3. Hoje ´e quarta- feira, 27 de fevereiro. Pedro tem 9 anos e far´a
anivers´ario no dia 21 de junho. Em que dia da semana Pedro completar´a 10
anos?

Solu¸c˜ao
Se n˜ao temos um calend´ario `a m˜ao, mesmo assim podemos de-
terminar o dia da semana em que Pedro far´a anivers´ario. Primeiro contamos
os dias at´e 21 de junho: 1 + 31 + 30 + 31 + 21 = 114 dias. Como iniciamos
a contagem a partir de uma quarta-feira, associamos 0 mod 7 a esse dia da
semana. Veja abaixo como ﬁca:

quarta-feira
−→ 0 mod 7 = 0
quinta-feira
−→ 1 mod 7 = 1
sexta-feira
−→ 2 mod 7 = 2
s´abado
−→ 3 mod 7 = 3
−→ 4 mod 7 = 4
domingo
segunda-feira −→ 5 mod 7 = 5
−→ 6 mod 7 = 6
ter¸ca-feira

Agora adicionamos 114 mod 7 ao dia de hoje (0 mod 7),

0 mod 7 + 114 mod 7 = 0 + 2 = 2 = 2 mod 7

Isto signiﬁca que o 114o dia a partir de hoje, dia do anivers´ario do

Pedro, cair´a numa sexta-feira (2 mod 7 na tabela).

Exemplo 4. Determine o primeiro termo (a1) de uma P.A. de raz˜ao 7, sa-
bendo que 0 < a1 < r e um dos termos dessa P.A. ´e 21888. Qual a ordem do
termo dado?

Solu¸c˜ao O termo geral de uma P.A. ´e an = a1 + (n − 1)r, onde a1 ´e o
primeiro termo e r ´e a raz˜ao.

Observe que

an mod r = [a1 + (n − 1)r] mod r = a1 mod r + [(n − 1)r] mod r =

a1 mod r =⇒

an mod r = a1 mod r =⇒ an ≡ a1 mod r (∀n, n ∈ N∗)

Como a1 < r =⇒ a1 mod r = a1 =⇒ an mod r = a1 (∀n, n ∈ N∗)

1.1.

INTRODUC¸ ˜AO

17

Logo,

a1 = an mod r =⇒ a1 = 21888 mod 7 =⇒ a1 = 6.

Usando agora a f´ormula do termo geral da P.A. temos,

an = a1 + (n − 1)r =⇒ 6 + (n − 1) · 7 = 21888 =⇒

n = 21888−6

7 + 1 =⇒ n = 3127 =⇒ 21888 = a3127.

Exemplo 5. Determine o 2954o algarismo da d´ızima per´ıodica gerada pela
fra¸c˜ao 11
7 .

Solu¸c˜ao Efetuando a divis˜ao do numerador 11 pelo denominador 7, obte-
mos a d´ızima 1, 571428 cujo per´ıodo possui 6 algarismos. O primeiro alga-
rismo da d´ızima ´e 1 (unidades). Portanto, o que queremos ´e o 2953o algarismo
da parte decimal. Calculando 2953 mod 6 obtemos quociente 492 e resto 1,
o que signiﬁca 492 per´ıodos e um algarismo, que no caso ´e o 5. Logo, o 2954o
algarismo desta d´ızima peri´odica ´e 5.

Exemplo 6. Qual ´e o 1234o termo da sequˆencia peri´odica abaixo?

∪, ⊂, ∩, ⊃, ∨, <, ∧, >, ∪, ⊂, ∩, ⊃, ∨, <, . . .

Solu¸c˜ao A sequˆencia possui oito termos distintos repetindo-se na mesma
ordem, portanto basta calcularmos 1234 mod 8 = 2. Conforme a tabela
abaixo, o resultado corresponde ao segundo termo, ou seja, ⊂.

1o termo: ∪ −→ 1 mod 8 = 1
2o termo: ⊂ −→ 2 mod 8 = 2
3o termo: ∩ −→ 3 mod 8 = 3
4o termo: ⊃ −→ 4 mod 8 = 4
5o termo: ∨ −→ 5 mod 8 = 5
6o termo: < −→ 6 mod 8 = 6
7o termo: ∧ −→ 7 mod 8 = 7
8o termo: > −→ 8 mod 8 = 0

18 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

Exemplo 7. Determine o algarismo das unidades de 273100.

Solu¸c˜ao O algarismo das unidades de qualquer n´umero ´e o resto da di-
vis˜ao desse n´umero por 10. Sendo assim, devemos resolver 273100 mod 10.

273 ≡ 3 mod 10 =⇒ 273100 ≡ 3100 mod 10 = (32)50 mod 10 =

950 mod 10.

Como 9 ≡ −1 mod 10, temos

950 mod 10 = (−1)50 mod 10 = 1.

Portanto o algarismo das unidades de 273100 ´e 1.

Exemplo 8. Calcule o mdc(858, 546).

Solu¸c˜ao O m´etodo mais eﬁciente para calcular o m´aximo divisor comum
de dois inteiros ´e o algoritmo de Euclides, que consiste primeiramente em
dividir o maior pelo menor. Em seguida divide-se o divisor pelo resto e assim
sucessivamente at´e obter resto zero. O mdc ser´a o ´ultimo resto diferente de
zero obtido. Vejamos o processo do ponto de vista da aritm´etica modular.

858 mod 546 = 312
546 mod 312 = 234
312 mod 234 = 78
234 mod 78 = 0

Logo, o mdc(858, 546) = 78.

Observa¸c˜ao: Como desaﬁo, encontre o mdc(12119247318071, 673624408921)
usando o m´etodo descrito acima e a fun¸c˜ao MOD da planilha Excel. (solu¸c˜ao:
151609)

1.2. PROPRIEDADES E OPERAC¸ ˜OES

19

1.2 Propriedades e Opera¸c˜oes

1.2.1 Propriedades da Congruˆencia M´odulo m

O conjunto Zm = {1, 2, . . . , m − 1} dos inteiros m´odulo m, ´e fechado
para as opera¸c˜oes de soma e multiplica¸c˜ao m´odulo m e valem as seguintes
propriedades.

Dados a, b e c inteiros, ent˜ao:

1) a ≡ a mod m;

(reﬂexiva)

2) a ≡ b mod m =⇒ b ≡ a mod m;

(sim´etrica)

3) a ≡ b mod m e

b ≡ c mod m =⇒ a ≡ c mod m;

(transitiva)

4) Se a ≡ b mod m ent˜ao

a ± c ≡ b ± c mod m;

a × c ≡ b × c mod m;

a ≡ b + cm mod m;

5) a + c ≡ b mod m =⇒ c ≡ b − a mod m;

Observa¸c˜ao: As trˆes primeiras propriedades fazem da congruˆencia m´odulo
m uma rela¸c˜ao de equivalˆencia. Cada n´umero inteiro corresponde a um dos
restos da divis˜ao euclidiana por m. Isto reduz o conjunto inﬁnito Z ao con-
junto ﬁnito Zm = {1, 2, . . . , m−1} onde cada elemento representa uma classe
de equivalˆencia.

Al´em disso, quando a e m forem co-primos (mdc(a, m) = 1),

6) ac ≡ b mod m =⇒ c ≡ ba−1 mod m;

7) ac ≡ ab mod m =⇒ c ≡ b mod m.

(lei do cancelamento).

20 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

O conjunto Zp, p primo, munido das opera¸c˜oes de adi¸c˜ao e mul-
tiplica¸c˜ao m´odulo p com as propriedades a seguir constitui uma estrutura
alg´ebrica denominada corpo. Dados a, b, c e k inteiros, temos:

A1) adi¸c˜ao associativa: a + (b + c) mod p = (a + b) + c mod p;

A2) adi¸c˜ao comutativa: a + b mod p = b + a mod p;

A3) neutro aditivo: a + kp mod p = kp + a mod p = a mod p;

A4) inversos aditivos: a+(kp−a) mod p = (kp−a)+a mod p = 0 mod p;

M1) multiplica¸c˜ao associativa: a(bc) mod p = (ab)c mod p;

M2) multiplica¸c˜ao comutativa: ab mod p = ba mod p;

M3) neutro multiplicativo: a1 mod p = 1a mod p = a mod p;

M4) inversos multiplicativos: aa−1 mod p = a−1a mod p = 1 mod p,

quando p (cid:54) | a;

D) distributiva: a(b + c) mod p = ab mod p + ac mod p.

1.2.2 Adi¸c˜ao e Multiplica¸c˜ao Modular

Efetuar adi¸c˜oes e multiplica¸c˜oes m´odulo m consiste basicamente em
tomar os operandos m´odulo m, fazer as opera¸c˜oes indicadas e reduzir o re-
sultado m´odulo m.

Proposi¸c˜ao 2. Para todo a, b e m inteiros, m > 1, valem:

1) a ± b mod m = [(a mod m) ± (b mod m)] mod m;

2) ab mod m = [(a mod m)(b mod m)] mod m;

1.2. PROPRIEDADES E OPERAC¸ ˜OES

21

Demonstra¸c˜ao. 1. Sejam a, b, e m inteiros, m > 1. Ent˜ao,

a = mq + r =⇒ r = a mod m, 0 ≤ r < m

e b = mq(cid:48) + r(cid:48) =⇒ r(cid:48) = b mod m, 0 ≤ r(cid:48) < m

e segue que

a ± b = m(q ± q(cid:48)) ± (r ± r(cid:48)) =⇒

(a ± b) mod m = (r ± r(cid:48)) mod m =⇒

(a ± b) mod m = [(a mod m) ± (b mod m)] mod m.

2. Agora,

ab = [(mq + r)(mq(cid:48) + r(cid:48))] = [m(mqq(cid:48) + qr(cid:48) + q(cid:48)r) + rr(cid:48)] =⇒

ab mod m = rr(cid:48) mod m =⇒

ab mod m = [(a mod m)(b mod m)] mod m.

Por indu¸c˜ao, pode-se provar que valem as igualdades:

(a1 +a2 +. . .+an) mod m = (a1 mod m+a2 mod m+. . .+an mod m) mod m

(a1a2 · · · an) mod m = [(a1 mod m)(a2 mod m) · · · (an mod m)] mod m.

Exemplo 9. Calcule:

a) (202 + 813 + 4455 + 2390) mod 2

b) (43 · 365 · 1007) mod 3

22 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

Solu¸c˜ao

a) (202 + 813 + 4455 + 2390) mod 2 =

(202 mod 2 + 813 mod 2 + 4455 mod 2 + 2390 mod 2) mod 2 =

(0 + 1 + 1 + 0) mod 2 = 2 mod 2 = 0

b) (43 · 365 · 1007) mod 3 =

[(43 mod 3) · (365 mod 3) · (1007 mod 3)] mod 3 =

(1 · 2 · 2) mod 3 = 4 mod 3 = 1

Exemplo 10. Resolva a express˜ao (23 · 8 + 13 · 6 − 25) mod 7.

Solu¸c˜ao

[(23 mod 7) · (8 mod 7) + (13 mod 7) · (6 mod 7) − (25 mod 7)] mod 7 =

(2 · 1 + 6 · 6 − 4) mod 7 = (2 + 36 − 4) mod 7 = 34 mod 7 = 6

1.2.3

Inversos M´odulo m

Dizemos que um inteiro a ´e o inverso m´odulo m de outro inteiro b e

vice-versa quando

ab ≡ 1 mod m.

O teorema seguinte estabelece a condi¸c˜ao para que um inteiro qual-

quer k possua inverso m´odulo m.

Teorema 1. Dados k e m inteiros, m > 1. O inteiro k possui inverso m´odulo
m, se e somente se, k e m forem co-primos, ou seja, mdc(k, m) = 1.

Demonstra¸c˜ao. (=⇒) Se k e m forem co-primos o mdc(k, m) = 1 e, como
consequˆencia do algoritmo estendido de Euclides, existem inteiros a e b, tais
que

ak + bm = 1 =⇒ ak mod m + bm mod m = 1 =⇒

1.2. PROPRIEDADES E OPERAC¸ ˜OES

23

ak mod m = 1 (pois bm mod m = 0) =⇒ ak ≡ 1 mod m =⇒

a ´e o inverso de k m´odulo m e escrevemos a = k−1 mod m.

(⇐=) Se a for o inverso de k m´odulo m, ou seja, ak ≡ 1 mod m, ent˜ao existe
−b inteiro, tal que

ak = −bm + 1 =⇒ ak + bm = 1 =⇒ mdc(k, m) = 1

Exemplo 11. Determine, se houver, o inverso de 7 m´odulo 12.

Solu¸c˜ao

Como mdc(7, 12) = 1, isto signiﬁca que 7 tem inverso m´odulo 12. Ent˜ao
existem inteiros a e b, tais que 7a + 12b = 1. Usando o algoritmo estendido
de Euclides, temos:

(1) 12 = 7 × 1 + 5
(2) 7 = 5 × 1 + 2
(3) 5 = 2 × 2 + 1
(4) 2 = 2 × 1 + 0

De (3): 5 − 2 × 2 = 1 (5)

De (2): 2 = 7 − 5, substituindo em (5): 5 − 2 × (7 − 5) = 1 =⇒

3 × 5 − 2 × 7 = 1 (6)

De (1): 5 = 12 − 7, substituindo em (6): 3 × (12 − 7) − 2 × 7 = 1 =⇒

3 × 12 − 5 × 7 = 1

Aplicando m´odulo, temos

(3 × 12) mod 12 + [(−5) × 7] mod 12 = 1 =⇒

[(−5) × 7] mod 12 = 1 =⇒ 7−1 mod 12 = −5 ≡ 7 mod 12

Portanto 7 ´e o seu pr´oprio inverso m´odulo 12.

24 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

1.2.4 Equa¸c˜oes M´odulo m

´E poss´ıvel resolver equa¸c˜oes do tipo aX + b ≡ c mod m quando o

mdc(a, m) = 1, ou seja, quando a tem inverso m´odulo m.

aX + b ≡ c mod m =⇒ aX ≡ c − b mod m =⇒

X ≡ (c − b)a−1 mod m, fazendo (c − b)a−1 = d, temos X = d + km, k ∈ Z.

Exemplo 12. Resolva a equa¸c˜ao modular 3X − 13 ≡ 4 mod 5.

Solu¸c˜ao

Como mdc(3, 5) = 1, temos:

3X − 13 ≡ 4 mod 5 =⇒ 3X ≡ 17 mod 5 =⇒ 3X ≡ 2 mod 5 =⇒

X ≡ (2 · 3−1) mod 5 =⇒ X ≡ 4 mod 5,

j´a que 3−1 mod 5 = 2

Portanto, X = 4 + 5k, k ∈ Z.

Se mdc(a, m) = d > 1, a equa¸c˜ao aX ≡ b mod m ter´a solu¸c˜ao
apenas se d dividir b, ou seja, se toda a equa¸c˜ao puder ser dividida por d,
de modo que a(cid:48)X ≡ b(cid:48) mod m(cid:48), onde a(cid:48) = a/d, b(cid:48) = b/d, m(cid:48) = m/d e
mdc(a(cid:48), m(cid:48)) = 1.

Exemplo 13. Resolva a equa¸c˜ao 9X ≡ 6 mod 15.

Solu¸c˜ao

Como o mdc(9, 15) = 3, que divide 6, simpliﬁcamos a equa¸c˜ao e obtemos

9X ≡ 6 mod 15 =⇒ 3X ≡ 2 mod 5,

cujas solu¸c˜oes, conforme o exemplo anterior, s˜ao da forma X = 4 + 5k,
k ∈ Z.

1.2. PROPRIEDADES E OPERAC¸ ˜OES

25

1.2.5 Potencia¸c˜ao

A maneira mais eﬁciente para calcular potˆencias m´odulo m consiste

em usar o expoente na base 2. Observe tamb´em que

ab mod m = (a mod m)b mod m.

Exemplo 14. Calcule 4311 mod 5.

Solu¸c˜ao

4311 mod 5 = (43 mod 5)11 mod 5 = 311 mod 5

11 = 10112 = 8 + 2 + 1 =⇒ 311 mod 5 = 38+2+1 mod 5 =

(38 × 32 × 31) mod 5 = (38 mod 5 × 32 mod 5 × 31 mod 5) mod 5

31 mod 5 = 3 mod 5 = 3

32 mod 5 = 9 mod 5 = 4

34 mod 5 = (32)2 mod 5 = (32 mod 5)2 mod 5 = 42 mod 5 =

16 mod 5 = 1

38 mod 5 = (34)2 mod 5 = (34 mod 5)2 mod 5 = 12 mod 5 = 1

4311 mod 5 = (1 × 4 × 3) mod 5 = 12 mod 5 = 2.

Portanto, 4311 mod 5 = 2.

26 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

1.3 C´alculo de potˆencias xy mod m com aux´ılio

da base 2

Para calcular potˆencias m´odulo m de expoentes elevados existe um
m´etodo simples e eﬁciente utilizando a base 2. Vamos exempliﬁcar calculando
117327 mod 143. Primeiro escreve-se o expoente 327 na base 2, dividindo-o
sucessivamente por 2 e tomando os restos.

327 = 163 × 2 + 1

327 = (81 × 2 + 1) × 2 + 1

327 = 81 × 22 + 1 × 2 + 1

327 = (40 × 2 + 1) × 22 + 1 × 2 + 1

327 = 40 × 23 + 1 × 22 + 1 × 2 + 1

327 = (20 × 2 + 0) × 23 + 1 × 22 + 1 × 2 + 1

327 = 20 × 24 + 0 × 23 + 1 × 22 + 1 × 2 + 1

327 = (10 × 2 + 0) × 24 + 0 × 23 + 1 × 22 + 1 × 2 + 1

327 = 10 × 25 + 0 × 24 + 0 × 23 + 1 × 22 + 1 × 2 + 1

327 = (5 × 2 + 0) × 25 + 0 × 24 + 0 × 23 + 1 × 22 + 1 × 2 + 1

327 = 5 × 26 + 0 × 25 + 0 × 24 + 0 × 23 + 1 × 22 + 1 × 2 + 1

327 = (2 × 2 + 1) × 26 + 0 × 25 + 0 × 24 + 0 × 23 + 1 × 22 + 1 × 2 + 1

327 = 2 × 27 + 1 × 26 + 0 × 25 + 0 × 24 + 0 × 23 + 1 × 22 + 1 × 2 + 1

327 = (1×2+0)×27+1×26+0×25+0×24+0×23+1×22+1×2+1

327 = 1×28+0×27+1×26+0×25+0×24+0×23+1×22+1×2+1

=⇒ 32710 = 1010001112

1.3. C ´ALCULO DE POT ˆENCIAS X Y MOD M COM AUX´ILIO DA BASE 227

Ent˜ao,

11732710 mod 143 = 1171010001112 mod 143 =

11728+0+26+0+0+0+22+2+1 mod 143 =

(117256 · 11764 · 1174 · 1172 · 1171) mod 143 =

[(117256 mod 143) · (11764 mod 143) · (1174 mod 143) · (1172 mod 143) · (1171
mod 143)] mod 143 =⇒ (continua mais abaixo)

Algumas potˆencias modulares 117x mod 143, sendo x uma potˆencia
de 2, foram calculadas a seguir (somente aquelas correspondentes ao alga-
rismo 1 no expoente 1010001112 = 32710 ser˜ao usadas no c´alculo de 117327
mod 143).

1171 mod 143 = 117

1172 mod 143 = 13689 mod 143 = 104

1174 mod 143 = (1172)2 mod 143 = (1172 mod 143)2 mod 143 =
1042 mod 143 = 10816 mod 143 = 91

1178 mod 143 = (1174)2 mod 143 = (1174 mod 143)2 mod 143 =
912 mod 143 = 8281 mod 143 = 130

11716 mod 143 = (1178)2 mod 143 = (1178 mod 143)2 mod 143 =
1302 mod 143 = 16900 mod 143 = 26

11732 mod 143 = (11716)2 mod 143 = (11716 mod 143)2 mod 143 =
262 mod 143 = 676 mod 143 = 104

11764 mod 143 = (11732)2 mod 143 = (11732 mod 143)2 mod 143 =
1042 mod 143 = 10816 mod 143 = 91

117128 mod 143 = (11764)2 mod 143 = (11764 mod 143)2 mod 143 =
912 mod 143 = 8281 mod 143 = 130

117256 mod 143 = (117128)2 mod 143 = (117128 mod 143)2 mod 143 =
1302 mod 143 = 16900 mod 143 = 26

28 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

Finalizando o c´alculo de 117327 mod 143, temos:

11732710 mod 143 = 1171010001112 mod 143 =

(117256 · 11764 · 1174 · 1172 · 1171) mod 143 =

[(117256 mod 143) · (11764 mod 143) · (1174 mod 143) · (1172 mod 143) · (1171
mod 143)] mod 143 =

(26 · 91 · 91 · 104 · 117) mod 143, que calculamos em etapas como segue:

(26 · 91) mod 143 = 2366 mod 143 = 78 mod 143

(78 · 91) mod 143 = 7098 mod 143 = 91 mod 143

(91 · 104) mod 143 = 9464 mod 143 = 26 mod 143

(26 · 117) mod 143 = 3042 mod 143 = 39 mod 143

Concluimos que 117327 mod 143 = 39. As contas podem ser feitas
numa calculadora comum, entretanto, calcular diretamente 117327 na calcula-
dora n˜ao ´e poss´ıvel porque o n´umero ´e muito grande chegando a ”estourar”a
capacidade de armazenamento de um computador pessoal.

Pode-se implementar o algoritmo a seguir em linguagem de pro-
grama¸c˜ao para efetuar o c´alculo da potˆencia y = xk mod m, onde k est´a
escrito na base 2.

y := 1; A := x mod m; // atribui¸c˜ao dos valores iniciais de y e A

y := (y ∗ A) mod m; // y recebe o valor de (1 · x) mod m

A := (A ∗ A) mod m; // A recebe o valor de (x · x = x2) mod m

y := (y ∗ A) mod m; // y recebe o valor de (1 · x · x2) mod m

A := (A ∗ A) mod m; // A recebe o valor de (x2 · x2 = x4) mod m

y := (y ∗ A) mod m; // y recebe o valor de (1 · x · x2 · x4) mod m

. . .

1.3. C ´ALCULO DE POT ˆENCIAS X Y MOD M COM AUX´ILIO DA BASE 229

Os valores da vari´avel A s˜ao calculados sempre, mas os valores de
y s˜ao calculados apenas quando o algarismo do n´umero bin´ario k for 1.
Come¸camos pelo primeiro algarismo `a direita de k. Se for 1, calculamos
y, calculamos A, eliminamos este algarismo e passamos ao seguinte. Caso
contr´ario, se o primeiro d´ıgito `a direita de k for zero, calculamos A e elimina-
mos o zero, passando ao pr´oximo algarismo. Repetimos isso at´e eliminarmos
todos os d´ıgitos de k. Ao ﬁnal do processo temos y = xk mod m. Num
programa, como o do exemplo abaixo, usamos um comando ’if’ para testar
os d´ıgitos e um ’loop while’ para reduzir a quantidade de linhas de programa,
permitindo rod´a-lo para qualquer tamanho do n´umero bin´ario k.

y = 1; A = x % m;
while (x ! = 0)
{

if (k & 1) // veriﬁca se o bit menos signiﬁcativo ´e 1
{

y = y ∗ A % m;

}
A = A ∗ A % m;
k = k >> 1; // elimina o bit menos signiﬁcativo de k

}

Exemplo em linguagem C.

Como atividade em sala de aula, podemos propor aos alunos imple-
mentar o algoritmo numa planilha do Excel e calcular uma potˆencia modular
de expoente grande como 117327 mod 143 usando essa planilha.

30 CAP´ITULO 1. ARITM ´ETICA MODULAR PARA O ENSINO M ´EDIO

Abaixo a descri¸c˜ao da planilha:

B1 : x
C1 : k
D1 : m
B4 : A
A5 : vazia
A6 : 1
A7 : 2
A8 : 3
A9 : 4
B5 : 0
B6 :=MOD(B2; D2)
B7 :=MOD(B6 ∗ B6; D2)
B8 :=MOD(B7 ∗ B7; D2)
B9 :=MOD(B8 ∗ B8; D2)
B10 :=MOD(B9 ∗ B9; D2)
B11 :=MOD(B10 ∗ B10; D2)
B12 :=MOD(B11 ∗ B11; D2)
B13 :=MOD(B12 ∗ B12; D2)
B14 :=MOD(B13 ∗ B13; D2)

B2 : 117
C2 : 327
D2 : 143
C4 : y
A10 : 5
A11 : 6
A12 : 7
A13 : 8
A14 : 9
C5 : 1
C6 :=MOD(B6 ∗ C5; D2)
C7 :=MOD(B7 ∗ C6; D2)
C8 :=MOD(B8 ∗ C7; D2)
C9 : vazia
C10 : vazia
C11 : vazia
C12 :=MOD(B12 ∗ C8; D2)
C13 : vazia
C14 :=MOD(B14 ∗ C12; D2)

Planilha excel para c´alculo de 117327 mod 143.

Cap´ıtulo 2

Criptograﬁa e Aritm´etica
Modular

2.1 Criptograﬁa

A necessidade de sigilo nas comunica¸c˜oes militares, diplom´aticas e
comerciais levou `a cria¸c˜ao de c´odigos para mascarar mensagens de modo
que somente os leg´ıtimos destinat´arios pudessem decifr´a-las. Assim surgiu a
criptograﬁa (do grego kryptos = secreto), a arte de codiﬁcar uma mensagem
segundo uma conven¸c˜ao pr´e-estabelecida entre o emissor e o receptor, impe-
dindo que qualquer outra pessoa que a intercepte consiga ler o seu conte´udo.
As t´ecnicas criptogr´aﬁcas consistem na transposi¸c˜ao e na substitui¸c˜ao. A
transposi¸c˜ao ´e o rearranjo das letras da mensagem original gerando um ana-
grama. O n´umero de anagramas cresce rapidamente quanto maior o texto a
ser cifrado. Matematicamente, uma transposi¸c˜ao nada mais ´e do que uma
das poss´ıveis permuta¸c˜oes com repeti¸c˜ao do conjunto das letras da mensa-
gem original. Para que seja eﬁciente, a transposi¸c˜ao deve ser feita segundo
um sistema objetivo conhecido pelo receptor da mensagem, ou seja, o ana-
grama n˜ao pode ser gerado de forma aleat´oria, caso contr´ario o alto n´umero
de anagramas poss´ıveis torna invi´avel a decifra¸c˜ao. Um exemplo de cifra por
transposi¸c˜ao consiste em escrever a mensagem original em blocos de n letras
e a seguir copiar as n colunas resultantes de cima para baixo, da esquerda
para a direita. Preliminarmente, exclu´ımos os espa¸cos entre as palavras e
exclu´ımos tamb´em os sinais gr´aﬁcos (cedilha, til, pontua¸c˜ao, etc.), se houver.
Al´em disso, os d´ıgrafos (rr, ss, oo, etc.) na mensagem s˜ao substitu´ıdos por
uma s´o letra. Tais medidas visam diﬁcultar a quebra do c´odigo. Vamos cifrar
a frase “O matem´atico ´e um cego numa sala escura, procurando um gato que
n˜ao est´a l´a”, atribu´ıda a Charles Darwin (1809-1882), naturalista inglˆes (na

31

32

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

verdade, fazendo um elogio aos matem´aticos), com o m´etodo acima e usando
n=7.

o m a
c
i
t
g
e
c
a
s
a
r
u
c
c
r
u
u m g
e
u
a
t

e m a
t
u m
o
e
u m
o n
s
e
a
l
o
r
a
p
o
d
a n
q
o
t
a
o
n a
s
e
a m a
a
l

A mensagem cifrada ﬁca assim:

“ o t c a c c u u t m i e s u u m e a a c g a r r g n l t o o l a a
a a a e e n a p n t o a m u u e r d o e m a m m s o o q s a”,

que ´e um anagrama do texto original, obtido segundo a regra descrita an-
teriormente. Observe que completamos a ´ultima linha a ser cifrada com
caracteres nulos (a m a).

O destinat´ario, conhecendo a chave n= 7, divide o n´umero de carac-
teres da mensagem cifrada por 7 (no caso, 63÷7 = 9) para obter o n´umero de
caracteres que colocar´a em cada coluna para decifrar a mensagem. O ponto
fraco neste caso ´e que um espi˜ao pode obter a chave fatorando o n´umero de
caracteres da mensagem.

A substitui¸c˜ao, como o nome sugere, consiste em substituir cada
letra da mensagem original por outra segundo um sistema previamente acer-
tado, de modo que a substitui¸c˜ao inversa forne¸ca o texto original.

2.1.1 A Cifra de C´esar

No cifr´ario de C´esar, uma das cifras de substitui¸c˜ao mais antigas,
cada letra da mensagem original ´e substitu´ıda pela terceira letra ap´os ela na
ordem alfab´etica. Ou seja, trata-se de corresponder o alfabeto original com
uma transla¸c˜ao do mesmo de trˆes letras adiante.

2.1. CRIPTOGRAFIA

33

alfabeto original: a b c d e f g h i j ... x y z

substitui¸c˜ao ... : d e f g h i j k l m ... a b c

A frase de Darwin codiﬁcada usando a cifra de C´esar ﬁcaria assim:
“r p d w h p d w l f r h x p f h j r q x p d v d o d h v f x u d s u r f x u d q
g r x p j d w r t x h q d r h v w d o d”.

2.1.2 A Matem´atica da Cifra de C´esar

Associamos a cada letra do alfabeto um n´umero inteiro n˜ao nega-
tivo da seguinte maneira: a = 0, b = 1, c = 2, d = 3 e assim por diante at´e
z = 25. Desse modo nos referimos a uma letra pelo seu n´umero correspon-
dente e vice-versa. Pensando na cifra de C´esar como uma fun¸c˜ao c que a
cada letra λ da mensagem original associa uma ´unica letra c(λ) = λ + 3,
surge um problema quando desejamos cifrar as letras x, y ou z. Com essa
fun¸c˜ao obtemos c(x) = c(23) = 23 + 3 = 26, c(y) = c(24) = 24 + 3 = 27 e
c(z) = c(25) = 25 + 3 = 28 que n˜ao correspondem a nenhuma letra do alfa-
beto original (que vai at´e z=25). Como sabemos, x corresponde `a letra a, y
`a letra b e z `a letra c. A solu¸c˜ao ´e tomar o resto da divis˜ao euclidiana de c(λ)
por 26. No caso da letra x, c(x) = 26 e o resto da divis˜ao por 26 ´e 0, portanto
c(x) = 0 = a. Analogamente, c(y) = 1 = b e c(z) = 2 = c. Para decodiﬁcar a
cifra de C´esar usamos a fun¸c˜ao inversa d[c(λ)] = c(λ) − 3 e novamente temos
problemas para decodifcar c(λ) = 0, c(λ) = 1 e c(λ) = 2 cujas decodiﬁca¸c˜oes
seriam inteiros negativos. Como vemos, as fun¸c˜oes adequadas para cifrar e
decifrar usando a cifra de C´esar s˜ao as fun¸c˜oes modulares correspondentes
c(λ) = (λ + 3) mod 26 e d[c(λ)] = [c(λ) − 3] mod 26.

Podemos generalizar o procedimento utilizado na cifra de C´esar. Fi-
xado um n´umero natural k (denominado chave), 0 < k < 26, a cifragem
´e feita substituindo cada letra por aquela k posi¸c˜oes adiante no alfabeto.
Em termos de aritm´etica modular isto signiﬁca adicionar, m´odulo 26, k ao
n´umero λ correspondente a letra a ser cifrada, ou seja

c(λ) = (λ + k) mod 26

A decifragem consiste em substitiuir cada letra do texto cifrado por
aquela obtida retrocedendo k posi¸c˜oes no alfabeto. Em termos de aritm´etica
modular signiﬁca subtrair, m´odulo 26, k de c(λ), ou seja

d[c(λ)] = [c(λ) − k] mod 26 = (λ + k) − k mod 26 = λ

34

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

O ponto fraco da cifra de C´esar est´a no pequeno n´umero de chaves

poss´ıveis (25 apenas), o que permite a quebra do c´odigo por tentativas.

Vamos exempliﬁcar cifrando ”legi˜oes romanas” com a chave k = 11.
Ap´os a supress˜ao de espa¸cos e acentos temos ”legioesromanas”. Substituindo
as letras por n´umeros temos 11-04-06-08-14-04-18-17-14-12-00-13-00-18.

c(11) = (11 + 11) mod 26 =⇒ c(11) = 22 mod 26 = 22

c(04) = (04 + 11) mod 26 =⇒ c(04) = 15 mod 26 = 15

c(06) = (06 + 11) mod 26 =⇒ c(06) = 17 mod 26 = 17

c(08) = (08 + 11) mod 26 =⇒ c(08) = 19 mod 26 = 19

c(14) = (14 + 11) mod 26 =⇒ c(14) = 25 mod 26 = 25

c(04) = (04 + 11) mod 26 =⇒ c(04) = 15 mod 26 = 15

c(18) = (18 + 11) mod 26 =⇒ c(18) = 29 ≡ 03 mod 26 = 03

c(17) = (17 + 11) mod 26 =⇒ c(17) = 28 ≡ 02 mod 26 = 02

c(14) = (14 + 11) mod 26 =⇒ c(14) = 25 mod 26 = 25

c(12) = (12 + 11) mod 26 =⇒ c(12) = 23 mod 26 = 23

c(00) = (00 + 11) mod 26 =⇒ c(00) = 11 mod 26 = 11

c(13) = (13 + 11) mod 26 =⇒ c(13) = 24 mod 26 = 24

c(00) = (00 + 11) mod 26 =⇒ c(00) = 11 mod 26 = 11

c(18) = (18 + 11) mod 26 =⇒ c(18) = 29 ≡ 03 mod 26 = 03

Obtemos assim 22-15-17-19-25-15-03-02-25-23-11-24-11-03 e a men-
sagem cifrada ´e ”w p r t z p d c z x l y l d”. Agora vamos decifrar a mensagem.

d(22) = (22 − 11) mod 26 =⇒ d(22) = 11 mod 26 = 11

d(15) = (15 − 11) mod 26 =⇒ d(15) = 04 mod 26 = 04

2.1. CRIPTOGRAFIA

35

d(17) = (17 − 11) mod 26 =⇒ d(17) = 06 mod 26 = 06

d(19) = (19 − 11) mod 26 =⇒ d(19) = 08 mod 26 = 08

d(25) = (25 − 11) mod 26 =⇒ d(25) = 14 mod 26 = 14

d(15) = (15 − 11) mod 26 =⇒ d(15) = 04 mod 26 = 04

d(03) = (03 − 11) mod 26 =⇒ d(03) = −8 ≡ 18 mod 26 = 18

d(02) = (02 − 11) mod 26 =⇒ d(02) = −9 ≡ 17 mod 26 = 17

d(25) = (25 − 11) mod 26 =⇒ d(25) = 14 mod 26 = 14

d(23) = (23 − 11) mod 26 =⇒ d(23) = 12 mod 26 = 12

d(11) = (11 − 11) mod 26 =⇒ d(11) = 00 mod 26 = 00

d(24) = (24 − 11) mod 26 =⇒ d(24) = 13 mod 26 = 13

d(11) = (11 − 11) mod 26 =⇒ d(11) = 00 mod 26 = 00

d(03) = (03 − 11) mod 26 =⇒ d(03) = −8 ≡ 18 mod 26 = 18

Como esperado obtemos 11-04-06-08-14-04-18-17-14-12-00-13-00-18,

que corresponde `a mensagem original ”legi˜oes romanas”.

2.1.3 A Cifra de Vigen`ere

A cifra de C´esar e suas varia¸c˜oes s˜ao denominadas cifras de subs-
titui¸c˜ao monoalfab´etica, ou seja, cada letra ´e substitu´ıda sempre por um
mesmo s´ımbolo em toda a mensagem. Existe uma correspondˆencia biun´ıvoca
entre o alfabeto original e o alfabeto de substitui¸c˜ao. Para decifrar a mensa-
gem, basta substituir cada s´ımbolo pela letra correspondente do alfabeto ori-
ginal. Este tipo de cifra foi eﬁcaz por muito tempo, mas com o surgimento da
t´ecnica de an´alise de frequˆencia, descoberta pelos ´arabes, tornou-se insegura.
A an´alise de frequˆencia baseia-se no fato de que cada letra aparece com uma
determinada frequˆencia em textos de um certo idioma. Assim, contando-se
os s´ımbolos na mensagem cifrada e sabendo-se o idioma do texto original,
basta comparar a frequˆencia dos s´ımbolos com uma tabela de frequˆencia pre-
viamente elaborada (a partir de um livro, por exemplo). A t´ecnica ´e muito

36

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

eﬁcaz quando se tem um texto relativamente longo ou muitos textos curtos,
mas pode n˜ao ser poss´ıvel aplic´a-la a um ´unico texto muito pequeno. Abaixo
mostramos a tabela de frequˆencia do idioma portuguˆes.

Portuguˆes

A 14,63 E 12,57
B
1,02
C
D 4,99 H

I
1,04 F
J
3,88 G 1,30 K 0,02 O 10,73

6,18 M 4,74 Q 1,20 U 4,63 Y 0,01
5,05 R 6,53 V 1,67 Z 0,47
0,40 N
7,81 W 0,01
2,52 T 4,74 X 0,21

1,28 L 2,78 P

-,-
-,-

-
-

S

Tabela de frequˆencia de letras do idioma portuguˆes (em porcentagem).

Para escapar `a an´alise de frequˆencia, Blaise de Vigen`ere (1523-1596),
diplomata e cript´ografo francˆes, utilizou uma cifra polialfab´etica que leva
o seu nome. A cifra de Vigen`ere consiste numa tabela com 26 alfabetos
dispostos horizontalmente e, a partir do segundo, deslocados uma letra para
a direita em rela¸c˜ao ao anterior. Ou seja, cada alfabeto come¸ca por uma
letra diferente. O primeiro come¸ca pela letra A, o segundo pela letra B, e
assim por diante.

2.1. CRIPTOGRAFIA

37

A B C D E F G H I
i
e
j
f
k
g
l m n
h
o
i
p
j
q
k
r
l m n
s
o
t
p
u
q
v w x
r
y
s
z
t
a
u
b
v w x
c
y
d
z
e
a
f
b
g
c
h
d
i
e
j
f
k
g
l m n
h

J K L M N O P Q R S T U V W X Y Z
z
r
j
a
s
k
b
t
l m n
c
u
o
d
v w x
p
e
y
q
f
z
r
g
a
s
h
b
t
i
c
u
j
d
v w x
k
e
y
f
z
l
g
a
h
b
i
c
j
d
k
e
l m n
f
o
g
p
h
q
i
r
j
s
k
t
l m n
u
o

y
v w x
u
t
z
y
v w x
u
a
z
y
v w x
b
a
z
y
c
b
a
z
d
c
b
a
e
d
c
b
f
e
d
c
g
f
e
d
h
g
f
e
i
h
g
f
j
i
h
g
k
j
i
h
k
l m
j
i
l m n
k
j
o
l m n
k
p
o
l m n
q
p
o
r
q
p
s
r
q
t
s
r
u
t
s
v
u
t
u
v w
v w x
y

k
l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j
k
l m n
o
p

l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j
k
l m n
o
p
q

s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j
k
l m n
o
p
q
r
s
t
u
v w x

f
g
h
i
j
k
l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i

o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j
k
l m n
o
p
q
r

h
i
j
k
l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j
k

p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j
k
l m n
o
p
q
r
s

g
h
i
j
k
l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j

q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g
h
i
j
k
l m n
o
p
q
r
s
t

d
e
f
g
h
i
j
k
l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f
g

b
c
d
e
f
g
h
i
j
k
l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e

c
d
e
f
g
h
i
j
k
l m n
o
p
q
r
s
t
u
v w x
y
z
a
b
c
d
e
f

A a
B b
C c
D d
E e
F f
G g
H h
i
I
J
j
K k
L l m n
o
M m n
p
o
N n
q
p
O o
r
q
P p
s
r
Q q
t
s
R r
u
t
S s
v w x
u
T t
y
v w x
U u
z
y
V v w x
a
z
y
W w x
b
a
z
y
X x
c
b
a
z
Y y
d
c
b
a
Z z

Alfabetos da cifra de Vigen`ere.

O m´etodo consiste em usar uma palavra ou frase como chave. Cada
letra da chave indica um alfabeto horizontal a ser usado na substitui¸c˜ao
de uma letra do texto original. Vejamos um exemplo. Se queremos cifrar a
palavra ”tempestade” usando como chave a palavra RAIO procedemos assim:

buscamos a letra no cruzamento da coluna do T com a linha do R e achamos
que ´e k ;
buscamos a letra no cruzamento da coluna do E com a linha do A e achamos
que ´e e;
buscamos a letra no cruzamento da coluna do M com a linha do I e achamos
que ´e u;
buscamos a letra no cruzamento da coluna do P com a linha do O e achamos
que ´e d ;
buscamos a letra no cruzamento da coluna do E com a linha do R e achamos
que ´e v ;

38

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

buscamos a letra no cruzamento da coluna do S com a linha do A e achamos
que ´e s;
buscamos a letra no cruzamento da coluna do T com a linha do I e achamos
que ´e b;
buscamos a letra no cruzamento da coluna do A com a linha do O e achamos
que ´e o;
buscamos a letra no cruzamento da coluna do D com a linha do R e achamos
que ´e u;
buscamos a letra no cruzamento da coluna do E com a linha do A e achamos
que ´e e.

A mensagem cifrada ´e ent˜ao ”k e u d v s b o u e”. A mensagem
agora n˜ao ´e vulner´avel `a an´alise de frequˆencia j´a que uma mesma letra do
texto original ´e substitu´ıda por mais de uma no texto cifrado (t, por exemplo,
´e cifrado como k e b e a letra e ´e cifrada como e e v ).

Para decifrar ”k e u d v s b o u e”, procuramos a letra k na linha R
e substitu´ımos pela letra no topo da coluna, ou seja T ; localizamos a letra
e na linha A e substitu´ımos pela letra no topo da coluna, E ; procuramos a
letra u na linha I e substitu´ımos pela letra no topo da coluna, M ; buscamos
a letra d na linha O e substitu´ımos pela primeira letra da coluna, ou seja P.
Repetindo o procedimento at´e a ´ultima letra do texto cifrado, obte-

mos o texto original ”tempestade”.

2.1.4 A Matem´atica da Cifra de Vigen`ere

Em termos de aritm´etica modular a cifra de Vigen`ere ´e semelhante
`a cifra de C´esar. S´o que agora a chave ´e constitu´ıda de um conjunto de
naturais k = {k1, k2, . . . , km}, 0 ≤ ki < 26, i = 1, 2, 3, . . . , m. Uma mensagem
n1n2 . . . np ´e criptografada segundo o procedimento:

2.1. CRIPTOGRAFIA

39

C(n1) = (n1 + k1) mod 26;

C(n2) = (n2 + k2) mod 26;

. . .

C(ni−1) = (ni−1 + km) mod 26;

C(ni) = (ni + k1) mod 26;

C(ni+1) = (ni+1 + k2) mod 26;

. . .

C(np) = (np + kj) mod 26, para 1 ≤ j ≤ m;

Vamos exempliﬁcar cifrando e decifrando a frase ’Os n´umeros gover-
nam o mundo.’ atribu´ıda ao geˆometra grego Pit´agoras. Inicialmente fazemos
uma pr´e-codiﬁca¸c˜ao (para diﬁcultar a quebra do c´odigo) onde os d´ıgrafos, se
existirem, s˜ao substitu´ıdos por uma letra apenas (”ss”por ”s”, por exemplo)
e tamb´em os acentos e os espa¸cos entre as palavras s˜ao suprimidos. Como
resultado obtemos o bloco ´unico: ’osnumerosgovernamomundo’. A cada le-
tra do alfabeto fazemos corresponder um n´umero do seguinte modo: a = 0,
b = 1, c = 2, e assim por diante. Temos agora o bloco num´erico (separamos
com h´ıfen para facilitar o entendimento do exemplo),

14-18-13-20-12-04-17-14-18-06-14-21-04-17-13-00-12-14-12-20-13-03-14

Usaremos como chave para cifragem a palavra cateto, que conver-
tida em n´umeros ´e k = {02, 00, 19, 04, 19, 14}. Agora fazemos a codiﬁca¸c˜ao:

c(14) = (14 + 02) mod 26 = 16 mod 26 = 16

c(18) = (18 + 00) mod 26 = 18 mod 26 = 18

c(13) = (13 + 19) mod 26 = 32 mod 26 = 06

c(20) = (20 + 04) mod 26 = 24 mod 26 = 24

c(12) = (12 + 19) mod 26 = 31 mod 26 = 05

c(04) = (04 + 14) mod 26 = 18 mod 26 = 18

40

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

c(17) = (17 + 02) mod 26 = 19 mod 26 = 19

c(14) = (14 + 00) mod 26 = 14 mod 26 = 14

c(18) = (18 + 19) mod 26 = 37 mod 26 = 11

c(06) = (06 + 04) mod 26 = 10 mod 26 = 10

c(14) = (14 + 19) mod 26 = 33 mod 26 = 07

c(21) = (21 + 14) mod 26 = 35 mod 26 = 09

c(04) = (04 + 02) mod 26 = 06 mod 26 = 06

c(17) = (17 + 00) mod 26 = 17 mod 26 = 17

c(13) = (13 + 19) mod 26 = 32 mod 26 = 06

c(00) = (00 + 04) mod 26 = 04 mod 26 = 04

c(12) = (12 + 19) mod 26 = 31 mod 26 = 05

c(14) = (14 + 14) mod 26 = 28 mod 26 = 02

c(12) = (12 + 02) mod 26 = 14 mod 26 = 14

c(20) = (20 + 00) mod 26 = 20 mod 26 = 20

c(13) = (13 + 19) mod 26 = 32 mod 26 = 06

c(03) = (03 + 04) mod 26 = 07 mod 26 = 07

c(14) = (14 + 19) mod 26 = 33 mod 26 = 07

A sequˆencia obtida,

16-18-06-24-05-18-19-14-11-10-07-09-06-17-06-04-05-02-14-20-06-07-07,

corresponde `a mensagem encriptada ”q s g y f s t o l k h j g r g e f c o
u g h h”.

Deciframos com a mesma chave k = {02, 00, 19, 04, 19, 14}, obser-
vando que, se a = c(λ) − ki < 0, ent˜ao d[c(λ)] = a mod 26 = (a + 26) mod
26.

d(16) = (16 − 02) mod 26 = 14 mod 26 =⇒ d(16) = 14

d(18) = (18 − 00) mod 26 = 18 mod 26 =⇒ d(18) = 18

d(06) = (06−19) mod 26 = −13 mod 26 ≡ (−13+26) mod 26 =⇒ d(06) = 13

2.1. CRIPTOGRAFIA

41

d(24) = (24 − 04) mod 26 = 20 mod 26 =⇒ d(24) = 20

d(05) = (05−19) mod 26 = −14 mod 26 ≡ (−14+26) mod 26 =⇒ d(05) = 12

d(18) = (18 − 14) mod 26 = 04 mod 26 =⇒ d(18) = 04

d(19) = (19 − 02) mod 26 = 17 mod 26 =⇒ d(19) = 17

d(14) = (14 − 00) mod 26 = 14 mod 26 =⇒ d(14) = 14

d(11) = (11−19) mod 26 = −08 mod 26 ≡ (−8+26) mod 26 =⇒ d(11) = 18

d(10) = (10 − 04) mod 26 = 06 mod 26 =⇒ d(10) = 06

d(07) = (07−19) mod 26 = −12 mod 26 ≡ (−12+26) mod 26 =⇒ d(07) = 14

d(09) = (09−14) mod 26 = −05 mod 26 ≡ (−5+26) mod 26 =⇒ d(09) = 21

d(06) = (06 − 02) mod 26 = 04 mod 26 =⇒ d(06) = 04

d(17) = (17 − 00) mod 26 = 17 mod 26 =⇒ d(17) = 17

d(06) = (06−19) mod 26 = −13 mod 26 ≡ (−13+26) mod 26 =⇒ d(06) = 13

d(04) = (04 − 04) mod 26 = 00 mod 26 =⇒ d(04) = 00

d(05) = (05−19) mod 26 = −14 mod 26 ≡ (−14+26) mod 26 =⇒ d(05) = 12

d(02) = (02−14) mod 26 = −12 mod 26 ≡ (−12+26) mod 26 =⇒ d(02) = 14

d(14) = (14 − 02) mod 26 = 12 mod 26 =⇒ d(14) = 12

d(20) = (20 − 00) mod 26 = 20 mod 26 =⇒ d(20) = 20

d(06) = (06−19) mod 26 = −13 mod 26 ≡ (−13+26) mod 26 =⇒ d(06) = 13

d(07) = (07 − 04) mod 26 = 03 mod 26 =⇒ d(07) = 03

d(07) = (07−19) mod 26 = −12 mod 26 ≡ (−12+26) mod 26 =⇒ d(07) = 14

O resultado ´e o bloco original

14-18-13-20-12-04-17-14-18-06-14-21-04-17-13-00-12-14-12-20-13-03-14

cuja mensagem ´e a frase de Pit´agoras ”Os n´umeros governam o mundo”.

42

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

2.1.5 Cifr´ario de Hill

Essa cifra foi proposta em 1920 pelo americano Lester S. Hill (1891-
1961) e utiliza o produto de matrizes. Vejamos como funciona. Primeira-
mente escolhe-se uma matriz quadrada K de ordem n com entradas kij tais
que, 0 ≤ kij < 26,



K =






k11 k12
k21 k22
...
...
kn1 kn2

. . . k1n
. . . k2n
...
. . .
. . . knn








Para cifrar um texto original X, primeiro quebramos o texto em
blocos de n letras (x1x2x3 . . . xn). Em seguida, obtemos o bloco cifrado
(y1y2y3 . . . yn) efetuando o produto matricial abaixo, m´odulo 26.



















y1
y2
y3
...
yn








=

k11 k12
k21 k22
...
...
kn1 kn2

. . . k1n
. . . k2n
...
. . .
. . . knn


























x1
x2
x3
...
xn

Caso o n´umero de caracteres de X n˜ao seja m´ultiplo de n, comple-
tamos o ´ultimo bloco com letras ao acaso. Tamb´em costuma-se acrescentar
de 1 a n − 1 letras aleatoriamente no ﬁnal da mensagem cifrada para diﬁ-
cultar que se descubra o valor de n (se isso n˜ao fosse feito toda mensagem
cifrada teria um n´umero de caracteres m´ultiplo de n, o que facilitaria a vida
do criptoanalista de plant˜ao).

A mensagem original X ´e resgatada fazendo o produto da matriz
K −1, inversa de K mod 26, por cada bloco cifrado (y1y2y3 . . . yn), operando
m´odulo 26. Obviamente, a matriz K deve ser invert´ıvel em Z26, o que ´e
verdadeiro se o determinante de K possuir inverso em Z26. Por exemplo, a
matriz

A =

(cid:21)

(cid:20) 8 12
9
3

cujo determinante ´e (det A) mod 26 = 36 mod 26 = 10 n˜ao ´e invert´ıvel em
Z26, pois 10 e 26 n˜ao s˜ao co-primos e, portanto, 10 n˜ao tem inverso m´odulo
26. J´a a matriz

B =

(cid:21)

(cid:20) 7 5
3 8

2.1. CRIPTOGRAFIA

43

cujo determinante (det B) mod 26 = 41 mod 26 = 15 ´e co-primo de 26,
possui inversa

B−1 =

(cid:21)

(cid:20) 4 17
5 23

A frase ”A terra ´e azul”dita pelo cosmonauta sovi´etico Iuri A. Ga-
garin (1934-1968), quando avistou nosso planeta pela janela de sua c´apsula
espacial, ser´a usada como exemplo da cifra de Hill. Utilizaremos n = 2 e a
matriz

K =

(cid:21)

(cid:20) 7 5
3 8

como chave.

Na pr´e-codiﬁca¸c˜ao temos ’ateraeazul’ que corresponde a

00-19-04-17-00-04-00-25-20-11 utilizando a conven¸c˜ao estabelecida anterior-
mente para representa¸c˜ao do alfabeto numericamente. Formamos ent˜ao os
blocos:

X1 =

(cid:21)

(cid:20) 00
19

X2 =

(cid:21)

(cid:20) 04
17

X3 =

(cid:21)

(cid:20) 00
04

X4 =

(cid:21)

(cid:20) 00
25

X5 =

(cid:21)

(cid:20) 20
11

O pr´oximo passo ´e a cifragem. Primeiro fazemos Y (cid:48)

i = KXi, i ∈

{1, 2, 3, 4, 5}. Depois calculamos Yi = Y (cid:48)

i mod 26.

Y (cid:48)
1 =

(cid:20) 7 5
3 8

(cid:21) (cid:20) 00
19

(cid:21)

=

(cid:20) 95
152

(cid:21)

Y (cid:48)
2 =

(cid:20) 7 5
3 8

(cid:21) (cid:20) 04
17

(cid:21)

=

(cid:20) 113
148

(cid:21)

44

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

Y (cid:48)
3 =

(cid:20) 7 5
3 8

(cid:21) (cid:20) 00
04

(cid:21)

=

(cid:20) 20
32

(cid:21)

Y (cid:48)
4 =

(cid:20) 7 5
3 8

(cid:21) (cid:20) 00
25

(cid:21)

=

(cid:20) 125
200

(cid:21)

Y (cid:48)
5 =

(cid:20) 7 5
3 8

(cid:21) (cid:20) 20
11

(cid:21)

=

(cid:20) 195
148

(cid:21)

Y1 = Y (cid:48)

1 mod 26

Y2 = Y (cid:48)

2 mod 26

Y3 = Y (cid:48)

3 mod 26

Y4 = Y (cid:48)

4 mod 26

Y5 = Y (cid:48)

5 mod 26

Y1 =

(cid:21)

(cid:20) 17
22

Y2 =

(cid:21)

(cid:20) 09
18

Y3 =

(cid:21)

(cid:20) 20
06

Y4 =

(cid:21)

(cid:20) 21
18

Y5 =

(cid:21)

(cid:20) 13
18

2.1. CRIPTOGRAFIA

45

Ent˜ao a mensagem cifrada ´e 17-22-09-18-20-06-21-12-13-18. Em le-

tras: ’r w j s u g v m n s’.

Vamos agora decifrar com a matriz inversa K −1 =

meiramente, calculamos X (cid:48)
Xi ≤ 25. Vejamos,

i = K −1Yi. Depois Xi = X (cid:48)

(cid:21)

(cid:20) 4 17
5 23
i mod 26, com 00 ≤

. Pri-

Y1 =

(cid:21)

(cid:20) 17
22

Y2 =

(cid:21)

(cid:20) 09
18

Y3 =

(cid:21)

(cid:20) 20
06

Y4 =

(cid:21)

(cid:20) 21
18

Y5 =

(cid:21)

(cid:20) 13
18

X (cid:48)

1 =

(cid:20) 4 17
5 23

(cid:21) (cid:20) 17
22

(cid:21)

=

(cid:20) 442
591

(cid:21)

X (cid:48)

2 =

(cid:20) 4 17
5 23

(cid:21) (cid:20) 09
18

(cid:21)

=

(cid:20) 342
459

(cid:21)

X (cid:48)

3 =

(cid:20) 4 17
5 23

(cid:21) (cid:20) 20
06

(cid:21)

=

(cid:20) 182
238

(cid:21)

X (cid:48)

4 =

(cid:20) 4 17
5 23

(cid:21) (cid:20) 21
18

(cid:21)

=

(cid:20) 390
519

(cid:21)

X (cid:48)

5 =

(cid:20) 4 17
5 23

(cid:21) (cid:20) 13
18

(cid:21)

=

(cid:20) 358
479

(cid:21)

X1 = X (cid:48)

1 mod 26

X1 =

(cid:21)

(cid:20) 00
19

46

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

X2 = X (cid:48)

2 mod 26

X3 = X (cid:48)

3 mod 26

X4 = X (cid:48)

4 mod 26

X5 = X (cid:48)

5 mod 26

X2 =

(cid:21)

(cid:20) 04
17

X3 =

(cid:21)

(cid:20) 00
04

X4 =

(cid:21)

(cid:20) 00
25

X5 =

(cid:21)

(cid:20) 20
11

O resultado 00-19-04-17-00-04-00-25-20-11, em letras ’ateraeazul’ ´e a men-

sagem original ”A terra ´e azul”.

2.2. CRIPTOGRAFIA DE CHAVE P ´UBLICA

47

2.2 Criptograﬁa de Chave P´ublica

2.2.1

Introdu¸c˜ao

Ao ﬁnal da segunda guerra mundial e durante o per´ıodo da chamada
guerra fria, a criptograﬁa consistia em m´etodos soﬁsticados de substitui¸c˜ao
utilizando uma chave previamente acertada entre o emissor e o receptor, que
a utilizava para inverter o processo e decodiﬁcar a mensagem. Para que
fosse eﬁciente, era necess´ario que o n´umero de chaves dispon´ıveis fosse muito
grande, de modo que mesmo conhecendo o processo de substitui¸c˜ao n˜ao fosse
vi´avel para um espi˜ao descobrir a chave por tentativas, mantendo seguro o
conte´udo do texto cifrado. O problema com esse procedimento ´e que emis-
sor e receptor precisavam combinar de antem˜ao qual a chave a ser utilizada.
Al´em disso, para que houvesse m´axima seguran¸ca, essa chave deveria ser
alterada com muita frequˆencia, sendo ideal que fosse trocada a cada mensa-
gem. Com isso chegou-se a um beco sem sa´ıda, pois o problema da troca de
chaves de maneira segura parecia n˜ao ter solu¸c˜ao. A frequˆencia das trocas, a
quantidade de chaves a ser distribu´ıda e as distˆancias entre os destinat´arios
eram os obst´aculos, al´em da inseguran¸ca causada pelo manuseio dessas cha-
ves por terceiros. Durante a segunda guerra mundial os alem˜aes usaram a
m´aquina Enigma nos campos de batalha para codiﬁcar suas comunica¸c˜oes,
transmitindo via r´adio a chave juntamente com a mensagem cifrada. Foi isso
que permitiu que os criptoanalistas poloneses, liderados por Marian Rejewski
(1905-1980) iniciassem a quebra do c´odigo da Enigma. A partir da an´alise
de muitas mensagens interceptadas e da compara¸c˜ao entre elas foi poss´ıvel
descobrir em que parte do texto cifrado se encontrava a chave o que deu in´ıcio
`a quebra do c´odigo. Quando a Polˆonia foi invadida pelas tropas alem˜as, os
poloneses j´a haviam comunicado seus avan¸cos em rela¸c˜ao `a Enigma aos fran-
ceses e ingleses, que dessa forma n˜ao tiveram de come¸car do zero. Em 1939,
os criptoanalistas ingleses instalaram em Bletchley Park, Buckinghamshire,
a Escola de Cifras e C´odigos do Governo, onde trabalharam intensamente na
quebra do c´odigo da Enigma. Foi l´a que o brilhante Alan Turing (1912-1954),
matem´atico e criptoanalista inglˆes, teve a id´eia do que chamou ”m´aquina uni-
versal de Turing” precursora do conceito do computador moderno.

Na segunda metade do s´eculo XX, o desenvolvimento tecnol´ogico,
com o advento do computador e das telecomunica¸c˜oes, acarretou um au-
mento no ﬂuxo de informa¸c˜oes sigilosas entre governos, empresas e pessoas
o que pressionou ainda mais a log´ıstica da distribui¸c˜ao das chaves. A troca
de chaves por meios convencionais, assim como as mensagens, estava su-
jeita a intercepta¸c˜ao. Nessa ´epoca, as chaves eram entregues diretamente
por bancos, governos e militares aos destinat´arios, utilizando mensageiros de

48

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

conﬁan¸ca. Era uma falha de seguran¸ca, pois as chaves podiam cair em m˜aos
indevidas e al´em disso, esse expediente consumia cada vez mais recursos. O
grande problema dos cript´ografos nessa ´epoca era a log´ıstica da distribui¸c˜ao
de chaves, que infelizmente parecia ser insolucion´avel.

A cren¸ca geral era de que o problema da troca de chaves de ma-
neira segura n˜ao tivesse solu¸c˜ao. Foi ent˜ao que, em 1976, os pesquisadores
Whitﬁeld Diﬃe e Martin Hellman publicaram um artigo onde descreveram
um m´etodo pelo qual emissor e receptor podem combinar uma chave utili-
zando um canal inseguro, que mesmo sujeito a intercepta¸c˜ao n˜ao permite a
dedu¸c˜ao da chave por um espi˜ao. O m´etodo de Diﬃe-Hellman mostrou que
o problema da distribui¸c˜ao de chaves podia ser superado e lan¸cou as bases
da criptograﬁa de chave p´ublica, amplamente utilizada nas transa¸c˜oes pela
internet.

Diﬃe e Hellman encontraram na aritm´etica modular a solu¸c˜ao que

buscavam. Quando calculamos valores de uma fun¸c˜ao f (x) usando a aritm´etica
normal, esta fun¸c˜ao pode apresentar um comportamento previs´ıvel (cres-
cente, decrescente, peri´odica, etc.). Agora, se calculamos os mesmos valores
para a fun¸c˜ao modular correspondente a f (x), ou seja, calculamos f (x) mod
m, m ∈ N, m > 1, observamos que, em geral, a fun¸c˜ao modular n˜ao apre-
senta regularidade. Isto signiﬁca que com a aritm´etica normal, conhecendo
f (x) podemos inferir x por tentativas ou usando m´etodos computacionais,
se necess´ario, baseados no comportamento da fun¸c˜ao. O mesmo n˜ao ocorre
com a maioria das chamadas fun¸c˜oes modulares, onde o conhecimento de
f (x) n˜ao ajuda em nada na dedu¸c˜ao de x. Um exemplo disso ´e a fun¸c˜ao ex-
ponencial y = ax. Na tabela 1 a seguir calculamos alguns valores da fun¸c˜ao
exponencial de base a = 3 e na tabela 2 fazemos o mesmo para esta fun¸c˜ao
m´odulo 7.

Aritm´etica Normal

x
f (x) = 3x

1
3

2
9

3
27

4
81

5
243

6
729

Tabela 1

Aritm´etica Modular
1
x
f (x) = 3x mod 7
3

2
2

3
6

4
4

5
5

6
1

Tabela 2

2.2. CRIPTOGRAFIA DE CHAVE P ´UBLICA

49

Podemos observar na tabela 1 que a fun¸c˜ao ´e crescente, ou seja, os valo-
res de f (x) aumentam `a medida que x aumenta. N˜ao ocorre nada semelhante
no caso da fun¸c˜ao modular (tabela 2). Os valores de f (x) neste caso variam
aleatoriamente.

2.2.2 O M´etodo de Diﬃe-Hellman

Considere o conjunto Zp\{0} dos inteiros m´odulo p menos o zero, sendo

p um n´umero primo, que representaremos por Z∗
p:

Z∗

p = {1, . . . , p − 1}.

Este conjunto, com a opera¸c˜ao de multiplica¸c˜ao usual constitui uma
estrutura alg´ebrica denominada grupo, no caso o grupo multiplicativo dos
inteiros m´odulo p. Existem elementos g em Z∗
p para os quais {gi mod
p : i = 1, . . . , p − 1} = Z∗
p, ou seja, elementos que geram o conjunto. Tais ele-
p. Por exemplo, 3 ∈ Z∗
mentos g s˜ao chamados geradores de Z∗
7 ´e um gerador,
pois {3i mod 7 : i = 1, . . . , 6} = Z∗
7, como podemos ver abaixo:

36 = 729 ≡ 1 mod 7;

32 = 9 ≡ 2 mod 7;

31 = 3 mod 7;

34 = 81 ≡ 4 mod 7;

35 = 243 ≡ 5 mod 7;

33 = 27 ≡ 6 mod 7.

Pois bem, suponha que Alice e Bob queiram combinar uma chave
por telefone. Primeiro um liga para o outro e eles escolhem um n´umero primo
p e um gerador g do grupo multiplicativo Z∗
p. Depois cada um faz o seguinte:

1) Alice escolhe um n´umero xA, 1 < xA < p − 1, e calcula yA = gxA
mod p. Depois ela informa o resultado yA para Bob, mantendo em segredo
o valor de xA.

50

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

2) Bob, por sua vez, faz o mesmo escolhendo um n´umero xB, 1 <
xB < p − 1, e calculando yB = gxB mod p. Ele informa apenas o resultado
yB para Alice mantendo secreto o valor de xB.

3) Agora ambos calculam a chave:

Alice toma o valor de yB informado por Bob e faz

(yB)xA mod p = (gxB )xA mod p = gxBxA mod p = K

Bob por sua vez calcula

(yA)xB mod p = (gxA)xB mod p = gxAxB mod p = K

obtendo a mesma chave K.

Por exemplo, Bob liga para Alice e eles combinam usar o primo
p = 7 e o gerador g = 3. Ent˜ao Alice pode escolher, por exemplo, xA = 2 e
Bob, xB = 3. Vejamos:

1) Alice calcula yA = 32 mod 7 = 2 =⇒ yA = 2.

2) Bob calcula yB = 33 mod 7 = 6 =⇒ yB = 6.

Eles voltam a se falar por telefone e trocam os valores de yA = 2 e yB = 6.

3) Agora Alice faz (yB)xA = 62 = 36 mod 7 = 1 e obt´em a chave K = 1.

4) Bob por sua vez calcula (yA)xB = 23 = 8 mod 7 = 1, obtendo a

mesma chave K = 1.

grupo Z∗

Evidentemente, escolhemos o primo p muito grande, de modo que o
p possua muitos elementos x, tais que 1 < x < p − 1.

2.2. CRIPTOGRAFIA DE CHAVE P ´UBLICA

51

Vamos analisar agora o problema da escuta. Caso algu´em inter-
cepte a liga¸c˜ao de Alice e Bob vai ter acesso ao primo p, ao gerador g, a yA e
a yB. Escolhendo p suﬁcientemente grande, o n´umero de possibilidades para
1 < x < p − 1 ´e tamb´em muito elevado. Al´em disso, ´e muito dif´ıcil calcular
a inversa da fun¸c˜ao exponencial m´odulo p (x = logg y mod p), pois como
sabemos a fun¸c˜ao exponencial m´odulo p n˜ao tem comportamento previs´ıvel.
Desse modo, n˜ao ´e poss´ıvel para um espi˜ao determinar xA nem xB e, mesmo
utilizando um canal inseguro, o m´etodo permite a Alice e Bob acertar uma
chave criptogr´aﬁca com seguran¸ca.

52

CAP´ITULO 2. CRIPTOGRAFIA E ARITM ´ETICA MODULAR

Cap´ıtulo 3

Criptograﬁa RSA

3.1

Introdu¸c˜ao

Em 1977 Ronald Rivest, Adi Shamir e Leonard Adleman apresen-
taram `a comunidade cient´ıﬁca o m´etodo que ﬁcaria conhecido como cripto-
graﬁa RSA. A criptograﬁa de chave p´ublica RSA tornou-se a mais utilizada
na internet em transa¸c˜oes comerciais e na codiﬁca¸c˜ao de mensagens que cir-
culam pela rede. O m´etodo se baseia em uma fun¸c˜ao exponencial modular
C(X) = X e mod n. Nesta fun¸c˜ao, X ´e o bloco a ser codiﬁcado (um n´umero
inteiro, obtido ap´os um processo de pr´e-codiﬁca¸c˜ao que consiste na subs-
titui¸c˜ao das letras da mensagem original por n´umeros, encadeados em um
´unico grande n´umero que depois ´e quebrado em blocos cujo valor ´e menor do
que n). O par de n´umeros (n, e) ´e a chave p´ublica do destinat´ario da mensa-
gem, n consiste no produto de dois n´umeros primos p e q muito grandes, da
ordem de 100 d´ıgitos cada enquanto e ´e um expoente escolhido de maneira
que exista o seu inverso d mod (p − 1) · (q − 1). Obviamente, os n´umeros
primos p e q s˜ao de conhecimento exclusivo do usu´ario do RSA, que os uti-
liza para obter o expoente d com o qual decodiﬁca as mensagens que recebe
segundo a f´ormula D(C) = C d mod n. Uma vez obtido o expoente d, os
primos p e q n˜ao s˜ao mais necess´arios, podendo ser descartados. A seguran¸ca
do m´etodo consiste na diﬁculdade de fatorar o produto de n´umeros primos
muito grandes (da ordem de 100 d´ıgitos decimais), mesmo tendo `a disposi¸c˜ao
recursos computacionais. Para se ter uma id´eia, o tempo estimado para a
fatora¸c˜ao do produto de dois primos dessa magnitude supera, em muito, a
idade do universo e s´o poderia ser realizada num tempo aceit´avel por um
computador quˆantico, uma tecnologia que ainda est´a mais no plano te´orico
do que no operacional.

53

54

CAP´ITULO 3. CRIPTOGRAFIA RSA

Uma ressalva deve ser feita, com rela¸c˜ao `a seguran¸ca, no que diz
respeito a mensagens falsas que podem ser enviadas para o usu´ario do RSA.
Como a chave p´ublica (n, e) ´e acess´ıvel a qualquer pessoa, as mensagens
recebidas devem ser veriﬁcadas quanto `a origem. Isto ´e feito utilizando-se
uma assinatura digital. O remetente tamb´em deve possuir uma chave p´ublica
(n(cid:48), e(cid:48)) e uma chave privada d(cid:48), com a qual assina digitalmente a mensagem,
ou seja, o remetente cifra a assinatura digital com sua chave privada d(cid:48), `a
qual somente ele tem acesso, e o destinat´ario decifra a assinatura digital com
a chave p´ublica (n(cid:48), e(cid:48)) do remetente. Procedendo assim, ﬁca garantida a
procedˆencia da mensagem.

3.2 A matem´atica do RSA

O primeiro passo para implementar o m´etodo criptogr´aﬁco RSA ´e a
escolha dos primos p e q. Por quest˜oes de seguran¸ca, ´e preciso que esses pri-
mos sejam grandes, da ordem de 100 d´ıgitos decimais. Isto ´e feito gerando-se
aleatoriamente n´umeros inteiros ´ımpares de 100 d´ıgitos e testando sua pri-
malidade por meios computacionais. Felizmente, a densidade de n´umeros
primos entre os inteiros de 100 d´ıgitos ´e bastante grande e os algoritmos para
teste de primalidade oferecem uma margem de erro muito pequena. Podemos
demonstrar a alta densidade de primos de 100 d´ıgitos decimais a partir do
”Teorema dos N´umeros Primos”que diz que, sendo π(n) o n´umero de inteiros
menores do que n e primos relativos de n (dois inteiros s˜ao primos relativos
quando o m´aximo divisor comum entre eles ´e 1), ent˜ao

π(n) ∼

n
ln n

, quando n −→ ∞

Se n ´e um inteiro com 100 d´ıgitos ent˜ao 1099 ≤ n < 10100, o que

signiﬁca que o n´umero de primos no intervalo acima ´e aproximadamente,

π(10100) − π(1099) =

10100
ln 10100 −

1099
ln 1099 ≈ 4 × 1097

Para se ter uma id´eia da magnitude desse n´umero vamos fazer c´alculos.

A densidade do universo ´e equivalente a aproximadamente 5,9 pr´otons por
metro c´ubico 1 enquanto o raio do universo conhecido ´e atualmente estimado

1http://map.gsfc.nasa.gov/universe/uni matter.html 02/03/2013 23H29min.

3.2. A MATEM ´ATICA DO RSA

55

em aproximadamente 14 bilh˜oes de anos-luz 2. A luz percorre 3 × 108 metros
a cada segundo, o que signiﬁca que o raio do universo, em metros, ´e

(14 × 109) × (60 × 60 × 24 × 365) × (3 × 108) ≈ 1, 3 × 1026

Considerando um universo esf´erico, o seu volume seria

4
3

πr3 =

4
3

π(1, 3 × 1026)3 ≈ 1079 m3

Pois bem, sendo a densidade do universo aproximadamente 6 pr´otons

por m3 ter´ıamos 6 × 1079 ≈ 1080 pr´otons no universo.

Comparando este resultado com o obtido para o n´umero de primos
com 100 d´ıgitos decimais, observamos que o n´umero de primos ´e 1017 vezes
maior. Portanto existe uma quantidade enorme de primos de 100 d´ıgitos
decimais dispon´ıveis. A densidade de primos no intervalo de 1099 a 10100 ´e

4 × 1097 ÷ (10100 − 1099) ≈

4
1000

=

1
250

Para obter primos dessa ordem gera-se aleatoriamente um inteiro
´ımpar com 100 d´ıgitos e testa-se a sua primalidade utilizando recursos com-
putacionais. O algoritmo mais utilizado para testar a primalidade ´e o Miller-
Rabin que retorna se o inteiro ´e ou n˜ao primo com probabilidade de erro de
1/4 se o resultado for positivo para n´umero primo. O que se faz ´e testar v´arias
vezes o n´umero e a cada vez que o algoritmo retorna que ele ´e primo a pro-
babilidade de erro diminui. Para n rodadas, a probabilidade de erro ´e (1/4)n.

De posse dos primos p e q, calculamos n = pq e o valor da fun¸c˜ao φ
de Euler para n, que no caso ´e φ(n) = (p − 1)(q − 1). Testamos at´e obter um
valor e, tal que o mdc [e, φ(n)] = 1. O par de n´umeros (n, e) constituir´a a
chave p´ublica necess´aria para encriptar as mensagens endere¸cadas ao usu´ario
do RSA. Em seguida, calculamos d = e−1 mod φ(n) que ´e a chave privada
necess´aria para decriptar as mensagens recebidas e que deve ser mantida em
sigilo, assim como os primos p e q. Quem quiser mandar uma mensagem
usar´a a chave p´ublica (n, e) da seguinte maneira. Ap´os uma pr´e-codiﬁca¸c˜ao
a mensagem ´e convertida em um ´unico bloco num´erico N = N1N2N3 . . . Nk,
com Ni < n, para i = 1, 2, 3, . . . k (Ni deve ser menor do que n para que
o resultado da decodiﬁca¸c˜ao seja exatamente a mensagem original) ao qual
aplicamos

C(Ni) = N e

i mod n

2http://map.gsfc.nasa.gov/universe/uni expansion.html 03/03/2013 00H09min.

56

CAP´ITULO 3. CRIPTOGRAFIA RSA

A mensagem recebida C(N ) ´e ent˜ao decodiﬁcada fazendo

D[C(Ni)] = C(Ni)d mod n = (N e

i )d mod n = Ni mod n = Ni

Observa¸c˜ao: A pr´e-codiﬁca¸c˜ao de N ´e feita utilizando-se a tabela AS-
CII (American Standard Code for Information Interchange). Esta tabela
´e composta por 256 n´umeros bin´arios de 8 d´ıgitos cada e cont´em as letras
mai´usculas e min´usculas (na base 10, respectivamente de 65 at´e 90 e de 97 a
122), al´em dos caracteres alfab´eticos acentuados, sinais de pontua¸c˜ao, etc.

decimal
56
57
58
59
60
61
62
63
64
65
66

bin´ario
00111000
00111001
00111010
00111011
00111100
00111101
00111110
00111111
01000000
01000001
01000010

hexadecimal
38
39
3A
3B
3C
3D
3E
3F
40
41
42

s´ımbolo
8
9
:
;
<
=
>
?
@
A
B

Uma parte da tabela ASCII.

3.3 Uma Fun¸c˜ao e dois Teoremas Importan-

tes

A quantidade de n´umeros inteiros menores e relativamente primos
de um inteiro a, a > 1, ´e dada por uma fun¸c˜ao chamada fun¸c˜ao ﬁ de Eu-
ler, φ : N∗ −→ N, onde N∗ denota o conjunto dos naturais menos o zero
(N∗ = N \ {0}). Para a, b ∈ N∗ e mdc(a, b) = 1, a fun¸c˜ao φ ´e multiplica-
tiva, ou seja, φ(ab) = φ(a) · φ(b). Sendo p primo, φ(p) = p − 1. Assim, o
n´umero de inteiros menores e relativamente primos de n = pq, p e q primos,
´e φ(n) = (p − 1) · (q − 1).

3.3. UMA FUNC¸ ˜AO E DOIS TEOREMAS IMPORTANTES

57

Teorema 2. Sejam a, b ∈ N∗ e mdc(a, b) = 1. Ent˜ao φ(ab) = φ(a) · φ(b).

Demonstra¸c˜ao. Observe que mdc(c, ab) = 1, se, e somente se, mdc(c, a) = 1
e mdc(c, b) = 1. Portanto, dispondo os n´umeros de 1 a ab na tabela abaixo
com b linhas e a colunas devemos veriﬁcar quais s˜ao co-primos de a e de b.

1
a + 1
2a + 1
...
(b − 1)a + 1

2
a + 2
2a + 2
...
(b − 1)a + 2

3
a + 3
2a + 3
...
(b − 1)a + 3

. . .
. . .
. . .

. . .

a − 1
a + (a − 1)
2a + (a − 1)
...
(b − 1)a + (a − 1)

a
2a
3a
...
ba

O elementos das colunas s˜ao da forma ka + j com 0 ≤ k ≤ b − 1 e
1 ≤ j ≤ a. Se j n˜ao for co-primo de a ent˜ao todos os elementos da coluna j
tamb´em n˜ao s˜ao co-primos de a. Portanto os elementos co-primos de a est˜ao
nas φ(a) colunas restantes.

Como mdc(a, b) = 1, os elementos das colunas j formam um sistema

completo de res´ıduos m´odulo b,

ka + j ≡ k(cid:48)a + j mod b ⇐⇒ ka ≡ k(cid:48)a mod b ⇐⇒ k ≡ k(cid:48) mod b

e portanto, φ(b) deles s˜ao co-primos de b. Logo, o n´umero de elementos co-
primos de a e co-primos de b na tabela ´e φ(a) · φ(b).

Teorema 3 (Fermat). Sejam p um n´umero primo, r e s cˆongruos m´odulo
(p − 1).

1. Se um n´umero inteiro a n˜ao for divis´ıvel por p, ent˜ao

ap−1 ≡ 1 mod p

ar ≡ as mod p

2. Se r > 0 e s > 0 ent˜ao, para todo a ∈ Z

ar ≡ as mod p.

58

CAP´ITULO 3. CRIPTOGRAFIA RSA

Demonstra¸c˜ao. 1. Considere o conjunto Z∗
x ∈ Zp que s˜ao primos com p. Como p n˜ao divide a, se x ∈ Z∗
p ∈ Z∗
injetora e o conjunto imagem ´e um rearranjo de Z∗
produtos

p = {1, 2, . . . , p − 1} dos n´umeros
p, ent˜ao ax mod
p, tal que f (x) = ax mod p ´e
p. Portanto, s˜ao iguais os

p. Isto signiﬁca que a fun¸c˜ao f : Z∗

p −→ Z∗

f (1) × f (2) × . . . × f (p − 1) = 1 × 2 × . . . × (p − 1),

ou seja,

1a × 2a × . . . × (p − 1)a mod p = 1 × 2 × . . . × (p − 1) mod p

Multiplicando ambos os lados pelos inversos m´odulo p de 2 a p − 1, obtemos

ap−1 mod p = 1

=⇒ ap−1 ≡ 1 mod p.

r ≡ s mod (p − 1)

=⇒ r = k(p − 1) + s

Agora

e

ar ≡ ak(p−1)+s ≡ (ap−1)k · as ≡ 1k · as ≡ as mod p

=⇒ ar ≡ as mod p.

2. Se p n˜ao divide a, j´a mostramos que ar ≡ as mod p. Se p divide a, as
potˆencias de a m´odulo p de expoente negativo n˜ao existem (pois a ≡ 0 mod
p) e as potˆencias de a m´odulo p de expoente positivo s˜ao congruentes a zero
m´odulo p, ou seja, s˜ao iguais. Isso prova que ar ≡ as mod p para qualquer a
inteiro.

Teorema 4 (Euler). Sejam n ≥ 2, n ∈ Z , r e s cˆongruos m´odulo φ(n).

1. Se a e n forem primos entre si,

aφ(n) ≡ 1 mod n

ar ≡ as mod n

2. Se n for produto de primos distintos, r > 0 e s > 0, ent˜ao

ar ≡ as mod n, ∀a ∈ Z.

3.3. UMA FUNC¸ ˜AO E DOIS TEOREMAS IMPORTANTES

59

Demonstra¸c˜ao. 1. A demonstra¸c˜ao ´e an´aloga `a do Teorema de Fermat.
n −→ Z∗
Sendo Z∗
n o conjunto dos elementos invers´ıveis de Zn, a fun¸c˜ao f : Z∗
n,
tal que f (x) = ax mod n ´e injetora e o conjunto {ax mod n : x ∈ Z∗
n} ´e igual
a Z∗

n. Desse modo, s˜ao iguais os produtos

ou seja,





(cid:89)

x ∈ Z∗
n







ax

 mod n =



(cid:89)

x ∈ Z∗
n

x

 mod n

aφ(n)





(cid:89)

x ∈ Z∗
n







x

 mod n =



(cid:89)

x

 mod n

x ∈ Z∗
n

Multiplicando ambos os lados da igualdade acima pelos inversos x−1 mod n
de cada x ∈ Z∗

n, obtemos

aφ(n) mod n = 1

=⇒ aφ(n) ≡ 1 mod n

2. Se n = p1p2 . . . pk, onde pi (cid:54)= pj, ∀ i, j com 1 ≤ i, j ≤ k

φ(n) = φ(p1)φ(p2) . . . φ(pk) = (p1 − 1)(p2 − 1) . . . (pk − 1)

Como r ≡ s mod φ(n), ent˜ao r ≡ s mod (pi − 1), i = 1, 2, ..., k. Pelo
teorema de Fermat, r ≡ s mod (pi − 1) implica ar ≡ as mod pi, ou seja,
pi divide ar − as, para i = 1, 2, ..., k o que signiﬁca que n divide ar − as e
consequentemente ar ≡ as mod n.

A fun¸c˜ao de Euler, bem como o teorema de Fermat e o teorema
de Euler s˜ao muito importantes. O teorema de Fermat facilita o c´alculo de
potˆencias m´odulo n, n inteiro positivo, e o teorema de Euler (generaliza¸c˜ao
do teorema de Fermat) est´a no centro do m´etodo criptogr´aﬁco RSA.

60

CAP´ITULO 3. CRIPTOGRAFIA RSA

3.4 Como Funciona a Criptograﬁa RSA

Neste ponto, podemos entender como tudo funciona:

1) Primeiro escolhemos dois primos p e q suﬁcientemente grandes.

2) Depois fazemos n = pq e calculamos k = φ(n) = (p − 1)(q − 1).

3) Escolhemos ao acaso um inteiro e, 1 < e < k e veriﬁcamos
se mdc(e, k) = 1, o que signiﬁca que e tem inverso m´odulo k.
Caso contr´ario, escolhemos outro e at´e encontrar um que seja in-
vert´ıvel m´odulo k.

4) Calculamos d = e−1mod k. A chave secreta utilizada pelo
usu´ario do RSA para decifrar as mensagens que recebe ´e um in-
teiro positivo d, tal que ed ≡ 1 mod k, onde k = φ(n). Ou seja,
d ´e o inverso de e m´odulo k. Tomando e, tal que mdc(e, k) = 1,
existem d e b inteiros, tais que

de + bk = 1 =⇒ de mod k + bk mod k = 1 =⇒

de mod k = 1 =⇒ d = e−1 mod k.

Observa¸c˜ao: Os inteiros d e b acima s˜ao determinados aplicando
o algoritmo estendido de Euclides a e e k e fazendo substitui¸c˜oes
sucessivas nas igualdades at´e obter a equa¸c˜ao de + bk = 1. Para
valores elevados de e e k, como ocorre na criptograﬁa RSA, usa-
mos um programa para realizar o algoritmo estendido de Euclides.
Devido `a velocidade de processamento e do algoritmo, o resultado
´e obtido em segundos.

5) Divulgamos a chave p´ublica (n, e) na internet e mantemos em
sigilo a chave privada d e tamb´em os primos p e q, que podem at´e
ser esquecidos.

Vejamos como utilizamos o RSA para cifrar e decifrar:

Para cifrar:

1) Transformamos a mensagem em blocos num´ericos (menores
do que n, para que a decifragem retorne o bloco cifrado e n˜ao

3.4. COMO FUNCIONA A CRIPTOGRAFIA RSA

61

outro congruente a ele m´odulo n).

2) Ciframos um bloco M calculando c(M ) = M e mod n.

Para decifrar:

1) O destinat´ario, de posse da chave privada d, calcula para cada
bloco c(M ), d[c(M )] = [c(M )]d mod n e fazendo isso obt´em a
mensagem original.

d[c(M )] = [c(M )]d mod n = (M e)d mod n = M ed mod n ≡

M s·φ(n)+1 mod n = [(M φ(n))s · M 1] mod n ≡

(1s · M ) mod n = M mod n = M .

3.4.1 Algoritmo Estendido de Euclides

Lema 1 (Euclides). Sejam a, b, n ∈ N tais que a < na < b. Ent˜ao mdc(a, b) =
mdc(a, b − na).

Demonstra¸c˜ao. Seja d = mdc(a, b − na). Como d|a e d|(b − na), segue que
d|b = b − na + na. Portanto d ´e divisor comum de a e b. Seja c um divisor
comum de a e b, ent˜ao c ´e divisor comum de a e b − na , logo, c|d o que prova
que d = mdc(a, b).

Algoritmo Estendido de Euclides

Dados a, b ∈ N, podemos supor a ≤ b. Ent˜ao, se a = 1, ou a = b, ou

a|b, o mdc(a, b) = a. Supondo que 1 < a < b e a (cid:54) | b, podemos escrever

b = aq1 + r1,

com r1 < a.

Se r1|a, pelo lema de Euclides r1 = mdc(a, r1) = mdc(a, b − aq1) =

mdc(a, b). Caso contr´ario, fazemos a divis˜ao de a por r1, obtendo

a = r1q2 + r2,

com r2 < r1.

Novamente, se r2|r1, ent˜ao

r2 = mdc(r1, r2) = mdc(r1, a − r1q2) = mdc(r1, a) = mdc(a, r1) =

62

CAP´ITULO 3. CRIPTOGRAFIA RSA

mdc(a, b − aq1) = mdc(a, b).

Caso contr´ario, fazemos a divis˜ao de r1 por r2, obtendo

r1 = q3r2 + r3,

com r3 < r2.

Repetimos o processo at´e obter o mdc(a, b). Pela Propriedade da
Boa Ordem, a sequˆencia dos naturais a > r1 > r2 > r3 > . . . possui m´ınimo,
ou seja, para algum n, temos que rn|rn−1 e o mdc(a, b) = rn. A partir das
equa¸c˜oes obtidas no algoritmo estendido de Euclides pode-se obter inteiros
x e y, tais que

ax + by = mdc(a, b)

A existˆencia de x e y que satisfazem a equa¸c˜ao ´e garantida pelo
Teorema de B´ezout, cuja demonstra¸c˜ao pode ser encontrada na referˆencia
bibliogr´aﬁca [4].

Exemplo

Obter o inverso de 18, m´odulo 1247.

Solu¸c˜ao

(1)

1247 = 69 × 18 + 5
(2)
18 = 3 × 5 + 3
(3)
5 = 1 × 3 + 2
(4)
3 = 1 × 2 + 1
2 = 2 × 1 + 0 =⇒ mdc(1247, 18) = 1

De (4): 3 − 2 = 1

(5)

De (3): 2 = 5 − 3, substituindo em (5): 3 − (5 − 3) = 1 =⇒
2 × 3 − 5 = 1

(6)

De (2): 3 = 18 − 3 × 5, substituindo em (6): 2 × (18 − 3 × 5) − 5 = 1 =⇒
2 × 18 − 7 × 5 = 1

(7)

De (1): 5 = 1247−69×18, substituindo em (7): 2×18−7×(1247−69×18) = 1

=⇒ (2 + 7 × 69) × 18 − 7 × 1247 = 485 × 18 − 7 × 1247 = 1

3.5. EXEMPLIFICANDO O USO DA RSA

63

Aplicando m´odulo, temos

(485 × 18) mod 1247 − (7 × 1247) mod 1247 = 1 =⇒ (485 × 18) mod 1247 = 1

=⇒ 18−1 mod 1247 = 485

Exemplo

Calcular d, tal que 19d = 1 mod 120 (observe que mdc(19, 120) = 1).

Solu¸c˜ao

Aplicando o algoritmo estendido de Euclides obtemos as igualdades:

120 = 19 × 6 + 6 =⇒ 6 = 120 − 19 × 6 (1)

19 = 6 × 3 + 1 =⇒ 19 − 6 × 3 = 1 (2)

Substituindo (1) em (2),

19 − (120 − 19 × 6) × 3 = 1 =⇒ 19 × 19 − 120 × 3 = 1 (3)

Agora aplicamos m´odulo em (3) para achar o inverso de 19 mod 120.

(19 × 19) mod 120 − (120 × 3) mod 120 = 1 =⇒

(19 × 19) mod 120 = 1 =⇒ 19−1 mod 120 = 19.

Ou seja, 19 ´e seu pr´oprio inverso m´odulo 120.

3.5 Exempliﬁcando o uso da RSA

Como exemplo do uso da criptograﬁa RSA, vamos codiﬁcar e de-
codiﬁcar a palavra ”enigma”. Para ﬁns did´aticos e para facilitar as contas
utilizaremos n´umeros primos bem pequenos. Tomando p = 11 e q = 13,
o valor de n ser´a n = 11 · 13 = 143. Associamos a cada letra do alfabeto

64

CAP´ITULO 3. CRIPTOGRAFIA RSA

um n´umero inteiro a partir de 10 (a = 10, b = 11, c = 12 e assim por di-
ante). Neste caso, ﬁcamos com ”enigma”= 142318162210, que dividiremos
em blocos. O tamanho de cada bloco a ser cifrado, assim como o tamanho
de cada bloco a ser decifrado ´e estabelecido previamente. Para garantir que
cada bloco a ser cifrado seja menor do que n, tomamos os blocos com um
algarismo decimal a menos do que n. No caso do exemplo, como n = 143 tem
trˆes algarismos decimais, dividimos a mensagem em blocos com dois d´ıgitos
apenas. Ficamos ent˜ao com os blocos 14-23-18-16-22-10. Estes blocos depois
de cifrados podem ter de um a trˆes algarismos, ent˜ao convencionamos que os
blocos cifrados ter˜ao todos o tamanho de n, no caso, trˆes algarismos. Aqueles
com dois ou um algarismo apenas ser˜ao completados com zeros `a esquerda,
que ser˜ao desprezados quando for feita a decifra¸c˜ao.

Para cifrar cada bloco X usamos a f´ormula C(X) = X e mod 143.
Para isso, escolhemos o expoente e = 7 (co-primo de φ(n) = 10 · 12 = 120,
logo possui inverso m´odulo φ(n)). A chave p´ublica ´e ent˜ao (n, e) = (143, 7).

Primeiro, escrevemos o expoente e = 7 na base 2:

7 = 1112 = 22 + 21 + 20 = 4 + 2 + 1

Ciframos os dois primeiros blocos, os demais s˜ao cifrados de modo
an´alogo:

C(14) = 147 mod 143 = (144+2+1) mod 143 =

(144 × 142 × 14) mod 143 =

(144 mod 143 × 142 mod 143 × 14 mod 143) mod 143

Mas,

142 mod 143 = 196 mod 143 = 53

144 mod 143 = (142)2 mod 143 = (142 mod 143)2 mod 143 =

532 mod 143 = 2809 mod 143 = 92

3.5. EXEMPLIFICANDO O USO DA RSA

65

Ent˜ao,

C(14) = (92 × 53 × 14) mod 143 =

[(92 × 53) mod 143 × 14] mod 143 =

[(4876 mod 143) × 14] mod 143 =

(14 × 14) mod 143 = 196 mod 143 = 53

C(14) = 53;

C(23) = 237 mod 143 = (234+2+1) mod 143 =

(234 × 232 × 23) mod 143 =

(234 mod 143 × 232 mod 143 × 23 mod 143) mod 143

Mas,

232 mod 143 = 529 mod 143 = 100

234 mod 143 = (232)2 mod 143 = (232 mod 143)2 mod 143 =

1002 mod 143 = 10000 mod 143 = 133

Ent˜ao,

C(23) = (133 × 100 × 23) mod 143 =

[(133 × 100) mod 143 × 23] mod 143 =

[(13300 mod 143) × 23] mod 143 =

(1 × 23) mod 143 = 23 mod 143 = 23

C(23) = 23.

O resultado, cifrando-se todos os blocos, ´e 53-23-138-3-22-10.

66

CAP´ITULO 3. CRIPTOGRAFIA RSA

De acordo com a conven¸c˜ao estabelecida para o tamanho dos blocos,
acrescentamos zeros `a esquerda aos blocos com menos de trˆes algarismos de-
cimais e a mensagem transmitida ´e 053-023-138-003-022-010.

Vejamos agora como decifrar a mensagem. Primeiramente, calcu-
lamos d, tal que 7d = 1 mod k, k = φ(143), usando o algoritmo estendido de
Euclides.

e = 7

k = φ(143) = 120

120 = 17 × 7 + 1 =⇒ −17 × 7 + 1 × 120 = 1 =⇒

(−17 × 7) mod 120 + (1 × 120) mod 120 = 1 =⇒

(−17 × 7) mod 120 = 1 =⇒ 7−1 mod 120 = −17 ≡ 103 =⇒

d = 103

A fun¸c˜ao modular que decodiﬁca ´e, ent˜ao, D(C) = C 103 mod 143.

Para decifrar, primeiro escrevemos o expoente d = 103 na base 2:

103 = 11001112 = 26 + 25 + 22 + 21 + 20 = 64 + 32 + 4 + 2 + 1

A mensagem recebida ´e quebrada em blocos com a mesma quanti-
dade de d´ıgitos de n (trˆes, no exemplo) e os zeros `a esquerda nestes blocos
s˜ao desprezados. A seguir, deciframos os dois primeiros blocos de 053-023-
138-003-022-010, os demais s˜ao decifrados de maneira an´aloga:

D(53) = 53103 mod 143 = (5364+32+4+2+1) mod 143 =

(5364 × 5332 × 534 × 532 × 53) mod 143 =

[(5364 mod 143) × (5332 mod 143) × (534 mod 143) × (532 mod 143) ×

(53 mod 143)] mod 143

532 mod 143 = 2809 mod 143 = 92

3.5. EXEMPLIFICANDO O USO DA RSA

67

534 mod 143 = (532)2 mod 143 = (532 mod 143)2 mod 143 =

922 mod 143 = 8464 mod 143 = 27

538 mod 143 = (534)2 mod 143 = (534 mod 143)2 mod 143 =

272 mod 143 = 729 mod 143 = 14

5316 mod 143 = (538)2 mod 143 = (538 mod 143)2 mod 143 =

142 mod 143 = 196 mod 143 = 53

5332 mod 143 = (5316)2 mod 143 = (5316 mod 143)2 mod 143 =

532 mod 143 = 2809 mod 143 = 92

5364 mod 143 = (5332)2 mod 143 = (5332 mod 143)2 mod 143 =

922 mod 143 = 8464 mod 143 = 27

D(53) = (27 × 92 × 27 × 92 × 53) mod 143 =⇒

D(53) = [(27 × 92) mod 143 × (27 × 92)mod 143 × 53] mod 143 =⇒

D(53) = [(2484 mod 143) × (2484 mod 143) × 53] mod 143 =⇒

D(53) = (53 × 53 × 53) mod 143 =

D(53) = [(53 × 53) mod 143 × 53] mod 143 =⇒

D(53) = [(2809 mod 143) × 53] mod 143 =⇒

D(53) = (92 × 53) mod 143 =⇒

D(53) = 4876 mod 143 = 14

D(53) = 14;

68

CAP´ITULO 3. CRIPTOGRAFIA RSA

D(23) = 23103 mod 143 = (2364+32+4+2+1) mod 143 =

(2364 × 2332 × 234 × 232 × 23) mod 143 =

[(2364 mod 143) × (2332 mod 143) × (234 mod 143) × (232 mod 143) ×

(23 mod 143)] mod 143

232 mod 143 = 529 mod 143 = 100

234 mod 143 = (232)2 mod 143 = (232 mod 143)2 mod 143 =

1002 mod 143 = 10000 mod 143 = 133

238 mod 143 = (234)2 mod 143 = (234 mod 143)2 mod 143 =

1332 mod 143 = 17689 mod 143 = 100

2316 mod 143 = (238)2 mod 143 = (238 mod 143)2 mod 143 =

1002 mod 143 = 10000 mod 143 = 133

2332 mod 143 = (2316)2 mod 143 = (2316 mod 143)2 mod 143 =

1332 mod 143 = 17689 mod 143 = 100

2364 mod 143 = (2332)2 mod 143 = (2332 mod 143)2 mod 143 =

1002 mod 143 = 10000 mod 143 = 133

D(23) = (133 × 100 × 133 × 100 × 23) mod 143 =⇒

D(23) = [(133 × 100) mod 143 × (133 × 100) mod 143 × 23] mod 143 =⇒

D(23) = [(13300 mod 143) × (13300 mod 143) × 23] mod 143 =⇒

D(23) = (1 × 1 × 23) mod 143 = 23 mod 143 = 23

D(23) = 23.

3.5. EXEMPLIFICANDO O USO DA RSA

69

Com a decifra¸c˜ao dos blocos 053-023-138-003-022-010 obtemos 14-
23-18-16-22-10, que agora podemos converter novamente para texto desfa-
zendo o que foi feito na etapa de pr´e-codiﬁca¸c˜ao, ou seja, juntamos tudo
(142318162210), e substituimos cada dois algarismos a partir da esquerda
pela letra correspondente na seguinte conven¸c˜ao: a=10, b=11, c=12, . . . ,
z=35. O resultado ﬁnal, como esper´avamos, ´e a palavra ”enigma”.

70

CAP´ITULO 3. CRIPTOGRAFIA RSA

Cap´ıtulo 4

Aplica¸c˜oes da Aritm´etica
Modular

Vamos supor que vocˆe deseja fazer um dep´osito em dinheiro no caixa
eletrˆonico do seu banco. Para isso ´e necess´ario que vocˆe informe os dados
da conta-corrente, isto ´e, o n´umero da agˆencia com d´ıgito e o n´umero da
conta-corrente com o d´ıgito veriﬁcador. Pois bem, a fun¸c˜ao do d´ıgito de
veriﬁca¸c˜ao ´e evitar erros. Se vocˆe trocar um n´umero na conta-corrente ou na
agˆencia o d´ıgito respectivo n˜ao vai conferir e o caixa eletrˆonico n˜ao aceitar´a o
dep´osito. Isto far´a com que vocˆe veriﬁque novamente os dados e evitar´a que
o dep´osito entre na conta de outra pessoa causando transtornos para vocˆe e
para o banco.

Em muitos documentos (RG, CPF, CNPJ, T´ıtulo de Eleitor, etc.)
os d´ıgitos de veriﬁca¸c˜ao est˜ao presentes e quando preenchemos um formul´ario
eletrˆonico (um cadastro on-line por exemplo), esses d´ıgitos s˜ao checados para
evitar poss´ıveis erros de digita¸c˜ao. O c´alculo do d´ıgito nestes casos ´e feito
utilizando a aritm´etica modular.

4.1 C´alculo do d´ıgito do CPF e do CNPJ

Vamos calcular os d´ıgitos veriﬁcadores de um CPF (Cadastro de

Pessoas F´ısicas) hipot´etico 234.400.562−??.

Devemos, primeiramente, multiplicar cada algarismo da direita para

a esquerda respectivamente por 9, 8, 7, 6, 5, 4, 3, 2, 1 e 0.

71

72

CAP´ITULO 4. APLICAC¸ ˜OES DA ARITM ´ETICA MODULAR

5

3

4

0

4

6

2
0
2
× × × × × × × × ×
9
5
1
↓
↓
↓
18
0
2

4
↓
16

7
↓
35

8
↓
48

3
↓
12

6
↓
0

2
↓
6

Depois somamos os resultados e calculamos o total m´odulo 11 (se o

resultado for 10 consideramos 0 como d´ıgito).

2 + 6 + 12 + 16 + 0 + 0 + 35 + 48 + 18 = 137 −→ 137 mod 11 = 5

O primeiro d´ıgito ´e, portanto, igual a 5.

Para calcular o segundo d´ıgito, inclu´ımos o primeiro d´ıgito junto

com os demais algarimos do CPF e repetimos o procedimento acima.

6

5

0

4

3

0

4

2
5
× × × × × × × × × ×
9
0
↓
↓
45
0

6
↓
30

8
↓
16

7
↓
42

3
↓
12

2
↓
8

4
↓
0

5
↓
0

1
↓
3

2

Depois somamos os resultados e calculamos o total m´odulo 11.

0 + 3 + 8 + 12 + 0 + 0 + 30 + 42 + 16 + 45 = 156 −→ 156 mod 11 = 2

O segundo d´ıgito ´e 2 e o CPF completo com os dois d´ıgitos veri-
ﬁcadores ´e 234.400.562−52. Os d´ıgitos de veriﬁca¸c˜ao calculados tomando-se
o resto da divis˜ao por 11 s˜ao conhecidos como DV m´odulo 11.

Os d´ıgitos do CNPJ (Cadastro Nacional de Pessoas Jur´ıdicas) tamb´em

s˜ao calculados m´odulo 11. Vamos calcular os d´ıgitos do CNPJ hipot´etico
22.345.293/0001−??.

Multiplicamos da direita para a esquerda cada algarismo respecti-
vamente por 9, 8, 7, 6, 5, 4, 3, 2, 9, 8, 7, 6 e 5. E procedemos de maneira
an´aloga ao que foi feito para o CPF.

2

2

5

3

9

3

4

2
1
× × × × × × × × × × × ×
9
6
↓
↓
9
12

5
↓
15

9
↓
36

2
↓
10

4
↓
36

8
↓
24

7
↓
14

8
↓
0

6
↓
0

7
↓
0

3
↓
6

0

0

0

4.2. C ´ALCULO DO D´IGITO DO RG

73

12 + 14 + 24 + 36 + 10 + 6 + 36 + 15 + 0 + 0 + 0 + 9 = 162 −→ 162 mod 11 = 8

Agora inclu´ımos o primeiro d´ıgito calculado com os demais e re-

petimos o procedimento para encontrar o segundo d´ıgito

3

3

2

2

4

5

2
8
9
× × × × × × × × × × × × ×
9
3
5
↓
↓
↓
72
27
10

4
↓
12

6
↓
12

9
↓
45

7
↓
21

8
↓
32

2
↓
4

5
↓
0

7
↓
0

8
↓
8

6
↓
0

0

0

0

1

10 + 12 + 21 + 32 + 45 + 4 + 27 + 12 + 0 + 0 + 0 + 8 + 72 = 243 −→

243 mod 11 = 1

O CNPJ com DV ´e 22.345.293/0001−81.

4.2 C´alculo do d´ıgito do RG

As carteiras de identidade emitidas no estado de S˜ao Paulo possuem
d´ıgito veriﬁcador tamb´em m´odulo 11. Como exemplo, vamos calcular o DV
do RG 11.966.756−?.

Multiplicamos da direita para a esquerda cada algarismo respecti-
vamente por 2, 3, 4, 5, 6, 7, 8 e 9. A seguir, somamos os resultados e
calculamos o total m´odulo 11.

9

7

6

6

1

5

1
6
× × × × × × × ×
2
9
↓
↓
12
9

4
↓
28

6
↓
36

3
↓
15

7
↓
63

5
↓
30

8
↓
8

9 + 8 + 63 + 36 + 30 + 28 + 15 + 12 = 201 −→ 201 mod 11 = 3

O RG com d´ıgito ´e 11.966.756−3.

74

CAP´ITULO 4. APLICAC¸ ˜OES DA ARITM ´ETICA MODULAR

No caso das contas-correntes e boletos de cobran¸ca, os bancos
utilizam o m´odulo 11 ou o m´odulo 10 (com varia¸c˜oes, como por exemplo
come¸car da esquerda para a direita ou utilizar X no lugar do d´ıgito 0). N˜ao
h´a um padr˜ao e o algoritmo varia de banco para banco.

Exerc´ıcio 1. Calcule os d´ıgitos veriﬁcadores do seu CPF utilizando os pro-
cedimentos descritos acima.

4.3 C´alculo do d´ıgito ISBN-13

Outro importante d´ıgito de veriﬁca¸c˜ao ´e o do ISBN-13 (International
Standard Book Number ), n´umero padr˜ao internacional de livros. Vejamos
como o d´ıgito ISBN-13 ´e calculado tomando como exemplo o livro ”The Code
Book” do renomado autor Simon Singh. O c´odigo sem o d´ıgito de veriﬁca¸c˜ao
´e ISBN 978-85-01-05598-?(onde colocamos o s´ımbolo de interroga¸c˜ao no lugar
do d´ıgito veriﬁcador).

0

8

0

1

7

5

8

9
8
× × × × × × × × × × × ×
3
1
↓
↓
24
9

3
↓
15

3
↓
21

3
↓
24

1
↓
5

3
↓
0

1
↓
1

1
↓
8

1
↓
9

1
↓
5

3
↓
0

9

5

5

9 + 21 + 8 + 24 + 5 + 0 + 1 + 0 + 5 + 15 + 9 + 24 = 121

Agora calculamos 121 mod 10 = 1. Por ﬁm, o d´ıgito veriﬁcador
do ISBN-13 ´e obtido subtraindo o resultado de 10. No caso, 10 − 1 = 9 ´e o
d´ıgito. Portanto o ISBN-13 do livro de Singh ´e ISBN 978-85-01-05598-9, o
que ´e poss´ıvel conﬁrmar olhando em um exemplar.

4.4. CRIT ´ERIOS DE DIVISIBILIDADE

75

4.4 Crit´erios de Divisibilidade

Usando artim´etica modular podemos deduzir os crit´erios de divisi-

bilidade. Vejamos como isto ´e feito.

4.4.1 Divisibilidade por 3

Sabemos que um n´umero inteiro α ´e divis´ıvel por 3 quando a soma
de seus algarimos for divis´ıvel por 3. Por exemplo, 915 ´e divis´ıvel por 3 por-
que a soma 9 + 1 + 5 de seus algarismos ´e 15, que ´e divis´ıvel por 3. Vejamos
como chegar a essa conclus˜ao usando a aritm´etica modular.

Seja α = anan−1 . . . a1a0 (onde os ai s˜ao os algarimos do sistema
decimal de numera¸c˜ao), um n´umero inteiro qualquer. Se α for divis´ıvel por
3, ent˜ao α satisfaz a equa¸c˜ao α mod 3 = 0. Usando a expans˜ao decimal de
α, temos

α mod 3 = 0 ⇐⇒ (anan−1 . . . a1a0) mod 3 = 0 ⇐⇒

(an10n + an−110n−1 + . . . + a110 + a0) mod 3 = 0 ⇐⇒

[an(999 . . . 9 + 1) + an−1(99 . . . 9 + 1) + . . . + a1(9 + 1) + a0]
mod 3 = 0 ⇐⇒

[(999 . . . 9an + 99 . . . 9an−1 + . . . + 9a1) + (an + an−1 + . . . + a1 + a0)]
mod 3 = 0 ⇐⇒

[(999 . . . 9an + 99 . . . 9an−1 + . . . + 9a1) mod 3 + (an + an−1 + . . . +
a1 + a0) mod 3] mod 3 = 0 ⇐⇒

(0 + 0 + . . . + 0) + (an + an−1 + . . . + a1 + a0) mod 3 = 0 ⇐⇒

(an + an−1 + . . . + a1 + a0) mod 3 = 0

Portanto, α mod 3 = 0 ⇐⇒ (an +an−1 +. . .+a1 +a0) mod 3 = 0.

76

CAP´ITULO 4. APLICAC¸ ˜OES DA ARITM ´ETICA MODULAR

4.4.2 Divisibilidade por 4

A divisibilidade de um n´umero por 4 se veriﬁca quando os dois
´ultimos algarimos desse n´umero `a direita (algarismo das dezenas e algarismo
das unidades) formam um n´umero divis´ıvel por 4. Por exemplo, 12928 ´e
divis´ıvel por 4 porque 28 ´e divis´ıvel por 4 (28 = 4 · 7). Assim como 1700
tamb´em o ´e, pois 00 ´e divis´ıvel por 4.

Novamente, seja α = anan−1 . . . a1a0 um n´umero inteiro qualquer.

Vamos resolver α mod 4 = 0, usando a expans˜ao decimal de α,

α mod 4 = 0 ⇐⇒ (anan−1 . . . a1a0) mod 4 = 0 ⇐⇒

(an10n + an−110n−1 + . . . + a110 + a0) mod 4 = 0 ⇐⇒

[(an10n−2+an−110n−3+. . .+a2)×100+a110+a0] mod 4 = 0 ⇐⇒

[(an10n−2 + an−110n−3 + . . . + a2) × 100] mod 4 +
(a110 + a0) mod 4 = 0 ⇐⇒

(an10n−2 + an−110n−3 + . . . + a2) mod 4×100 mod 4 +
(a110 + a0) mod 4= 0 ⇐⇒

Como 100 mod 4 = 0,

[(an10n−2 + an−110n−3 + . . . + a2) mod 4]×0+
(a110 + a0) mod 4= 0 ⇐⇒

(a110 + a0) mod 4 = 0

Portanto

α mod 4 = 0 ⇐⇒ (a110 + a0) mod 4 = 0 ⇐⇒

(a1a0) mod 4 = 0

Desse modo, justiﬁcamos o crit´erio de divisibilidade por 4.

4.4. CRIT ´ERIOS DE DIVISIBILIDADE

77

4.4.3 Divisibilidade por 5

Procedemos de maneira semelhante aos casos anteriores para justi-

ﬁcar o crit´erio de divisibilidade por 5. Seja α = anan−1 . . . a1a0,

α mod 5 = 0 ⇐⇒ (anan−1 . . . a1a0) mod 5 = 0 ⇐⇒

(an10n + an−110n−1 + . . . + a110 + a0) mod 5 = 0 ⇐⇒

[(an10n−1 +an−110n−2 +. . .+a210+a1)×10+a0] mod 5 = 0 ⇐⇒

[(an10n−1 + an−110n−2 + . . . + a210 + a1) × 10] mod 5 +
a0 mod 5 = 0 ⇐⇒

(an10n−1 + an−110n−2 + . . . + a210 + a1) mod 5 × 10 mod 5 +
a0 mod 5 = 0 ⇐⇒

Como 10 mod 5 = 0,

(an10n−1 + an−110n−2 + . . . + a210 + a1) mod 5 × 0 +
a0 mod 5 = 0 ⇐⇒

a0 mod 5 = 0

Portanto,

α mod 5 = 0 ⇐⇒ a0 mod 5 = 0

Desse modo, temos

α mod 5 = 0 ⇐⇒ a0 mod 5 = 0 ⇐⇒ a0 = 5 ou a0 = 0

Justiﬁca-se assim o crit´erio de divisibilidade por 5.

78

CAP´ITULO 4. APLICAC¸ ˜OES DA ARITM ´ETICA MODULAR

4.4.4 Divisibilidade por 6

Sabemos que um n´umero ´e divis´ıvel por 6 quando ´e par e divis´ıvel
por 3. Esse ´e o crit´erio de divisibilidade por 6. Mas podemos veriﬁcar a
divisibilidade por 6 de outra forma. Observe que

10 mod 6 = 4;

102 mod 6 = 100 mod 6 = 4;

103 mod 6 = (102 · 10) mod 6 = (100 mod 6) · (10 mod 6) =

4 · 4 mod 6 = 16 mod 6 = 4

Observamos que 10i ≡ 4 mod 6, para i ∈ N. Ent˜ao

α = (an10n + an−110n−1 + . . . + a110 + a0) mod 6 = 0 ⇐⇒

(4an + 4an−1 + . . . + 4a1 + a0) mod 6 = 0

Logo, α ´e divis´ıvel por 6 se 4 · (an + an−1 + . . . + a1) + a0 tamb´em

for divis´ıvel por 6.

4.4.5 Divisibilidade por 11

Novamente, seja α = anan−1 . . . a1a0, ent˜ao

α = an10n + an−110n−1 + . . . + a110 + a0

Como 10 ≡ −1 mod 11 =⇒ 10k ≡ (−1)k mod 11, ent˜ao

α = an10n + an−110n−1 + . . . + a110 + a0 ≡

[an(−1)n + an−1(−1)n−1 + . . . + a1(−1) + a0] mod 11, ou seja,

α ≡ 0 mod 11 ⇐⇒

an(−1)n + an−1(−1)n−1 + . . . + a1(−1) + a0 ≡ 0 mod 11

4.4. CRIT ´ERIOS DE DIVISIBILIDADE

79

Sendo assim, se n for de ordem par, por exemplo, α ser´a divis´ıvel

por onze se a soma a seguir for divis´ıvel por 11

an − an−1 + an−2 + . . . + a2 − a1 + a0

Justiﬁcando a regra que diz que um n´umero ´e divis´ıvel por 11 se a
soma dos algarismos de ordem ´ımpar subtra´ıda da soma dos algarismos de
ordem par for divis´ıvel por 11.

4.4.6 Divisibilidade por 7, 11 e 13

Fatorando 1001, obtemos 1001 = 7 · 11 · 13. Isto signiﬁca que

1001 ≡ 0 mod [7, 11, 13] =⇒ 1000 ≡ −1 mod [7, 11, 13] =⇒

103 ≡ −1 mod [7, 11, 13];

106 = (103)2 ≡ (−1)2 ≡ 1 mod [7, 11, 13];

109 = (103)3 ≡ (−1)3 ≡ −1 mod [7, 11, 13];
...

Agora,

α = anan−1 . . . a2a1a0 =

an10n + an−110n−1 + . . . + a2102 + a110 + a0 =

a2a1a0 + a5a4a3 × 103 + a8a7a6 × 106 + . . . ≡

a2a1a0 − a5a4a3 + a8a7a6 + . . .

Ent˜ao o n´umero α = anan−1 . . . a2a1a0 ser´a divis´ıvel por 7, 11 e 13

se o resultado a seguir:

a2a1a0 − a5a4a3 + a8a7a6 + . . .

tamb´em for divis´ıvel por 7, 11 e 13.

80

CAP´ITULO 4. APLICAC¸ ˜OES DA ARITM ´ETICA MODULAR

4.4.7 Outros crit´erios de Divisibilidade

Para outros crit´erios de divisibilidade procedemos de maneira an´aloga,
utilizando a expans˜ao decimal de α. O crit´erio de divisibilidade por 9 ´e ob-
tido de maneira semelhante ao que foi feito para o 3, ou seja,

α mod 9 = 0 ⇐⇒ (an + an−1 + . . . + a1 + a0) mod 9 = 0.

O crit´erio de divisibilidade por 8 ´e semelhante ao que foi feito para

o 4, sendo que

α mod 8 = 0 ⇐⇒ (a2102 + a110 + a0) mod 8 = 0 ⇐⇒

(a2a1a0) mod 8 = 0.

O crit´erios de divisibilidade por 2 e por 10 seguem o modelo da di-

visibilidade por 5, sendo que

α mod 2 = 0 ⇐⇒ a0 mod 2 = 0

e

α mod 10 = 0 ⇐⇒ a0 mod 10 = 0.

4.5. CONSIDERAC¸ ˜OES FINAIS

81

4.5 Considera¸c˜oes Finais

O objetivo do presente trabalho foi apresentar a aritm´etica modular
de uma forma que pudesse ser objeto de estudo no ensino m´edio da educa¸c˜ao
b´asica, ou seja, relacionada a aplica¸c˜oes que pudessem despertar o interesse
dos alunos desse segmento. Para tanto nos valemos da criptograﬁa, pela aura
de mist´erio em que est´a envolvida e pela sua importˆancia em v´arios momen-
tos da hist´oria. A criptograﬁa sempre esteve presente nas rela¸c˜oes comercias
e diplom´aticas entre os pa´ıses, com destaque para os grandes conﬂitos mun-
diais (as grandes guerras e a guerra fria) onde a seguran¸ca das comunica¸c˜oes
foi de vital importˆancia.

Ainda hoje esse ramo da matem´atica ´e largamente utilizado para ga-
rantir a privacidade das comunica¸c˜oes no mundo globalizado, especialmente
na internet com as chamadas cifras de chave p´ublica.

Na abordagem do assunto, utilizamos exemplos de cifras de f´acil
manipula¸c˜ao pelos alunos, como as cifras de C´esar, de Vigen`ere e de Hill
(que envolve matrizes) procurando mostrar a matem´atica por detr´as de cada
uma delas. Apresentamos tamb´em o m´etodo de Diﬃe-Hellman que revolu-
cionou a criptograﬁa ao permitir a troca de chaves criptogr´aﬁcas com segu-
ran¸ca. A criptograﬁa RSA, por ser de maior complexidade, pode constituir
um exerc´ıcio exemplar que o professor usar´a em sala de aula para ilustrar a
atualidade do tema e despertar o interesse pela pesquisa.

Na proposta para o ensino m´edio, quisemos mostrar exemplos de pro-
blemas envolvendo aritm´etica modular e cuja resolu¸c˜ao est´a ao alcance dos
alunos. N˜ao esgotamos as possibidades nos exemplos dados, havendo espa¸co
para a cria¸c˜ao de in´umeros outros que certamente enriquecer˜ao o conte´udo.
Exploramos tamb´em a rela¸c˜ao da aritm´etica modular com as regras de di-
visibilidade e outras aplica¸c˜oes como o c´alculo de d´ıgitos de veriﬁca¸c˜ao de
documentos.

Atividades pr´aticas como a cifragem e a decifragem de mensagens
entre grupos de alunos utilizando os m´etodos apresentados aqui, o c´alculo do
d´ıgito de veriﬁca¸c˜ao das c´edulas de identidade dos alunos, a implementa¸c˜ao
de algoritmo para c´alculo de potˆencias de expoente muito grande, usando os
recursos da sala de inform´atica, entre outras, contribuiriam para aumentar a
participa¸c˜ao e o interesse pelas aulas.

82

CAP´ITULO 4. APLICAC¸ ˜OES DA ARITM ´ETICA MODULAR

Referˆencias Bibliogr´aﬁcas

[1] Antonio Cˆandido Faleiros: Criptograﬁa, SBMAC, S˜ao Carlos (2011)

[2] Abramo Hefez: Elementos de Aritm´etica, SBM, Rio de Janeiro (2011)

[3] Abramo Hefez: Inicia¸c˜ao `a Aritm´etica, OBMEP, Niter´oi (2009)

[4] C´esar Polcino Milies N´umeros, Uma Introdu¸c˜ao `a Matem´atica, Edusp,

S˜ao Paulo (2000)

[5] Ilydio P. S´a: Aritm´etica Modular e Algumas de suas Aplica¸c˜oes, in

http://magiadamatematica.com

[6] Simon Singh: O Livro dos C´odigos, Record, S˜ao Paulo (2007)

[7] http://map.gsfc.nasa.gov/universe

83

