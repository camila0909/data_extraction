SERVIÇO PÚBLICO FEDERAL

UNIVERSIDADE FEDERAL DO PARÁ

INSTITUTO DE CIÊNCIAS EXATAS E NATURAIS

MESTRADO PROFISSIONAL EM MATEMÁTICA EM REDE NACIONAL

EDISON GARRETA DE ANDRADE

CRIPTOGRAFIA COM CURVAS

ELÍPTICAS

BELÉM

2016

SERVIÇO PÚBLICO FEDERAL

UNIVERSIDADE FEDERAL DO PARÁ

INSTITUTO DE CIÊNCIAS EXATAS E NATURAIS

MESTRADO PROFISSIONAL EM MATEMÁTICA EM REDE NACIONAL

EDISON GARRETA DE ANDRADE

CRIPTOGRAFIA COM CURVAS

ELÍPTICAS

Dissertação apresentada como requisito parcial para

obtenção do grau de mestre em matemática pelo

Programa de Mestrado Proﬁssional em Matemática

(PROFMAT) da Universidade Federal do Pará

Orientador: Profa. Dra. Irene Castro Pereira

BELÉM

2016

À minha família, por sempre acreditar em mim.

AGRADECIMENTOS

Ao grande Pai celestial, por ser tão bondoso comigo desde sempre.

A meus pais, pelo apoio incondicional, desde que decidi sair de Igarapé-Açu para Belém pra

fazer a graduação.

A toda minha família, em especial a minha irmã Kleide, por ser uma inspiração desde a

infância e indiretamente me levar para a docência. Jamais conseguirei retribuir todos os

ensinamentos recebidos.

Aos amigos espirituais, pelas valorosas contribuições nos momentos difíceis e pela inspiração

quanto ao tema.

A Paulo Sérgio, pelo apoio, compreensão e companheirismo ao longo do curso.

Aos amigos e colegas de trabalho, em especial as amigas Emília e Cris Brasil, pelas cobranças

e motivações.

A meus alunos do ensino fundamental da Escola Municipal Francisco Espinheiro Gomes,

do município de Castanhal – Pará, pela curiosidade em saber porque eu ainda continuo

estudando e pelo constante interesse em meu trabalho, mesmo não compreendendo-o.

A meus amigos da época do BNB, pela torcida e pelas energias positivas.

A Universidade Federal do Pará, ao Programa de Mestrado Proﬁssional em Matemática –

PROFMAT e a CAPES, pela oportunidade de aprimoramento.

Aos colegas de curso, em especial Jhon e Serginho, por se preocuparem mais comigo do que

eu mesmo.

A todos os professores do curso.

A minha orientadora Professora Dra. Irene Castro Pereira, pela disponibilidade, pelos con-

selhos ao longo da realização deste trabalho e por me repassar parte de seu conhecimento.

"A felicidade não está na partida e nem na chegada, mas na travessia."

Guimarães Rosa

Resumo

Neste trabalho estudamos um criptossistema de chave pública que utiliza curvas elíp-

ticas a partir de uma adaptação do Problema do Logaritmo Discreto. Este sistema se utiliza

da diﬁculdade de resolver o Problema do Logaritmo Discreto para garantir segurança à

transmissão de dados, principalmente quando o mesmo é aplicado a curvas elípticas sobre

corpos ﬁnitos. São apresentadas algumas sugestões de atividades para aplicação em turmas

de ensino médio utilizando o tema deste trabalho como motivação.

Palavras-chave: criptograﬁa, curvas elípticas, problema do logaritmo discreto.

Abstract

In this work we study a public-key cryptosystem that uses elliptic curves through an

adaptation of the Discrete Logarithm Problem. This system makes use of the fact that it’s

not easy to solve the Discrete Logarithm Problem to guarantee security in data transmission,

especially when applied to elliptic curves over ﬁnite ﬁelds. We show some activities to be

applied to high school classes using the subject of this work as motivation.

Keywords: criptography, elliptic curves, discrete logarithm problem.

Sumário

INTRODUÇÃO

1 CONCEITOS ESSENCIAIS

1.1 Números Inteiros

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.2 Grupos, Anéis e Corpos

. . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.3 Criptograﬁa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.3.1 Criptograﬁa de Chave Secreta . . . . . . . . . . . . . . . . . . . . . .

1.3.2 Criptograﬁa de Chave Pública . . . . . . . . . . . . . . . . . . . . . .

2 PROBLEMA DO LOGARITMO DISCRETO

2.1 Protocolo Diﬃe-Hellman . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2.2 Criptossistema de Chave Pública ElGamal

. . . . . . . . . . . . . . . . . . .

3 CURVAS ELÍPTICAS

3.1 Equação de Weierstrass Simpliﬁcada . . . . . . . . . . . . . . . . . . . . . .

3.2 Soma de pontos em curvas elípticas . . . . . . . . . . . . . . . . . . . . . . .

3.2.1

Soma algébrica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.3 Curvas elípticas sobre o corpo Zp

. . . . . . . . . . . . . . . . . . . . . . . .

3.4 O problema do logaritmo discreto elíptico

. . . . . . . . . . . . . . . . . . .

4 CRIPTOGRAFIA COM CURVAS ELÍPTICAS

4.1 Protocolo Diﬃe-Hellman aplicado a curvas elípticas sobre Zp . . . . . . . . .
4.2 Criptossistema ElGamal aplicado a curvas elípticas sobre Zp

. . . . . . . . .

5 SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

5.1 Noção Geral de Criptograﬁa . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

8

10

10

15

17

19

19

21

24

26

31

31

35

39

45

48

51

51

52

56

56

5.2 Determinar interseções entre uma reta e uma curva . . . . . . . . . . . . . .
5.3 Múltiplos de Pontos de Curvas sobre Zp

. . . . . . . . . . . . . . . . . . . .

5.4 Simulação do Criptossistema ElGamal aplicado a curvas elípticas

. . . . . .

CONSIDERAÇÕES FINAIS

Referências Bibliográﬁcas

Apêndice A – Programa para calcular o logaritmo discreto

Anexo A – Demonstração do Teorema 1.1: Teorema Fundamental da Arit-

mética

Anexo B – Demonstração do Teorema 1.3: Pequeno Teorema de Fermat

Anexo C – Demonstração do Teorema 1.5: Teorema de Euler

60

62

65

66

67

69

71

73

74

INTRODUÇÃO

Neste trabalho abordamos um método de criptograﬁa envolvendo curvas elípti-

cas, inicialmente proposto por Koblitz e Miller. Criptograﬁa é a arte de esconder a escrita,

na tentativa de impedir que pessoas não autorizadas tenham acesso ao conteúdo de uma

mensagem. Os algoritmos de criptograﬁa podem ser classiﬁcados de acordo com a chave

de encriptação: criptograﬁa de chave secreta ou simétrica – quando apenas os sujeitos en-

volvidos na comunicação possuem conhecimento da chave – e criptograﬁa de chave pública –

quando a chave de encriptação é de conhecimento público.

Diversos algoritmos de criptograﬁa já foram propostos até hoje, cada um com van-

tagens e desvantagens, como por exemplo: Cifra de César, Protocolo Diﬃe-Helman, RSA e

Criptograﬁa com Curvas Elípticas (ECC). Este último tem demonstrado ser mais eﬁciente

do que o RSA quanto a espaço de memória utilizado e tempo de processamento, fornecendo

relativamente o mesmo nível de segurança [9]. Entretanto, o RSA continua sendo o algoritmo

mais utilizado devido a poucos estudos sobre ECC, até mesmo envolvendo suas possíveis vul-

nerabilidades.

No capítulo 1, abordamos conceitos essenciais para a compreensão deste trabalho,

a saber, principais resultados da Teoria dos Números, alguns conceitos introdutórios de Ál-

gebra Abstrata e noções básicas de Criptograﬁa.

No capítulo 2, conceituamos logaritmo discreto e deﬁnimos o Problema do Loga-

ritmo Discreto (PLD). Mostramos como a diﬁculdade de resolução do PLD contribui para a

segurança da informação e apresentamos dois algoritmos criptográﬁcos que utilizam direta-

mente o PLD como forma de garantir segurança: protocolo Diﬃe-Hellman e criptossistema

8

9

ElGamal.

No capítulo 3, deﬁnimos curvas elípticas a partir de uma modiﬁcação na equação

de Weierstrass e a operação de soma sobre dois pontos de uma curva, tanto na forma geo-

métrica quanto na forma algébrica. Esta operação é essencial para discretizar a curva,
adaptando-a para uma estrutura sobre um corpo Zp.

No capítulo 4, adaptamos o PLD para a estrutura de curvas elípticas, deste modo

podemos aplicar algoritmos de criptograﬁa a esta estrutura.

No capítulo 5, sugerimos atividades para o ensino médio, com base no tema abor-

dado neste trabalho, desde o uso de noções básicas de criptograﬁa como recurso educacional,

até uma simulação de um algoritmo criptográﬁco envolvendo curvas elípticas.

Capítulo 1

CONCEITOS ESSENCIAIS

Antes de discutir curvas elípticas e métodos de criptograﬁa, vamos, inicialmente,

revisar alguns resultados da Teoria dos Números, bem como a deﬁnição de grupo e conceitos

de criptograﬁa, essenciais para a compreensão deste trabalho.

1.1 Números Inteiros

O conjunto de todos os números inteiros é representado por Z. Sejam a, b, c ∈ Z, a

soma e a multiplicação de dois inteiros quaisquer gozam das seguintes propriedades:

A1. Propriedade Associativa da Adição: a + (b + c) = (a + b) + c.

A2. Propriedade Comutativa da Adição: a + b = b + a.

A3. Existência do Elemento Neutro Aditivo: existe um único 0 ∈ Z tal que a + 0 = a.

A4. Existência do Elemento Oposto Aditivo: para todo a existe um −a tal que a+(−a) = 0.

M1. Propriedade Associativa da Multiplicação: a(bc) = (ab)c.

M2. Propriedade Comutativa da Multiplicação: ab = ba.

M3. Existência do Elemento Neutro da Multiplicação: existe um único 1 ∈ Z tal que

1.a = a.

M4. Propriedade Cancelativa da Multiplicação: se ab = ac com a (cid:54)= 0, então b = c.

10

CAPÍTULO 1. CONCEITOS ESSENCIAIS

11

D1. Propriedade Distributiva: a(b + c) = ab + ac.

Deﬁnição 1.1.1. Sejam a, b ∈ Z, com b (cid:54)= 0. Dizemos que b divide a se existe um inteiro q

tal que a = bq. Escrevemos

b | a

Dizemos que b é um divisor de a. Caso não exista nenhum inteiro q tal que a = bq,

diz-se que b não divide a e representa-se b (cid:45) a.

Deﬁnição 1.1.2 (Números Primos e Compostos). Um inteiro a > 1 é dito primo se os

únicos divisores positivos de a são 1 e o próprio a. Dizemos que a é um número composto

se a não é primo.

Com estas deﬁnições, podemos enunciar um importante resultado da Teoria dos

Números.

Teorema 1.1 (Teorema Fundamental da Aritmética). Todo número inteiro positivo maior

que 1 pode ser escrito de maneira única como o produto de números primos, a menos da

ordem dos fatores.

A demonstração deste teorema pode ser consultada no anexo A.

(cid:3)

Teorema 1.2 (Divisão Inteira). Sejam a, b ∈ Z, com b (cid:54)= 0. Existem inteiros q e r únicos

tais que a = bq + r, com 0 ≤ r < |b|.

Demonstração:

Vejamos, primeiramente, o caso em que b > 0 e a qualquer.

Consideremos a ≥ 0. Seja S o conjunto de todos os inteiros não negativos n tais que

a − bn é não negativo. Deste modo, 0 ∈ S, pois a − b.0 = a ≥ 0, logo, S (cid:54)= ∅. Temos também

que S é limitado, pois para todo n > a/b, temos a − bn < 0. Seja q o elemento máximo de

S. Tomando r = a − bq, temos r < b, caso contrário q + 1 também estaria em S. Logo,

existem inteiros q e r tais que a = bq + r, com 0 ≤ r < b.

Para o caso a < 0, podemos, pelo resultado acima, encontrar q(cid:48) e r(cid:48) tais que

CAPÍTULO 1. CONCEITOS ESSENCIAIS

12

|a| = bq(cid:48) + r(cid:48) e 0 ≤ r(cid:48) < b

Como a < 0, temos |a| = −a

Se r(cid:48) = 0:

−|a| = −(bq(cid:48) + 0)

a = b(−q(cid:48)) + 0

logo, q = −q(cid:48) e r = 0 satisfazem as condições.

Se r(cid:48) > 0:

−|a| = −(bq(cid:48) + r(cid:48))

a = b(−q(cid:48)) − r(cid:48) = b(−q(cid:48)) + (−r(cid:48))

logo, q = −q(cid:48) e r = −r(cid:48) satisfazem as condições

Vejamos, agora, o caso b < 0. Pela parte anterior, para qualquer inteiro a, con-

seguimos encontrar q(cid:48) e r(cid:48) tais que

a = |b|q(cid:48) + r(cid:48) e 0 ≤ r(cid:48) < |b|

Como b < 0, temos que |b| = −b, logo,

a = |b|q(cid:48) + r(cid:48) = (−b)q(cid:48) + r(cid:48) = b(−q(cid:48)) + r(cid:48)

.

Os inteiros q = −q(cid:48) e r = r(cid:48) satisfazem as condições do enunciado do teorema. Deste

modo, sempre é possível encontrar q e r nas condições descritas.

Vejamos, agora, a unicidade. Sejam a e b tais

Temos que

a = bq + r

e

a = bq(cid:48) + r(cid:48)

bq + r = bq(cid:48) + r(cid:48)

(q − q(cid:48))b = r(cid:48) − r

Suponhamos que r(cid:48) ≥ r. Como r(cid:48) < |b| e r < |b|, concluímos que r(cid:48) − r < |b|, logo:

CAPÍTULO 1. CONCEITOS ESSENCIAIS

13

(q − q(cid:48))b < |b|

0 ≤ |q − q(cid:48)|.|b| < |b|

aplicando a propriedade cancelativa da multiplicação, obtemos:

0 ≤ |q − q(cid:48)| < 1

Como q e q(cid:48) são inteiros, conclui-se que |q − q(cid:48)| = 0, logo, q = q(cid:48). Substituindo em

bq + r = bq(cid:48) + r(cid:48), encontramos r = r(cid:48). Portanto, os inteiros q e r são únicos.

(cid:3)

Deﬁnição 1.1.3. Sejam a e b inteiros, com b (cid:54)= 0, tais que a = bq + r, com q e r inteiros e

0 ≤ r < |b|. Os inteiro q e r são denominados, respectivamente, quociente e resto da divisão

de a por b.

Deﬁnição 1.1.4 (Congruência). Seja m (cid:54)= 0 um inteiro ﬁxo. Dois inteiros a e b são

congruentes módulo m se m divide a diferença a − b, ou seja, m | (a − b). Escrevemos

a ≡ b ( mod m)

Proposição 1.1. Seja m (cid:54)= 0 um inteiro ﬁxo. Dois inteiros a e b são congruentes módulo

m se, e somente se, o resto da divisão de a por m é igual ao resto da divisão de b por m.

Demonstração:

Sejam

Então:

Logo,

a = mq1 + r1, com 0 ≤ r1 < |m|

b = mq2 + r2,

com 0 ≤ r2 < |m|

a − b = m(q1 − q2) + (r1 − r2)

m | (a − b), se e somente se m | (r1 − r2)

CAPÍTULO 1. CONCEITOS ESSENCIAIS

14

Como 0 ≤ |r1 − r2| < m, temos que m | |r1 − r2| se e somente se |r1 − r2| = 0, ou

seja, se e somente se r1 = r2.

Logo, a ≡ b (mod m) se e somente se r1 = r2.

(cid:3)

Deﬁnição 1.1.5 (Sistema Completo de Resíduos). O conjunto dos inteiros Zm = {r1, r2, . . . , rm}

é um sistema completo de resíduos módulo m se:

(i) ri (cid:54)≡ rjmódulo m para i (cid:54)= j

(ii) ∀n ∈ Z, existe um ri tal que n ≡ ri (mod m)

Alguns exemplos de sistemas completos de resíduos módulo 5 são:

{0, 1, 2, 3, 4}

{5, 6, 7, 8, 9}

{31, 47, −1, 15, 23}

Se p é primo, Zp = {0, 1, 2, . . . , p − 1} é um sistema completo de resíduos. Isto é

facilmente veriﬁcável, pois p é relativamente primo a qualquer inteiro positivo menor que p.

Teorema 1.3 (Pequeno Teorema de Fermat). Sejam p primo e a um inteiro. Se p (cid:45) a, então

ap−1 ≡ 1 (mod p).

A demonstração deste teorema pode ser vista no anexo B.

(cid:3)

Corolário 1.1. Se p é um primo e a é um inteiro positivo, então ap ≡ a (mod p).

Demonstração

Temos que analisar dois casos: se p | a e se p (cid:45) a.

Se p | a, então

p | a(ap−1 − 1) ⇔ p | (ap − a)

portanto, ap ≡ a (mod p).

Se p (cid:45) a, pelo teorema 1.3, p | (ap−1 − 1) e, portanto, p | a(ap−1 − 1) ⇔ p | (ap − a)

CAPÍTULO 1. CONCEITOS ESSENCIAIS

Logo, em ambos os casos, ap ≡ a (mod p).

15

(cid:3)

Deﬁnição 1.1.6 (Função φ de Euler). Para cada inteiro n ≥ 1 indicaremos por φ(n) o

número de inteiros positivos, menores ou iguais a n, que são relativamente primos com n.

A função assim deﬁnida chama-se função φ de Euler.

Deﬁnição 1.1.7. Sistema reduzido de resíduos módulo m é um conjunto com φ(m) inteiros

r1, r2, . . . , rφ(m), tais que cada elemento do conjunto é relativamente primo com m e se i (cid:54)= j,

então ri (cid:54)≡ rj mod m.

Teorema 1.4. Seja a um inteiro positivo tal que mdc(a, m) = 1. Se r1, r2, . . . , rφ(m) é um

conjunto reduzido de resíduos módulo m, então ar1, ar2, . . . , arφ(m) também o é.

Ideia da Demonstração

Cada um dos φ(m) números é relativamente primo com m (pois cada fator comum

de ari deveria dividir ri e m). Além disso, cada par é incongruente. Para uma demonstração

mais completa, ver [10].

(cid:3)

Teorema 1.5 (Teorema de Euler). Sejam a, m ∈ Z com m ≥ 1, tais que mdc(a, m) = 1,

então

aφ(m) ≡ 1 ( mod m)

Para demonstração, ver anexo C

(cid:3)

1.2 Grupos, Anéis e Corpos

Deﬁnição 1.2.1. Um grupo (G, ∗) é um conjunto G com uma operação binária ∗ deﬁnida

sobre G, de tal forma que as seguintes propriedades sejam válidas:

P1. A operação ∗ é associativa, isto é, ∀a, b, c ∈ G temos a ∗ (b ∗ c) = (a ∗ b) ∗ c.

CAPÍTULO 1. CONCEITOS ESSENCIAIS

16

P2. Existe um elemento e ∈ G, chamado elemento neutro, tal que ∀a ∈ G temos a ∗ e =

e ∗ a = a.

P3. Para cada elemento a ∈ G existe um elemento a−1 ∈ G, chamado elemento inverso,

tal que a ∗ a−1 = a−1 ∗ a = e.

Se a operação ∗ for comutativa, ou seja, ∀a, b ∈ G : a ∗ b = b ∗ a, o grupo é chamado

grupo comutativo ou grupo abeliano.

Deﬁnição 1.2.2. Seja p um número primo. Chamamos de grupo multiplicativo Z∗

p ao con-

junto

p = {n ∈ Z|0 < n < p}
Z∗

munido da operação de multiplicação.

Um exemplo de grupo multiplicativo é Z∗
7:

Z∗

7 = {1, 2, 3, 4, 5, 6}

Se existe um elemento g ∈ G tal que ∀a ∈ G, ∃j ∈ Z tal que gj = a, dizemos que

(G, ∗) é um grupo cíclico e g é um gerador de (G, ∗).

Por exemplo, 3 é um gerador de Z∗

7, pois:

31 ≡ 3 ( mod 7)

32 ≡ 2 ( mod 7)

33 ≡ 6 ( mod 7)

34 ≡ 4 ( mod 7)

35 ≡ 5 ( mod 7)

36 ≡ 1 ( mod 7)

Deﬁnição 1.2.3. Um conjunto não-vazio A é chamado anel se em A estão deﬁnidas duas

operações + e ∗, tais que, ∀a, b ∈ A, temos:

• a + b ∈ A

• a + b = b + a

CAPÍTULO 1. CONCEITOS ESSENCIAIS

17

• (a + b) + c = a + (b + c)

• ∃e ∈ A tal que a + e = a, ∀a ∈ R

• ∃ − a ∈ A tal que a + (−a) = e

• a ∗ b ∈ A

• a ∗ (b ∗ c) = (a ∗ b) ∗ c

• a ∗ (b + c) = a ∗ b + a ∗ c

• (b + c) ∗ a = b ∗ a + c ∗ a

Se além de todas estas propriedades a operação ∗ for comutativa, ou seja, a ∗ b = b ∗ a,

dizemos que R é um anel comutativo.

Deﬁnição 1.2.4. Seja K um anel comutativo com unidade1. Se ∀x ∈ K, com x (cid:54)= 0, ∃y ∈ K

tal que x ∗ y = y ∗ x = 1, dizemos que K é um corpo.

Segundo GONÇALVES [5], um corpo é um anel comutativo no qual cada elemento

não nulo possui inverso multiplicativo.

Dizemos que um corpo é ﬁnito quando o mesmo possui uma quantidade ﬁnita de

elementos.

Deﬁnição 1.2.5. Seja p um número primo. O conjunto Zp, formado pelos inteiros não

negativos menores que p,

Zp = {0, 1, 2, . . . , p − 1}

e para o qual estão deﬁnidas as operações de adição e multiplicação é um corpo ﬁnito.

1.3 Criptograﬁa

Criptograﬁa é a arte e ciência de cifrar a escrita, ou seja, torná-la ininteligível. Se-

gundo TERADA [15], o objetivo principal da criptograﬁa é "esconder informações sigilosas

de qualquer pessoa desautorizada a lê-las, isto é, de qualquer pessoa que não conheça a

1isto é, existe elemento neutro para a operação ∗

CAPÍTULO 1. CONCEITOS ESSENCIAIS

18

chamada chave secreta de criptograﬁa". De forma mais geral, STINSON [14] diz que a crip-

tograﬁa objetiva permitir a comunicação entre duas pessoas, por meio de um canal inseguro,

de tal forma que uma terceira pessoa (um intruso) não consiga compreender a mensagem.

O conteúdo da comunicação, que neste trabalho será referenciado como mensagem, pode ser

um texto, dados numéricos, um arquivo, ou qualquer outro tipo de conteúdo.

Deﬁnição 1.3.1 (Chave de codiﬁcação). Chamamos de chave à informação necessária para

cifrar e decifrar uma mensagem.

No escopo deste trabalho, uma chave pode ser um inteiro ou uma n-upla de inteiros.

Para encriptar uma mensagem é necessário, primeiramente, que os sujeitos envolvidos

entrem em acordo quanto ao sistema de criptograﬁa, também chamado criptossistema, que

empregarão.

Deﬁnição 1.3.2 (Criptossistema). Criptossistema é uma quíntupla (P, C, K, E, D) na qual

1. P é um conjunto ﬁnito de possíveis textos legíveis;

2. C é um conjunto ﬁnito de possíveis textos cifrados;

3. K é um conjunto ﬁnito com todas as possíveis chaves de codiﬁcação;

4. E é um conjunto com todas as regras de encriptação ou codiﬁcação de um texto legível;

5. D é um conjunto com todas as regras de decodiﬁcação de um texto cifrado.

Ao escolher o criptossistema utilizado na encriptação da mensagem, já se determina

como a mensagem será cifrada pelo remetente e quais procedimentos o destinatário deverá

realizar para decodiﬁcar a mensagem cifrada recebida, podendo, desta forma, ler a mensagem

original.

Empregando a notação da deﬁnição 1.3.2, temos que para cada chave K ∈ K, existe uma

regra ou função de codiﬁcação EK ∈ E, EK : P → C e uma correspondente regra de decodi-

ﬁcação DK ∈ D, DK : C → P tais que

DK(EK(x)) = x

CAPÍTULO 1. CONCEITOS ESSENCIAIS

19

para qualquer x ∈ P.2

Os criptossistemas são classiﬁcados de acordo com o tipo de chave utilizada, podendo

a mesma ser secreta ou pública.

1.3.1 Criptograﬁa de Chave Secreta

Quando um emissor deseja encriptar uma mensagem e enviá-la a um único receptor

e pretende que somente este consiga decodiﬁcá-la, é intuitivo que se deseje compartilhar

uma chave secreta K, ou seja, a chave utilizada pelo emissor para codiﬁcar a mensagem é

a mesma utilizada pelo receptor para decodiﬁcá-la. Por este motivo, é também chamado

de criptograﬁa de chave simétrica ou compartilhada. É considerado pouco seguro, pois é

necessário que a chave de codiﬁcação também seja compartilhada por um canal que é dese-

javelmente seguro, mas está sujeito a interceptação de intrusos. Deste modo, para que uma

pessoa não autorizada decifrasse a mensagem, seria necessário apenas ter posse da chave

utilizada e do texto cifrado, pois neste caso DK é facilmente determinável a partir de EK.

Para diminuir o risco de quebra de código, os criptossistemas de chave secreta costu-

mam realizar permutações de blocos de textos da mensagem original, ou mesmo alterações

na própria chave de encriptação para gerar subchaves. Alguns exemplos de sistemas de

criptograﬁa de chave secreta são: Data Encryption Standard (DES), International Data

Encryption Algorithm (IDEA) e Secur and Fast Encryption Routine (SAFER K-64). Na

seção 2.1 será visto um protocolo para melhorar a segurança no compartilhamento de chaves

secretas.

1.3.2 Criptograﬁa de Chave Pública

Para resolver o problema de enviar uma chave secreta sem que a mesma seja inter-

ceptada por intrusos (o que implicaria quebra de código), faz-se necessário um sistema no

qual a mensagem original continue intacta mesmo que um estranho tenha conhecimento da

chave empregada. Ou seja, deseja-se que caso EK seja conhecido, seja difícil determinar DK.

Deste modo, EK pode até mesmo ser divulgado, pois a diﬁculdade de computar DK garante

2DK é a função inversa de EK

CAPÍTULO 1. CONCEITOS ESSENCIAIS

20

a segurança. Por este motivo este sistema é chamado de criptograﬁa de chave pública.

Neste sistema, cada usuário possui um par de chaves (S, P ), com S, P ∈ K. S é sua

chave secreta e P sua chave pública. Devido a chaves diferentes serem utilizadas durante

o processo de codiﬁcação/decodiﬁcação, também chamamos este sistema de criptograﬁa de

chave assimétrica.

Alguns exemplos de sistema de criptograﬁa de chave pública são: Algoritmo RSA,

Algoritmo Rabin e Criptograﬁa com Curvas Elípticas.

Capítulo 2

PROBLEMA DO LOGARITMO

DISCRETO

Diversos sistemas de criptograﬁa de chave pública são baseados na diﬁculdade de

resolver o Problema do Logaritmo Discreto, entre eles o objeto de estudo deste trabalho,

criptograﬁa com curvas elípticas.

Sejam (G, ×) um grupo multiplicativo e α, β ∈ G. Pretendemos encontrar um inteiro

x tal que

αx = β

O inteiro x denotado por logα β é chamado de logaritmo discreto de β.
De acordo com STINSON [14], determinar o logaritmo discreto em Zp é considerado
um problema intratável1 quando p possui no mínimo 150 algarismos. Por este motivo,
trataremos o logaritmo discreto limitado a Zp.

Seja p primo e seja a ∈ Z com a (cid:54)≡ 0 (mod p). Suponhamos que para cada inteiro b,

com b (cid:54)≡ 0 (mod p), exista um inteiro x tal que

ax ≡ b ( mod p)

O Problema do Logaritmo Discreto consiste em encontrar o inteiro x para cada b.

1"Certos problemas computacionais são solúveis em princípio, mas as soluções requerem tanto tempo ou

espaço que elas não podem ser usadas na prática. Tais problemas são chamados intratáveis". (SIPSER,

2007. pg 355)[12]

21

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

22

Proposição 2.1. Se existir x ∈ Z tal que ax ≡ b (mod p), então esta congruência possui

inﬁnitas soluções em Z.

Demonstração:

Seja x uma solução para a congruência. Pelo teorema 1.3 (P.T.F.), temos que

ap−1 ≡ 1 ( mod p)

Deste modo, temos:

ax.ap−1 ≡ b.1 ( mod p) ⇒ ax+(p−1) ≡ b ( mod p)

Ou seja, x + (p − 1) é uma solução da congruência. De modo geral, temos que

x + k(p − 1) é solução da congruência ∀k ∈ Z. De fato:

ax+k(p−1) ≡ ax.ak(p−1) ≡ ax.(ap−1)k ≡ b.1k ≡ b ( mod p).

Logo, a congruência possui inﬁnitas soluções inteiras.

(cid:3)

Para evitar uma multiplicidade de soluções, restringiremos o expoente x ao corpo Zp.

Proposição 2.2. Dado um inteiro ﬁxo a (cid:54)= 0, o problema do logaritmo discreto ax ≡ b
(mod p) possui solução em Zp para qualquer b ∈ Zp, com b (cid:54)≡ 0 (mod p), se, e somente se,
a é um gerador do grupo multiplicativo Z∗
p.

Demonstração:

Considere que ax ≡ b (mod p) possui solução em Zp para todo inteiro b. Isto signiﬁca
que, qualquer que seja b ∈ Zp, existe um x ∈ Zp tal que ax ≡ b (mod p), logo, a é um gerador
de Z∗
p.

Agora, considere que a é um gerador de Z∗

p. Cada elemento de Zp é congruente a
alguma potência de a, portanto, ∀b ∈ Zp existe x ∈ Zp tal que ax ≡ b (mod p), logo, o

problema do logaritmo discreto possui solução.

(cid:3)

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

23

Vejamos um exemplo.

Exemplo 2.1. Calcular x = log7 9 em Z11.

Solução:

Veriﬁcamos, primeiramente, que 7 é um gerador do grupo multiplicativo Z∗

11. De

fato, temos:

71 ≡ 7 ( mod 11)

72 ≡ 5 ( mod 11)

73 ≡ 2 ( mod 11)

74 ≡ 3 ( mod 11)

75 ≡ 10 ( mod 11)

76 ≡ 4 ( mod 11)

77 ≡ 6 ( mod 11)

78 ≡ 9 ( mod 11)

79 ≡ 8 ( mod 11)

710 ≡ 1 ( mod 11)

(2.1)

Logo, pela proposição 2.2, o logaritmo possui solução. Resolvendo o logaritmo, temos:

x = log7 9 ⇔ 7x ≡ 9 ( mod 11)

Como se pode ver em (2.1), 9 ≡ 78 (mod 11), portanto, x = 8.

(cid:3)

Vejamos um exemplo mais elaborado.

Exemplo 2.2. O número p = 87557 é primo e podemos veriﬁcar que 3 é gerador de Z∗

87557.

Calcule o logaritmo discreto de 27634.

Solução:

Desejamos calcular x = log3 27634 em Z87557. O método óbvio seria calcular todas as

potências

31, 32, 33, ..., 387556 ( mod 87557)

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

24

para encontrarmos algum potência de 3 congruente a 27634. Fazer este calculo manualmente

é inviável, pois demanda muito tempo, mas utilizando um computador2 encontramos que

324890 ≡ 27634 ( mod 87557)

Logo, temos em Z87557, log3 27634 = 24890.

(cid:3)

Neste exemplo foram utilizados valores baixos, o que torna o problema de fácil resolu-

ção via computador. Entretanto, quando o primo p e o gerador a de Z∗

p são convenientemente

escolhidos (sobretudo com p possuindo uma grande quantidade de algarismos), a resolução

torna-se difícil até mesmo para um computador. Esta diﬁculdade inspirou Diﬃe e Hellman

a criarem um protocolo de encriptação baseado no problema do logaritmo discreto, que

veremos na próxima seção.

2.1 Protocolo Diﬃe-Hellman

O protocolo Diﬃe-Hellman, publicado em 1976 por W. Diﬃe e M. E. Hellman [4],

propõe um modelo que combina criptograﬁa simétrica ao problema do logaritmo discreto

para realizar a troca de chaves. O protocolo consiste em realizar a troca de chave para crip-

tograﬁa simétrica por um canal inseguro de tal forma que, mesmo que um intruso intercepte

a chave compartilhada, seja inviável determinar as chaves secretas e, consequentemente, de-

cifrar a mensagem.

Textos sobre o tema critograﬁa usualmente denominam o emissor de Alice, o recep-

tor de Bob e o intruso de Carlos para facilitar a compreensão. Neste trabalho, também

seguiremos esta nomenclatura. Vejamos os passos para a criação e compartilhamento da

chave.

1. Inicialmente, Alice e Bob escolhem um primo p suﬁcientemente grande e um inteiro g

tal que 0 < g < p e g seja um gerador de Z∗

p. Estes valores p e g são públicos.

2. Alice escolhe um inteiro a, 1 ≤ a ≤ p − 2, que não será divulgado.

2ver Apêndice A

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

25

3. Bob escolhe um inteiro b, 1 ≤ b ≤ p − 2, que também não será divulgado.

4. Alice escolhe um inteiro A ≡ ga (mod p) e o envia para Bob.

5. Bob escolhe um inteiro B ≡ gb (mod p) e o envia para Alice.

6. Alice, então, escolhe uma chave KA ≡ Ba (mod p).

KA ≡ (gb)a ≡ gab ( mod p)

7. Bob, por sua vez, escolhe uma chave KB ≡ Ab (mod p).

KB ≡ (gb)a ≡ gab ( mod p)

8. A chave secreta compartilhada é um inteiro KAB ≡ KA ≡ KB (mod p).

Como se pode ver, Alice e Bob possuem a mesma chave para codiﬁcação e decodiﬁ-

cação, mas em nenhum momento esta chave KAB foi transmitida de fato. Após executar este

protocolo, a comunicação pode ser realizada utilizando um criptossistema de chave secreta

qualquer.

Empregando a notação da deﬁnição 1.3.2, para codiﬁcar uma mensagem M ∈ P,

deve-se aplicar a função de codiﬁcação

EKAB : P → C

x (cid:55)→ KAB.x (mod p)

à mensagem M , gerando a mensagem cifrada M (cid:48):

M (cid:48) = EKAB (M ) ≡ KAB.M ( mod p)

Para decodiﬁcar a mensagem M (cid:48) ∈ C, deve-se aplicar a função de decodiﬁcação a M (cid:48),

ou seja, DKAB (M (cid:48)), que utiliza o inverso de KAB módulo p, KAB

−1.

DKAB (M (cid:48)) ≡ KAB

−1.M (cid:48) ( mod p)

DKAB (M (cid:48)) ≡ KAB

−1.KAB.M ( mod p)

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

26

DKAB (M (cid:48)) ≡ 1.M ( mod p)

DKAB (M (cid:48)) ≡ M ( mod p)

Suponhamos que Carlos consiga interceptar a chave que Alice envia a Bob, neste caso

a única informação sobre a chave de que ele tem conhecimento é

A ≡ ga ( mod p)

Carlos conhece os inteiros p e g, mas não conhece a. Para determinar este valor,

precisa calcular o logaritmo discreto a = logg A (mod p), o que é inviável.

De modo análogo, se Carlos receptasse a transmissão de Bob a Alice, teria a seguinte

informação:

B ≡ gb (mod p)

o que implica em calcular o logaritmo discreto b = logg B (mod p), o que também é inviável,

pois Carlos não conhece o inteiro b e p é um primo com grande quantidade de algarismos.

Deste modo, o problema do logaritmo discreto contribui para a segurança na troca de chaves

pelo protocolo Diﬃe-Hellman.

2.2 Criptossistema de Chave Pública ElGamal

Um cripstossistema de chave pública baseado no Problema do Logaritmo Discreto foi

proposto por Taher ElGamal em 1985 no artigo A public key cryptosystem and a signature

scheme based on discrete logarithms. Ao contrário do protocolo Diﬃe-Hellman, tratado na

seção anterior, o ElGamal utiliza chave assimétrica. Empregando a notação da deﬁnição

1.3.2, temos:

Deﬁnição 2.2.1 (Criptossistema ElGamal). Sejam p um primo, g ∈ Zp um gerador de Z∗
p
e a ∈ Zp. Seja P = Zp e C = Zp × Zp e

K = (p, g, a, A) : A ≡ ga ( mod p)

Para cada K = (p, g, a, A), e para cada número aleatório k, com 0 < k < p − 1, deﬁna, para

cada x ∈ P,

EK(x) = (y1, y2),

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

27

com

e para y1, y2 ∈ Zp:

y1 ≡ gk ( mod p)

y2 ≡ xAk ( mod p)

DK(y1, y2) = y2(ya

1)−1 ( mod p)

Chamamos Cripstossistema de Chave Pública ElGamal em Zp à quíntupla

(P, C, K, EK(x), DK(y1, y2))

Em termos práticos, suponhamos que Bob deseja enviar uma mensagem M a Alice.

Para isto, Alice e Bob combinam de utilizar um primo p convenientemente longo e um inteiro

g, gerador de Z∗

p, sendo que estes valores são públicos. A comunicação ocorre como segue:

1. Alice escolhe uma chave secreta a, com 1 ≤ a ≤ p − 2 e escolhe um inteiro A tal que

A ≡ ga ( mod p)

2. Alice envia A para Bob, que escolhe um inteiro aleatório k e escolhe dois inteiros y1 e

y2 tais que

y1 ≡ gk ( mod p)

e

y2 ≡ M.Ak ( mod p)

3. Bob envia o par (y1, y2), esta é a mensagem cifrada.

Note que no passo 1, o valor a escolhido por Alice precisa ser diferente de p − 1 pois,

pelo teorema 1.5, gφ(p) ≡ 1 (mod p) e como φ(p) = p − 1, teríamos A ≡ gp−1 ≡ 1 (mod p),

logo, y2 seria a própria mensagem M e não faria sentido cifrar esta mensagem. Pelo mesmo

motivo, deve-se ter k < p − 1. O valor A também é considerado público, pois pode ser

interceptado facilmente. Apesar disto, a segurança não é comprometida, pois Carlos, um

intruso, terá diﬁculdade para decifrar a mensagem original.

Caso Carlos consiga o valor A, considerando que p e g são conhecidos, precisaria re-

solver logg A (mod p) para determinar a chave secreta a, o que já sabemos ser inviável. Além

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

28

disso, se Carlos interceptar a mensagem (y1, y2), deverá determinar k = logg y1 (mod p), ou

seja, determinar dois logaritmos discretos igualmente inviáveis de resolver.

Para decodiﬁcar a mensagem (y1, y2) recebida, Alice precisa executar os seguintes

passos:

1. Determina x ≡ (y1)a (mod p) e seu inverso x−1 módulo p.

2. Calcula y2x−1 para encontrar a mensagem original

y2x−1 ≡ (M.Ak)x−1 ≡ M (ga)kx−1 ≡ M (gk)ax−1

≡ M (y1)ax−1 ≡ M.x.x−1 ≡ M ( mod p)

Deste modo, após estas operações Alice consegue ler a mensagem original.

Quando a mensagem codiﬁcada é um texto, usualmente utiliza-se a tabela ASCII

para converter a mensagem em um valor numérico, aﬁm de efetuar as operações necessárias

para codiﬁcação e decodiﬁcação.

Figura 2.1: Tabela ASCII

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

29

Vejamos um exemplo numérico:

Exemplo 2.3. Codiﬁcar a palavra PAI, utilizando p = 817.123 e g = 13.

Solução:

Vamos, incialmente, converter a palavra PAI utilizando a tabela ASCII da ﬁgura 2.1.

Para efeitos de simpliﬁcação, consideraremos apenas dois dígitos para cada letra:

• P = 80

• A = 65

• I = 73

Logo, a palavra PAI corresponde a 806.573. Seja a = 5, temos:

A ≡ 135 ≡ 371.293 ( mod 817.123)

Neste caso, temos a chave K = (817.123, 13, 5, 371.293). Façamos k = 2, temos:

y1 ≡ 132 ≡ 169 ( mod 817.123)

y2 ≡ 806.573(371.293)2 ≡ 550.537 ( mod 817.123)

Logo, a mensagem cifrada é (169, 550.537).

(cid:3)

Para decifrar esta mensagem, seguimos os passos:

1. x ≡ 1695 ≡ 36.273 (mod 817.123)

2. x−1 ≡ x817.123−2 ≡ 36.273817.121 ≡ 371.268 (mod 817.123)

3. y2x−1 = 550.537 × 371.268 = 204.396.770.916 ≡ 806.573 (mod 817.123)

Separando este último resultado em blocos de dois dígitos e convertendo de acordo

com a tabela da ﬁgura 2.1, encontramos a mensagem original:

CAPÍTULO 2. PROBLEMA DO LOGARITMO DISCRETO

30

Figura 2.2: Mensagem decodiﬁcada

Agora que já temos o Problema do Logaritmo Discreto bem deﬁnido e sabemos como

aplicá-lo, passaremos a abordar as curvas elípticas.

Capítulo 3

CURVAS ELÍPTICAS

Curvas elípticas são deﬁnidas a partir da Equação de Weierstrass sobre um corpo

K:

com a1, a2, a3, a4, a5 ∈ K.

y2 + a1xy + a3y = x3 + a2x2 + a4x + a5

(3.1)

Porém, para o escopo deste trabalho, trabalharemos com curvas elípticas simétricas

em relação ao eixo-x e sem singularidades, pois precisaremos que as mesmas tenham retas

tangentes em todos os seus pontos. Deste modo, trabalharemos com uma versão simpliﬁcada

da equação (3.1).

3.1 Equação de Weierstrass Simpliﬁcada

Deﬁnição 3.1.1. Seja K um corpo. Uma curva elíptica E sobre K, denotada por E(K), é

o lugar geométrico dos pontos (x, y) ∈ K × K tais que x e y são soluções da equação

com A, B ∈ K e

4A3 + 27B2 (cid:54)= 0.

y2 = x3 + Ax + B

A condição 4A3 + 27B2 (cid:54)= 0 é necessária para que a curva não tenha singularidades.

De fato, derivando a equação y2 = x3 + Ax + B em relação a x, temos:

2y

dy
dx

= 3x2 + A

31

CAPÍTULO 3. CURVAS ELÍPTICAS

dy
dx

=

3x2 + A
2y

32

(3.2)

Para que a derivada

dy
dx

exista, devemos ter y (cid:54)= 0. Vejamos o que ocorre nos pon-

tos críticos da curva, ou seja, nos nos pontos em que a derivada

3x2 + A = 0 na equação (3.2), logo:

dy
dx

é zero. Temos, então,

(cid:114)

x = ±

−

A
3

(3.3)

Fazendo y = 0, temos que a derivada da equação (3.2) não existe e, portanto, a curva

não é diferenciável. Se tivéssemos y = 0, teríamos que y2 = 0. Logo, da deﬁnição 3.1.1:

x3 + Ax + B = 0

x(x2 + A) + B = 0

Substituindo (3.3) na equação acima, temos:

(cid:19) (cid:18)

(cid:18)

(cid:114)

±

−

A
3

−

A
3

(cid:19)

+ A

+ B = 0

(cid:18)

(cid:114)

±

−

(cid:18)

−

A
3

(cid:19) (cid:18) 2A
A
3
3
(cid:19) (cid:18) 4A2
9

(cid:19)

= −B

(cid:19)

= B2

−4A3
27

= B2

−4A3 = 27B2

4A3 + 27B2 = 0

Portanto, para que a curva exista, devemos ter 4A3 + 27B2 (cid:54)= 0. Esta condição é

necessária e suﬁciente para que a curva não tenha singularidades. A condição acima garante,

ainda, que a equação não possui raízes múltiplas.

Se consideramos curvas elípticas sobre R, podemos traçar o gráﬁco no plano carte-

siano. Vejamos alguns exemplos de curvas elípticas.

CAPÍTULO 3. CURVAS ELÍPTICAS

33

Exemplo 3.1. Seja a curva elíptica E(R) de equação y2 = x3 − 2x + 2. Veriﬁque se a curva

satisfaz a condição da deﬁnição 3.1.1.

Solução:

Vejamos se a equação y2 = x3 − 2x + 2 satisfaz a condição 4A3 + 27B2 (cid:54)= 0. Neste

caso, temos A = −2 e B = 2.

4.(−2)3 + 27.22 = 4.(−8) + 27.4 = −32 + 108 = 76 (cid:54)= 0

Logo, a curva E(R) satisfaz a condição da deﬁnição 3.1.1.

(cid:3)

O gráﬁco desta curva pode ser visto na ﬁgura 3.1

Figura 3.1: Gráﬁco da curva y2 = x3 − 2x + 2

Conforme se pode observar na ﬁgura 3.1, a curva possui apenas uma raiz real. Vejamos um

exemplo de curva com três raízes reais distintas.

Exemplo 3.2. Mostre que a curva E(R) de equação y2 = x3 − 4x + 3 não possui singulari-

dades.

Solução:

CAPÍTULO 3. CURVAS ELÍPTICAS

34

Para que uma curva não possua singularidades é suﬁciente que tenhamos 4A3+27B2 (cid:54)=

0. No caso da curva em questão, temos A = −4 e B = 3, logo:

4.(−4)3 + 27.32 = 4.(−64) + 27.9 = −256 + 243 = −13 (cid:54)= 0

Portanto, a curva não possui singularidades.

(cid:3)

O gráﬁco desta curva pode ser visto na ﬁgura 3.2 a seguir.

Figura 3.2: Gráﬁco da curva y2 = x3 − 4x + 3

Como se pode ver, o gráﬁco da curva intersecta o eixo-x em três pontos diferentes,

o que signiﬁca que a equação da curva possui três raízes reais distintas. No exemplo 3.3,

mostramos um exemplo de curva com raízes duplas.

Exemplo 3.3. Veriﬁque se a curva sobre R de equação y2 = x3 − 3x + 2 satisfaz a condição

da deﬁnição 3.1.1.

Solução

Vejamos se a condição 4A3 + 27B2 (cid:54)= 0 é verdadeira para a curva com A = −3 e

B = 2:

4.(−3)3 + 27.22 = 4.(−27) + 27.4 = −108 + 108 = 0

Portanto, esta curva não se encaixa na deﬁnição 3.1.11.

1Equações deste tipo são chamadas de equações cúbicas singulares. Ver SILVERMAN[11], página 43

CAPÍTULO 3. CURVAS ELÍPTICAS

35

(cid:3)

Isto signiﬁca que a equação cúbica y2 = x3 − 3x + 2 possui uma raiz real dupla.

Observe o gráﬁco na ﬁgura 3.3.

Figura 3.3: Gráﬁco da curva y2 = x3 − 3x + 2

As raízes da equação, como se pode concluir da ﬁgura 3.3, são -2 e 1, sendo que 1 é

uma raiz dupla. Como veremos na seção 3.2, curvas deste tipo não servem para o propósito

deste trabalho, pois não possuem reta tangente nos pontos de singularidade.

Podemos deﬁnir uma operação de soma entre dois pontos de uma curva E(K) e, desta

forma, transformá-la em um grupo abeliano.

3.2 Soma de pontos em curvas elípticas

A soma de dois pontos em uma curva elíptica pode ser tratada tanto de forma geomé-

trica quanto algébrica. Vejamos, inicialmente, a forma geométrica. Para tornar o texto mais

didático, analisaremos curvas E(R) sobre o corpo dos reais, mas as propriedades a seguir são

válidas para curvas sobre qualquer corpo K

Sejam dois pontos P, Q ∈ E(R). Considere a reta r que passa pelos pontos P e Q,

tal que r não seja uma reta vertical2. Temos que a reta r intersecta a curva E(R) em um

2O caso que a reta r é vertical, ou seja, paralela ao eixo-y será analisado quando deﬁnirmos o elemento

neutro da operação de soma entre dois pontos

CAPÍTULO 3. CURVAS ELÍPTICAS

36

terceiro ponto R(cid:48).

Figura 3.4: Soma de dois pontos em uma curva E(R)

Como a curva é simétrica em relação ao eixo horizontal, temos que a reﬂexão do ponto

R(cid:48) em relação ao eixo horizontal pertence à curva. Chamemos este ponto de R, dizemos que

R = P + Q.

Figura 3.5: Soma de dois pontos em uma curva E(R): R = P + Q

CAPÍTULO 3. CURVAS ELÍPTICAS

37

Para que a curva E(R) com a operação de soma de dois pontos em curva seja um

grupo abeliano, de acordo com a seção 1.2, devemos ter um elemento neutro para esta ope-

ração. Para isto, deﬁnimos um ponto O, chamado Ponto no Inﬁnito3, não pertecente ao

plano R2, tal que O esteja em toda reta vertical do R2, ou seja, O pertence a todas as retas

x = k, com k ∈ R.

Para que seja possível realizar uma soma P +O, consideramos que o ponto O também

pertence à curva E(R). Deste modo,ao fazermos P + O, teremos que a reta que passa por

estes pontos é vertical e intersecta a curva E(R) no ponto P (cid:48), que é a reﬂexão do ponto P

em relação ao eixo horizontal, devido à simetria da curva.

Figura 3.6: Soma entre um ponto P e o ponto no inﬁnito O: P + O

Como se pode ver na ﬁgura 3.6, a reﬂexão do ponto P (cid:48) em relação ao eixo horizontal

é o próprio ponto P , logo, temos que

portanto, o ponto O é o elemento neutro da operação de soma entre dois pontos de uma

P + O = P

curva elíptica.

3Também chamado de ponto impróprio.

CAPÍTULO 3. CURVAS ELÍPTICAS

38

Observe que o ponto P (cid:48) é o inverso aditivo de P , pois a reta que passa por P e P (cid:48) é

vertical e, portanto, o terceiro ponto de interseção com a curva é o ponto O, ou seja:

P + P (cid:48) = O

Neste trabalho, o ponto P (cid:48), inverso aditivo de P , será representado por −P .

Também podemos determinar uma soma P + P , para isto tomamos a reta tangente

à curva no ponto P . Neste caso, a reta tangente em P intersecta a curva em um segundo

ponto R(cid:48) e temos que a reﬂexão R em relação ao eixo horizontal é o ponto desejado, ou seja,

R = P + P . Também podemos representar a soma P + P como 2P .

Figura 3.7: R = P + P ou R = 2P

Um caso especial ocorre quando a reta tangente no ponto P é vertical. Como o ponto

O ∈ E(R) pertence a todas as retas verticais do plano, temos que O também pertence à reta

tangente em P. Logo:

P + P = O

CAPÍTULO 3. CURVAS ELÍPTICAS

39

Figura 3.8: P + P quando a reta tangente é vertical.

3.2.1 Soma algébrica

Podemos, também, trabalhar com as coordenadas dos pontos em uma curva elíptica.
Sejam P = (xp, yp) e Q = (xq, yq) dois pontos de uma curva elíptica E(R) de equação
y2 = x3 + Ax + B, com 4A3 + 27B2 (cid:54)= 0, com P (cid:54)= O e Q (cid:54)= O. Tomemos P (cid:54)= Q (trataremos

o caso P = Q posteriormente). Seja r a reta que passa pelos pontos P e Q, sabemos que

esta reta intersecta a curva E(R) em um terceiro ponto R(cid:48) = (x(cid:48)

r, y(cid:48)

r).

Figura 3.9: Reta que passa pelos pontos P e Q.

CAPÍTULO 3. CURVAS ELÍPTICAS

40

Da ﬁgura 3.9 conclui-se que a inclinação da reta r é

com xq (cid:54)= xp (se xq = xp, temos uma reta vertical, ver ﬁgura 3.6).

m =

yq − yp
xq − xp

Deste modo, a equação da reta r é

y = m(x − xp) + yp

(3.4)

pois r passa pelo ponto P . Para determinarmos as interseções entre a reta r e a curva E(R),

basta substituirmos a equação da reta na equação da curva. Temos:

(m(x − xp) + yp)2 = x3 + Ax + B

m2x2 − 2m2xpx + m2x2

p + mypx − mxpyp + y2

p = x3 + Ax + B

x3 − m2x2 + (A + 2m2xp − myp)x + (B − m2x2

p + mxpyp − y2

p) = 0

Fazendo a = −m2, b = A + 2m2xp − myp e c = B − m2x2

p + mxpyp − y2

p temos a

seguinte equação cúbica:

x3 + ax2 + bx + c = 0

(3.5)

Como os pontos P , Q e R(cid:48) são as interseções da reta r com a curva E(R), temos que

xp, xq e x(cid:48)

r são as raízes da equação (3.5). Aplicando as Relações de Girard, temos que a

soma das raízes é

Como a = −m2, temos:

−a = xp + xq + x(cid:48)
r

m2 = xp + xq + x(cid:48)
r

r = m2 − xp − xq
x(cid:48)

(3.6)

Como R(cid:48) ∈ r, podemos substituir suas coordenadas na equação (3.4). Portanto:

CAPÍTULO 3. CURVAS ELÍPTICAS

r = m(x(cid:48)
y(cid:48)

r − xp) + yp

41

(3.7)

Conforme deﬁnimos na seção 3.2, o ponto R = P + Q, R = (xr, yr), é a reﬂexão de R(cid:48)

em relação ao eixo horizontal, ou seja, xr = x(cid:48)

r e yr = −y(cid:48)

r. Substituindo, respectivamente,

em (3.6) e (3.7), temos:

xr = m2 − xp − xq

e

yr = m(xp − xr) − yp

Consideremos, agora, o caso em que temos P = Q, temos que a reta r é tangente à

curva no ponto P . Deste modo, a inclinação da reta será a derivada no ponto P em relação

a x. Conforme se pode concluir da equação (3.2), temos para (xp, yp):

m =

3x2

p + A
2yp

com yp (cid:54)= 0, caso contrário, assume-se que a reta é vertical e, conforme vimos na seção 3.2,

teremos P + P = O.

Sendo assim, a reta r que passa por P com inclinação m tem a mesma forma da

equação (3.4): y = m(x − xp) + yp. Deste modo, ao fazermos a interseção desta reta com a
curva E(R) obteremos novamente a equação (3.5), com a diferença de que agora as raízes

não são todas distintas, pois xp é uma raiz dupla. Deste modo, temos, aplicando as Relações

de Girard, que

m2 = xp + xp + x(cid:48)
r

xr = x(cid:48)

r = m2 − 2xp

Para determinar yr, o raciocínio é o mesmo empregado no caso P (cid:54)= Q e temos

yr = m(xp − xr) − yp

CAPÍTULO 3. CURVAS ELÍPTICAS

42

No caso em que temos P = O, teremos xr = xp e yr = yp e no caso Q = O, teremos

xr = xq e yr = yq, já que o ponto O serve como elemento neutro para a operação.

Podemos, agora, formalizar a deﬁnição de soma entre dois pontos de uma curva

elíptica em termos algébricos.

Deﬁnição 3.2.1 (Soma de dois pontos de uma curva elíptica em termos algébricos). Seja

E(R) uma curva elíptica de equação y2 = x3 + Ax + B, com 4A3 + 27B2 (cid:54)= 0 e sejam
P = (xp, yp), Q = (xq, yq) e R = (xr, yr) pontos da curva E(R) tais que R = P + Q.

1. Se P = O, então R = Q

2. Se Q = O, então R = P

3. Se xp = xq e yp = −yq, então R = O

caso contrário, deﬁna

Então:

e

m =






yq − yp
xq − xp

,

se P (cid:54)= Q

3x2

p + A
2yp

,

se P = Q

xr =





m2 − xp − xq,

se P (cid:54)= Q

m2 − 2xp,

se P = Q

yr = m(xp − xr) − yp

Vejamos um exemplo de aplicação da soma algébrica.

Exemplo 3.4. Considere a curva E(R) de equação y2 = x3 − 3x + 1 e os pontos P = (0, 1)

3). Determine as coordenadas do ponto R ∈ E(R) tal que R = P + Q.

√

e Q = (2,

Solução:

A ﬁgura a seguir mostra o gráﬁco de E(R) e a soma geométrica P + Q

CAPÍTULO 3. CURVAS ELÍPTICAS

43

Figura 3.10: Gráﬁco de y2 = x3 − 3x + 1.

Aplicando a deﬁnição 3.2.1, temos:

m =

yq − yp
xq − xp

,

pois P (cid:54)= Q

m =

m =

Deste modo:

√

3 − 1
2 − 0
√

3 − 1
2

xr = m2 − xp − xq
(cid:18) √

(cid:19)2

xr =

xr =

− 0 − 2

− 2

√
3

3 − 1
2

4 − 2
4
√

xr = −

Calculando yr, temos:

3
2

− 1

(cid:18) √

yr =

yr = m(xp − xr) − yp

(cid:19) (cid:18)

0 +

3 − 1
2

√

3
2

yr =

√

1
4

(1 +

3) − 1

(cid:19)

+ 1

− 1

CAPÍTULO 3. CURVAS ELÍPTICAS

yr =
√

− 1,

√

3 − 3
4

(cid:19)

.

3 − 3
4

(cid:18)

√

3
2

−

Portanto, temos R =

44

(cid:3)

Como a operação de soma está bem deﬁnida, podemos veriﬁcar o seguinte:

Proposição 3.1. (E(K), +), onde + é a operação de soma entre dois pontos de E(K), é

um grupo abeliano.

Demonstração:

De acordo com a seção 1.2, um grupo abeliano precisa satisfazer as seguintes pro-

priedades:

P1. associativa;

P2. possuir elemento neutro;

P3. possuir elemento inverso;

P4. comutativa.

Vejamos se E(K) com a operação de soma entre dois pontos goza destas propriedades:

P1: Associatividade

A prova da associatividade é extensa, pois, dados três pontos P, Q e R ∈ E(K), para

mostrarmos que (P + Q) + R = P + (Q + R), devemos considerar os casos em que P = Q,

P = R, Q = R, P + Q = R, P = Q + R e P (cid:54)= Q (cid:54)= R, o que foge do escopo deste trabalho.

Uma demonstração completa pode ser encontrada em WASHINGTON [16], página 20.

P2: Existência do Elemento Neutro

Como vimos na seção 3.2, o ponto O é o elemento neutro da soma entre dois pontos

de uma curva elíptica e para qualquer P ∈ E(K), temos P + O = O + P = P , logo, existe

CAPÍTULO 3. CURVAS ELÍPTICAS

45

elemento neutro.

P3: Existência do Elemento Inverso

Seja um ponto P qualquer da curva e um ponto −P tal que −P é a reﬂexão de P

em relação ao eixo horizontal. A reta que passa por P e −P é vertical e, conforme vimos na

seção 3.2, P + (−P ) = (−P ) + P = O, portanto, existe o inverso aditivo.

P4: Comutatividade

A comutatividade é óbvia, visto que dados dois pontos P e Q da curva, a reta que

passa por P e Q é a mesma que passa por Q e P , portanto, a interseção de ambas as retas

com a curva é o mesmo ponto, logo, P + Q = Q + P .

Portanto, (E(K), +) é um grupo abeliano.

(cid:3)

Como a operação de soma é válida para qualquer corpo K, podemos trabalhar com

curvas sobre corpos ﬁnitos. Para o escopo deste trabalho, trabalharemos com curvas sobre
o corpo Zp.

3.3 Curvas elípticas sobre o corpo Zp

Uma curva elíptica sobre o corpo Zp, segundo a deﬁnição 3.1.1, é o conjunto de pontos
e 4A3 + 27B2 (cid:54)≡ 0(mod p),

(x, y), com x, y ∈ Zp, tais que y2 = x3 + Ax + B, com A, B ∈ Zp

incluindo o ponto no inﬁnito O.

Uma curva E(Zp) claramente possui um número ﬁnito de pontos, pois existem p pos-

sibilidades para a coordenada x e, para cada valor de x, existem dois valores possíveis para
y (devido à simetria da curva). Sendo assim, acrescentando o ponto O, uma curva sobre Zp
possui, no máximo, 2p+1 pontos4.

4O Teorema de Hasse-Weil melhora esta estimativa, dizendo que o total de pontos de uma curva elíptica

sobre Zp é menor do que ou igual a p + 1 + 2

√

p ver[11, 16]

CAPÍTULO 3. CURVAS ELÍPTICAS

46

Como uma curva E(K) é um conjunto ﬁnito de pontos, podemos determinar todos

eles.

Exemplo 3.5. Determine todos os pontos da curva E(Z11) de equação y2 = x3 − x + 3.

Solução:

Para determinar se um ponto pertence à curva, tomamos cada valor possível de x,

substituímos em x3 − x + 3 mod (11) e veriﬁcamos se este resultado é o quadrado módulo 11

de algum y. A tabela abaixo com todos os valores possíveis de x e y facilita a visualização.

y

0

1

2

3

4

5

6

7

8

9

10

y2 mod (11)

x

x3 − x + 3 mod (11)

0

1

4

9

5

3

3

5

9

4

1

0

1

2

3

4

5

6

7

8

9

10

3

3

9

5

8

2

4

9

1

8

3

Na tabela podemos ver, por exemplo, que para x = 7, temos x3 −x+3 ≡ 9 mod (11),

que por sua vez é quadrado módulo 11 de y = 3 e y = 8. Portanto, os pontos (7, 3) e (7, 8)

pertencem a curva. Observe que para x = 5 temos x3 − x + 3 ≡ 2 mod (11), mas não há

nenhum valor de y cujo quadrado seja congruente a 2 mod (11), ou seja, nenhum ponto

da curva tem coordenada x = 5. Analisando todos os valores possíveis, encontramos os

seguintes pontos:

(0, 5)

(0, 6)

(1, 5)

(1, 6)

(2, 3)

(2, 8)

(3, 3)

(3, 7)

(6, 2)

(6, 9)

(7, 3)

(7, 8)

(8, 1)

(8, 10)

(10, 5)

(10, 6)

CAPÍTULO 3. CURVAS ELÍPTICAS

47

(cid:3)

Obviamente, quanto maior o primo p escolhido, mais inviável se torna determinar
todos os pontos de E(Zp). Ao trabalharmos com curvas sobre Zp, não faz sentido falarmos

em gráﬁco da curva, pois a mesma se torna uma plotagem de pontos. Na ﬁgura 3.11 podemos
ver a plotagem da curva E(Z23) de equação y2 = x3 + 9x + 17.

Figura 3.11: Plotagem de uma curva sobre Z23.

Quando lidamos com curvas sobre Zp, empregamos a soma entre dois pontos na forma

algébrica. Vejamos um exemplo:

Exemplo 3.6. Seja a curva E(Z11) de equação y2 = x3 − x + 3 e os pontos P = (1, 5) e

Q = (8, 10) pertencentes a curva. Calcule as coordenadas do ponto R = P + Q.

Solução

Para somar os pontos basta aplicar a deﬁnição 3.2.1. Como P (cid:54)= Q e xp (cid:54)= xq:

m =

yq − yp
xq − xp

CAPÍTULO 3. CURVAS ELÍPTICAS

48

m =

10 − 5
8 − 1
5
7

m =

Estamos trabalhando em Z11,

isto signiﬁca que m é o inteiro tal que 7m ≡ 5

mod (11), logo, m = 7, pois 7.7 = 49 ≡ 5 mod (11).

Calculando a coordenada xr:

Para yr:

xr = m2 − xp − xq

xr = 72 − 1 − 8

xr = 40 ≡ 7 mod (11)

yr = m(xp − xr) − yp

yr = 7(1 − 7) − 5

yr = −47 ≡ 8 mod (11)

Logo, temos R = (7, 8). Como podemos ver no exemplo 3.5, R ∈ Z11.

(cid:3)

3.4 O problema do logaritmo discreto elíptico

Conforme vimos na seção 3.2, ao somarmos P +P encontramos um ponto 2P , múltiplo

de P . Se tomarmos este resultado e somarmos P novamente, ou seja, 2P + P , teremos como

resultado um ponto que denominaremos 3P . Fazendo este procedimento n vezes, com n ∈ N,

temos:

P + P + · · · + P = nP

Deste modo, dado um ponto P ∈ E(Zp), podemos determinar os múltiplos 2P, 3P,

4P, . . . , nP deste ponto P . Vejamos um exemplo.

Exemplo 3.7. Considere a curva E(Z13) de equação y2 = x3 + 2x − 1. Veriﬁque se o ponto

P = (5, 2) pertence à curva e, em caso positivo, determine seus múltiplos.

CAPÍTULO 3. CURVAS ELÍPTICAS

49

Solução

Empregando o mesmo procedimento utilizando no exemplo 3.5, encontramos que os

pontos da curva em questão são:

(0, 5)

(0, 8)

(5, 2)

(5, 11)

(11, 0)

(12, 3)

(12, 10)

Portanto, P ∈ E(Z13).

Para determinar os múltiplos de P , empregamos a deﬁnição algébrica de soma. Ve-

jamos:

2P = P + P = (5, 2) + (5, 2) = (12, 3)

3P = 2P + P = (12, 3) + (5, 2) = (0, 8)

4P = 3P + P = (0, 8) + (5, 2) = (11, 0)

5P = 4P + P = (11, 0) + (5, 2) = (0, 5)

6P = 5P + P = (0, 5) + (5, 2) = (12, 10)

7P = 6P + P = (12, 10) + (5, 2) = (5, 11)

8P = 7P + P = (5, 11) + (5, 2) = O5

Observe que estes são os únicos múltiplos de P , pois como 8P = O, a partir de 9P

os resultados seriam repetidos.

(cid:3)

No exemplo 3.7, todos os pontos da curva são múltiplos de P = (5, 2), como E(Z13)

com a operação de adição entre dois pontos é um grupo abeliano (cíclico), dizemos que P é

um gerador do grupo. É importante notar que nem todo ponto de uma curva possui múlti-

plos, além disso, algum ponto pode não ser múltiplo de outro. Por exemplo, o ponto (11, 0)

na curva do exemplo anterior não possui múltiplos6.

511 ≡ −2 mod 13, logo esta soma cai no caso 3 da deﬁnição 3.2.1
6De forma geral, pontos da curva E(Zp) que possuem a forma (k, 0), com k ∈ Z, não possuem múltiplos,

pois a reta tangente neste ponto é sempre vertical. Ver ﬁgura 3.8

CAPÍTULO 3. CURVAS ELÍPTICAS

50

Podemos adaptar o Problema do Logaritmo Discreto à operação de soma entre dois
pontos de uma curva sobre Zp. Considere um ponto P ∈ E(Zp) tal que P seja um gerador
de E(Zp). Deste modo, para cada Q ∈ E(Zp), existe um n ∈ Zp tal que

Q = nP

Dizemos que n é o Logaritmo Discreto Elíptico de Q em relação a P , represen-

tamos n = logP (Q). O Problema do Logaritmo Discreto Elíptico consiste em determinar n

para cada ponto Q.

Como a operação de soma entre pontos de uma curva elíptica é consideravelmente
mais trabalhosa que a multiplicação em Zp, determinar o logaritmo discreto elíptico sem

conhecer os valores empregados no cálculo é ainda mais difícil que o Problema do Logaritmo
Discreto em Zp.

O Problema do Logaritmo Discreto Elíptico está bem deﬁnido e E(Zp) com a opera-

ção de adição entre dois pontos da curva é um grupo abeliano, logo, os resultados do capítulo

2 são válidos também para esta estrutura. Vejamos como os protocolos estudados naquele

capítulo podem ser empregados com curvas elípticas.

Capítulo 4

CRIPTOGRAFIA COM CURVAS

ELÍPTICAS

Para implementar um criptossistema baseado em curvas elípticas, é necessário fazer

algumas mudanças nos protocolos estudados no capítulo 2 para adaptá-los à estrutura de

curvas elípticas. Por exemplo, a equação da curva é um dado necessário ao processo de

encriptação. Vejamos as mudanças realizadas.

4.1 Protocolo Diﬃe-Hellman aplicado a curvas elípticas

sobre Zp

Voltemos para o caso em que Alice e Bob desejam criar e compartilhar uma chave

de codiﬁcação segura. No caso do protocolo Diﬃe-Hellman (ver seção 2.1), além do primo
p e do gerador P , a equação da curva E(Zp) também é um dado público, pois Alice e Bob

precisam calcular os pontos empregando a mesma curva. O processo ocorre como segue:

1. Alice e Bob escolhem um primo p, uma curva E(Zp) de equação y2 = x3 + Ax + B,

com 4A3 + 27B2 (cid:54)= 0, e um ponto P ∈ E(Zp) gerador do grupo.

2. Alice escolhe um inteiro secreto nA ∈ Zp, calcula QA = nAP e envia QA para Bob.

3. Bob escolhe um inteiro secreto nB ∈ Zp, calcula QB = nBP e envia QB para Alice.

51

CAPÍTULO 4. CRIPTOGRAFIA COM CURVAS ELÍPTICAS

52

4. Alice calcula RA = nAQB

5. Bob calcula RB = nBQA

RA = nA(nBP ) = (nAnB)P

RB = nB(nAP ) = (nAnB)P

6. A chave secreta é RAB = RA = RB

Como se pode ver, o procedimento para criar e compartilhar a chave secreta é o

mesmo. A comunicação pode, então, ser realizada utilizando um criptossistema qualquer.

Caso Carlos, um intruso, consiga interceptar a comunicação, deverá calcular o logaritmo

discreto elíptico de QA e QB para obter os dados originais, o que e inviável.

4.2 Criptossistema ElGamal aplicado a curvas elípticas

sobre Zp

Quando abordamos o criptossistema de chave pública ElGamal na seção 2.2, deﬁni-
mos o mesmo para o grupo multiplicativo Zp. No entanto, o ElGamal pode ser generalizado

para um grupo cíclico ﬁnito qualquer. Voltemos para o caso de Alice e Bob.

Novamente, o primo p, a curva E(Zp) de equação y2 = x3+Ax+B, com 4A3+27B2 (cid:54)=
0, e o ponto P ∈ E(Zp), gerador do grupo, são de conhecimento público. Antes de iniciar

o processo de encriptação, Bob, que deseja enviar uma mensagem codiﬁcada a Alice, deve
transformar sua mensagem M em um ponto PM ∈ E(Zp)1. Feito isto, pode-se iniciar a

codiﬁcação.

1. Alice escolhe um inteiro secreto nA ∈ Zp, calcula QA = nAP e envia QA para Bob.

2. Bob escolhe um inteiro aleatório k e calcula

1no caso de a mensagem ser um texto, normalmente se utiliza a tabela ASCII para converter em um

número inteiro, ver ﬁgura 2.1

R = kP e S = PM + kQA

CAPÍTULO 4. CRIPTOGRAFIA COM CURVAS ELÍPTICAS

53

3. Bob envia para Alice o par de pontos (R, S)

Para Alice decifrar a mensagem, basta calcular S − nAR:

S − nAR = PM + kQA − nA.kP = PM + k.nAP − k.nAP = PM

O procedimento para transformar uma mensagem M em um ponto PM ∈ E(Zp)

pode ser feito de várias maneiras, como por exemplo convertendo a mensagem para um

inteiro empregando a tabela ASCII (ﬁgura 2.1) e, em seguida, separando este inteiro em
duas coordenadas de um ponto, de tal forma que este ponto pertença à curva E(Zp). Nos

casos em que o ponto gerado por esta operação não pertence à curva, usualmente acrescenta-

se zero, ou outro algarismo acordado entre as partes, até que as coordenadas encontradas
formem um ponto de E(Zp). Vejamos um exemplo:

Exemplo 4.1. Considere a curva E(Z23) de equação y2 = x3 + 9x + 17 e o ponto P = (16, 5)
gerador de E(Z23) com a operação de soma entre dois pontos. Transforme a mensagem M

= MÁ em um ponto PM da curva.

Solução

Para tornar mais didático, utilizaremos a tabela abaixo em que cada letra, a partir

de A, recebe um valor sequencial iniciado em 1.

Figura 4.1: Tabela de correspondência letra-valor

Neste caso, temos que a mensagem M = MÁ, em termos numéricos, corresponde ao

inteiro 1301 pois, pela tabela anterior, M = 13 e A = 01. Desmembrando este inteiro em

duas coordenadas, encontramos o ponto (13, 1), vejamos se este ponto pertence à curva:

CAPÍTULO 4. CRIPTOGRAFIA COM CURVAS ELÍPTICAS

54

y2 = 12 = 1

x3 + 9x + 17 = 133 + 9.13 + 17 = 2331 ≡ 8 mod 23

Logo, (13, 1) /∈ E(Z23), pois 1 (cid:54)= 8. Devemos, então, fazer alguma modiﬁcação nas

coordenadas do ponto. Vamos acrescentar o algarismo zero na ordenada do ponto encontrado,

gerando o novo ponto (13, 10), e vejamos se o mesmo pertence à curva.

y2 = 102 = 100 ≡ 8 mod 23

Portanto, a mensagem M é transformada no ponto PM = (13, 10) e está pronta para

ser codiﬁcada.

(cid:3)

Utilizando a mensagem e a curva do exemplo 4.1, vejamos como funciona o criptossis-

tema ElGamal aplicado a curvas elípticas com um exemplo prático.

Exemplo 4.2. Suponha que Bob deseja enviar a mensagem M = MÁ para Alice empregando

o primo, a curva e o ponto gerador do exemplo 4.1. Faça a codiﬁcação e decodiﬁcação da

mensagem M utilizando o criptossistema ElGamal.

Solução:

Como vimos no exemplo 4.1, PM = (13, 10). Vejamos os passos do ElGamal:

1. Suponhamos que Alice escolha nA = 4. Temos:

P = (16, 5)

2P = (20, 20)

3P = (14, 14)

4P = (19, 20) = QA

2. Alice envia (19, 20) para Bob.

CAPÍTULO 4. CRIPTOGRAFIA COM CURVAS ELÍPTICAS

55

3. Suponhamos que Bob escolha k = 2, temos

R = 2P = (20, 20)

S = PM + 2.(19, 20) = (13, 10) + (12, 17) = (1, 21)

4. A mensagem codiﬁcada é formada pelos pontos (20, 20) e (1, 21), nesta ordem.

Para decodiﬁcar a mensagem, basta Alice calcular

S − nAR = (1, 21) − 4.(20, 20) = (1, 21) − (12, 17) =

= (1, 21) + (12, −17) = (1, 21) + (12, 6) = (13, 10) = PM

Portanto, Alice consegue ler a mensagem.

(cid:3)

Capítulo 5

SUGESTÕES DE ATIVIDADES PARA

O ENSINO MÉDIO

Neste capítulo sugerimos algumas maneiras de o professor de matemática empregar a

temática deste trabalho como ponto de partida ou tema motivador para atividades no ensino

médio. Não se pretende que o professor aplique diretamente o conteúdo de curvas elípticas

em sala de aula, mas sim que o tema geral Segurança da Informação seja um norte na

elaboração de sequências didáticas, haja visto que, de acordo com a Lei de Diretrizes e Bases

da Educação Nacional - LDB, uma das ﬁnalidades do ensino médio é "a compreensão dos

fundamentos cientíﬁco-tecnológicos dos processos produtivos, relacionando a teoria com a

prática no ensino de cada disciplina"(BRASIL, Lei 9394/96, Art. 35, IV)[1]. A atividade

da seção 5.1 é direcionada para turmas do 1o ano do ensino médio, enquanto as demais

atividades propostas neste capítulo são direcionadas para o 3o ano do ensino médio. Vejamos

as atividades.

5.1 Noção Geral de Criptograﬁa

Esta atividade objetiva propiciar um primeiro contato com a ideia de informação

criptografada. É importante que o professor conceitue criptograﬁa e mostre um esquema

geral de funcionamento da mesma, conforme a ﬁgura a seguir.

56

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

57

Figura 5.1: Esquema geral de criptograﬁa

O professor pode, também, mostrar o exemplo 2.3 para os alunos, sem entrar em

detalhes quanto às operações realizadas, ou até mesmo preparar um exemplo de acordo com

a atividade proposta a seguir. É importante que os alunos vejam pelo menos um exemplo

de uma mensagem criptografada, para que possam observar na prática que, após o processo

de encriptação, a mensagem se torna ilegível.

Recomenda-se que, neste momento, o professor não entre em detalhes quanto à dife-

rença entre chaves secretas e públicas. Conforme vimos na deﬁnição 1.3.2, um criptossistema

precisa de uma função de codiﬁcação e de sua função inversa, para decodiﬁcação. Nesta ativi-

dade, empregaremos função aﬁm tanto para codiﬁcação quanto decodiﬁcação, uma vez que

o aluno que já estudou este conteúdo está familiarizado a calcular imagens de valores especí-

ﬁcos e determinar a função inversa. É recomendável, ainda, o uso de calculadora durante a

realização da atividade.

Ações Didáticas

Separa-se a turma em grupos de até 4 alunos, para que todos possam participar

ativamente. Para esta atividade, recomenda-se utilizar a tabela da ﬁgura 5.2, pois desta

forma elimina-se números iniciados com algarismo 0. Entrega-se uma cópia desta tabela

para cada grupo, orientando-os sobre como converter uma mensagem de texto em um número

inteiro.

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

58

Figura 5.2: Tabela de correspondência letra-valor adaptada

Por exemplo, para converter a mensagem "MATEMÁTICA É LEGAL", deve-se

primeiramente, para efeitos de simpliﬁcação, ignorar os espaços entre as palavras e acentu-

ação, resultando em "MATEMATICAELEGAL". Em seguida, cada letra deve ser convertida

conforme a tabela 5.2, resultando no inteiro

23113015231130191311152215171122

Devido a limitações do visor da calculadora, o inteiro acima deverá ser separado em

blocos. Recomenda-se deixar os alunos livres para fazer a separação da forma que acharem

melhor. Uma maneira seria

231130 152311 301913 111522 1517 1122

É necessário explicar aos alunos que cada inteiro obtido a partir da separação da

mensagem original é um elemento do domínio para o qual calcularemos a imagem via função

de codiﬁcação. Neste momento, deve-se escolher qual será a função aﬁm utilizada para co-

diﬁcação. Cada grupo receberá uma função diferente, ﬁca a critério do professor determinar

se cada um dos grupos terá liberdade para escolher a função empregada ou se o professor

fornecerá as funções. Como exemplo, vamos utilizar a função f deﬁnida como segue:1

f : N → Z

1Observe que o domínio da função é natural, mas, dependendo da função utilizada, a imagem pode ser

um número negativo. Portanto, utilizaremos Z como contradomínio. É interessante aproveitar o momento

para indagar os alunos quanto ao domínio e contradomínio da função.

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

59

x (cid:55)→ 2x − 1

Aplicando a função a cada bloco de mensagem, temos:

f (231130) = 2.231130 − 1 = 462259

f (152311) = 2.152311 − 1 = 304621

f (301913) = 2.301913 − 1 = 603825

f (111522) = 2.111522 − 1 = 223043

f (1517) = 2.1517 − 1 = 3033

f (1122) = 2.1122 − 1 = 2243

Portanto, a mensagem criptografada é

462259 304621 603825 223043 3033 2243

Neste momento, o professor deverá trocar as mensagens criptografadas entre os gru-

pos. Cada grupo deverá receber a mensagem criptografa e a função de codiﬁcação empregada.

O grupo deverá, então, determinar a inversa f −1 da função recebida e aplicá-la a cada bloco

de mensagem criptografada. No nosso exemplo, temos que f −1(y) =

y + 1
2

. Vejamos:

f −1(462259) =

f −1(304621) =

f −1(603825) =

f −1(223043) =

f −1(3033) =

f −1(2243) =

462259 + 1
2
304621 + 1
2
603825 + 1
2
223043 + 1
2
3033 + 1
2
2243 + 1
2

=

=

=

=

=

=

462260
2
304622
2
603826
2
223044
2
3034
2
2244
2

= 231130

= 152311

= 301913

= 111522

= 1517

= 1122

Desta forma, retornamos para a mensagem original. Basta, então, substituir cada

bloco de dois dígitos por uma letra conforme a tabela da ﬁgura 5.2.

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

60

5.2 Determinar interseções entre uma reta e uma curva

Com esta atividade, pretende-se aplicar os conhecimentos dos alunos em conteúdos

que envolvam determinar se um ponto pertence a uma curva, determinar a equação de uma

reta e compreender as interseções entre duas curvas como sendo as soluções de um sistema de

equações. É desejável que a atividade seja realizada em dupla, para veriﬁcação dos cálculos.

Cada dupla deverá receber cópias impressas dos gráﬁcos das curvas para manipulação.

Ações Didáticas

Para realizar esta atividade, deve-se, primeiramente, familiarizar o aluno com a ideia

de ponto pertencente a uma curva, iniciando com curvas simples, como uma parábola. Ob-

serve o exemplo:

Exemplo 5.1. Veriﬁque se os pontos A = (1, 4) e B = (2, −3) pertencem à parábola y =

x2 − 4x + 1

Solução:

Vejamos, primeiramente, o ponto A. Substituindo as coordenadas do ponto na

equação da parábola, temos:

x2 − 4x + 1 = 12 − 4.1 + 1 = 1 − 4 + 1 = −2

mas y = 4, como −2 (cid:54)= 4, A não pertence à parábola. Vejamos o ponto B:

x2 − 4x + 1 = 22 − 4.2 + 1 = 4 − 8 + 1 = −3

Como y = −3, temos que B pertence à parábola

(cid:3)

Após a familiarização, deve-se mostrar aos alunos o gráﬁco de uma curva elíptica,

como a curva do exemplo 3.1, de equação y2 = x3 − 2x + 2, e pedir aos alunos que veriﬁquem

se os pontos C = (1, −1) e D = (3, 4) pertencem à curva. Espera-se que os alunos respondam

que apenas o ponto C pertence à curva. O professor deve perguntar qual o outro ponto da

curva cuja coordenada x = 1 e quais os pontos cuja coordenada x = 3. Deve-se aproveitar

esta oportunidade para explicar que a curva é simétrica em relação ao eixo horizontal.

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

61

Mostre, agora, a curva do exemplo 3.2, de equação y2 = x3 − 4x + 3, e peça que os

alunos veriﬁquem que os pontos (1, 0) e (2,

3) pertencem à curva. Alunos que já estudaram

Geometria Analítica no ensino médio devem estar habituados a determinar a equação de uma

reta que passa por dois pontos. Solicite que os alunos determinem a equação da reta que

passa pelos pontos citados, o resultado deve ser

√

√

3

3x −

y =

.

Espera-se que os alunos percebam, a partir do gráﬁco, que a reta e a curva intersectam-

√

√

se em três pontos, sendo que (1, 0) e (2,

3) são dois pontos de interseção. Resta, portanto,

determinar o terceiro ponto. Mostre para os alunos que, para encontrar este terceiro ponto,

basta resolver o sistema de equações






y2 = x3 − 4x + 3

√

y =

3x −

√
3

Substituindo a segunda equação na primeira, obtemos:

√
(

3x −

√

3)2 = x3 − 4x + 3

3x2 − 6x + 3 = x3 − 4x + 3

x3 − 3x2 + 2x = 0

(5.1)

No ensino médio os alunos ainda não resolvem equações cúbicas, no entanto, a equação

(5.1) é de fácil resolução. Colocando x em evidência, temos:

x(x2 − 3x + 2) = 0

O que implica dizer que x1 = 0 é uma raiz da equação. Para determinar as demais
raízes, basta resolver a equação do segundo grau x2 − 3x + 2 = 0, de onde obtemos x2 = 1

e x3 = 2, o que já sabíamos. Portanto, o terceiro ponto de interseção entre a reta e a curva

elíptica é o ponto tal que x = 0, ou seja,

√

3.0 −

√

y =

√

3 = −

3

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

62

.

O ponto procurado é (0, −

√

3)

O professor pode aproveitar a oportunidade e destacar que, como a curva é simétrica

em relação ao eixo horizontal, a reﬂexão deste ponto em relação ao referido eixo também

pertence à curva. Peça que os alunos veriﬁquem que o ponto (0,

3) pertence à curva em

questão. Alternativamente, o professor pode apresentar a deﬁnição 3.2.1 para o caso em

√

que P (cid:54)= Q e pedir que os alunos façam a veriﬁcação fazendo P = (1, 0) e Q = (2,

3). É

√

importante ressaltar para os alunos que, na deﬁnição 3.2.1, m é o coeﬁciente angular da reta

entre P e Q. Uma outra forma de veriﬁcação de resultados nesta atividade é a utilização de

softwares como o Geogebra.

5.3 Múltiplos de Pontos de Curvas sobre Zp

Para realizar esta atividade, os alunos deverão retomar a noção de resto de divisão

inteira e trabalharão implicitamente com a ideia de congruência. Também será necessário

fazer uma breve introdução à Aritmética Modular. Para facilitar a compreensão, pode-se
deﬁnir o conjunto Zp, com p primo, da seguinte maneira:

Zp = {x ∈ Z+|x < p}

Deve-se mostrar aos alunos que qualquer inteiro n possui um valor equivalente no
conjunto Zp, bastando apenas calcular o resto da divisão de n por p. É interessante que o

professor utilize a divisão inteira vista no teorema 1.2, ou seja, n = pq + r, sendo r o resto.
Por exemplo, Z7 = {0, 1, 2, 3, 4, 5, 6}. Temos que, para Z7, 29 equivale a 1, pois

29 = 7.4 + 1, logo, o resto da divisão de 29 por 7 é igual a 1. Em seguida, deve-se mostrar
aos alunos como resolver equações em Zp. Vejamos um exemplo.

Exemplo 5.2. Considere o conjunto Z5. Determine o valor de x na equação 3x = 4.

Solução:

Os possíveis valores de x são os elementos de Z5, ou seja:

Z5 = {0, 1, 2, 3, 4}

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

63

Façamos a veriﬁcação para cada valor por tentativa e erro.

x = 0 =⇒ 3.0 = 5.0 + 0 e 0 (cid:54)= 4

x = 1 =⇒ 3.1 = 5.0 + 3 e 3 (cid:54)= 4

x = 2 =⇒ 3.2 = 6 = 5.1 + 1 e 1 (cid:54)= 4

x = 3 =⇒ 3.3 = 9 = 5.1 + 4 e 4 = 4

Portanto, temos x = 3.

(cid:3)

Ações Didáticas

A partir do momento em que a turma conseguir resolver equações como a do exemplo

5.2, a atividade pode ser aplicada. Inicialmente, o professor deve introduzir a deﬁnição 3.2.1

e apresentar alguns exemplos de soma, certiﬁcando-se de que os alunos compreendam que

o ponto O é o elemento neutro da operação. Podem ser utilizadas algumas das somas do

exemplo 3.7, para habituá-los à operação.

Quando os alunos estiverem familiarizados, apresente a curva do exemplo 3.5, de

equação y2 = x3 − x + 3 sobre Z11, mostrando todos os pontos da curva, a saber,

(0, 5)

(0, 6)

(1, 5)

(1, 6)

(2, 3)

(2, 8)

(3, 3)

(3, 7)

(6, 2)

(6, 9)

(7, 3)

(7, 8)

(8, 1)

(8, 10)

(10, 5)

(10, 6)

Solicite que os alunos escolham um ponto P qualquer e calculem o ponto 2P . Em

seguida, que façam um mesmo para um ponto Q qualquer, diferente de P , e determinem 2Q.

Após isto, proponha os seguintes questionamentos:

I - 2P pertence à curva?

II - 2Q pertence à curva?

• Calcule P + Q e então calcule 2(P + Q)

• Calcule 2P + 2Q

III - Qual a relação entre 2(P + Q) e 2P + 2Q?

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

64

IV - Se ﬁzermos 3(P + Q) e 3P + 3Q esta relação se mantém?

V - Calcule 2(2P ) e 4P . Qual a relação entre estes pontos?

O aluno deverá ser capaz de deduzir que nos itens III, IV e V acima os pontos em

questão são iguais e, com isto, concluir que a multiplicação por escalar para um ponto da

curva goza das propriedades associativa, comutativa, distributiva e pode considerar 1 como

elemento neutro.

Voltemos, agora, para o exemplo 3.7, com y2 = x3 + 2x − 1 sobre Z13. Mostre para

os alunos todos os múltiplos do ponto P = (5, 2).

1P = P = (5, 2)

2P = P + P = (5, 2) + (5, 2) = (12, 3)

3P = 2P + P = (12, 3) + (5, 2) = (0, 8)

4P = 3P + P = (0, 8) + (5, 2) = (11, 0)

5P = 4P + P = (11, 0) + (5, 2) = (0, 5)

6P = 5P + P = (0, 5) + (5, 2) = (12, 10)

7P = 6P + P = (12, 10) + (5, 2) = (5, 11)

8P = 7P + P = (5, 11) + (5, 2) = O

É importante ressaltar que, para este ponto, tem-se que 8P = O, deste modo, temos,

por exemplo, que

ou ainda

13P = 8P + 5P = O + 5P = (0, 5)

37P = 4.8P + 5P = 4O + 5P = O + 5P = 5P = (0, 5)

Proponha o seguinte desaﬁo para os alunos: considerando P = (5, 2), determine o

ponto 1500P .

Uma maneira de resolver é empregando a decomposição

1500P = 187.8P + 4P = 187O + 4P = O + 4P = 4P = (11, 0)

Proponha que os alunos calculem 3000P . Espera-se que os mesmos encontrem facil-

mente o resultado

3000P = 2.1500P = 2.4P = 8P = O

CAPÍTULO 5. SUGESTÕES DE ATIVIDADES PARA O ENSINO MÉDIO

65

Deste modo, pode-se determinar qualquer múltiplo de P a partir de decomposições.

Proponha que os alunos façam o mesmo escolhendo algum outro ponto da curva.

5.4 Simulação do Criptossistema ElGamal aplicado a cur-

vas elípticas

Para aplicar esta atividade, é necessário que a turma já tenha realizado a atividade

5.3 anteriormente. Sugerimos que, antes de aplicar a atividade, seja feita um leitura atenta

da seção 4.2 pelo professor.

Ações Didáticas

O professor deve separar a turma em várias duplas. Um aluno será o emissor e o

outro será o receptor da mensagem criptografada. Para esta atividade utilizaremos a curva
do exemplo 4.1, de equação y2 = x3 + 9x + 17 sobre Z23, considerando o ponto P = (16, 5)

como gerador. Abaixo, temos o mapeamento de todos os pontos desta curva:

(1, 2)

(1, 21)

(3, 5)

(3, 18)

(4, 5)

(4, 18)

(5, 7)

(5, 16)

(7, 3)

(7, 20)

(8, 7)

(8, 16)

(10, 7)

(10, 16)

(12, 6)

(12, 17)

(13, 10)

(13, 13)

(14, 9)

(14, 14)

(15, 10)

(15, 13)

(17, 0)

(18, 10)

(18, 13)

(19, 3)

(19, 20)

(20, 3)

(20, 20)

Solicite que cada aluno emissor secretamente escolha um dentre os pontos do ma-

peamento e não informe para o colega de dupla. Os alunos executarão o passo a passo do

criptossistema ElGamal, seguindo as orientações do professor. Veriﬁque se o ponto escolhido

pelo aluno emissor é o mesmo obtido pelo aluno receptor. Em seguida, deve-se repetir a

atividade, trocando os papéis de cada aluno. o emissor passa a ser receptor e vice versa.

CONSIDERAÇÕES FINAIS

Neste trabalho estudamos um método de criptograﬁa que envolve curvas elípticas,

cuja segurança é garantida pela diﬁculdade de solução do problema do logaritmo discreto.

Vimos que determinar o logaritmo discreto, para primos com grande quantidade de algaris-

mos, é um procedimento inviável, pois demanda um tempo considerável para se encontrar

a solução. Com base nisto, mostramos dois modelos de criptograﬁa que se utilizam da

diﬁculdade descrita anteriormente para proporcionar segurança na transmissão de dados.

Mostramos que uma curva elíptica deﬁnida sobre um corpo Zp, munida da operação

de soma entre dois pontos da curva, é um grupo abeliano. Desta forma, o problema do

logaritmo discreto pode ser adaptado a esta estrutura e, deste modo, podemos aplicar os

métodos de criptograﬁa estudados, realizando as devidas adaptações.

Sugerimos algumas atividades para aplicação em turmas do ensino médio baseadas

no tema deste trabalho. Com o crescimento do acesso a tecnologias da informação, observa-

se maior interesse dos discentes por assuntos relacionados a esta área. Ao utilizar celulares

com aplicativos de troca de mensagens e outros que requerem sigilo da informação, indire-

tamente se está utilizando algum sistema de criptograﬁa. Pode-se utilizar este fato como

ponto de partida para introduzir o tema segurança da informação como motivador para a

realização das atividades propostas neste trabalho. Com isto, objetivamos despertar o in-

teresse do aluno pela matemática por trás da prática em assuntos relacionados a tecnologia

da informação

Ainda há muito a ser estudado sobre o tema e muitas abordagens possíveis. Pretende-

se, com este trabalho, contribuir para o enriquecimento da bibliograﬁa sobre o tema em língua

portuguesa, que ainda é escassa.

66

Referências Bibliográﬁcas

[1] BRASIL, LEI 9394 de 20/12/1996. Lei de Diretrizes e Bases da Educação

Nacional. Disponível em: <http://www.planalto.gov.br/ccivil_03/Leis/L9394.htm>.

Acesso em: 24 de janeiro de 2015.

[2] CORREIA JUNIOR, Sergio dos Santos. Criptograﬁa via curvas elípticas.

2013. 87 f. Dissertação (Mestrado Proﬁssional em Matemática - PROFMAT)

- Universidade Federal do Estado do Rio de Janeiro - UNIRIO. Disponível

em: <http://www2.unirio.br/unirio/ccet/profmat/tcc/2011/TCCSergioCorreia.pdf>.

Acesso em: 23 de agosto de 2015.

[3] DELGADO, J., FRENSEL, K., CRISSAFF, L. Geometria Analítica. SBM, 2014

(Coleção PROFMAT).

[4] DIFFIE, W. and HELLMAN, M.E. New directions in criptography. IEEE Transac-

tions on Information Theory. Vol. 22, No 6, Pág. 644-654, 1976.

[5] GONÇALVES, Adilson. Introdução à Álgebra. Rio de Janeiro: IMPA, 2008

[6] HERSTEIN, I. N. Topics in Algebra. Chicago: Blaisdell Publishing Company, 1964.

[7] LANDAU, Edmund. Teoria Elementar dos Números. Coleção Clássicos da

Matemática. 1a edição. Rio de Janeiro: Ciência Moderna, 2002.

[8] MILLIES, César Polcino & COELHO, Sônia Pitta. Números. Uma Introdução à

Matemática. 3a edição. São Paulo: Edusp, 2001.

[9] SAEKI, Mugino. Elliptic curve cryptosystems. 1997. 82 f. Dissertação (Master of

Science in Computer Science) - School of Computer Sciences, McGill University, Mon-

67

REFERÊNCIAS BIBLIOGRÁFICAS

68

treal. Disponível em <http://www.cs.mcgill.ca/ crepeau/PDF/memoire-mugino.pdf>.

Acesso em: 23 de agosto de 2015.

[10] SANTOS, José Plínio de Oliveira. Introdução à Teoria dos Números. Coleção

Matemática Universitária. Rio de Janeiro: IMPA, 1998.

[11] SILVERMAN, Joseph H. The Arithmetic of Elliptic Curves.. Graduate Texts in

Mathematics. 2nd edition. San Francisco: Springer, 2009.

[12] SIPSER, Michael. Introdução à Teoria da Computação. São Paulo: Thomson,

2007.

[13] STALLINGS, William. Criptograﬁa e Segurança de Redes: princípios e práti-

cas. 4a edição. São Paulo: Pearson Prentice Hall, 2008.

[14] STINSON, Douglas R. Criptography: theory and practice. 3rd edition. Boca Ra-

ton/Florida: Chapman & Hall, 2006.

[15] TERADA, Routo. Segurança de Dados: criptograﬁa em redes de computador.

São Paulo: Edgar Blücher, 2000.

[16] WASHINGTON, Lawrence C. Elliptic Curves: number theory and criptography.

2nd edition. Boca Raton: Chapman & Hall, 2008.

Apêndice A – Programa para calcular o

logaritmo discreto

Para calcular o logaritmo discreto nos exemplos do texto, elaboramos um programa
na linguagem de programação C++ que, dados o primo p, o gerador g de Zp e o inteiro para

o qual desejamos calcular o logaritmo discreto, retorna o valor do logaritmo. Para isto, o

programa testa todos os valores possíveis, iniciando em 1, até encontrar o resultado.

#include <iostream>

#include <cmath>

using namespace std;

int resto;

int main()

{

int primo; //primo p

int contador=0; //controla o expoente

int gerador; //gerador de Zp

int logaritmo; //valor para o qual sera calculado o logaritmo

cout « "Informe o numero primo p: "; //exibicao na tela

cin » primo; //leitura do valor informado pelo usuario

cout « "Informe o gerador de Z"« primo « ":

";

cin » gerador;

cout « "Informe o valor para calcular o logaritmo:

";

69

REFERÊNCIAS BIBLIOGRÁFICAS

70

cin » logaritmo;

resto=primo+1; //p+1 congruente a 1 mod p

while (resto != logaritmo) //enquanto o resto nao for o esperado

contador++;

resto=(gerador*resto)%primo;

cout « contador-1 « "nao e a resposta" « endl;

{

}

endl;

cout « "O resultado e "« contador « endl;

}

Anexo A – Demonstração do Teorema

1.1: Teorema Fundamental da

Aritmética

Apresentamos uma demonstração do Teorema 1.1 retirada de SANTOS [10], página

9.

Teorema 1.1 (Teorema Fundamental da Aritmética). Todo número inteiro positivo maior

que 1 pode ser escrito de maneira única como o produto de números primos, a menos da

ordem dos fatores.

Demonstração:

Seja n um número inteiro. Se n é primo, não há nada a ser demonstrado. Suponha-

mos, pois, n composto. Seja p1, com p1 > 1, o menor dos divisores positivos de n. Aﬁrmamos

de que p1 é primo. Isto é verdade, pois, caso contrário, existiria p, com 1 < p < p1, tal que

p|n, contradizendo a escolha de p1. Logo, n = p1n1.

Se n1 for primo, a prova está completa. Caso contrário, tomamos p2 como o menor

fator de n1. Pelo argumento anterior, p2 é primo e temos que n = p1p2n2.

Repetindo este procedimento, obtemos uma sequência decrescente de inteiros positi-

vos n1, n2, . . . , nr. Como todos eles são inteiros maiores do que 1, este processo deve terminar.

Como os primos na sequência p1, p2, . . . , pk não são, necessariamente, distintos, n terá, em

geral, a forma:

n = pα1

1 pα2

2 . . . pαk

k

Para mostramos a unicidade usamos indução em n. Para n = 2 a aﬁrmação é

71

REFERÊNCIAS BIBLIOGRÁFICAS

72

verdadeira. Assumimos, então, que ela se veriﬁca para todos os inteiros maiores do que 1 e

menores do que n. Vamos provar que ela também é verdadeira para n. Se n é primo, não há

nada a provar. Vamos supor, então, que n seja composto e que tenha duas fatorações, isto

é,

n = p1p2 . . . ps = q1q2 . . . qr

Vamos provar que s = r e que cada pi é igual a algum qj. Como p1 divide o produto q1q2 . . . qr,

ele divide pelo menos um dos fatores qj. Sem perda de generalidade, podemos supor que

p1|q1. Como são ambos primos, isto implica p1 = q1. Logo, n/p1 = p2 . . . ps = q2 . . . qr.

Como 1 < n/p1 < n, a hipótese de indução nos diz que as duas fatorações são idênticas, isto

é, s = r e, a menos da ordem, as fatorações p1p2 . . . ps e q1q2 . . . qr são iguais.

(cid:3)

Anexo B – Demonstração do Teorema

1.3: Pequeno Teorema de Fermat

Apresentamos uma demonstração do Teorema 1.3 retirada de SANTOS [10], página

41.

Teorema 1.3 (Pequeno Teorema de Fermat). Sejam p primo e a um inteiro. Se p (cid:45) a, então

ap−1 ≡ 1 (mod p).

Demonstração:

Sabemos que o conjunto formado pelos p números 0, 1, 2, . . . , p − 1 constitui um

sistema completo de resíduos módulo p (ver deﬁnição 1.1.5).

Isto signiﬁca que qualquer

conjunto contendo no máximo p elementos incongruentes módulo p pode ser colocado em

correspondência biunívoca com um subconjunto de {0, 1, 2, . . . , p − 1}. Vamos, agora, con-

siderar os números a, 2a, 3a, . . . , (p − 1)a. Como mdc(a, p) = 1, nenhum destes números ia,

1 ≤ i ≤ p − 1 é divisível por p, ou seja, nenhum é congruente a zero módulo p. Quaisquer

dois deles são incongruentes módulo p, pois aj ≡ ak (mod p) implica j ≡ k (mod p) e isto

só é possível se j = k, uma vez que ambos j e k são positivos e menores do que p. Temos,

portanto, um conjunto de p − 1 elementos incongruentes módulo p e não-divisíveis por p.

Logo, cada um deles é congruente a exatamente um dentre os elementos 1, 2, 3, . . . , p − 1. Se

multiplicarmos estas congruências, membro a membro, teremos:

a(2a)(3a) . . . (p − 1)a ≡ 1.2.3 . . . (p − 1) ( mod p)

ou seja, ap−1(p − 1)! ≡ (p − 1)! (mod p). Mas, como mdc((p − 1)!, p) = 1, podemos cancelar

o fator (p − 1)! em ambos os lados, obtendo

ﬁnalizando, assim, a demonstração.

ap−1 ≡ 1 ( mod p),

73

Anexo C – Demonstração do Teorema

1.5: Teorema de Euler

Apresentamos uma demonstração do Teorema 1.5 retirada de SANTOS [10], página

43.

Teorema 1.5 (Teorema de Euler). Sejam a, m ∈ Z com m ≥ 1, tais que mdc(a, m) = 1,

então

Demonstração:

aφ(m) ≡ 1 ( mod m)

No teorema 1.4 mostramos que os elementos ar1, ar2, . . . , arφ(m) constituem um sis-

tema reduzido de resíduos módulo m se mdc(a, m) = 1 e r1, r2, . . . , rφ(m) for um sistema

reduzido de resíduos módulo m. Isto signiﬁca que ari é congruente a exatamente um dos rj,

1 ≤ j ≤ φ(m), e portanto o produto dos ari deve ser congruente ao produto dos rj módulo

m, isto é,

ou seja

ar1.ar2 . . . arφ(m) ≡ r1.r2 . . . rφ(m) ( mod m)

aφ(m)r1.r2 . . . rφ(m) ≡ r1.r2 . . . rφ(m)( mod m)

Como para cada ri, com 1 ≤ ri ≤ φ(m), temos mdc(ri, m) = 1, podemos cancelar

cada ri em ambos os lados para obter aφ(m) ≡ 1 (mod m)

(cid:3)

74

